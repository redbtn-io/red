(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},94785,e=>{"use strict";e.s(["default",()=>x],94785);var r=e.i(43476),t=e.i(71645),a=e.i(25697),s=e.i(2971),o=e.i(22140);let l="text-xs px-3 py-1 rounded bg-[var(--background)] text-[var(--foreground)] hover:bg-[var(--background)]/60",n="bg-[var(--red-primary)] text-white";function i(e){return!!e&&"object"==typeof e&&!!Object.prototype.hasOwnProperty.call(e,"logs")&&Array.isArray(e.logs)}function c(e){let{conversationId:a,generationId:s,filterLevel:o,filterCategory:c,showThoughts:u,onStreamingChange:g}=e,[x,v]=(0,t.useState)([]),[m,h]=(0,t.useState)(!1),[b,p]=(0,t.useState)(null),[f,j]=(0,t.useState)(!0),[y,N]=(0,t.useState)(!1),w=(0,t.useRef)(null),k=(0,t.useRef)(null),S=(0,t.useCallback)(async()=>{g(!0);try{var e;let r=s?"/api/v1/generations/".concat(s,"/stream"):"/api/v1/conversations/".concat(a,"/stream"),t=await fetch(r);if(!t.ok)throw Error("Failed to stream logs");let o=null==(e=t.body)?void 0:e.getReader();if(!o)throw Error("Stream not available");let l=new TextDecoder,n="";for(;;){let{done:e,value:r}=await o.read();if(e)break;let t=(n+=l.decode(r,{stream:!0})).split("\n");for(let e of(n=t.pop()||"",t))if(e.startsWith("data: "))try{let r=JSON.parse(e.slice(6));r&&"object"==typeof r&&"id"in r&&"timestamp"in r&&v(e=>[...e,r])}catch(e){console.error("Failed to parse log:",e)}else if(e.startsWith("event: complete"))return void g(!1)}}catch(e){console.error("Streaming error:",e instanceof Error?e.message:String(e)),g(!1)}},[a,s,g]);(0,t.useEffect)(()=>{f&&w.current&&w.current.scrollIntoView({behavior:"smooth"})},[x,f]),(0,t.useEffect)(()=>a||s?(k.current&&k.current.abort(),k.current=new AbortController,(async()=>{h(!0),p(null),g(!1);try{var e,r;let t=!1;if(s){let r=await fetch("/api/v1/generations/".concat(s,"/logs"),{signal:null==(e=k.current)?void 0:e.signal});if(!r.ok)throw Error("Failed to fetch logs");let a=await r.json();i(a)&&v(a.logs);let o=await fetch("/api/v1/generations/".concat(s)),l=await o.json();l&&"string"==typeof l.status&&(t="generating"===l.status)}else if(a){let e=await fetch("/api/v1/conversations/".concat(a,"/logs"),{signal:null==(r=k.current)?void 0:r.signal});if(!e.ok)throw Error("Failed to fetch logs");let s=await e.json();i(s)&&v(s.logs);let o=await fetch("/api/v1/conversations/".concat(a,"/generation-state")),l=await o.json();l&&"boolean"==typeof l.isGenerating&&(t=l.isGenerating)}h(!1),t&&S()}catch(r){let e=r&&"string"==typeof r.name&&"AbortError"===r.name?null:r instanceof Error?r.message:String(r);e&&(p(e),h(!1))}})(),()=>{var e;null==(e=k.current)||e.abort()}):void v([]),[a,s,S,g]);let C=x.filter(e=>("all"===o||e.level===o)&&("all"===c||e.category===c)&&(!!u||"thought"!==e.category));return a||s?m?(0,r.jsxs)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] p-12 text-center",children:[(0,r.jsx)("div",{className:"inline-block w-8 h-8 border-4 border-[var(--background)] border-t-[var(--red-primary)] rounded-full animate-spin mb-4"}),(0,r.jsx)("p",{className:"text-[var(--foreground)] opacity-60",children:"Loading logs..."})]}):b?(0,r.jsx)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] p-6",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"text-2xl",children:"âŒ"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-[var(--red-primary)] mb-1",children:"Error loading logs"}),(0,r.jsx)("p",{className:"text-[var(--foreground)] opacity-60 text-sm",children:b})]})]})}):(0,r.jsxs)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-[var(--background)]/40 border-b border-[var(--border-color)] px-4 py-3 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm text-[var(--foreground)] opacity-70",children:[(0,r.jsx)("span",{className:"font-medium",children:C.length})," ",1===C.length?"log":"logs"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>j(!f),className:"".concat(l," ").concat(f?n:""),title:f?"Disable auto-scroll":"Enable auto-scroll",children:f?"ðŸ“Œ Auto":"ðŸ“Œ"}),(0,r.jsx)("button",{onClick:()=>N(!y),className:"".concat(l," ").concat(y?n:""),title:y?"Disable compact view":"Enable compact view",children:y?"ï¿½ Compact":"ï¿½"}),(0,r.jsx)("button",{onClick:()=>v([]),className:l,title:"Clear logs",children:"ðŸ—‘ï¸"}),(0,r.jsx)("button",{onClick:()=>{let e=C.map(e=>"[".concat(new Date(e.timestamp).toISOString(),"] [").concat(e.level,"] ").concat(e.message.replace(/<\/?(?:red|green|yellow|blue|magenta|cyan|white|black|gray|dim|bold|underline|blink|reverse|hidden)>/gi,""))).join("\n");navigator.clipboard.writeText(e)},className:l,title:"Copy logs",children:"ðŸ“‹"})]})]}),(0,r.jsx)("div",{className:"p-4 max-h-[70vh] overflow-y-auto font-sans text-sm",children:0===C.length?(0,r.jsx)("div",{className:"text-center py-12 text-[var(--foreground)] opacity-60",children:"No logs match the current filters"}):(0,r.jsxs)("div",{className:"space-y-2",children:[C.map(e=>(0,r.jsx)(d,{log:e,compact:y},e.id)),(0,r.jsx)("div",{ref:w})]})})]}):(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg border border-gray-800 p-12 text-center",children:[(0,r.jsx)("div",{className:"text-6xl mb-4",children:"ðŸ“"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No logs selected"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Enter a conversation ID or generation ID to view logs"})]})}function d(e){let a,{log:s,compact:o}=e,l=new Date(s.timestamp).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3}),n=(a=s.message,Object.entries({red:"text-red-400",green:"text-green-400",yellow:"text-yellow-400",blue:"text-blue-400",magenta:"text-magenta-400",cyan:"text-cyan-400",white:"text-white",gray:"text-gray-400",dim:"text-gray-500",bold:"font-bold"}).forEach(e=>{let[r,t]=e,s=RegExp("<".concat(r,">"),"gi");a=a.replace(s,'<span class="'.concat(t,'">'))}),a=a.replace(/<\/(?:red|green|yellow|blue|magenta|cyan|white|black|gray|dim|bold|underline|blink|reverse|hidden)>/gi,"</span>")),[i,c]=(0,t.useState)(!1);return(0,r.jsxs)("div",{className:"".concat("py-3 px-3 rounded-lg group border border-[var(--border-color)]/30 bg-[var(--background)]"," ").concat(o?"py-2 px-2":"py-3 px-3"),children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 ".concat(o?"mb-1":"mb-2"," flex-wrap"),children:[(0,r.jsx)("span",{className:"text-[var(--foreground)]/70 text-xs tabular-nums shrink-0",children:l}),(0,r.jsx)("span",{className:"shrink-0",title:s.level,children:{debug:"ðŸ›",info:"â„¹ï¸",success:"âœ…",warning:"âš ï¸",error:"âŒ"}[s.level]||"â€¢"}),(0,r.jsx)("span",{className:"shrink-0 text-xs uppercase font-semibold ".concat({debug:"text-gray-500",info:"text-blue-400",success:"text-green-400",warning:"text-yellow-400",error:"text-red-400"}[s.level]),children:s.level}),(0,r.jsx)("span",{className:"shrink-0 text-xs text-[var(--foreground)]/60 uppercase",children:s.category}),(0,r.jsx)("button",{onClick:()=>c(e=>!e),className:"ml-auto text-xs px-2 py-1 rounded bg-[var(--background)] text-[var(--foreground)] hover:bg-[var(--background)]/60",title:i?"Collapse":"Expand",children:i?"â–¾":"â–¸"})]}),(!o||i)&&(0,r.jsx)("div",{className:"pl-2 break-words text-sm leading-relaxed font-mono text-[var(--foreground)]/90",children:(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:n}})})]})}function u(e){let{conversationId:t,setConversationId:a,generationId:s,setGenerationId:o,filterLevel:l,setFilterLevel:n,filterCategory:i,setFilterCategory:c,showThoughts:d,setShowThoughts:u}=e;return(0,r.jsxs)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] p-4 space-y-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-[var(--foreground)] mb-4",children:"Filters"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"Conversation ID"}),(0,r.jsx)("input",{type:"text",value:t,onChange:e=>{a(e.target.value),o("")},placeholder:"conv_...",className:"w-full px-3 py-2 bg-[var(--background)] border border-[var(--border-color)] rounded text-sm text-[var(--foreground)] placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--red-primary)]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"Generation ID"}),(0,r.jsx)("input",{type:"text",value:s,onChange:e=>{o(e.target.value),a("")},placeholder:"gen_...",className:"w-full px-3 py-2 bg-[var(--background)] border border-[var(--border-color)] rounded text-sm text-[var(--foreground)] placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--red-primary)]"})]}),(0,r.jsx)("div",{className:"border-t border-[var(--border-color)] pt-4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"Log Level"}),(0,r.jsxs)("select",{value:l,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 bg-[var(--background)] border border-[var(--border-color)] rounded text-sm text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--red-primary)]",children:[(0,r.jsx)("option",{value:"all",children:"All Levels"}),(0,r.jsx)("option",{value:"debug",children:"ðŸ› Debug"}),(0,r.jsx)("option",{value:"info",children:"â„¹ï¸ Info"}),(0,r.jsx)("option",{value:"success",children:"âœ… Success"}),(0,r.jsx)("option",{value:"warning",children:"âš ï¸ Warning"}),(0,r.jsx)("option",{value:"error",children:"âŒ Error"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"Category"}),(0,r.jsxs)("select",{value:i,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 bg-[var(--background)] border border-[var(--border-color)] rounded text-sm text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--red-primary)]",children:[(0,r.jsx)("option",{value:"all",children:"All Categories"}),(0,r.jsx)("option",{value:"generation",children:"ðŸ”„ Generation"}),(0,r.jsx)("option",{value:"router",children:"ðŸ§­ Router"}),(0,r.jsx)("option",{value:"tool",children:"ðŸ”§ Tool"}),(0,r.jsx)("option",{value:"chat",children:"ðŸ’¬ Chat"}),(0,r.jsx)("option",{value:"thought",children:"ðŸ’­ Thought"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:d,onChange:e=>u(e.target.checked),className:"w-4 h-4 rounded border-[var(--border-color)] bg-[var(--background)] text-[var(--red-primary)] focus:ring-2 focus:ring-[var(--red-primary)]"}),(0,r.jsx)("span",{className:"text-sm text-[var(--foreground)] opacity-70",children:"ðŸ’­ Show Thoughts"})]}),(0,r.jsx)("p",{className:"text-xs text-[var(--foreground)] opacity-50 mt-1 ml-6",children:"Internal reasoning from AI nodes"})]}),(0,r.jsxs)("div",{className:"border-t border-[var(--border-color)] pt-4 space-y-2",children:[(0,r.jsx)("button",{onClick:()=>{n("all"),c("all"),u(!0)},className:"w-full px-3 py-2 bg-[var(--background)] hover:bg-[var(--sidebar-bg)] text-sm text-[var(--foreground)] opacity-70 hover:opacity-100 rounded transition-all",children:"Reset Filters"}),(0,r.jsx)("button",{onClick:()=>{a(""),o("")},className:"w-full px-3 py-2 bg-[var(--background)] hover:bg-[var(--sidebar-bg)] text-sm text-[var(--foreground)] opacity-70 hover:opacity-100 rounded transition-all",children:"Clear IDs"})]})]})}function g(e){let{conversationId:a}=e,[s,o]=(0,t.useState)(null),[l,n]=(0,t.useState)(!1);return((0,t.useEffect)(()=>{if(!a)return void o(null);let e=async()=>{n(!0);try{let e=await fetch("/api/v1/logs/stats?conversationId=".concat(a));if(e.ok){let r=await e.json();o(r)}}catch(e){console.error("Failed to fetch stats:",e)}n(!1)};e();let r=setInterval(()=>{(null==s?void 0:s.isGenerating)&&e()},5e3);return()=>clearInterval(r)},[a,null==s?void 0:s.isGenerating]),a)?l&&!s?(0,r.jsx)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] p-4",children:(0,r.jsxs)("div",{className:"animate-pulse space-y-3",children:[(0,r.jsx)("div",{className:"h-4 bg-[var(--background)] rounded w-3/4"}),(0,r.jsx)("div",{className:"h-4 bg-[var(--background)] rounded w-1/2"})]})}):s?(0,r.jsxs)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] p-4 space-y-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-[var(--foreground)] mb-4",children:"Statistics"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-[var(--foreground)] opacity-60",children:"Total Logs"}),(0,r.jsx)("span",{className:"text-[var(--foreground)] font-semibold",children:s.totalLogs})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-[var(--foreground)] opacity-60",children:"Generations"}),(0,r.jsx)("span",{className:"text-[var(--foreground)] font-semibold",children:s.generationCount})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-[var(--foreground)] opacity-60",children:"Status"}),(0,r.jsx)("span",{className:s.isGenerating?"text-[var(--red-primary)]":"text-[var(--foreground)] opacity-40",children:s.isGenerating?"ðŸŸ¢ Active":"âšª Idle"})]})]}),(0,r.jsxs)("div",{className:"border-t border-[var(--border-color)] pt-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"By Level"}),(0,r.jsx)("div",{className:"space-y-2",children:Object.entries(s.byLevel).map(e=>{let[t,a]=e,o={debug:"text-gray-500",info:"text-blue-400",success:"text-green-400",warning:"text-yellow-400",error:"text-red-400"},l=s.totalLogs>0?a/s.totalLogs*100:0;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,r.jsxs)("span",{className:o[t],children:[{debug:"ðŸ›",info:"â„¹ï¸",success:"âœ…",warning:"âš ï¸",error:"âŒ"}[t]," ",t]}),(0,r.jsx)("span",{className:"text-[var(--foreground)] opacity-60",children:a})]}),(0,r.jsx)("div",{className:"w-full bg-[var(--background)] rounded-full h-1.5",children:(0,r.jsx)("div",{className:"h-1.5 rounded-full ".concat(o[t].replace("text-","bg-")),style:{width:"".concat(l,"%")}})})]},t)})})]}),(0,r.jsxs)("div",{className:"border-t border-[var(--border-color)] pt-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"By Category"}),(0,r.jsx)("div",{className:"space-y-2",children:Object.entries(s.byCategory).map(e=>{let[t,a]=e,o=s.totalLogs>0?a/s.totalLogs*100:0;return(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,r.jsxs)("span",{className:"text-[var(--foreground)] opacity-60",children:[{generation:"ðŸ”„",router:"ðŸ§­",tool:"ðŸ”§",chat:"ðŸ’¬",thought:"ðŸ’­"}[t]," ",t]}),(0,r.jsx)("span",{className:"text-[var(--foreground)] font-medium",children:a})]}),(0,r.jsx)("div",{className:"w-full bg-[var(--background)] rounded-full h-1.5",children:(0,r.jsx)("div",{className:"h-1.5 rounded-full bg-[var(--red-primary)]",style:{width:"".concat(o,"%")}})})]},t)})})]})]}):null:null}function x(){let[e,l]=(0,t.useState)(""),[n,i]=(0,t.useState)(""),[d,x]=(0,t.useState)("all"),[v,m]=(0,t.useState)("all"),[h,b]=(0,t.useState)(!0),[p,f]=(0,t.useState)(!1),[j,y]=(0,t.useState)(!1),[N,w]=(0,t.useState)([]),[k,S]=(0,t.useState)(null);(0,t.useEffect)(()=>{let e=a.conversationStorage.getAll();w(e);let r=a.conversationStorage.getActiveId();r&&e.some(e=>e.id===r)&&(S(r),l(r))},[]);let C=()=>{let e=a.conversationStorage.create();w(r=>[e,...r]),S(e.id),a.conversationStorage.setActiveId(e.id),l(e.id),y(!1)};return(0,r.jsxs)("div",{className:"flex bg-[var(--background)]",style:{height:"calc(var(--vh, 1vh) * 100)"},children:[(0,r.jsx)(o.Sidebar,{isOpen:j,conversations:N,activeConversationId:k,editingTitleId:null,editingTitleValue:"",onClose:()=>y(!1),onNewChat:C,onSwitchConversation:e=>{S(e),a.conversationStorage.setActiveId(e),l(e),i(""),y(!1)},onDeleteClick:()=>{},onStartEditingTitle:()=>{},onSaveEditedTitle:()=>{},onCancelEditingTitle:()=>{},onEditingTitleChange:()=>{}}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,r.jsx)(s.Header,{title:"ðŸ“ Virtual Terminal",onMenuClick:()=>y(!j),onNewChat:C}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,r.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-[var(--foreground)] text-sm opacity-70",children:"Real-time logs from Red AI generations"})}),p&&(0,r.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-[var(--red-primary)]/10 border border-[var(--red-primary)]/30 rounded-lg",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-[var(--red-primary)] rounded-full animate-pulse"}),(0,r.jsx)("span",{className:"text-[var(--red-primary)] text-sm font-medium",children:"LIVE"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,r.jsx)(u,{conversationId:e,setConversationId:l,generationId:n,setGenerationId:i,filterLevel:d,setFilterLevel:x,filterCategory:v,setFilterCategory:m,showThoughts:h,setShowThoughts:b}),(0,r.jsx)(g,{conversationId:e})]}),(0,r.jsx)("div",{className:"lg:col-span-3",children:(0,r.jsx)(c,{conversationId:e,generationId:n,filterLevel:d,filterCategory:v,showThoughts:h,onStreamingChange:f})})]})]})]})]})}}]);