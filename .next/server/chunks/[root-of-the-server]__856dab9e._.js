module.exports=[22734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},46786,(e,t,r)=>{t.exports=e.x("os",()=>require("os"))},80490,e=>{e.v(JSON.parse('{"name":"dotenv","version":"17.2.3","description":"Loads environment variables from .env file","main":"lib/main.js","types":"lib/main.d.ts","exports":{".":{"types":"./lib/main.d.ts","require":"./lib/main.js","default":"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},"scripts":{"dts-check":"tsc --project tests/types/tsconfig.json","lint":"standard","pretest":"npm run lint && npm run dts-check","test":"tap run tests/**/*.js --allow-empty-coverage --disable-coverage --timeout=60000","test:coverage":"tap run tests/**/*.js --show-full-coverage --timeout=60000 --coverage-report=text --coverage-report=lcov","prerelease":"npm test","release":"standard-version"},"repository":{"type":"git","url":"git://github.com/motdotla/dotenv.git"},"homepage":"https://github.com/motdotla/dotenv#readme","funding":"https://dotenvx.com","keywords":["dotenv","env",".env","environment","variables","config","settings"],"readmeFilename":"README.md","license":"BSD-2-Clause","devDependencies":{"@types/node":"^18.11.3","decache":"^4.6.2","sinon":"^14.0.1","standard":"^17.0.0","standard-version":"^9.5.0","tap":"^19.2.0","typescript":"^4.8.4"},"engines":{"node":">=12"},"browser":{"fs":false}}'))},97289,(e,t,r)=>{let n=e.r(22734),i=e.r(14747),a=e.r(46786),s=e.r(54799),o=e.r(80490).version,l=["ðŸ” encrypt with Dotenvx: https://dotenvx.com","ðŸ” prevent committing .env to code: https://dotenvx.com/precommit","ðŸ” prevent building .env in docker: https://dotenvx.com/prebuild","ðŸ“¡ add observability to secrets: https://dotenvx.com/ops","ðŸ‘¥ sync secrets across teammates & machines: https://dotenvx.com/ops","ðŸ—‚ï¸ backup and recover secrets: https://dotenvx.com/ops","âœ… audit secrets and track compliance: https://dotenvx.com/ops","ðŸ”„ add secrets lifecycle management: https://dotenvx.com/ops","ðŸ”‘ add access controls to secrets: https://dotenvx.com/ops","ðŸ› ï¸  run anywhere with `dotenvx run -- yourcommand`","âš™ï¸  specify custom .env file path with { path: '/custom/path/.env' }","âš™ï¸  enable debug logging with { debug: true }","âš™ï¸  override existing env vars with { override: true }","âš™ï¸  suppress all logs with { quiet: true }","âš™ï¸  write to custom object with { processEnv: myObject }","âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }"];function u(e){return"string"==typeof e?!["false","0","no","off",""].includes(e.toLowerCase()):!!e}let c=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function d(e){console.log(`[dotenv@${o}][DEBUG] ${e}`)}function p(e){console.log(`[dotenv@${o}] ${e}`)}function h(e){return e&&e.DOTENV_KEY&&e.DOTENV_KEY.length>0?e.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function f(e){let t=null;if(e&&e.path&&e.path.length>0)if(Array.isArray(e.path))for(let r of e.path)n.existsSync(r)&&(t=r.endsWith(".vault")?r:`${r}.vault`);else t=e.path.endsWith(".vault")?e.path:`${e.path}.vault`;else t=i.resolve(process.cwd(),".env.vault");return n.existsSync(t)?t:null}function m(e){return"~"===e[0]?i.join(a.homedir(),e.slice(1)):e}let g={configDotenv:function(e){let t,r=i.resolve(process.cwd(),".env"),a="utf8",s=process.env;e&&null!=e.processEnv&&(s=e.processEnv);let o=u(s.DOTENV_CONFIG_DEBUG||e&&e.debug),c=u(s.DOTENV_CONFIG_QUIET||e&&e.quiet);e&&e.encoding?a=e.encoding:o&&d("No encoding is specified. UTF-8 is used by default");let h=[r];if(e&&e.path)if(Array.isArray(e.path))for(let t of(h=[],e.path))h.push(m(t));else h=[m(e.path)];let f={};for(let r of h)try{let t=g.parse(n.readFileSync(r,{encoding:a}));g.populate(f,t,e)}catch(e){o&&d(`Failed to load ${r} ${e.message}`),t=e}let y=g.populate(s,f,e);if(o=u(s.DOTENV_CONFIG_DEBUG||o),c=u(s.DOTENV_CONFIG_QUIET||c),o||!c){var b;let e=Object.keys(y).length,r=[];for(let e of h)try{let t=i.relative(process.cwd(),e);r.push(t)}catch(r){o&&d(`Failed to load ${e} ${r.message}`),t=r}p(`injecting env (${e}) from ${r.join(",")} ${(b=`-- tip: ${l[Math.floor(Math.random()*l.length)]}`,process.stdout.isTTY?`\x1b[2m${b}\x1b[0m`:b)}`)}return t?{parsed:f,error:t}:{parsed:f}},_configVault:function(e){let t=u(process.env.DOTENV_CONFIG_DEBUG||e&&e.debug),r=u(process.env.DOTENV_CONFIG_QUIET||e&&e.quiet);(t||!r)&&p("Loading env from encrypted .env.vault");let n=g._parseVault(e),i=process.env;return e&&null!=e.processEnv&&(i=e.processEnv),g.populate(i,n,e),{parsed:n}},_parseVault:function(e){let t,r=f(e=e||{});e.path=r;let n=g.configDotenv(e);if(!n.parsed){let e=Error(`MISSING_DATA: Cannot parse ${r} for an unknown reason`);throw e.code="MISSING_DATA",e}let i=h(e).split(","),a=i.length;for(let e=0;e<a;e++)try{let r=i[e].trim(),a=function(e,t){let r;try{r=new URL(t)}catch(e){if("ERR_INVALID_URL"===e.code){let e=Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw e.code="INVALID_DOTENV_KEY",e}throw e}let n=r.password;if(!n){let e=Error("INVALID_DOTENV_KEY: Missing key part");throw e.code="INVALID_DOTENV_KEY",e}let i=r.searchParams.get("environment");if(!i){let e=Error("INVALID_DOTENV_KEY: Missing environment part");throw e.code="INVALID_DOTENV_KEY",e}let a=`DOTENV_VAULT_${i.toUpperCase()}`,s=e.parsed[a];if(!s){let e=Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${a} in your .env.vault file.`);throw e.code="NOT_FOUND_DOTENV_ENVIRONMENT",e}return{ciphertext:s,key:n}}(n,r);t=g.decrypt(a.ciphertext,a.key);break}catch(t){if(e+1>=a)throw t}return g.parse(t)},config:function(e){if(0===h(e).length)return g.configDotenv(e);let t=f(e);if(!t){var r;return r=`You set DOTENV_KEY but you are missing a .env.vault file at ${t}. Did you forget to build it?`,console.error(`[dotenv@${o}][WARN] ${r}`),g.configDotenv(e)}return g._configVault(e)},decrypt:function(e,t){let r=Buffer.from(t.slice(-64),"hex"),n=Buffer.from(e,"base64"),i=n.subarray(0,12),a=n.subarray(-16);n=n.subarray(12,-16);try{let e=s.createDecipheriv("aes-256-gcm",r,i);return e.setAuthTag(a),`${e.update(n)}${e.final()}`}catch(n){let e=n instanceof RangeError,t="Invalid key length"===n.message,r="Unsupported state or unable to authenticate data"===n.message;if(e||t){let e=Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw e.code="INVALID_DOTENV_KEY",e}if(r){let e=Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw e.code="DECRYPTION_FAILED",e}throw n}},parse:function(e){let t,r={},n=e.toString();for(n=n.replace(/\r\n?/mg,"\n");null!=(t=c.exec(n));){let e=t[1],n=t[2]||"",i=(n=n.trim())[0];n=n.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),'"'===i&&(n=(n=n.replace(/\\n/g,"\n")).replace(/\\r/g,"\r")),r[e]=n}return r},populate:function(e,t,r={}){let n=!!(r&&r.debug),i=!!(r&&r.override),a={};if("object"!=typeof t){let e=Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw e.code="OBJECT_REQUIRED",e}for(let r of Object.keys(t))Object.prototype.hasOwnProperty.call(e,r)?(!0===i&&(e[r]=t[r],a[r]=t[r]),n&&(!0===i?d(`"${r}" is already defined and WAS overwritten`):d(`"${r}" is already defined and was NOT overwritten`))):(e[r]=t[r],a[r]=t[r]);return a}};t.exports.configDotenv=g.configDotenv,t.exports._configVault=g._configVault,t.exports._parseVault=g._parseVault,t.exports.config=g.config,t.exports.decrypt=g.decrypt,t.exports.parse=g.parse,t.exports.populate=g.populate,t.exports=g},42945,(e,t,r)=>{let n={};null!=process.env.DOTENV_CONFIG_ENCODING&&(n.encoding=process.env.DOTENV_CONFIG_ENCODING),null!=process.env.DOTENV_CONFIG_PATH&&(n.path=process.env.DOTENV_CONFIG_PATH),null!=process.env.DOTENV_CONFIG_QUIET&&(n.quiet=process.env.DOTENV_CONFIG_QUIET),null!=process.env.DOTENV_CONFIG_DEBUG&&(n.debug=process.env.DOTENV_CONFIG_DEBUG),null!=process.env.DOTENV_CONFIG_OVERRIDE&&(n.override=process.env.DOTENV_CONFIG_OVERRIDE),null!=process.env.DOTENV_CONFIG_DOTENV_KEY&&(n.DOTENV_KEY=process.env.DOTENV_CONFIG_DOTENV_KEY),t.exports=n},92474,(e,t,r)=>{let n=/^dotenv_config_(encoding|path|quiet|debug|override|DOTENV_KEY)=(.+)$/;t.exports=function(e){let t=e.reduce(function(e,t){let r=t.match(n);return r&&(e[r[1]]=r[2]),e},{});return"quiet"in t||(t.quiet="true"),t}},64913,(e,t,r)=>{e.r(97289).config(Object.assign({},e.r(42945),e.r(92474)(process.argv)))},75291,e=>{e.v(JSON.parse('{"acl":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"append":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"asking":{"arity":1,"flags":["fast"],"keyStart":0,"keyStop":0,"step":0},"auth":{"arity":-2,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"bgrewriteaof":{"arity":1,"flags":["admin","noscript","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"bgsave":{"arity":-1,"flags":["admin","noscript","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"bitcount":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"bitfield":{"arity":-2,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"bitfield_ro":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"bitop":{"arity":-4,"flags":["write","denyoom"],"keyStart":2,"keyStop":-1,"step":1},"bitpos":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"blmove":{"arity":6,"flags":["write","denyoom","noscript","blocking"],"keyStart":1,"keyStop":2,"step":1},"blmpop":{"arity":-5,"flags":["write","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"blpop":{"arity":-3,"flags":["write","noscript","blocking"],"keyStart":1,"keyStop":-2,"step":1},"brpop":{"arity":-3,"flags":["write","noscript","blocking"],"keyStart":1,"keyStop":-2,"step":1},"brpoplpush":{"arity":4,"flags":["write","denyoom","noscript","blocking"],"keyStart":1,"keyStop":2,"step":1},"bzmpop":{"arity":-5,"flags":["write","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"bzpopmax":{"arity":-3,"flags":["write","noscript","blocking","fast"],"keyStart":1,"keyStop":-2,"step":1},"bzpopmin":{"arity":-3,"flags":["write","noscript","blocking","fast"],"keyStart":1,"keyStop":-2,"step":1},"client":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"cluster":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"command":{"arity":-1,"flags":["loading","stale"],"keyStart":0,"keyStop":0,"step":0},"config":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"copy":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"dbsize":{"arity":1,"flags":["readonly","fast"],"keyStart":0,"keyStop":0,"step":0},"debug":{"arity":-2,"flags":["admin","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"decr":{"arity":2,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"decrby":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"del":{"arity":-2,"flags":["write"],"keyStart":1,"keyStop":-1,"step":1},"discard":{"arity":1,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"dump":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"echo":{"arity":2,"flags":["fast"],"keyStart":0,"keyStop":0,"step":0},"eval":{"arity":-3,"flags":["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"eval_ro":{"arity":-3,"flags":["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"evalsha":{"arity":-3,"flags":["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"evalsha_ro":{"arity":-3,"flags":["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"exec":{"arity":1,"flags":["noscript","loading","stale","skip_slowlog"],"keyStart":0,"keyStop":0,"step":0},"exists":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":-1,"step":1},"expire":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"expireat":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"expiretime":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"failover":{"arity":-1,"flags":["admin","noscript","stale"],"keyStart":0,"keyStop":0,"step":0},"fcall":{"arity":-3,"flags":["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"fcall_ro":{"arity":-3,"flags":["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"flushall":{"arity":-1,"flags":["write"],"keyStart":0,"keyStop":0,"step":0},"flushdb":{"arity":-1,"flags":["write"],"keyStart":0,"keyStop":0,"step":0},"function":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"geoadd":{"arity":-5,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"geodist":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geohash":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geopos":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"georadius":{"arity":-6,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"georadius_ro":{"arity":-6,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"georadiusbymember":{"arity":-5,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"georadiusbymember_ro":{"arity":-5,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geosearch":{"arity":-7,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geosearchstore":{"arity":-8,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"get":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"getbit":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"getdel":{"arity":2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"getex":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"getrange":{"arity":4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"getset":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hdel":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"hello":{"arity":-1,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"hexists":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hexpire":{"arity":-6,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"hpexpire":{"arity":-6,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"hget":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hgetall":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hincrby":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hincrbyfloat":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hkeys":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hlen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hmget":{"arity":-3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hmset":{"arity":-4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hrandfield":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hscan":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hset":{"arity":-4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hsetnx":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hstrlen":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hvals":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"incr":{"arity":2,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"incrby":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"incrbyfloat":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"info":{"arity":-1,"flags":["loading","stale"],"keyStart":0,"keyStop":0,"step":0},"keys":{"arity":2,"flags":["readonly"],"keyStart":0,"keyStop":0,"step":0},"lastsave":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"latency":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"lcs":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":2,"step":1},"lindex":{"arity":3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"linsert":{"arity":5,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"llen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"lmove":{"arity":5,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"lmpop":{"arity":-4,"flags":["write","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"lolwut":{"arity":-1,"flags":["readonly","fast"],"keyStart":0,"keyStop":0,"step":0},"lpop":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"lpos":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"lpush":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"lpushx":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"lrange":{"arity":4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"lrem":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"lset":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"ltrim":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"memory":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"mget":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":-1,"step":1},"migrate":{"arity":-6,"flags":["write","movablekeys"],"keyStart":3,"keyStop":3,"step":1},"module":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"monitor":{"arity":1,"flags":["admin","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"move":{"arity":3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"mset":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":2},"msetnx":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":2},"multi":{"arity":1,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"object":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"persist":{"arity":2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"pexpire":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"pexpireat":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"pexpiretime":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"pfadd":{"arity":-2,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"pfcount":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"pfdebug":{"arity":3,"flags":["write","denyoom","admin"],"keyStart":2,"keyStop":2,"step":1},"pfmerge":{"arity":-2,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"pfselftest":{"arity":1,"flags":["admin"],"keyStart":0,"keyStop":0,"step":0},"ping":{"arity":-1,"flags":["fast"],"keyStart":0,"keyStop":0,"step":0},"psetex":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"psubscribe":{"arity":-2,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"psync":{"arity":-3,"flags":["admin","noscript","no_async_loading","no_multi"],"keyStart":0,"keyStop":0,"step":0},"pttl":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"publish":{"arity":3,"flags":["pubsub","loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"pubsub":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"punsubscribe":{"arity":-1,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"quit":{"arity":-1,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"randomkey":{"arity":1,"flags":["readonly"],"keyStart":0,"keyStop":0,"step":0},"readonly":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"readwrite":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"rename":{"arity":3,"flags":["write"],"keyStart":1,"keyStop":2,"step":1},"renamenx":{"arity":3,"flags":["write","fast"],"keyStart":1,"keyStop":2,"step":1},"replconf":{"arity":-1,"flags":["admin","noscript","loading","stale","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"replicaof":{"arity":3,"flags":["admin","noscript","stale","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"reset":{"arity":1,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"restore":{"arity":-4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"restore-asking":{"arity":-4,"flags":["write","denyoom","asking"],"keyStart":1,"keyStop":1,"step":1},"role":{"arity":1,"flags":["noscript","loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"rpop":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"rpoplpush":{"arity":3,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"rpush":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"rpushx":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"sadd":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"save":{"arity":1,"flags":["admin","noscript","no_async_loading","no_multi"],"keyStart":0,"keyStop":0,"step":0},"scan":{"arity":-2,"flags":["readonly"],"keyStart":0,"keyStop":0,"step":0},"scard":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"script":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"sdiff":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"sdiffstore":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"select":{"arity":2,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"set":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"setbit":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"setex":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"setnx":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"setrange":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"shutdown":{"arity":-1,"flags":["admin","noscript","loading","stale","no_multi","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"sinter":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"sintercard":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"sinterstore":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"sismember":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"slaveof":{"arity":3,"flags":["admin","noscript","stale","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"slowlog":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"smembers":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"smismember":{"arity":-3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"smove":{"arity":4,"flags":["write","fast"],"keyStart":1,"keyStop":2,"step":1},"sort":{"arity":-2,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"sort_ro":{"arity":-2,"flags":["readonly","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"spop":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"spublish":{"arity":3,"flags":["pubsub","loading","stale","fast"],"keyStart":1,"keyStop":1,"step":1},"srandmember":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"srem":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"sscan":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"ssubscribe":{"arity":-2,"flags":["pubsub","noscript","loading","stale"],"keyStart":1,"keyStop":-1,"step":1},"strlen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"subscribe":{"arity":-2,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"substr":{"arity":4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"sunion":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"sunionstore":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"sunsubscribe":{"arity":-1,"flags":["pubsub","noscript","loading","stale"],"keyStart":1,"keyStop":-1,"step":1},"swapdb":{"arity":3,"flags":["write","fast"],"keyStart":0,"keyStop":0,"step":0},"sync":{"arity":1,"flags":["admin","noscript","no_async_loading","no_multi"],"keyStart":0,"keyStop":0,"step":0},"time":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"touch":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":-1,"step":1},"ttl":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"type":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"unlink":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":-1,"step":1},"unsubscribe":{"arity":-1,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"unwatch":{"arity":1,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"wait":{"arity":3,"flags":["noscript"],"keyStart":0,"keyStop":0,"step":0},"watch":{"arity":-2,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":1,"keyStop":-1,"step":1},"xack":{"arity":-4,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xadd":{"arity":-5,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"xautoclaim":{"arity":-6,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xclaim":{"arity":-6,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xdel":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xdelex":{"arity":-5,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xgroup":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"xinfo":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"xlen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"xpending":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"xrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"xread":{"arity":-4,"flags":["readonly","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"xreadgroup":{"arity":-7,"flags":["write","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"xrevrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"xsetid":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"xtrim":{"arity":-4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zadd":{"arity":-4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"zcard":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zcount":{"arity":4,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zdiff":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zdiffstore":{"arity":-4,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"zincrby":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"zinter":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zintercard":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zinterstore":{"arity":-4,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"zlexcount":{"arity":4,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zmpop":{"arity":-4,"flags":["write","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zmscore":{"arity":-3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zpopmax":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"zpopmin":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"zrandmember":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrangebylex":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrangebyscore":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrangestore":{"arity":-5,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"zrank":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zrem":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"zremrangebylex":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zremrangebyrank":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zremrangebyscore":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zrevrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrevrangebylex":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrevrangebyscore":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrevrank":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zscan":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zscore":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zunion":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zunionstore":{"arity":-4,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1}}'))},12522,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.getKeyIndexes=r.hasFlag=r.exists=r.list=void 0;let i=n(e.r(75291));r.list=Object.keys(i.default);let a={};function s(e){"string"!=typeof e&&(e=String(e));let t=e.indexOf("->");return -1===t?e.length:t}r.list.forEach(e=>{a[e]=i.default[e].flags.reduce(function(e,t){return e[t]=!0,e},{})}),r.exists=function(e){return!!i.default[e]},r.hasFlag=function(e,t){if(!a[e])throw Error("Unknown command "+e);return!!a[e][t]},r.getKeyIndexes=function(e,t,r){let n=i.default[e];if(!n)throw Error("Unknown command "+e);if(!Array.isArray(t))throw Error("Expect args to be an array");let a=[],o=!!(r&&r.parseExternalKey),l=(e,t)=>{let r=[],n=Number(e[t]);for(let e=0;e<n;e++)r.push(e+t+1);return r},u=(e,t,r)=>{for(let n=t;n<e.length-1;n+=1)if(String(e[n]).toLowerCase()===r.toLowerCase())return n+1;return null};switch(e){case"zunionstore":case"zinterstore":case"zdiffstore":a.push(0,...l(t,1));break;case"eval":case"evalsha":case"eval_ro":case"evalsha_ro":case"fcall":case"fcall_ro":case"blmpop":case"bzmpop":a.push(...l(t,1));break;case"sintercard":case"lmpop":case"zunion":case"zinter":case"zmpop":case"zintercard":case"zdiff":a.push(...l(t,0));break;case"georadius":{a.push(0);let e=u(t,5,"STORE");e&&a.push(e);let r=u(t,5,"STOREDIST");r&&a.push(r);break}case"georadiusbymember":{a.push(0);let e=u(t,4,"STORE");e&&a.push(e);let r=u(t,4,"STOREDIST");r&&a.push(r);break}case"sort":case"sort_ro":a.push(0);for(let e=1;e<t.length-1;e++){let r=t[e];if("string"!=typeof r)continue;let n=r.toUpperCase();"GET"===n?(e+=1,"#"!==(r=t[e])&&(o?a.push([e,s(r)]):a.push(e))):"BY"===n?(e+=1,o?a.push([e,s(t[e])]):a.push(e)):"STORE"===n&&(e+=1,a.push(e))}break;case"migrate":if(""===t[2])for(let e=5;e<t.length-1;e++){let r=t[e];if("string"==typeof r&&"KEYS"===r.toUpperCase()){for(let r=e+1;r<t.length;r++)a.push(r);break}}else a.push(2);break;case"xreadgroup":case"xread":for(let r=3*("xread"!==e);r<t.length-1;r++)if("STREAMS"===String(t[r]).toUpperCase()){for(let e=r+1;e<=r+(t.length-1-r)/2;e++)a.push(e);break}break;default:if(n.step>0){let e=n.keyStart-1,r=n.keyStop>0?n.keyStop:t.length+n.keyStop+1;for(let t=e;t<r;t+=n.step)a.push(t)}}return a}},27699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},48575,(e,t,r)=>{"use strict";let n;function i(e,t){try{let e=n;return n=null,e.apply(this,arguments)}catch(e){return r.errorObj.e=e,r.errorObj}}Object.defineProperty(r,"__esModule",{value:!0}),r.tryCatch=r.errorObj=void 0,r.errorObj={e:{}},r.tryCatch=function(e){return n=e,i}},19335,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(48575);function i(e){setTimeout(function(){throw e},0)}r.default=function(e,t,r){return"function"==typeof t&&e.then(e=>{let a;(a=void 0!==r&&Object(r).spread&&Array.isArray(e)?n.tryCatch(t).apply(void 0,[null].concat(e)):void 0===e?n.tryCatch(t)(null):n.tryCatch(t)(null,e))===n.errorObj&&i(a.e)},e=>{if(!e){let t=Error(e+"");Object.assign(t,{cause:e}),e=t}let r=n.tryCatch(t)(e);r===n.errorObj&&i(r.e)}),e}},49719,(e,t,r)=>{t.exports=e.x("assert",()=>require("assert"))},8339,(e,t,r)=>{"use strict";let n=e.r(49719);class i extends Error{get name(){return this.constructor.name}}class a extends i{get name(){return this.constructor.name}}t.exports={RedisError:i,ParserError:class extends i{constructor(e,t,r){n(t),n.strictEqual(typeof r,"number");let i=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=i,this.offset=r,this.buffer=t}get name(){return this.constructor.name}},ReplyError:class extends i{constructor(e){let t=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=t}get name(){return this.constructor.name}},AbortError:a,InterruptError:class extends a{get name(){return this.constructor.name}}}},47281,(e,t,r)=>{"use strict";let n=e.r(49719),i=e.r(24361);function a(e){Object.defineProperty(this,"message",{value:e||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}function s(e,t,r){n(t),n.strictEqual(typeof r,"number"),Object.defineProperty(this,"message",{value:e||"",configurable:!0,writable:!0});let i=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=i,this.offset=r,this.buffer=t}function o(e){Object.defineProperty(this,"message",{value:e||"",configurable:!0,writable:!0});let t=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=t}function l(e){Object.defineProperty(this,"message",{value:e||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}function u(e){Object.defineProperty(this,"message",{value:e||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}i.inherits(a,Error),Object.defineProperty(a.prototype,"name",{value:"RedisError",configurable:!0,writable:!0}),i.inherits(s,a),Object.defineProperty(s.prototype,"name",{value:"ParserError",configurable:!0,writable:!0}),i.inherits(o,a),Object.defineProperty(o.prototype,"name",{value:"ReplyError",configurable:!0,writable:!0}),i.inherits(l,a),Object.defineProperty(l.prototype,"name",{value:"AbortError",configurable:!0,writable:!0}),i.inherits(u,l),Object.defineProperty(u.prototype,"name",{value:"InterruptError",configurable:!0,writable:!0}),t.exports={RedisError:a,ParserError:s,ReplyError:o,AbortError:l,InterruptError:u}},63227,(e,t,r)=>{"use strict";t.exports=55>process.version.charCodeAt(1)&&46===process.version.charCodeAt(2)?e.r(47281):e.r(8339)},9068,(e,t,r)=>{var n=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],i=function(e){for(var t,r=0,n=0,i=[],a=e.length;r<a;r++)(t=e.charCodeAt(r))<128?i[n++]=t:(t<2048?i[n++]=t>>6|192:((64512&t)==55296&&r+1<e.length&&(64512&e.charCodeAt(r+1))==56320?(t=65536+((1023&t)<<10)+(1023&e.charCodeAt(++r)),i[n++]=t>>18|240,i[n++]=t>>12&63|128):i[n++]=t>>12|224,i[n++]=t>>6&63|128),i[n++]=63&t|128);return i},a=t.exports=function(e){for(var t,r=0,a=-1,s=0,o=0,l="string"==typeof e?i(e):e,u=l.length;r<u;){if(t=l[r++],-1===a)123===t&&(a=r);else if(125!==t)o=n[(t^o>>8)&255]^o<<8;else if(r-1!==a)return 16383&o;s=n[(t^s>>8)&255]^s<<8}return 16383&s};t.exports.generateMulti=function(e){for(var t=1,r=e.length,n=a(e[0]);t<r;)if(a(e[t++])!==n)return -1;return n}},92509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},64397,(e,t,r)=>{var n=/^(?:0|[1-9]\d*)$/;function i(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var a=Object.prototype,s=a.hasOwnProperty,o=a.toString,l=a.propertyIsEnumerable,u=Math.max;function c(e,t,r,n){return void 0===e||h(e,a[r])&&!s.call(n,r)?t:e}function d(e,t){return t=u(void 0===t?e.length-1:t,0),function(){for(var r=arguments,n=-1,a=u(r.length-t,0),s=Array(a);++n<a;)s[n]=r[t+n];n=-1;for(var o=Array(t+1);++n<t;)o[n]=r[n];return o[t]=s,i(e,this,o)}}function p(e,t){return!!(t=null==t?0x1fffffffffffff:t)&&("number"==typeof e||n.test(e))&&e>-1&&e%1==0&&e<t}function h(e,t){return e===t||e!=e&&t!=t}var f=Array.isArray;function m(e){var t,r,n;return null!=e&&"number"==typeof(t=e.length)&&t>-1&&t%1==0&&t<=0x1fffffffffffff&&"[object Function]"!=(n=g(r=e)?o.call(r):"")&&"[object GeneratorFunction]"!=n}function g(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var y=function(e){return d(function(t,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&function(e,t,r){if(!g(r))return!1;var n=typeof t;return("number"==n?!!(m(r)&&p(t,r.length)):"string"==n&&t in r)&&h(r[t],e)}(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var o=r[n];o&&e(t,o,n,a)}return t})}(function(e,t,r,n){var i;!function(e,t,r,n){r||(r={});for(var i=-1,a=t.length;++i<a;){var o=t[i],l=n?n(r[o],e[o],o,r,e):void 0;!function(e,t,r){var n=e[t];s.call(e,t)&&h(n,r)&&(void 0!==r||t in e)||(e[t]=r)}(r,o,void 0===l?e[o]:l)}}(t,m(i=t)?function(e,t){var r,n,i,a=f(e)||(i=n=r=e)&&"object"==typeof i&&m(n)&&s.call(r,"callee")&&(!l.call(r,"callee")||"[object Arguments]"==o.call(r))?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],u=a.length,c=!!u;for(var d in e)(t||s.call(e,d))&&!(c&&("length"==d||p(d,u)))&&a.push(d);return a}(i,!0):function(e){if(!g(e)){var t,r,n=e,i=[];if(null!=n)for(var o in Object(n))i.push(o);return i}var l=(r=(t=e)&&t.constructor,t===("function"==typeof r&&r.prototype||a)),u=[];for(var c in e)"constructor"==c&&(l||!s.call(e,c))||u.push(c);return u}(i),e,n)});t.exports=d(function(e){return e.push(void 0,c),i(y,void 0,e)})},4136,(e,t,r)=>{var n=Object.prototype,i=n.hasOwnProperty,a=n.toString,s=n.propertyIsEnumerable;t.exports=function(e){var t,r,n,o,l,u,c,d;return!!(n=t=e)&&"object"==typeof n&&null!=(r=t)&&"number"==typeof(o=r.length)&&o>-1&&o%1==0&&o<=0x1fffffffffffff&&"[object Function]"!=(c=typeof(u=l=r),d=u&&("object"==c||"function"==c)?a.call(l):"")&&"[object GeneratorFunction]"!=d&&i.call(e,"callee")&&(!s.call(e,"callee")||"[object Arguments]"==a.call(e))}},57517,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isArguments=r.defaults=r.noop=void 0,r.defaults=e.r(64397),r.isArguments=e.r(4136),r.noop=function(){}},41528,(e,t,r)=>{function n(e,t,r,n){return Math.round(e/r)+" "+n+(t>=1.5*r?"s":"")}t.exports=function(e,t){t=t||{};var r,i,a,s,o=typeof e;if("string"===o&&e.length>0){var l=e;if(!((l=String(l)).length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(l);if(u){var c=parseFloat(u[1]);switch((u[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*c;case"weeks":case"week":case"w":return 6048e5*c;case"days":case"day":case"d":return 864e5*c;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*c;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*c;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:break}}}return}if("number"===o&&isFinite(e)){return t.long?(i=Math.abs(r=e))>=864e5?n(r,i,864e5,"day"):i>=36e5?n(r,i,36e5,"hour"):i>=6e4?n(r,i,6e4,"minute"):i>=1e3?n(r,i,1e3,"second"):r+" ms":(s=Math.abs(a=e))>=864e5?Math.round(a/864e5)+"d":s>=36e5?Math.round(a/36e5)+"h":s>=6e4?Math.round(a/6e4)+"m":s>=1e3?Math.round(a/1e3)+"s":a+"ms"}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},16525,(e,t,r)=>{t.exports=function(t){function r(e){let t,i,a,s=null;function o(...e){if(!o.enabled)return;let n=Number(new Date);o.diff=n-(t||n),o.prev=t,o.curr=n,t=n,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(t,n)=>{if("%%"===t)return"%";i++;let a=r.formatters[n];if("function"==typeof a){let r=e[i];t=a.call(o,r),e.splice(i,1),i--}return t}),r.formatArgs.call(o,e),(o.log||r.log).apply(o,e)}return o.namespace=e,o.useColors=r.useColors(),o.color=r.selectColor(e),o.extend=n,o.destroy=r.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==r.namespaces&&(i=r.namespaces,a=r.enabled(e)),a),set:e=>{s=e}}),"function"==typeof r.init&&r.init(o),o}function n(e,t){let n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function i(e,t){let r=0,n=0,i=-1,a=0;for(;r<e.length;)if(n<t.length&&(t[n]===e[r]||"*"===t[n]))"*"===t[n]?(i=n,a=r):r++,n++;else{if(-1===i)return!1;n=i+1,r=++a}for(;n<t.length&&"*"===t[n];)n++;return n===t.length}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){let e=[...r.names,...r.skips.map(e=>"-"+e)].join(",");return r.enable(""),e},r.enable=function(e){for(let t of(r.save(e),r.namespaces=e,r.names=[],r.skips=[],("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean)))"-"===t[0]?r.skips.push(t.slice(1)):r.names.push(t)},r.enabled=function(e){for(let t of r.skips)if(i(e,t))return!1;for(let t of r.names)if(i(e,t))return!0;return!1},r.humanize=e.r(41528),r.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(e=>{r[e]=t[e]}),r.names=[],r.skips=[],r.formatters={},r.selectColor=function(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return r.colors[Math.abs(t)%r.colors.length]},r.enable(r.load()),r}},70722,(e,t,r)=>{t.exports=e.x("tty",()=>require("tty"))},55225,(e,t,r)=>{"use strict";t.exports=(e,t=process.argv)=>{let r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return -1!==n&&(-1===i||n<i)}},81042,(e,t,r)=>{"use strict";let n;e.r(46786);let i=e.r(70722),a=e.r(55225),{env:s}=process;function o(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function l(e,t){if(0===n)return 0;if(a("color=16m")||a("color=full")||a("color=truecolor"))return 3;if(a("color=256"))return 2;if(e&&!t&&void 0===n)return 0;let r=n||0;if("dumb"===s.TERM)return r;if("CI"in s)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(e=>e in s)||"codeship"===s.CI_NAME?1:r;if("TEAMCITY_VERSION"in s)return+!!/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(s.TEAMCITY_VERSION);if("truecolor"===s.COLORTERM)return 3;if("TERM_PROGRAM"in s){let e=parseInt((s.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(s.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(s.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(s.TERM)||"COLORTERM"in s?1:r}a("no-color")||a("no-colors")||a("color=false")||a("color=never")?n=0:(a("color")||a("colors")||a("color=true")||a("color=always"))&&(n=1),"FORCE_COLOR"in s&&(n="true"===s.FORCE_COLOR?1:"false"===s.FORCE_COLOR?0:0===s.FORCE_COLOR.length?1:Math.min(parseInt(s.FORCE_COLOR,10),3)),t.exports={supportsColor:function(e){return o(l(e,e&&e.isTTY))},stdout:o(l(!0,i.isatty(1))),stderr:o(l(!0,i.isatty(2)))}},23440,(e,t,r)=>{let n=e.r(70722),i=e.r(24361);r.init=function(e){e.inspectOpts={};let t=Object.keys(r.inspectOpts);for(let n=0;n<t.length;n++)e.inspectOpts[t[n]]=r.inspectOpts[t[n]]},r.log=function(...e){return process.stderr.write(i.formatWithOptions(r.inspectOpts,...e)+"\n")},r.formatArgs=function(e){let{namespace:n,useColors:i}=this;if(i){let r=this.color,i="\x1b[3"+(r<8?r:"8;5;"+r),a=`  ${i};1m${n} \u001B[0m`;e[0]=a+e[0].split("\n").join("\n"+a),e.push(i+"m+"+t.exports.humanize(this.diff)+"\x1b[0m")}else e[0]=(r.inspectOpts.hideDate?"":new Date().toISOString()+" ")+n+" "+e[0]},r.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},r.load=function(){return process.env.DEBUG},r.useColors=function(){return"colors"in r.inspectOpts?!!r.inspectOpts.colors:n.isatty(process.stderr.fd)},r.destroy=i.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),r.colors=[6,2,3,4,5,1];try{let t=e.r(81042);t&&(t.stderr||t).level>=2&&(r.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}r.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase()),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e},{}),t.exports=e.r(16525)(r);let{formatters:a}=t.exports;a.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map(e=>e.trim()).join(" ")},a.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},28452,(e,t,r)=>{r.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;e.splice(1,0,r,"color: inherit");let n=0,i=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))}),e.splice(i,0,r)},r.save=function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(e){}},r.load=function(){let e;try{e=r.storage.getItem("debug")||r.storage.getItem("DEBUG")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},r.useColors=function(){let e;return!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},r.storage=function(){try{return localStorage}catch(e){}}(),r.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.log=console.debug||console.log||(()=>{}),t.exports=e.r(16525)(r);let{formatters:n}=t.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},17293,(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||process.__nwjs?t.exports=e.r(28452):t.exports=e.r(23440)},28181,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.genRedactedString=r.getStringValue=r.MAX_ARGUMENT_LENGTH=void 0;let n=e.r(17293);function i(e){if(null!==e)switch(typeof e){case"boolean":case"number":return;case"object":if(Buffer.isBuffer(e))return e.toString("hex");if(Array.isArray(e))return e.join(",");try{return JSON.stringify(e)}catch(e){return}case"string":return e}}function a(e,t){let{length:r}=e;return r<=t?e:e.slice(0,t)+' ... <REDACTED full-length="'+r+'">'}r.MAX_ARGUMENT_LENGTH=200,r.getStringValue=i,r.genRedactedString=a,r.default=function(e){let t=(0,n.default)(`ioredis:${e}`);function r(...e){if(t.enabled){for(let t=1;t<e.length;t++){let r=i(e[t]);"string"==typeof r&&r.length>200&&(e[t]=a(r,200))}return t.apply(null,e)}}return Object.defineProperties(r,{namespace:{get:()=>t.namespace},enabled:{get:()=>t.enabled},destroy:{get:()=>t.destroy},log:{get:()=>t.log,set(e){t.log=e}}}),r}},86961,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=`-----BEGIN CERTIFICATE-----
MIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP
JnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz
rmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E
QwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2
BDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3
TMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp
4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w
MB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w
DQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta
lbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6
Su8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ
uFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k
BpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp
Z4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx
CzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w
KwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN
MTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG
A1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy
bWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA
A4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv
Tq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4
VuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym
hjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W
P0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN
r0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw
hhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s
UzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u
P1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9
MjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT
t5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID
AQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy
LnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw
AYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G
A1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4
L2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB
hjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr
AP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW
vcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw
7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+
XoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc
AUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1
jQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh
/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z
zDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli
iF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43
iqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo
616pxqo=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV
BAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz
TGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC
VVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz
MS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw
ggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1
G5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY
Dm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl
pp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT
ULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag
54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ
xeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC
JpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K
2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3
StsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI
SIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B
cS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL
yzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T
AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg
z5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu
rYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3
3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+
hSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ
D0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj
TY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l
FXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj
mcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf
ybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji
n8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F
UhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM
MSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv
YmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y
NTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu
IG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy
MDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf
8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD
BVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg
ofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK
dZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh
counQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu
jE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
CCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW
BBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj
move4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw
Mi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1
cmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w
K6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD
VR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC
AQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/
3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY
0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX
y+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3
15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5
ZgKnO/Fx2hBgTxhOTMYaD312kg==
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----`;r.default={RedisCloudFixed:{ca:n},RedisCloudFlexible:{ca:n}}},26898,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.noop=r.defaults=r.Debug=r.getPackageMeta=r.zipMap=r.CONNECTION_CLOSED_ERROR_MSG=r.shuffle=r.sample=r.resolveTLSProfile=r.parseURL=r.optimizeErrorStack=r.toArg=r.convertMapToArray=r.convertObjectToArray=r.timeout=r.packObject=r.isInt=r.wrapMultiResult=r.convertBufferToString=void 0;let n=e.r(22734),i=e.r(14747),a=e.r(92509),s=e.r(57517);Object.defineProperty(r,"defaults",{enumerable:!0,get:function(){return s.defaults}}),Object.defineProperty(r,"noop",{enumerable:!0,get:function(){return s.noop}}),r.Debug=e.r(28181).default;let o=e.r(86961);function l(e){let t=parseFloat(e);return!isNaN(e)&&(0|t)===t}r.convertBufferToString=function e(t,r){if(t instanceof Buffer)return t.toString(r);if(Array.isArray(t)){let n=t.length,i=Array(n);for(let a=0;a<n;++a)i[a]=t[a]instanceof Buffer&&"utf8"===r?t[a].toString():e(t[a],r);return i}return t},r.wrapMultiResult=function(e){if(!e)return null;let t=[],r=e.length;for(let n=0;n<r;++n){let r=e[n];r instanceof Error?t.push([r]):t.push([null,r])}return t},r.isInt=l,r.packObject=function(e){let t={},r=e.length;for(let n=1;n<r;n+=2)t[e[n-1]]=e[n];return t},r.timeout=function(e,t){let r=null,n=function(){r&&(clearTimeout(r),r=null,e.apply(this,arguments))};return r=setTimeout(n,t,Error("timeout")),n},r.convertObjectToArray=function(e){let t=[],r=Object.keys(e);for(let n=0,i=r.length;n<i;n++)t.push(r[n],e[r[n]]);return t},r.convertMapToArray=function(e){let t=[],r=0;return e.forEach(function(e,n){t[r]=n,t[r+1]=e,r+=2}),t},r.toArg=function(e){return null==e?"":String(e)},r.optimizeErrorStack=function(e,t,r){let n,i=t.split("\n"),a="";for(n=1;n<i.length&&-1!==i[n].indexOf(r);++n);for(let e=n;e<i.length;++e)a+="\n"+i[e];if(e.stack){let t=e.stack.indexOf("\n");e.stack=e.stack.slice(0,t)+a}return e},r.parseURL=function(e){if(l(e))return{port:e};let t=(0,a.parse)(e,!0,!0);t.slashes||"/"===e[0]||(e="//"+e,t=(0,a.parse)(e,!0,!0));let r=t.query||{},n={};if(t.auth){let e=t.auth.indexOf(":");n.username=-1===e?t.auth:t.auth.slice(0,e),n.password=-1===e?"":t.auth.slice(e+1)}if(t.pathname&&("redis:"===t.protocol||"rediss:"===t.protocol?t.pathname.length>1&&(n.db=t.pathname.slice(1)):n.path=t.pathname),t.host&&(n.host=t.hostname),t.port&&(n.port=t.port),"string"==typeof r.family){let e=Number.parseInt(r.family,10);Number.isNaN(e)||(n.family=e)}return(0,s.defaults)(n,r),n},r.resolveTLSProfile=function(e){let t=null==e?void 0:e.tls;"string"==typeof t&&(t={profile:t});let r=o.default[null==t?void 0:t.profile];return r&&(t=Object.assign({},r,t),delete t.profile,e=Object.assign({},e,{tls:t})),e},r.sample=function(e,t=0){let r=e.length;return t>=r?null:e[t+Math.floor(Math.random()*(r-t))]},r.shuffle=function(e){let t=e.length;for(;t>0;){let r=Math.floor(Math.random()*t);t--,[e[t],e[r]]=[e[r],e[t]]}return e},r.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.",r.zipMap=function(e,t){let r=new Map;return e.forEach((e,n)=>{r.set(e,t[n])}),r};let u=null;r.getPackageMeta=async function(){if(u)return u;try{let e=(0,i.resolve)("/ROOT/node_modules/ioredis/built/utils","..","..","package.json"),t=await n.promises.readFile(e,"utf8");return u={version:JSON.parse(t).version}}catch(e){return u={version:"error-fetching-version"}}}},30846,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(12522),i=e.r(9068),a=e.r(19335),s=e.r(26898);class o{constructor(e,t=[],r={},n){if(this.name=e,this.inTransaction=!1,this.isResolved=!1,this.transformed=!1,this.replyEncoding=r.replyEncoding,this.errorStack=r.errorStack,this.args=t.flat(),this.callback=n,this.initPromise(),r.keyPrefix){let e=r.keyPrefix instanceof Buffer,t=e?r.keyPrefix:null;this._iterateKeys(n=>n instanceof Buffer?(null===t&&(t=Buffer.from(r.keyPrefix)),Buffer.concat([t,n])):e?Buffer.concat([r.keyPrefix,Buffer.from(String(n))]):r.keyPrefix+n)}r.readOnly&&(this.isReadOnly=!0)}static checkFlag(e,t){return!!this.getFlagMap()[e][t]}static setArgumentTransformer(e,t){this._transformer.argument[e]=t}static setReplyTransformer(e,t){this._transformer.reply[e]=t}static getFlagMap(){return this.flagMap||(this.flagMap=Object.keys(o.FLAGS).reduce((e,t)=>(e[t]={},o.FLAGS[t].forEach(r=>{e[t][r]=!0}),e),{})),this.flagMap}getSlot(){if(void 0===this.slot){let e=this.getKeys()[0];this.slot=null==e?null:i(e)}return this.slot}getKeys(){return this._iterateKeys()}toWritable(e){let t,r="*"+(this.args.length+1)+"\r\n$"+Buffer.byteLength(this.name)+"\r\n"+this.name+"\r\n";if(this.bufferMode){let e=new c;e.push(r);for(let t=0;t<this.args.length;++t){let r=this.args[t];r instanceof Buffer?0===r.length?e.push("$0\r\n\r\n"):(e.push("$"+r.length+"\r\n"),e.push(r),e.push("\r\n")):e.push("$"+Buffer.byteLength(r)+"\r\n"+r+"\r\n")}t=e.toBuffer()}else{t=r;for(let e=0;e<this.args.length;++e){let r=this.args[e];t+="$"+Buffer.byteLength(r)+"\r\n"+r+"\r\n"}}return t}stringifyArguments(){for(let e=0;e<this.args.length;++e){let t=this.args[e];"string"==typeof t||(t instanceof Buffer?this.bufferMode=!0:this.args[e]=(0,s.toArg)(t))}}transformReply(e){this.replyEncoding&&(e=(0,s.convertBufferToString)(e,this.replyEncoding));let t=o._transformer.reply[this.name];return t&&(e=t(e)),e}setTimeout(e){this._commandTimeoutTimer||(this._commandTimeoutTimer=setTimeout(()=>{this.isResolved||this.reject(Error("Command timed out"))},e))}initPromise(){let e=new Promise((e,t)=>{if(!this.transformed){this.transformed=!0;let e=o._transformer.argument[this.name];e&&(this.args=e(this.args)),this.stringifyArguments()}this.resolve=this._convertValue(e),this.errorStack?this.reject=e=>{t((0,s.optimizeErrorStack)(e,this.errorStack.stack,"/ROOT/node_modules/ioredis/built"))}:this.reject=t});this.promise=(0,a.default)(e,this.callback)}_iterateKeys(e=e=>e){if(void 0===this.keys&&(this.keys=[],(0,n.exists)(this.name)))for(let t of(0,n.getKeyIndexes)(this.name,this.args))this.args[t]=e(this.args[t]),this.keys.push(this.args[t]);return this.keys}_convertValue(e){return t=>{try{let r=this._commandTimeoutTimer;r&&(clearTimeout(r),delete this._commandTimeoutTimer),e(this.transformReply(t)),this.isResolved=!0}catch(e){this.reject(e)}return this.promise}}}r.default=o,o.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"]},o._transformer={argument:{},reply:{}};let l=function(e){if(1===e.length){if(e[0]instanceof Map)return(0,s.convertMapToArray)(e[0]);if("object"==typeof e[0]&&null!==e[0])return(0,s.convertObjectToArray)(e[0])}return e},u=function(e){if(2===e.length){if(e[1]instanceof Map)return[e[0]].concat((0,s.convertMapToArray)(e[1]));if("object"==typeof e[1]&&null!==e[1])return[e[0]].concat((0,s.convertObjectToArray)(e[1]))}return e};o.setArgumentTransformer("mset",l),o.setArgumentTransformer("msetnx",l),o.setArgumentTransformer("hset",u),o.setArgumentTransformer("hmset",u),o.setReplyTransformer("hgetall",function(e){if(Array.isArray(e)){let t={};for(let r=0;r<e.length;r+=2){let n=e[r],i=e[r+1];n in t?Object.defineProperty(t,n,{value:i,configurable:!0,enumerable:!0,writable:!0}):t[n]=i}return t}return e});class c{constructor(){this.length=0,this.items=[]}push(e){this.length+=Buffer.byteLength(e),this.items.push(e)}toBuffer(){let e=Buffer.allocUnsafe(this.length),t=0;for(let r of this.items){let n=Buffer.byteLength(r);Buffer.isBuffer(r)?r.copy(e,t):e.write(r,t,n),t+=n}return e}}},17798,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(63227);class i extends n.RedisError{constructor(e,t){super(e),this.lastNodeError=t,Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}r.default=i,i.defaultMessage="Failed to refresh slots cache."},88947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},12749,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(88947);class i extends n.Readable{constructor(e){super(e),this.opt=e,this._redisCursor="0",this._redisDrained=!1}_read(){if(this._redisDrained)return void this.push(null);let e=[this._redisCursor];this.opt.key&&e.unshift(this.opt.key),this.opt.match&&e.push("MATCH",this.opt.match),this.opt.type&&e.push("TYPE",this.opt.type),this.opt.count&&e.push("COUNT",String(this.opt.count)),this.opt.noValues&&e.push("NOVALUES"),this.opt.redis[this.opt.command](e,(e,t)=>{if(e)return void this.emit("error",e);this._redisCursor=t[0]instanceof Buffer?t[0].toString():t[0],"0"===this._redisCursor&&(this._redisDrained=!0),this.push(t[1])})}close(){this._redisDrained=!0}}r.default=i},33700,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.executeWithAutoPipelining=r.getFirstValueInFlattenedArray=r.shouldUseAutoPipelining=r.notAllowedAutoPipelineCommands=r.kCallbacks=r.kExec=void 0;let n=e.r(57517),i=e.r(9068),a=e.r(19335);function s(e){for(let t=0;t<e.length;t++){let r=e[t];if("string"==typeof r)return r;if(Array.isArray(r)||(0,n.isArguments)(r)){if(0===r.length)continue;return r[0]}let i=[r].flat();if(i.length>0)return i[0]}}r.kExec=Symbol("exec"),r.kCallbacks=Symbol("callbacks"),r.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select"],r.shouldUseAutoPipelining=function(e,t,n){return t&&e.options.enableAutoPipelining&&!e.isPipeline&&!r.notAllowedAutoPipelineCommands.includes(n)&&!e.options.autoPipeliningIgnoredCommands.includes(n)},r.getFirstValueInFlattenedArray=s,r.executeWithAutoPipelining=function e(t,o,l,u,c){if(t.isCluster&&!t.slots.length)return"wait"===t.status&&t.connect().catch(n.noop),(0,a.default)(new Promise(function(r,n){t.delayUntilReady(i=>{if(i)return void n(i);e(t,o,l,u,null).then(r,n)})}),c);let d=t.options.keyPrefix||"",p=t.isCluster?t.slots[i(`${d}${s(u)}`)].join(","):"main";if(!t._autoPipelines.has(p)){let e=t.pipeline();e[r.kExec]=!1,e[r.kCallbacks]=[],t._autoPipelines.set(p,e)}let h=t._autoPipelines.get(p);h[r.kExec]||(h[r.kExec]=!0,setImmediate(function e(t,n){if(t._runningAutoPipelines.has(n)||!t._autoPipelines.has(n))return;t._runningAutoPipelines.add(n);let i=t._autoPipelines.get(n);t._autoPipelines.delete(n);let a=i[r.kCallbacks];i[r.kCallbacks]=null,i.exec(function(r,i){if(t._runningAutoPipelines.delete(n),r)for(let e=0;e<a.length;e++)process.nextTick(a[e],r);else for(let e=0;e<a.length;e++)process.nextTick(a[e],...i[e]);t._autoPipelines.has(n)&&e(t,n)})},t,p));let f=new Promise(function(e,t){h[r.kCallbacks].push(function(r,n){if(r)return void t(r);e(n)}),"call"===o&&u.unshift(l),h[o](...u)});return(0,a.default)(f,c)}},40162,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(54799),i=e.r(30846),a=e.r(19335);r.default=class{constructor(e,t=null,r="",a=!1){this.lua=e,this.numberOfKeys=t,this.keyPrefix=r,this.readOnly=a,this.sha=(0,n.createHash)("sha1").update(e).digest("hex");let s=this.sha,o=new WeakSet;this.Command=class extends i.default{toWritable(t){let r=this.reject;return this.reject=e=>{-1!==e.message.indexOf("NOSCRIPT")&&o.delete(t),r.call(this,e)},o.has(t)?"eval"===this.name&&(this.name="evalsha",this.args[0]=s):(o.add(t),this.name="eval",this.args[0]=e),super.toWritable(t)}}}execute(e,t,r,n){"number"==typeof this.numberOfKeys&&t.unshift(this.numberOfKeys),this.keyPrefix&&(r.keyPrefix=this.keyPrefix),this.readOnly&&(r.readOnly=!0);let i=new this.Command("evalsha",[this.sha,...t],r);return i.promise=i.promise.catch(n=>{if(-1===n.message.indexOf("NOSCRIPT"))throw n;let i=new this.Command("evalsha",[this.sha,...t],r);return(e.isPipeline?e.redis:e).sendCommand(i)}),(0,a.default)(i.promise,n),e.sendCommand(i)}}},67061,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(12522),i=e.r(33700),a=e.r(30846),s=e.r(40162);class o{constructor(){this.options={},this.scriptsSet={},this.addedBuiltinSet=new Set}getBuiltinCommands(){return l.slice(0)}createBuiltinCommand(e){return{string:u(null,e,"utf8"),buffer:u(null,e,null)}}addBuiltinCommand(e){this.addedBuiltinSet.add(e),this[e]=u(e,e,"utf8"),this[e+"Buffer"]=u(e+"Buffer",e,null)}defineCommand(e,t){let r=new s.default(t.lua,t.numberOfKeys,this.options.keyPrefix,t.readOnly);this.scriptsSet[e]=r,this[e]=c(e,e,r,"utf8"),this[e+"Buffer"]=c(e+"Buffer",e,r,null)}sendCommand(e,t,r){throw Error('"sendCommand" is not implemented')}}let l=n.list.filter(e=>"monitor"!==e);function u(e,t,r){return void 0===r&&(r=t,t=null),function(...n){let s=t||n.shift(),o=n[n.length-1];"function"==typeof o?n.pop():o=void 0;let l={errorStack:this.options.showFriendlyErrorStack?Error():void 0,keyPrefix:this.options.keyPrefix,replyEncoding:r};return(0,i.shouldUseAutoPipelining)(this,e,s)?(0,i.executeWithAutoPipelining)(this,e,s,n,o):this.sendCommand(new a.default(s,n,l,o))}}function c(e,t,r,n){return function(...a){let s="function"==typeof a[a.length-1]?a.pop():void 0,o={replyEncoding:n};return(this.options.showFriendlyErrorStack&&(o.errorStack=Error()),(0,i.shouldUseAutoPipelining)(this,e,t))?(0,i.executeWithAutoPipelining)(this,e,t,a,s):r.execute(this,a,o,s)}}l.push("sentinel"),l.forEach(function(e){o.prototype[e]=u(e,e,"utf8"),o.prototype[e+"Buffer"]=u(e+"Buffer",e,null)}),o.prototype.call=u("call","utf8"),o.prototype.callBuffer=u("callBuffer",null),o.prototype.send_command=o.prototype.call,r.default=o},6135,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(9068),i=e.r(12522),a=e.r(19335),s=e.r(24361),o=e.r(30846),l=e.r(26898),u=e.r(67061);class c extends u.default{constructor(e){super(),this.redis=e,this.isPipeline=!0,this.replyPending=0,this._queue=[],this._result=[],this._transactions=0,this._shaToScript={},this.isCluster="Cluster"===this.redis.constructor.name||this.redis.isCluster,this.options=e.options,Object.keys(e.scriptsSet).forEach(t=>{let r=e.scriptsSet[t];this._shaToScript[r.sha]=r,this[t]=e[t],this[t+"Buffer"]=e[t+"Buffer"]}),e.addedBuiltinSet.forEach(t=>{this[t]=e[t],this[t+"Buffer"]=e[t+"Buffer"]}),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t});let t=this;Object.defineProperty(this,"length",{get:function(){return t._queue.length}})}fillResult(e,t){if("exec"===this._queue[t].name&&Array.isArray(e[1])){let r=e[1].length;for(let n=0;n<r;n++){if(e[1][n]instanceof Error)continue;let i=this._queue[t-(r-n)];try{e[1][n]=i.transformReply(e[1][n])}catch(t){e[1][n]=t}}}if(this._result[t]=e,--this.replyPending)return;if(this.isCluster){let e,t=!0;for(let r=0;r<this._result.length;++r){let n=this._result[r][0],a=this._queue[r];if(n){if("exec"===a.name&&"EXECABORT Transaction discarded because of previous errors."===n.message)continue;if(e){if(e.name!==n.name||e.message!==n.message){t=!1;break}}else e={name:n.name,message:n.message}}else if(!a.inTransaction&&!((0,i.exists)(a.name)&&(0,i.hasFlag)(a.name,"readonly"))){t=!1;break}}if(e&&t){let t=this,r=e.message.split(" "),n=this._queue,i=!1;this._queue=[];for(let e=0;e<n.length;++e){if("ASK"===r[0]&&!i&&"asking"!==n[e].name&&(!n[e-1]||"asking"!==n[e-1].name)){let e=new o.default("asking");e.ignore=!0,this.sendCommand(e)}n[e].initPromise(),this.sendCommand(n[e]),i=n[e].inTransaction}let a=!0;void 0===this.leftRedirections&&(this.leftRedirections={});let s=function(){t.exec()},l=this.redis;if(l.handleError(e,this.leftRedirections,{moved:function(e,n){t.preferKey=n,l.slots[r[1]]=[n],l._groupsBySlot[r[1]]=l._groupsIds[l.slots[r[1]].join(";")],l.refreshSlotsCache(),t.exec()},ask:function(e,r){t.preferKey=r,t.exec()},tryagain:s,clusterDown:s,connectionClosed:s,maxRedirections:()=>{a=!1},defaults:()=>{a=!1}}),a)return}}let r=0;for(let e=0;e<this._queue.length-r;++e)this._queue[e+r].ignore&&(r+=1),this._result[e]=this._result[e+r];this.resolve(this._result.slice(0,this._result.length-r))}sendCommand(e){this._transactions>0&&(e.inTransaction=!0);let t=this._queue.length;return e.pipelineIndex=t,e.promise.then(e=>{this.fillResult([null,e],t)}).catch(e=>{this.fillResult([e],t)}),this._queue.push(e),this}addBatch(e){let t,r,n;for(let i=0;i<e.length;++i)r=(t=e[i])[0],n=t.slice(1),this[r].apply(this,n);return this}}r.default=c;let d=c.prototype.multi;c.prototype.multi=function(){return this._transactions+=1,d.apply(this,arguments)};let p=c.prototype.execBuffer;c.prototype.execBuffer=(0,s.deprecate)(function(){return this._transactions>0&&(this._transactions-=1),p.apply(this,arguments)},"Pipeline#execBuffer: Use Pipeline#exec instead"),c.prototype.exec=function(e){let t;if(this.isCluster&&!this.redis.slots.length)return"wait"===this.redis.status&&this.redis.connect().catch(l.noop),e&&!this.nodeifiedPromise&&(this.nodeifiedPromise=!0,(0,a.default)(this.promise,e)),this.redis.delayUntilReady(t=>{if(t)return void this.reject(t);this.exec(e)}),this.promise;if(this._transactions>0)return this._transactions-=1,p.apply(this,arguments);if(this.nodeifiedPromise||(this.nodeifiedPromise=!0,(0,a.default)(this.promise,e)),this._queue.length||this.resolve([]),this.isCluster){let e=[];for(let t=0;t<this._queue.length;t++){let r=this._queue[t].getKeys();if(r.length&&e.push(r[0]),r.length&&0>n.generateMulti(r))return this.reject(Error("All the keys in a pipeline command should belong to the same slot")),this.promise}if(e.length){if((t=function(e,t){let r=n(t[0]),i=e._groupsBySlot[r];for(let r=1;r<t.length;r++)if(e._groupsBySlot[n(t[r])]!==i)return -1;return r}(this.redis,e))<0)return this.reject(Error("All keys in the pipeline should belong to the same slots allocation group")),this.promise}else t=16384*Math.random()|0}let r=this;return function(){let e,n,i=r.replyPending=r._queue.length;r.isCluster&&(e={slot:t,redis:r.redis.connectionPool.nodes.all[r.preferKey]});let a="",s={isPipeline:!0,destination:r.isCluster?e:{redis:r.redis},write(e){"string"!=typeof e?(n||(n=[]),a&&(n.push(Buffer.from(a,"utf8")),a=""),n.push(e)):a+=e,--i||(n?(a&&n.push(Buffer.from(a,"utf8")),s.destination.redis.stream.write(Buffer.concat(n))):s.destination.redis.stream.write(a),i=r._queue.length,a="",n=void 0)}};for(let t=0;t<r._queue.length;++t)r.redis.sendCommand(r._queue[t],s,e);r.promise}(),this.promise}},19212,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.addTransactionSupport=void 0;let n=e.r(26898),i=e.r(19335),a=e.r(6135);r.addTransactionSupport=function(e){e.pipeline=function(e){let t=new a.default(this);return Array.isArray(e)&&t.addBatch(e),t};let{multi:t}=e;e.multi=function(e,r){if(void 0!==r||Array.isArray(e)||(r=e,e=null),r&&!1===r.pipeline)return t.call(this);let s=new a.default(this);s.multi(),Array.isArray(e)&&s.addBatch(e);let o=s.exec;s.exec=function(e){if(this.isCluster&&!this.redis.slots.length)return"wait"===this.redis.status&&this.redis.connect().catch(n.noop),(0,i.default)(new Promise((e,t)=>{this.redis.delayUntilReady(r=>{if(r)return void t(r);this.exec(s).then(e,t)})}),e);if(this._transactions>0&&o.call(s),this.nodeifiedPromise)return o.call(s);let t=o.call(s);return(0,i.default)(t.then(function(e){let t=e[e.length-1];if(void 0===t)throw Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.");if(t[0]){t[0].previousErrors=[];for(let r=0;r<e.length-1;++r)e[r][0]&&t[0].previousErrors.push(e[r][0]);throw t[0]}return(0,n.wrapMultiResult)(t[1])}),e)};let{execBuffer:l}=s;return s.execBuffer=function(e){return this._transactions>0&&l.call(s),s.exec(e)},s};let{exec:r}=e;e.exec=function(e){return(0,i.default)(r.call(this).then(function(e){return Array.isArray(e)&&(e=(0,n.wrapMultiResult)(e)),e}),e)}}},57674,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){Object.getOwnPropertyNames(t.prototype).forEach(r=>{Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r))})}},79594,(e,t,r)=>{t.exports=e.x("dns",()=>require("dns"))},23086,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_CLUSTER_OPTIONS=void 0;let n=e.r(79594);r.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:e=>Math.min(100+2*e,2e3),enableOfflineQueue:!0,enableReadyCheck:!0,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1e3,useSRVRecords:!1,resolveSrv:n.resolveSrv,dnsLookup:n.lookup,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],shardedSubscribers:!1}},4446,(e,t,r)=>{t.exports=e.x("net",()=>require("net"))},78695,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getConnectionName=r.weightSrvRecords=r.groupSrvRecords=r.getUniqueHostnamesFromOptions=r.normalizeNodeOptions=r.nodeKeyToRedisOptions=r.getNodeKey=void 0;let n=e.r(26898),i=e.r(4446);r.getNodeKey=function(e){return e.port=e.port||6379,e.host=e.host||"127.0.0.1",e.host+":"+e.port},r.nodeKeyToRedisOptions=function(e){let t=e.lastIndexOf(":");if(-1===t)throw Error(`Invalid node key ${e}`);return{host:e.slice(0,t),port:Number(e.slice(t+1))}},r.normalizeNodeOptions=function(e){return e.map(e=>{let t={};if("object"==typeof e)Object.assign(t,e);else if("string"==typeof e)Object.assign(t,(0,n.parseURL)(e));else if("number"==typeof e)t.port=e;else throw Error("Invalid argument "+e);return"string"==typeof t.port&&(t.port=parseInt(t.port,10)),delete t.db,t.port||(t.port=6379),t.host||(t.host="127.0.0.1"),(0,n.resolveTLSProfile)(t)})},r.getUniqueHostnamesFromOptions=function(e){let t={};return e.forEach(e=>{t[e.host]=!0}),Object.keys(t).filter(e=>!(0,i.isIP)(e))},r.groupSrvRecords=function(e){let t={};for(let r of e)t.hasOwnProperty(r.priority)?(t[r.priority].totalWeight+=r.weight,t[r.priority].records.push(r)):t[r.priority]={totalWeight:r.weight,records:[r]};return t},r.weightSrvRecords=function(e){if(1===e.records.length)return e.totalWeight=0,e.records.shift();let t=Math.floor(Math.random()*(e.totalWeight+e.records.length)),r=0;for(let[n,i]of e.records.entries())if((r+=1+i.weight)>t)return e.totalWeight-=i.weight,e.records.splice(n,1),i},r.getConnectionName=function(e,t){let r=`ioredis-cluster(${e})`;return t?`${r}:${t}`:r}},55925,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(78695),i=e.r(26898),a=e.r(66735),s=(0,i.Debug)("cluster:subscriber");r.default=class{constructor(e,t,r=!1){this.connectionPool=e,this.emitter=t,this.isSharded=r,this.started=!1,this.subscriber=null,this.slotRange=[],this.onSubscriberEnd=()=>{if(!this.started)return void s("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.");s("subscriber has disconnected, selecting a new one..."),this.selectSubscriber()},this.connectionPool.on("-node",(e,t)=>{this.started&&this.subscriber&&(0,n.getNodeKey)(this.subscriber.options)===t&&(s("subscriber has left, selecting a new one..."),this.selectSubscriber())}),this.connectionPool.on("+node",()=>{this.started&&!this.subscriber&&(s("a new node is discovered and there is no subscriber, selecting a new one..."),this.selectSubscriber())})}getInstance(){return this.subscriber}associateSlotRange(e){return this.isSharded&&(this.slotRange=e),this.slotRange}start(){this.started=!0,this.selectSubscriber(),s("started")}stop(){this.started=!1,this.subscriber&&(this.subscriber.disconnect(),this.subscriber=null)}isStarted(){return this.started}selectSubscriber(){let e=this.lastActiveSubscriber;e&&(e.off("end",this.onSubscriberEnd),e.disconnect()),this.subscriber&&(this.subscriber.off("end",this.onSubscriberEnd),this.subscriber.disconnect());let t=(0,i.sample)(this.connectionPool.getNodes());if(!t){s("selecting subscriber failed since there is no node discovered in the cluster yet"),this.subscriber=null;return}let{options:r}=t;s("selected a subscriber %s:%s",r.host,r.port);let o="subscriber";this.isSharded&&(o="ssubscriber"),this.subscriber=new a.default({port:r.port,host:r.host,username:r.username,password:r.password,enableReadyCheck:!0,connectionName:(0,n.getConnectionName)(o,r.connectionName),lazyConnect:!0,tls:r.tls,retryStrategy:null}),this.subscriber.on("error",i.noop),this.subscriber.on("moved",()=>{this.emitter.emit("forceRefresh")}),this.subscriber.once("end",this.onSubscriberEnd);let l={subscribe:[],psubscribe:[],ssubscribe:[]};if(e){let t=e.condition||e.prevCondition;t&&t.subscriber&&(l.subscribe=t.subscriber.channels("subscribe"),l.psubscribe=t.subscriber.channels("psubscribe"),l.ssubscribe=t.subscriber.channels("ssubscribe"))}if(l.subscribe.length||l.psubscribe.length||l.ssubscribe.length){let e=0;for(let t of["subscribe","psubscribe","ssubscribe"]){let r=l[t];r.length&&(e+=1,s("%s %d channels",t,r.length),this.subscriber[t](r).then(()=>{--e||(this.lastActiveSubscriber=this.subscriber)}).catch(()=>{s("failed to %s %d channels",t,r.length)}))}}else this.lastActiveSubscriber=this.subscriber;for(let e of["message","messageBuffer"])this.subscriber.on(e,(t,r)=>{this.emitter.emit(e,t,r)});for(let e of["pmessage","pmessageBuffer"])this.subscriber.on(e,(t,r,n)=>{this.emitter.emit(e,t,r,n)});if(!0==this.isSharded)for(let e of["smessage","smessageBuffer"])this.subscriber.on(e,(t,r)=>{this.emitter.emit(e,t,r)})}}},77825,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(27699),i=e.r(26898),a=e.r(78695),s=e.r(66735),o=(0,i.Debug)("cluster:connectionPool");class l extends n.EventEmitter{constructor(e){super(),this.redisOptions=e,this.nodes={all:{},master:{},slave:{}},this.specifiedOptions={}}getNodes(e="all"){let t=this.nodes[e];return Object.keys(t).map(e=>t[e])}getInstanceByKey(e){return this.nodes.all[e]}getSampleInstance(e){let t=Object.keys(this.nodes[e]),r=(0,i.sample)(t);return this.nodes[e][r]}addMasterNode(e){let t=(0,a.getNodeKey)(e.options),r=this.createRedisFromOptions(e,e.options.readOnly);return!e.options.readOnly&&(this.nodes.all[t]=r,this.nodes.master[t]=r,!0)}createRedisFromOptions(e,t){return new s.default((0,i.defaults)({retryStrategy:null,enableOfflineQueue:!0,readOnly:t},e,this.redisOptions,{lazyConnect:!0}))}findOrCreate(e,t=!1){let r,n=(0,a.getNodeKey)(e);return t=!!t,this.specifiedOptions[n]?Object.assign(e,this.specifiedOptions[n]):this.specifiedOptions[n]=e,this.nodes.all[n]?(r=this.nodes.all[n]).options.readOnly!==t&&(r.options.readOnly=t,o("Change role of %s to %s",n,t?"slave":"master"),r[t?"readonly":"readwrite"]().catch(i.noop),t?(delete this.nodes.master[n],this.nodes.slave[n]=r):(delete this.nodes.slave[n],this.nodes.master[n]=r)):(o("Connecting to %s as %s",n,t?"slave":"master"),r=this.createRedisFromOptions(e,t),this.nodes.all[n]=r,this.nodes[t?"slave":"master"][n]=r,r.once("end",()=>{this.removeNode(n),this.emit("-node",r,n),Object.keys(this.nodes.all).length||this.emit("drain")}),this.emit("+node",r,n),r.on("error",function(e){this.emit("nodeError",e,n)})),r}reset(e){o("Reset with %O",e);let t={};e.forEach(e=>{let r=(0,a.getNodeKey)(e);e.readOnly&&t[r]||(t[r]=e)}),Object.keys(this.nodes.all).forEach(e=>{t[e]||(o("Disconnect %s because the node does not hold any slot",e),this.nodes.all[e].disconnect(),this.removeNode(e))}),Object.keys(t).forEach(e=>{let r=t[e];this.findOrCreate(r,r.readOnly)})}removeNode(e){let{nodes:t}=this;t.all[e]&&(o("Remove %s from the pool",e),delete t.all[e]),delete t.master[e],delete t.slave[e]}}r.default=l},89977,(e,t,r)=>{"use strict";function n(e,t){var t=t||{};this._capacity=t.capacity,this._head=0,this._tail=0,Array.isArray(e)?this._fromArray(e):(this._capacityMask=3,this._list=[,,,,])}n.prototype.peekAt=function(e){var t=e;if(t===(0|t)){var r=this.size();if(!(t>=r)&&!(t<-r))return t<0&&(t+=r),t=this._head+t&this._capacityMask,this._list[t]}},n.prototype.get=function(e){return this.peekAt(e)},n.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},n.prototype.peekFront=function(){return this.peek()},n.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(n.prototype,"length",{get:function(){return this.size()}}),n.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},n.prototype.unshift=function(e){if(0==arguments.length)return this.size();var t=this._list.length;return(this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail)?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},n.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}},n.prototype.push=function(e){if(0==arguments.length)return this.size();var t=this._tail;return(this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail)?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},n.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var r=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),r}},n.prototype.removeOne=function(e){var t,r=e;if(r===(0|r)&&this._head!==this._tail){var n=this.size(),i=this._list.length;if(!(r>=n)&&!(r<-n)){r<0&&(r+=n),r=this._head+r&this._capacityMask;var a=this._list[r];if(e<n/2){for(t=e;t>0;t--)this._list[r]=this._list[r=r-1+i&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+i&this._capacityMask}else{for(t=n-1-e;t>0;t--)this._list[r]=this._list[r=r+1+i&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+i&this._capacityMask}return a}}},n.prototype.remove=function(e,t){var r,n,i=e,a=t;if(i===(0|i)&&this._head!==this._tail){var s=this.size(),o=this._list.length;if(!(i>=s)&&!(i<-s)&&!(t<1)){if(i<0&&(i+=s),1===t||!t)return(r=[,])[0]=this.removeOne(i),r;if(0===i&&i+t>=s)return r=this.toArray(),this.clear(),r;for(i+t>s&&(t=s-i),r=Array(t),n=0;n<t;n++)r[n]=this._list[this._head+i+n&this._capacityMask];if(i=this._head+i&this._capacityMask,e+t===s){for(this._tail=this._tail-t+o&this._capacityMask,n=t;n>0;n--)this._list[i=i+1+o&this._capacityMask]=void 0;return r}if(0===e){for(this._head=this._head+t+o&this._capacityMask,n=t-1;n>0;n--)this._list[i=i+1+o&this._capacityMask]=void 0;return r}if(i<s/2){for(this._head=this._head+e+t+o&this._capacityMask,n=e;n>0;n--)this.unshift(this._list[i=i-1+o&this._capacityMask]);for(i=this._head-1+o&this._capacityMask;a>0;)this._list[i=i-1+o&this._capacityMask]=void 0,a--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+t+o&this._capacityMask,n=s-(t+e);n>0;n--)this.push(this._list[i++]);for(i=this._tail;a>0;)this._list[i=i+1+o&this._capacityMask]=void 0,a--}return this._head<2&&this._tail>1e4&&this._tail<=o>>>2&&this._shrinkArray(),r}}},n.prototype.splice=function(e,t){var r=e;if(r===(0|r)){var n=this.size();if(r<0&&(r+=n),!(r>n))if(!(arguments.length>2))return this.remove(r,t);else{var i,a,s,o=arguments.length,l=this._list.length,u=2;if(!n||r<n/2){for(i=0,a=Array(r);i<r;i++)a[i]=this._list[this._head+i&this._capacityMask];for(0===t?(s=[],r>0&&(this._head=this._head+r+l&this._capacityMask)):(s=this.remove(r,t),this._head=this._head+r+l&this._capacityMask);o>u;)this.unshift(arguments[--o]);for(i=r;i>0;i--)this.unshift(a[i-1])}else{var c=(a=Array(n-(r+t))).length;for(i=0;i<c;i++)a[i]=this._list[this._head+r+t+i&this._capacityMask];for(0===t?(s=[],r!=n&&(this._tail=this._head+r+l&this._capacityMask)):(s=this.remove(r,t),this._tail=this._tail-c+l&this._capacityMask);u<o;)this.push(arguments[u++]);for(i=0;i<c;i++)this.push(a[i])}return s}}},n.prototype.clear=function(){this._list=Array(this._list.length),this._head=0,this._tail=0},n.prototype.isEmpty=function(){return this._head===this._tail},n.prototype.toArray=function(){return this._copyArray(!1)},n.prototype._fromArray=function(e){var t=e.length,r=this._nextPowerOf2(t);this._list=Array(r),this._capacityMask=r-1,this._tail=t;for(var n=0;n<t;n++)this._list[n]=e[n]},n.prototype._copyArray=function(e,t){var r,n=this._list,i=n.length,a=this.length;if((t|=a)==a&&this._head<this._tail)return this._list.slice(this._head,this._tail);var s=Array(t),o=0;if(e||this._head>this._tail){for(r=this._head;r<i;r++)s[o++]=n[r];for(r=0;r<this._tail;r++)s[o++]=n[r]}else for(r=this._head;r<this._tail;r++)s[o++]=n[r];return s},n.prototype._growArray=function(){if(0!=this._head){var e=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=e}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1},n.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},n.prototype._nextPowerOf2=function(e){return Math.max(1<<Math.log(e)/Math.log(2)+1,4)},t.exports=n},66392,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(26898),i=e.r(89977),a=(0,n.Debug)("delayqueue");r.default=class{constructor(){this.queues={},this.timeouts={}}push(e,t,r){let n=r.callback||process.nextTick;this.queues[e]||(this.queues[e]=new i),this.queues[e].push(t),this.timeouts[e]||(this.timeouts[e]=setTimeout(()=>{n(()=>{this.timeouts[e]=null,this.execute(e)})},r.timeout))}execute(e){let t=this.queues[e];if(!t)return;let{length:r}=t;if(r)for(a("send %d commands in %s queue",r,e),this.queues[e]=null;t.length>0;)t.shift()()}}},58432,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(26898),i=e.r(55925),a=e.r(77825),s=e.r(78695),o=e.r(9068),l=(0,n.Debug)("cluster:subscriberGroup");r.default=class{constructor(e,t){this.cluster=e,this.shardedSubscribers=new Map,this.clusterSlots=[],this.subscriberToSlotsIndex=new Map,this.channels=new Map,e.on("+node",e=>{this._addSubscriber(e)}),e.on("-node",e=>{this._removeSubscriber(e)}),e.on("refresh",()=>{this._refreshSlots(e)}),e.on("forceRefresh",()=>{t()})}getResponsibleSubscriber(e){let t=this.clusterSlots[e][0];return this.shardedSubscribers.get(t)}addChannels(e){let t=o(e[0]);e.forEach(e=>{if(o(e)!=t)return -1});let r=this.channels.get(t);return r?this.channels.set(t,r.concat(e)):this.channels.set(t,e),[...this.channels.values()].flatMap(e=>e).length}removeChannels(e){let t=o(e[0]);e.forEach(e=>{if(o(e)!=t)return -1});let r=this.channels.get(t);if(r){let n=r.filter(t=>!e.includes(t));this.channels.set(t,n)}return[...this.channels.values()].flatMap(e=>e).length}stop(){for(let e of this.shardedSubscribers.values())e.stop()}start(){for(let e of this.shardedSubscribers.values())e.isStarted()||e.start()}_addSubscriber(e){let t=new a.default(e.options);if(t.addMasterNode(e)){let r=new i.default(t,this.cluster,!0),n=(0,s.getNodeKey)(e.options);return this.shardedSubscribers.set(n,r),r.start(),this._resubscribe(),this.cluster.emit("+subscriber"),r}return null}_removeSubscriber(e){let t=(0,s.getNodeKey)(e.options),r=this.shardedSubscribers.get(t);return r&&(r.stop(),this.shardedSubscribers.delete(t),this._resubscribe(),this.cluster.emit("-subscriber")),this.shardedSubscribers}_refreshSlots(e){if(this._slotsAreEqual(e.slots))l("Nothing to refresh because the new cluster map is equal to the previous one.");else{l("Refreshing the slots of the subscriber group."),this.subscriberToSlotsIndex=new Map;for(let t=0;t<e.slots.length;t++){let r=e.slots[t][0];this.subscriberToSlotsIndex.has(r)||this.subscriberToSlotsIndex.set(r,[]),this.subscriberToSlotsIndex.get(r).push(Number(t))}return this._resubscribe(),this.clusterSlots=JSON.parse(JSON.stringify(e.slots)),this.cluster.emit("subscribersReady"),!0}return!1}_resubscribe(){this.shardedSubscribers&&this.shardedSubscribers.forEach((e,t)=>{let r=this.subscriberToSlotsIndex.get(t);r&&(e.associateSlotRange(r),r.forEach(t=>{let r=e.getInstance(),n=this.channels.get(t);n&&n.length>0&&r&&(r.ssubscribe(n),r.on("ready",()=>{r.ssubscribe(n)}))}))})}_slotsAreEqual(e){return void 0!==this.clusterSlots&&JSON.stringify(this.clusterSlots)===JSON.stringify(e)}}},83252,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(12522),i=e.r(27699),a=e.r(63227),s=e.r(19335),o=e.r(30846),l=e.r(17798),u=e.r(66735),c=e.r(12749),d=e.r(19212),p=e.r(26898),h=e.r(57674),f=e.r(67061),m=e.r(23086),g=e.r(55925),y=e.r(77825),b=e.r(66392),_=e.r(78695),v=e.r(89977),w=e.r(58432),O=(0,p.Debug)("cluster"),P=new WeakSet;class S extends f.default{constructor(e,t={}){if(super(),this.slots=[],this._groupsIds={},this._groupsBySlot=Array(16384),this.isCluster=!0,this.retryAttempts=0,this.delayQueue=new b.default,this.offlineQueue=new v,this.isRefreshing=!1,this._refreshSlotsCacheCallbacks=[],this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this._readyDelayedCallbacks=[],this.connectionEpoch=0,i.EventEmitter.call(this),this.startupNodes=e,this.options=(0,p.defaults)({},t,m.DEFAULT_CLUSTER_OPTIONS,this.options),!0==this.options.shardedSubscribers&&(this.shardedSubscribers=new w.default(this,this.refreshSlotsCache.bind(this))),this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix&&(this.options.keyPrefix=this.options.redisOptions.keyPrefix),"function"!=typeof this.options.scaleReads&&-1===["all","master","slave"].indexOf(this.options.scaleReads))throw Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function');this.connectionPool=new y.default(this.options.redisOptions),this.connectionPool.on("-node",(e,t)=>{this.emit("-node",e)}),this.connectionPool.on("+node",e=>{this.emit("+node",e)}),this.connectionPool.on("drain",()=>{this.setStatus("close")}),this.connectionPool.on("nodeError",(e,t)=>{this.emit("node error",e,t)}),this.subscriber=new g.default(this.connectionPool,this),this.options.scripts&&Object.entries(this.options.scripts).forEach(([e,t])=>{this.defineCommand(e,t)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(e=>{O("connecting failed: %s",e)})}connect(){return new Promise((e,t)=>{if("connecting"===this.status||"connect"===this.status||"ready"===this.status)return void t(Error("Redis is already connecting/connected"));let r=++this.connectionEpoch;this.setStatus("connecting"),this.resolveStartupNodeHostnames().then(n=>{let i;if(this.connectionEpoch!==r){O("discard connecting after resolving startup nodes because epoch not match: %d != %d",r,this.connectionEpoch),t(new a.RedisError("Connection is discarded because a new connection is made"));return}if("connecting"!==this.status){O("discard connecting after resolving startup nodes because the status changed to %s",this.status),t(new a.RedisError("Connection is aborted"));return}this.connectionPool.reset(n);let s=()=>{this.setStatus("ready"),this.retryAttempts=0,this.executeOfflineCommands(),this.resetNodesRefreshInterval(),e()},o=()=>{this.invokeReadyDelayedCallbacks(void 0),this.removeListener("close",i),this.manuallyClosing=!1,this.setStatus("connect"),this.options.enableReadyCheck?this.readyCheck((e,t)=>{e||t?(O("Ready check failed (%s). Reconnecting...",e||t),"connect"===this.status&&this.disconnect(!0)):s()}):s()};i=()=>{let e=Error("None of startup nodes is available");this.removeListener("refresh",o),this.invokeReadyDelayedCallbacks(e),t(e)},this.once("refresh",o),this.once("close",i),this.once("close",this.handleCloseEvent.bind(this)),this.refreshSlotsCache(e=>{e&&e.message===l.default.defaultMessage&&(u.default.prototype.silentEmit.call(this,"error",e),this.connectionPool.reset([]))}),this.subscriber.start(),this.options.shardedSubscribers&&this.shardedSubscribers.start()}).catch(e=>{this.setStatus("close"),this.handleCloseEvent(e),this.invokeReadyDelayedCallbacks(e),t(e)})})}disconnect(e=!1){let t=this.status;this.setStatus("disconnecting"),e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null,O("Canceled reconnecting attempts")),this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers&&this.shardedSubscribers.stop(),"wait"===t?(this.setStatus("close"),this.handleCloseEvent()):this.connectionPool.reset([])}quit(e){let t=this.status;if(this.setStatus("disconnecting"),this.manuallyClosing=!0,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers&&this.shardedSubscribers.stop(),"wait"===t){let t=(0,s.default)(Promise.resolve("OK"),e);return setImmediate((function(){this.setStatus("close"),this.handleCloseEvent()}).bind(this)),t}return(0,s.default)(Promise.all(this.nodes().map(e=>e.quit().catch(e=>{if(e.message===p.CONNECTION_CLOSED_ERROR_MSG)return"OK";throw e}))).then(()=>"OK"),e)}duplicate(e=[],t={}){return new S(e.length>0?e:this.startupNodes.slice(0),Object.assign({},this.options,t))}nodes(e="all"){if("all"!==e&&"master"!==e&&"slave"!==e)throw Error('Invalid role "'+e+'". Expected "all", "master" or "slave"');return this.connectionPool.getNodes(e)}delayUntilReady(e){this._readyDelayedCallbacks.push(e)}get autoPipelineQueueSize(){let e=0;for(let t of this._autoPipelines.values())e+=t.length;return e}refreshSlotsCache(e){if(e&&this._refreshSlotsCacheCallbacks.push(e),this.isRefreshing)return;this.isRefreshing=!0;let t=this,r=e=>{for(let t of(this.isRefreshing=!1,this._refreshSlotsCacheCallbacks))t(e);this._refreshSlotsCacheCallbacks=[]},n=(0,p.shuffle)(this.connectionPool.getNodes()),i=null;!function e(a){if(a===n.length)return r(new l.default(l.default.defaultMessage,i));let s=n[a],o=`${s.options.host}:${s.options.port}`;O("getting slot cache from %s",o),t.getInfoFromNode(s,function(n){switch(t.status){case"close":case"end":return r(Error("Cluster is disconnected."));case"disconnecting":return r(Error("Cluster is disconnecting."))}n?(t.emit("node error",n,o),i=n,e(a+1)):(t.emit("refresh"),r())})}(0)}sendCommand(e,t,r){if("wait"===this.status&&this.connect().catch(p.noop),"end"===this.status)return e.reject(Error(p.CONNECTION_CLOSED_ERROR_MSG)),e.promise;let i=this.options.scaleReads;"master"!==i&&(e.isReadOnly||(0,n.exists)(e.name)&&(0,n.hasFlag)(e.name,"readonly")||(i="master"));let s=r?r.slot:e.getSlot(),l={},u=this;if(!r&&!P.has(e)){P.add(e);let t=e.reject;e.reject=function(r){let n=c.bind(null,!0);u.handleError(r,l,{moved:function(t,r){O("command %s is moved to %s",e.name,r),s=Number(t),u.slots[t]?u.slots[t][0]=r:u.slots[t]=[r],u._groupsBySlot[t]=u._groupsIds[u.slots[t].join(";")],u.connectionPool.findOrCreate(u.natMapper(r)),c(),O("refreshing slot caches... (triggered by MOVED error)"),u.refreshSlotsCache()},ask:function(t,r){O("command %s is required to ask %s:%s",e.name,r);let n=u.natMapper(r);u.connectionPool.findOrCreate(n),c(!1,`${n.host}:${n.port}`)},tryagain:n,clusterDown:n,connectionClosed:n,maxRedirections:function(r){t.call(e,r)},defaults:function(){t.call(e,r)}})}}function c(n,l){let c;if("end"===u.status)return void e.reject(new a.AbortError("Cluster is ended."));if("ready"===u.status||"cluster"===e.name){if(r&&r.redis)c=r.redis;else if(o.default.checkFlag("ENTER_SUBSCRIBER_MODE",e.name)||o.default.checkFlag("EXIT_SUBSCRIBER_MODE",e.name)){if(!0==u.options.shardedSubscribers&&("ssubscribe"==e.name||"sunsubscribe"==e.name)){let t=u.shardedSubscribers.getResponsibleSubscriber(s),r=-1;"ssubscribe"==e.name&&(r=u.shardedSubscribers.addChannels(e.getKeys())),"sunsubscribe"==e.name&&(r=u.shardedSubscribers.removeChannels(e.getKeys())),-1!==r?c=t.getInstance():e.reject(new a.AbortError("Can't add or remove the given channels. Are they in the same slot?"))}else c=u.subscriber.getInstance();if(!c)return void e.reject(new a.AbortError("No subscriber for the cluster"))}else{if(!n){if("number"==typeof s&&u.slots[s]){let t=u.slots[s];if("function"==typeof i){let r=t.map(function(e){return u.connectionPool.getInstanceByKey(e)});Array.isArray(c=i(r,e))&&(c=(0,p.sample)(c)),c||(c=r[0])}else{let e;e="all"===i?(0,p.sample)(t):"slave"===i&&t.length>1?(0,p.sample)(t,1):t[0],c=u.connectionPool.getInstanceByKey(e)}}l&&(c=u.connectionPool.getInstanceByKey(l)).asking()}c||(c=("function"==typeof i?null:u.connectionPool.getSampleInstance(i))||u.connectionPool.getSampleInstance("all"))}r&&!r.redis&&(r.redis=c)}c?c.sendCommand(e,t):u.options.enableOfflineQueue?u.offlineQueue.push({command:e,stream:t,node:r}):e.reject(Error("Cluster isn't ready and enableOfflineQueue options is false"))}return c(),e.promise}sscanStream(e,t){return this.createScanStream("sscan",{key:e,options:t})}sscanBufferStream(e,t){return this.createScanStream("sscanBuffer",{key:e,options:t})}hscanStream(e,t){return this.createScanStream("hscan",{key:e,options:t})}hscanBufferStream(e,t){return this.createScanStream("hscanBuffer",{key:e,options:t})}zscanStream(e,t){return this.createScanStream("zscan",{key:e,options:t})}zscanBufferStream(e,t){return this.createScanStream("zscanBuffer",{key:e,options:t})}handleError(e,t,r){if(void 0===t.value?t.value=this.options.maxRedirections:t.value-=1,t.value<=0)return void r.maxRedirections(Error("Too many Cluster redirections. Last error: "+e));let n=e.message.split(" ");if("MOVED"===n[0]){let e=this.options.retryDelayOnMoved;e&&"number"==typeof e?this.delayQueue.push("moved",r.moved.bind(null,n[1],n[2]),{timeout:e}):r.moved(n[1],n[2])}else"ASK"===n[0]?r.ask(n[1],n[2]):"TRYAGAIN"===n[0]?this.delayQueue.push("tryagain",r.tryagain,{timeout:this.options.retryDelayOnTryAgain}):"CLUSTERDOWN"===n[0]&&this.options.retryDelayOnClusterDown>0?this.delayQueue.push("clusterdown",r.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)}):e.message===p.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&"ready"===this.status?this.delayQueue.push("failover",r.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)}):r.defaults()}resetOfflineQueue(){this.offlineQueue=new v}clearNodesRefreshInterval(){this.slotsTimer&&(clearTimeout(this.slotsTimer),this.slotsTimer=null)}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval)return;let e=()=>{this.slotsTimer=setTimeout(()=>{O('refreshing slot caches... (triggered by "slotsRefreshInterval" option)'),this.refreshSlotsCache(()=>{e()})},this.options.slotsRefreshInterval)};e()}setStatus(e){O("status: %s -> %s",this.status||"[empty]",e),this.status=e,process.nextTick(()=>{this.emit(e)})}handleCloseEvent(e){let t;e&&O("closed because %s",e),this.manuallyClosing||"function"!=typeof this.options.clusterRetryStrategy||(t=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,e)),"number"==typeof t?(this.setStatus("reconnecting"),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,O("Cluster is disconnected. Retrying after %dms",t),this.connect().catch(function(e){O("Got error %s when reconnecting. Ignoring...",e)})},t)):(this.setStatus("end"),this.flushQueue(Error("None of startup nodes is available")))}flushQueue(e){let t;for(;t=this.offlineQueue.shift();)t.command.reject(e)}executeOfflineCommands(){if(this.offlineQueue.length){let e;O("send %d commands in offline queue",this.offlineQueue.length);let t=this.offlineQueue;for(this.resetOfflineQueue();e=t.shift();)this.sendCommand(e.command,e.stream,e.node)}}natMapper(e){let t="string"==typeof e?e:`${e.host}:${e.port}`,r=null;return(this.options.natMap&&"function"==typeof this.options.natMap?r=this.options.natMap(t):this.options.natMap&&"object"==typeof this.options.natMap&&(r=this.options.natMap[t]),r)?(O("NAT mapping %s -> %O",t,r),Object.assign({},r)):"string"==typeof e?(0,_.nodeKeyToRedisOptions)(e):e}getInfoFromNode(e,t){if(!e)return t(Error("Node is disconnected"));let r=e.duplicate({enableOfflineQueue:!0,enableReadyCheck:!1,retryStrategy:null,connectionName:(0,_.getConnectionName)("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});r.on("error",p.noop),r.cluster("SLOTS",(0,p.timeout)((e,n)=>{if(r.disconnect(),e)return O("error encountered running CLUSTER.SLOTS: %s",e),t(e);if("disconnecting"===this.status||"close"===this.status||"end"===this.status){O("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",n.length,this.status),t();return}let i=[];O("cluster slots result count: %d",n.length);for(let e=0;e<n.length;++e){let t=n[e],r=t[0],a=t[1],s=[];for(let e=2;e<t.length;e++){if(!t[e][0])continue;let r=this.natMapper({host:t[e][0],port:t[e][1]});r.readOnly=2!==e,i.push(r),s.push(r.host+":"+r.port)}O("cluster slots result [%d]: slots %d~%d served by %s",e,r,a,s);for(let e=r;e<=a;e++)this.slots[e]=s}this._groupsIds=Object.create(null);let a=0;for(let e=0;e<16384;e++){let t=(this.slots[e]||[]).join(";");if(!t.length){this._groupsBySlot[e]=void 0;continue}this._groupsIds[t]||(this._groupsIds[t]=++a),this._groupsBySlot[e]=this._groupsIds[t]}this.connectionPool.reset(i),t()},this.options.slotsRefreshTimeout))}invokeReadyDelayedCallbacks(e){for(let t of this._readyDelayedCallbacks)process.nextTick(t,e);this._readyDelayedCallbacks=[]}readyCheck(e){this.cluster("INFO",(t,r)=>{let n;if(t)return e(t);if("string"!=typeof r)return e();let i=r.split("\r\n");for(let e=0;e<i.length;++e){let t=i[e].split(":");if("cluster_state"===t[0]){n=t[1];break}}"fail"===n?(O("cluster state not ok (%s)",n),e(null,n)):e()})}resolveSrv(e){return new Promise((t,r)=>{this.options.resolveSrv(e,(e,n)=>{if(e)return r(e);let i=this,a=(0,_.groupSrvRecords)(n),s=Object.keys(a).sort((e,t)=>parseInt(e)-parseInt(t));!function e(n){if(!s.length)return r(n);let o=a[s[0]],l=(0,_.weightSrvRecords)(o);o.records.length||s.shift(),i.dnsLookup(l.name).then(e=>t({host:e,port:l.port}),e)}()})})}dnsLookup(e){return new Promise((t,r)=>{this.options.dnsLookup(e,(n,i)=>{n?(O("failed to resolve hostname %s to IP: %s",e,n.message),r(n)):(O("resolved hostname %s to IP %s",e,i),t(i))})})}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||0===this.startupNodes.length)throw Error("`startupNodes` should contain at least one node.");let e=(0,_.normalizeNodeOptions)(this.startupNodes),t=(0,_.getUniqueHostnamesFromOptions)(e);if(0===t.length)return e;let r=await Promise.all(t.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this))),n=(0,p.zipMap)(t,r);return e.map(e=>{let t=n.get(e.host);return t?this.options.useSRVRecords?Object.assign({},e,t):Object.assign({},e,{host:t}):e})}createScanStream(e,{key:t,options:r={}}){return new c.default({objectMode:!0,key:t,redis:this,command:e,...r})}}(0,h.default)(S,i.EventEmitter),(0,d.addTransactionSupport)(S.prototype),r.default=S},55004,(e,t,r)=>{t.exports=e.x("tls",()=>require("tls"))},58451,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=(0,e.r(26898).Debug)("AbstractConnector");r.default=class{constructor(e){this.connecting=!1,this.disconnectTimeout=e}check(e){return!0}disconnect(){if(this.connecting=!1,this.stream){let e=this.stream,t=setTimeout(()=>{n("stream %s:%s still open, destroying it",e.remoteAddress,e.remotePort),e.destroy()},this.disconnectTimeout);e.on("close",()=>clearTimeout(t)),e.end()}}}},90851,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(4446),i=e.r(55004),a=e.r(26898),s=e.r(58451);class o extends s.default{constructor(e){super(e.disconnectTimeout),this.options=e}connect(e){let t,{options:r}=this;return this.connecting=!0,"path"in r&&r.path?t={path:r.path}:(t={},"port"in r&&null!=r.port&&(t.port=r.port),"host"in r&&null!=r.host&&(t.host=r.host),"family"in r&&null!=r.family&&(t.family=r.family)),r.tls&&Object.assign(t,r.tls),new Promise((e,s)=>{process.nextTick(()=>{if(!this.connecting)return void s(Error(a.CONNECTION_CLOSED_ERROR_MSG));try{r.tls?this.stream=(0,i.connect)(t):this.stream=(0,n.createConnection)(t)}catch(e){s(e);return}this.stream.once("error",e=>{this.firstError=e}),e(this.stream)})})}}r.default=o},85649,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=class{constructor(e){this.cursor=0,this.sentinels=e.slice(0)}next(){let e=this.cursor>=this.sentinels.length;return{done:e,value:e?void 0:this.sentinels[this.cursor++]}}reset(e){e&&this.sentinels.length>1&&1!==this.cursor&&this.sentinels.unshift(...this.sentinels.splice(this.cursor-1)),this.cursor=0}add(e){for(let r=0;r<this.sentinels.length;r++){var t;if(t=this.sentinels[r],(e.host||"127.0.0.1")===(t.host||"127.0.0.1")&&(e.port||26379)===(t.port||26379))return!1}return this.sentinels.push(e),!0}toString(){return`${JSON.stringify(this.sentinels)} @${this.cursor}`}}},87575,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FailoverDetector=void 0;let n=(0,e.r(26898).Debug)("FailoverDetector"),i="+switch-master";r.FailoverDetector=class{constructor(e,t){this.isDisconnected=!1,this.connector=e,this.sentinels=t}cleanup(){for(let e of(this.isDisconnected=!0,this.sentinels))e.client.disconnect()}async subscribe(){n("Starting FailoverDetector");let e=[];for(let t of this.sentinels){let r=t.client.subscribe(i).catch(e=>{n("Failed to subscribe to failover messages on sentinel %s:%s (%s)",t.address.host||"127.0.0.1",t.address.port||26739,e.message)});e.push(r),t.client.on("message",e=>{this.isDisconnected||e!==i||this.disconnect()})}await Promise.all(e)}disconnect(){this.isDisconnected=!0,n("Failover detected, disconnecting"),this.connector.disconnect()}}},77420,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SentinelIterator=void 0;let n=e.r(4446),i=e.r(26898),a=e.r(55004),s=e.r(85649);r.SentinelIterator=s.default;let o=e.r(58451),l=e.r(66735),u=e.r(87575),c=(0,i.Debug)("SentinelConnector");class d extends o.default{constructor(e){if(super(e.disconnectTimeout),this.options=e,this.emitter=null,this.failoverDetector=null,!this.options.sentinels.length)throw Error("Requires at least one sentinel to connect to.");if(!this.options.name)throw Error("Requires the name of master.");this.sentinelIterator=new s.default(this.options.sentinels)}check(e){let t=!e.role||this.options.role===e.role;return t||(c("role invalid, expected %s, but got %s",this.options.role,e.role),this.sentinelIterator.next(),this.sentinelIterator.next(),this.sentinelIterator.reset(!0)),t}disconnect(){super.disconnect(),this.failoverDetector&&this.failoverDetector.cleanup()}connect(e){let t;this.connecting=!0,this.retryAttempts=0;let r=async()=>{let s=this.sentinelIterator.next();if(s.done){this.sentinelIterator.reset(!1);let n="function"==typeof this.options.sentinelRetryStrategy?this.options.sentinelRetryStrategy(++this.retryAttempts):null,i="number"!=typeof n?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${n}ms.`;t&&(i+=` Last error: ${t.message}`),c(i);let a=Error(i);if("number"==typeof n)return e("error",a),await new Promise(e=>setTimeout(e,n)),r();throw a}let o=null,l=null;try{o=await this.resolve(s.value)}catch(e){l=e}if(!this.connecting)throw Error(i.CONNECTION_CLOSED_ERROR_MSG);let u=s.value.host+":"+s.value.port;if(o)return c("resolved: %s:%s from sentinel %s",o.host,o.port,u),this.options.enableTLSForSentinelMode&&this.options.tls?(Object.assign(o,this.options.tls),this.stream=(0,a.connect)(o),this.stream.once("secureConnect",this.initFailoverDetector.bind(this))):(this.stream=(0,n.createConnection)(o),this.stream.once("connect",this.initFailoverDetector.bind(this))),this.stream.once("error",e=>{this.firstError=e}),this.stream;{let n=l?"failed to connect to sentinel "+u+" because "+l.message:"connected to sentinel "+u+" successfully, but got an invalid reply: "+o;return c(n),e("sentinelError",Error(n)),l&&(t=l),r()}};return r()}async updateSentinels(e){if(!this.options.updateSentinels)return;let t=await e.sentinel("sentinels",this.options.name);Array.isArray(t)&&(t.map(i.packObject).forEach(e=>{if(-1===(e.flags?e.flags.split(","):[]).indexOf("disconnected")&&e.ip&&e.port){let t=this.sentinelNatResolve(p(e));this.sentinelIterator.add(t)&&c("adding sentinel %s:%s",t.host,t.port)}}),c("Updated internal sentinels: %s",this.sentinelIterator))}async resolveMaster(e){let t=await e.sentinel("get-master-addr-by-name",this.options.name);return await this.updateSentinels(e),this.sentinelNatResolve(Array.isArray(t)?{host:t[0],port:Number(t[1])}:null)}async resolveSlave(e){let t=await e.sentinel("slaves",this.options.name);if(!Array.isArray(t))return null;let r=t.map(i.packObject).filter(e=>e.flags&&!e.flags.match(/(disconnected|s_down|o_down)/));return this.sentinelNatResolve(function(e,t){let r;if(0===e.length)return null;if("function"==typeof t)r=t(e);else if(null!==t&&"object"==typeof t){let n=Array.isArray(t)?t:[t];n.sort((e,t)=>(e.prio||(e.prio=1),t.prio||(t.prio=1),e.prio<t.prio)?-1:+(e.prio>t.prio));for(let t=0;t<n.length;t++){for(let i=0;i<e.length;i++){let a=e[i];if(a.ip===n[t].ip&&a.port===n[t].port){r=a;break}}if(r)break}}return r||(r=(0,i.sample)(e)),p(r)}(r,this.options.preferredSlaves))}sentinelNatResolve(e){if(!e||!this.options.natMap)return e;let t=`${e.host}:${e.port}`,r=e;return"function"==typeof this.options.natMap?r=this.options.natMap(t)||e:"object"==typeof this.options.natMap&&(r=this.options.natMap[t]||e),r}connectToSentinel(e,t){return new l.default({port:e.port||26379,host:e.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:e.family||("path"in this.options&&this.options.path?void 0:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:!1,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...t})}async resolve(e){let t=this.connectToSentinel(e);t.on("error",h);try{if("slave"===this.options.role)return await this.resolveSlave(t);return await this.resolveMaster(t)}finally{t.disconnect()}}async initFailoverDetector(){var e;if(!this.options.failoverDetector)return;this.sentinelIterator.reset(!0);let t=[];for(;t.length<this.options.sentinelMaxConnections;){let{done:e,value:r}=this.sentinelIterator.next();if(e)break;let n=this.connectToSentinel(r,{lazyConnect:!0,retryStrategy:this.options.sentinelReconnectStrategy});n.on("reconnecting",()=>{var e;null==(e=this.emitter)||e.emit("sentinelReconnecting")}),t.push({address:r,client:n})}this.sentinelIterator.reset(!1),this.failoverDetector&&this.failoverDetector.cleanup(),this.failoverDetector=new u.FailoverDetector(this,t),await this.failoverDetector.subscribe(),null==(e=this.emitter)||e.emit("failoverSubscribed")}}function p(e){return{host:e.ip,port:Number(e.port)}}function h(){}r.default=d},18652,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SentinelConnector=r.StandaloneConnector=void 0,r.StandaloneConnector=e.r(90851).default,r.SentinelConnector=e.r(77420).default},53757,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(63227);class i extends n.AbortError{constructor(e){super(`Reached the max retries per request limit (which is ${e}). Refer to "maxRetriesPerRequest" option for details.`),Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}r.default=i},88060,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MaxRetriesPerRequestError=void 0,r.MaxRetriesPerRequestError=e.r(53757).default},874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},99348,(e,t,r)=>{t.exports=e.x("string_decoder",()=>require("string_decoder"))},29082,(e,t,r)=>{"use strict";let n=e.r(874).Buffer,i=new(e.r(99348)).StringDecoder,a=e.r(63227),s=a.ReplyError,o=a.ParserError;var l=n.allocUnsafe(32768),u=0,c=null,d=0,p=0;function h(e){let t=e.offset,r=e.buffer,n=r.length-1;for(var i=t;i<n;)if(13===r[i++]){if(e.offset=i+1,!0===e.optionReturnBuffers)return e.buffer.slice(t,i-1);return e.buffer.toString("utf8",t,i-1)}}function f(e){let t=e.buffer.length-1;for(var r=e.offset,n=0;r<t;){let t=e.buffer[r++];if(13===t)return e.offset=r+1,n;n=10*n+(t-48)}}function m(e,t,r){e.arrayCache.push(t),e.arrayPos.push(r)}function g(e){let t=e.arrayCache.pop();var r=e.arrayPos.pop();if(e.arrayCache.length){let n=g(e);if(void 0===n)return void m(e,t,r);t[r++]=n}return y(e,t,r)}function y(e,t,r){let n=e.buffer.length;for(;r<t.length;){let i=e.offset;if(e.offset>=n)return void m(e,t,r);let a=b(e,e.buffer[e.offset++]);if(void 0===a){e.arrayCache.length||e.bufferCache.length||(e.offset=i),m(e,t,r);return}t[r]=a,r++}return t}function b(e,t){switch(t){case 36:let r=f(e);if(void 0===r)return;if(r<0)return null;let n=e.offset+r;if(n+2>e.buffer.length){e.bigStrSize=n+2,e.totalChunkSize=e.buffer.length,e.bufferCache.push(e.buffer);return}let i=e.offset;return(e.offset=n+2,!0===e.optionReturnBuffers)?e.buffer.slice(i,n):e.buffer.toString("utf8",i,n);case 43:return h(e);case 42:let a=f(e);return void 0===a?void 0:a<0?null:y(e,Array(a),0);case 58:return!0===e.optionStringNumbers?function(e){let t=e.buffer.length-1;var r=e.offset,n=0,i="";for(45===e.buffer[r]&&(i+="-",r++);r<t;){var a=e.buffer[r++];if(13===a)return e.offset=r+1,0!==n&&(i+=n),i;n>0x19999998?(i+=10*n+(a-48),n=0):48===a&&0===n?i+=0:n=10*n+(a-48)}}(e):function(e){let t=e.buffer.length-1;var r=e.offset,n=0,i=1;for(45===e.buffer[r]&&(i=-1,r++);r<t;){let t=e.buffer[r++];if(13===t)return e.offset=r+1,i*n;n=10*n+(t-48)}}(e);case 45:var l=h(e);if(void 0!==l)return!0===e.optionReturnBuffers&&(l=l.toString()),new s(l);return;default:let u=new o("Protocol error, got "+JSON.stringify(String.fromCharCode(t))+" as reply type byte",JSON.stringify(e.buffer),e.offset);e.buffer=null,e.returnFatalError(u);return}}function _(){if(l.length>51200)if(1===d||p>2*d){let e=Math.floor(l.length/10),t=e<u?u:e;u=0,l=l.slice(t,l.length)}else p++,d--;else clearInterval(c),d=0,p=0,c=null}t.exports=class{constructor(e){if(!e)throw TypeError("Options are mandatory.");if("function"!=typeof e.returnError||"function"!=typeof e.returnReply)throw TypeError("The returnReply and returnError options have to be functions.");this.setReturnBuffers(!!e.returnBuffers),this.setStringNumbers(!!e.stringNumbers),this.returnError=e.returnError,this.returnFatalError=e.returnFatalError||e.returnError,this.returnReply=e.returnReply,this.reset()}reset(){this.offset=0,this.buffer=null,this.bigStrSize=0,this.totalChunkSize=0,this.bufferCache=[],this.arrayCache=[],this.arrayPos=[]}setReturnBuffers(e){if("boolean"!=typeof e)throw TypeError("The returnBuffers argument has to be a boolean");this.optionReturnBuffers=e}setStringNumbers(e){if("boolean"!=typeof e)throw TypeError("The stringNumbers argument has to be a boolean");this.optionStringNumbers=e}execute(e){if(null===this.buffer)this.buffer=e,this.offset=0;else if(0===this.bigStrSize){let t=this.buffer.length,r=t-this.offset,i=n.allocUnsafe(r+e.length);if(this.buffer.copy(i,0,this.offset,t),e.copy(i,r,0,e.length),this.buffer=i,this.offset=0,this.arrayCache.length){let e=g(this);if(void 0===e)return;this.returnReply(e)}}else if(this.totalChunkSize+e.length>=this.bigStrSize){this.bufferCache.push(e);var t=this.optionReturnBuffers?function(e){let t=e.bufferCache,r=e.offset,i=e.bigStrSize-r-2;var a=t.length,s=e.bigStrSize-e.totalChunkSize;if(e.offset=s,s<=2){if(2===a)return t[0].slice(r,t[0].length+s-2);a--,s=t[t.length-2].length+s}l.length<i+u&&(u>0x6f00000&&(u=0x3200000),l=n.allocUnsafe(i*(i>0x4b00000?2:3)+u),u=0,d++,null===c&&(c=setInterval(_,50)));let o=u;t[0].copy(l,o,r,t[0].length),u+=t[0].length-r;for(var p=1;p<a-1;p++)t[p].copy(l,u),u+=t[p].length;return t[p].copy(l,u,0,s-2),u+=s-2,l.slice(o,u)}(this):function(e){let t=e.bufferCache,r=e.offset;var n=t.length,a=e.bigStrSize-e.totalChunkSize;if(e.offset=a,a<=2){if(2===n)return t[0].toString("utf8",r,t[0].length+a-2);n--,a=t[t.length-2].length+a}for(var s=i.write(t[0].slice(r)),o=1;o<n-1;o++)s+=i.write(t[o]);return s+i.end(t[o].slice(0,a-2))}(this);if(this.bigStrSize=0,this.bufferCache=[],this.buffer=e,this.arrayCache.length&&(this.arrayCache[0][this.arrayPos[0]++]=t,void 0===(t=g(this))))return;this.returnReply(t)}else{this.bufferCache.push(e),this.totalChunkSize+=e.length;return}for(;this.offset<this.buffer.length;){let e=this.offset,t=this.buffer[this.offset++],r=b(this,t);if(void 0===r){this.arrayCache.length||this.bufferCache.length||(this.offset=e);return}45===t?this.returnError(r):this.returnReply(r)}this.buffer=null}}},43906,(e,t,r)=>{"use strict";t.exports=e.r(29082)},89611,(e,t,r)=>{"use strict";function n(e){return"unsubscribe"===e?"subscribe":"punsubscribe"===e?"psubscribe":"sunsubscribe"===e?"ssubscribe":e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=class{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}}}add(e,t){this.set[n(e)][t]=!0}del(e,t){delete this.set[n(e)][t]}channels(e){return Object.keys(this.set[n(e)])}isEmpty(){return 0===this.channels("subscribe").length&&0===this.channels("psubscribe").length&&0===this.channels("ssubscribe").length}}},73052,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(30846),i=e.r(26898),a=e.r(43906),s=e.r(89611),o=(0,i.Debug)("dataHandler");r.default=class{constructor(e,t){this.redis=e;let r=new a({stringNumbers:t.stringNumbers,returnBuffers:!0,returnError:e=>{this.returnError(e)},returnFatalError:e=>{this.returnFatalError(e)},returnReply:e=>{this.returnReply(e)}});e.stream.prependListener("data",e=>{r.execute(e)}),e.stream.resume()}returnFatalError(e){e.message+=". Please report this.",this.redis.recoverFromFatalError(e,e,{offlineQueue:!1})}returnError(e){let t=this.shiftCommand(e);if(t){if(e.command={name:t.command.name,args:t.command.args},"ssubscribe"==t.command.name&&e.message.includes("MOVED"))return void this.redis.emit("moved");this.redis.handleReconnection(e,t)}}returnReply(e){if(this.handleMonitorReply(e)||this.handleSubscriberReply(e))return;let t=this.shiftCommand(e);t&&(n.default.checkFlag("ENTER_SUBSCRIBER_MODE",t.command.name)?(this.redis.condition.subscriber=new s.default,this.redis.condition.subscriber.add(t.command.name,e[1].toString()),u(t.command,e[2])||this.redis.commandQueue.unshift(t)):n.default.checkFlag("EXIT_SUBSCRIBER_MODE",t.command.name)?c(t.command,e[2])||this.redis.commandQueue.unshift(t):t.command.resolve(e))}handleSubscriberReply(e){if(!this.redis.condition.subscriber)return!1;let t=Array.isArray(e)?e[0].toString():null;switch(o('receive reply "%s" in subscriber mode',t),t){case"message":this.redis.listeners("message").length>0&&this.redis.emit("message",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("messageBuffer",e[1],e[2]);break;case"pmessage":{let t=e[1].toString();this.redis.listeners("pmessage").length>0&&this.redis.emit("pmessage",t,e[2].toString(),e[3].toString()),this.redis.emit("pmessageBuffer",t,e[2],e[3]);break}case"smessage":this.redis.listeners("smessage").length>0&&this.redis.emit("smessage",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("smessageBuffer",e[1],e[2]);break;case"ssubscribe":case"subscribe":case"psubscribe":{let r=e[1].toString();this.redis.condition.subscriber.add(t,r);let n=this.shiftCommand(e);if(!n)return;u(n.command,e[2])||this.redis.commandQueue.unshift(n);break}case"sunsubscribe":case"unsubscribe":case"punsubscribe":{let r=e[1]?e[1].toString():null;r&&this.redis.condition.subscriber.del(t,r);let n=e[2];0===Number(n)&&(this.redis.condition.subscriber=!1);let i=this.shiftCommand(e);if(!i)return;c(i.command,n)||this.redis.commandQueue.unshift(i);break}default:{let t=this.shiftCommand(e);if(!t)return;t.command.resolve(e)}}return!0}handleMonitorReply(e){if("monitoring"!==this.redis.status)return!1;let t=e.toString();if("OK"===t)return!1;let r=t.indexOf(" "),n=t.slice(0,r),i=t.indexOf('"'),a=t.slice(i+1,-1).split('" "').map(e=>e.replace(/\\"/g,'"')),s=t.slice(r+2,i-2).split(" ");return this.redis.emit("monitor",n,a,s[1],s[0]),!0}shiftCommand(e){let t=this.redis.commandQueue.shift();if(!t){let t=Error("Command queue state error. If you can reproduce this, please report it."+(e instanceof Error?` Last error: ${e.message}`:` Last reply: ${e.toString()}`));return this.redis.emit("error",t),null}return t}};let l=new WeakMap;function u(e,t){let r=l.has(e)?l.get(e):e.args.length;return(r-=1)<=0?(e.resolve(t),l.delete(e),!0):(l.set(e,r),!1)}function c(e,t){let r=l.has(e)?l.get(e):e.args.length;return 0===r?0===Number(t)&&(l.delete(e),e.resolve(t),!0):(r-=1)<=0?(e.resolve(t),!0):(l.set(e,r),!1)}},45247,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.readyHandler=r.errorHandler=r.closeHandler=r.connectHandler=void 0;let n=e.r(63227),i=e.r(30846),a=e.r(88060),s=e.r(26898),o=e.r(73052),l=(0,s.Debug)("connection");function u(e){let t=new n.AbortError("Command aborted due to connection close");return t.command={name:e.name,args:e.args},t}r.connectHandler=function(e){return function(){e.setStatus("connect"),e.resetCommandQueue();let t=!1,{connectionEpoch:n}=e;e.condition.auth&&e.auth(e.condition.auth,function(r){n===e.connectionEpoch&&r&&(-1!==r.message.indexOf("no password is set")?console.warn("[WARN] Redis server does not require a password, but a password was supplied."):-1!==r.message.indexOf("without any password configured for the default user")?console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied"):-1!==r.message.indexOf("wrong number of arguments for 'auth' command")?console.warn("[ERROR] The server returned \"wrong number of arguments for 'auth' command\". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under."):(t=!0,e.recoverFromFatalError(r,r)))}),e.condition.select&&e.select(e.condition.select).catch(t=>{e.silentEmit("error",t)}),e.options.enableReadyCheck||r.readyHandler(e)(),new o.default(e,{stringNumbers:e.options.stringNumbers}),e.options.enableReadyCheck&&e._readyCheck(function(i,a){n===e.connectionEpoch&&(i?t||e.recoverFromFatalError(Error("Ready check failed: "+i.message),i):e.connector.check(a)?r.readyHandler(e)():e.disconnect(!0))})}},r.closeHandler=function(e){return function(){let r=e.status;if(e.setStatus("close"),e.commandQueue.length&&function(e){var t;let r=0;for(let n=0;n<e.length;){let i=null==(t=e.peekAt(n))?void 0:t.command,a=i.pipelineIndex;if((void 0===a||0===a)&&(r=0),void 0!==a&&a!==r++){e.remove(n,1),i.reject(u(i));continue}n++}}(e.commandQueue),e.offlineQueue.length&&function(e){var t;for(let r=0;r<e.length;){let n=null==(t=e.peekAt(r))?void 0:t.command;if("multi"===n.name)break;if("exec"===n.name){e.remove(r,1),n.reject(u(n));break}n.inTransaction?(e.remove(r,1),n.reject(u(n))):r++}}(e.offlineQueue),"ready"===r&&(e.prevCondition||(e.prevCondition=e.condition),e.commandQueue.length&&(e.prevCommandQueue=e.commandQueue)),e.manuallyClosing)return e.manuallyClosing=!1,l("skip reconnecting since the connection is manually closed."),t();if("function"!=typeof e.options.retryStrategy)return l("skip reconnecting because `retryStrategy` is not a function"),t();let n=e.options.retryStrategy(++e.retryAttempts);if("number"!=typeof n)return l("skip reconnecting because `retryStrategy` doesn't return a number"),t();l("reconnect in %sms",n),e.setStatus("reconnecting",n),e.reconnectTimeout=setTimeout(function(){e.reconnectTimeout=null,e.connect().catch(s.noop)},n);let{maxRetriesPerRequest:i}=e.options;"number"==typeof i&&(i<0?l("maxRetriesPerRequest is negative, ignoring..."):0==e.retryAttempts%(i+1)&&(l("reach maxRetriesPerRequest limitation, flushing command queue..."),e.flushQueue(new a.MaxRetriesPerRequestError(i))))};function t(){e.setStatus("end"),e.flushQueue(Error(s.CONNECTION_CLOSED_ERROR_MSG))}},r.errorHandler=function(e){return function(t){l("error: %s",t),e.silentEmit("error",t)}},r.readyHandler=function(e){return function(){var t,r;if(e.setStatus("ready"),e.retryAttempts=0,e.options.monitor){e.call("monitor").then(()=>e.setStatus("monitoring"),t=>e.emit("error",t));let{sendCommand:t}=e;e.sendCommand=function(r){return i.default.checkFlag("VALID_IN_MONITOR_MODE",r.name)?t.call(e,r):(r.reject(Error("Connection is in monitoring mode, can't process commands.")),r.promise)},e.once("close",function(){delete e.sendCommand});return}let n=e.prevCondition?e.prevCondition.select:e.condition.select;if(e.options.connectionName&&(l("set the connection name [%s]",e.options.connectionName),e.client("setname",e.options.connectionName).catch(s.noop)),!(null==(t=e.options)?void 0:t.disableClientInfo)){l("set the client info");let t=null;(0,s.getPackageMeta)().then(e=>{t=null==e?void 0:e.version}).catch(s.noop).finally(()=>{e.client("SETINFO","LIB-VER",t).catch(s.noop)}),e.client("SETINFO","LIB-NAME",(null==(r=e.options)?void 0:r.clientInfoTag)?`ioredis(${e.options.clientInfoTag})`:"ioredis").catch(s.noop)}if(e.options.readOnly&&(l("set the connection to readonly mode"),e.readonly().catch(s.noop)),e.prevCondition){let t=e.prevCondition;if(e.prevCondition=null,t.subscriber&&e.options.autoResubscribe){e.condition.select!==n&&(l("connect to db [%d]",n),e.select(n));let r=t.subscriber.channels("subscribe");r.length&&(l("subscribe %d channels",r.length),e.subscribe(r));let i=t.subscriber.channels("psubscribe");i.length&&(l("psubscribe %d channels",i.length),e.psubscribe(i));let a=t.subscriber.channels("ssubscribe");if(a.length)for(let t of(l("ssubscribe %s",a.length),a))e.ssubscribe(t)}}if(e.prevCommandQueue)if(e.options.autoResendUnfulfilledCommands)for(l("resend %d unfulfilled commands",e.prevCommandQueue.length);e.prevCommandQueue.length>0;){let t=e.prevCommandQueue.shift();t.select!==e.condition.select&&"select"!==t.command.name&&e.select(t.select),e.sendCommand(t.command,t.stream)}else e.prevCommandQueue=null;if(e.offlineQueue.length){l("send %d commands in offline queue",e.offlineQueue.length);let t=e.offlineQueue;for(e.resetOfflineQueue();t.length>0;){let r=t.shift();r.select!==e.condition.select&&"select"!==r.command.name&&e.select(r.select),e.sendCommand(r.command,r.stream)}}e.condition.select!==n&&(l("connect to db [%d]",n),e.select(n))}}},77143,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_REDIS_OPTIONS=void 0,r.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:4,connectTimeout:1e4,disconnectTimeout:2e3,retryStrategy:function(e){return Math.min(50*e,2e3)},keepAlive:0,noDelay:!0,connectionName:null,disableClientInfo:!1,clientInfoTag:void 0,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function(e){return Math.min(10*e,1e3)},sentinelReconnectStrategy:function(){return 6e4},natMap:null,enableTLSForSentinelMode:!1,updateSentinels:!0,failoverDetector:!1,username:null,password:null,db:0,enableOfflineQueue:!0,enableReadyCheck:!0,autoResubscribe:!0,autoResendUnfulfilledCommands:!0,lazyConnect:!1,keyPrefix:"",reconnectOnError:null,readOnly:!1,stringNumbers:!1,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10}},66735,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(12522),i=e.r(27699),a=e.r(19335),s=e.r(83252),o=e.r(30846),l=e.r(18652),u=e.r(77420),c=e.r(45247),d=e.r(77143),p=e.r(12749),h=e.r(19212),f=e.r(26898),m=e.r(57674),g=e.r(67061),y=e.r(57517),b=e.r(89977),_=(0,f.Debug)("redis");class v extends g.default{constructor(e,t,r){if(super(),this.status="wait",this.isCluster=!1,this.reconnectTimeout=null,this.connectionEpoch=0,this.retryAttempts=0,this.manuallyClosing=!1,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this.parseOptions(e,t,r),i.EventEmitter.call(this),this.resetCommandQueue(),this.resetOfflineQueue(),this.options.Connector)this.connector=new this.options.Connector(this.options);else if(this.options.sentinels){let e=new u.default(this.options);e.emitter=this,this.connector=e}else this.connector=new l.StandaloneConnector(this.options);this.options.scripts&&Object.entries(this.options.scripts).forEach(([e,t])=>{this.defineCommand(e,t)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(y.noop)}static createClient(...e){return new v(...e)}get autoPipelineQueueSize(){let e=0;for(let t of this._autoPipelines.values())e+=t.length;return e}connect(e){let t=new Promise((e,t)=>{if("connecting"===this.status||"connect"===this.status||"ready"===this.status)return void t(Error("Redis is already connecting/connected"));this.connectionEpoch+=1,this.setStatus("connecting");let{options:r}=this;this.condition={select:r.db,auth:r.username?[r.username,r.password]:r.password,subscriber:!1};let n=this;(0,a.default)(this.connector.connect(function(e,t){n.silentEmit(e,t)}),function(i,a){if(i){n.flushQueue(i),n.silentEmit("error",i),t(i),n.setStatus("end");return}let s=r.tls?"secureConnect":"connect";if("sentinels"in r&&r.sentinels&&!r.enableTLSForSentinelMode&&(s="connect"),n.stream=a,r.noDelay&&a.setNoDelay(!0),"number"==typeof r.keepAlive&&(a.connecting?a.once(s,()=>{a.setKeepAlive(!0,r.keepAlive)}):a.setKeepAlive(!0,r.keepAlive)),a.connecting){if(a.once(s,c.connectHandler(n)),r.connectTimeout){let e=!1;a.setTimeout(r.connectTimeout,function(){if(e)return;a.setTimeout(0),a.destroy();let t=Error("connect ETIMEDOUT");t.errorno="ETIMEDOUT",t.code="ETIMEDOUT",t.syscall="connect",c.errorHandler(n)(t)}),a.once(s,function(){e=!0,a.setTimeout(0)})}}else if(a.destroyed){let e=n.connector.firstError;e&&process.nextTick(()=>{c.errorHandler(n)(e)}),process.nextTick(c.closeHandler(n))}else process.nextTick(c.connectHandler(n));a.destroyed||(a.once("error",c.errorHandler(n)),a.once("close",c.closeHandler(n)));let o=function(){n.removeListener("close",l),e()};var l=function(){n.removeListener("ready",o),t(Error(f.CONNECTION_CLOSED_ERROR_MSG))};n.once("ready",o),n.once("close",l)})});return(0,a.default)(t,e)}disconnect(e=!1){e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),"wait"===this.status?c.closeHandler(this)():this.connector.disconnect()}end(){this.disconnect()}duplicate(e){return new v({...this.options,...e})}get mode(){var e;return this.options.monitor?"monitor":(null==(e=this.condition)?void 0:e.subscriber)?"subscriber":"normal"}monitor(e){let t=this.duplicate({monitor:!0,lazyConnect:!1});return(0,a.default)(new Promise(function(e,r){t.once("error",r),t.once("monitoring",function(){e(t)})}),e)}sendCommand(e,t){var r,i;if("wait"===this.status&&this.connect().catch(y.noop),"end"===this.status)return e.reject(Error(f.CONNECTION_CLOSED_ERROR_MSG)),e.promise;if((null==(r=this.condition)?void 0:r.subscriber)&&!o.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",e.name))return e.reject(Error("Connection in subscriber mode, only subscriber commands may be used")),e.promise;"number"==typeof this.options.commandTimeout&&e.setTimeout(this.options.commandTimeout);let a="ready"===this.status||!t&&"connect"===this.status&&(0,n.exists)(e.name)&&(0,n.hasFlag)(e.name,"loading");if(this.stream&&this.stream.writable?this.stream._writableState&&this.stream._writableState.ended&&(a=!1):a=!1,a)_.enabled&&_("write command[%s]: %d -> %s(%o)",this._getDescription(),null==(i=this.condition)?void 0:i.select,e.name,e.args),t?"isPipeline"in t&&t.isPipeline?t.write(e.toWritable(t.destination.redis.stream)):t.write(e.toWritable(t)):this.stream.write(e.toWritable(this.stream)),this.commandQueue.push({command:e,stream:t,select:this.condition.select}),o.default.checkFlag("WILL_DISCONNECT",e.name)&&(this.manuallyClosing=!0),void 0!==this.options.socketTimeout&&void 0===this.socketTimeoutTimer&&this.setSocketTimeout();else{if(!this.options.enableOfflineQueue)return e.reject(Error("Stream isn't writeable and enableOfflineQueue options is false")),e.promise;if("quit"===e.name&&0===this.offlineQueue.length)return this.disconnect(),e.resolve(Buffer.from("OK")),e.promise;_.enabled&&_("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,e.name,e.args),this.offlineQueue.push({command:e,stream:t,select:this.condition.select})}if("select"===e.name&&(0,f.isInt)(e.args[0])){let t=parseInt(e.args[0],10);this.condition.select!==t&&(this.condition.select=t,this.emit("select",t),_("switch to db [%d]",this.condition.select))}return e.promise}setSocketTimeout(){this.socketTimeoutTimer=setTimeout(()=>{this.stream.destroy(Error(`Socket timeout. Expecting data, but didn't receive any in ${this.options.socketTimeout}ms.`)),this.socketTimeoutTimer=void 0},this.options.socketTimeout),this.stream.once("data",()=>{clearTimeout(this.socketTimeoutTimer),this.socketTimeoutTimer=void 0,0!==this.commandQueue.length&&this.setSocketTimeout()})}scanStream(e){return this.createScanStream("scan",{options:e})}scanBufferStream(e){return this.createScanStream("scanBuffer",{options:e})}sscanStream(e,t){return this.createScanStream("sscan",{key:e,options:t})}sscanBufferStream(e,t){return this.createScanStream("sscanBuffer",{key:e,options:t})}hscanStream(e,t){return this.createScanStream("hscan",{key:e,options:t})}hscanBufferStream(e,t){return this.createScanStream("hscanBuffer",{key:e,options:t})}zscanStream(e,t){return this.createScanStream("zscan",{key:e,options:t})}zscanBufferStream(e,t){return this.createScanStream("zscanBuffer",{key:e,options:t})}silentEmit(e,t){let r;if("error"!==e||(r=t,"end"!==this.status&&(!this.manuallyClosing||!(r instanceof Error)||r.message!==f.CONNECTION_CLOSED_ERROR_MSG&&"connect"!==r.syscall&&"read"!==r.syscall)))return this.listeners(e).length>0?this.emit.apply(this,arguments):(r&&r instanceof Error&&console.error("[ioredis] Unhandled error event:",r.stack),!1)}recoverFromFatalError(e,t,r){this.flushQueue(t,r),this.silentEmit("error",t),this.disconnect(!0)}handleReconnection(e,t){var r;let n=!1;switch(this.options.reconnectOnError&&(n=this.options.reconnectOnError(e)),n){case 1:case!0:"reconnecting"!==this.status&&this.disconnect(!0),t.command.reject(e);break;case 2:"reconnecting"!==this.status&&this.disconnect(!0),(null==(r=this.condition)?void 0:r.select)!==t.select&&"select"!==t.command.name&&this.select(t.select),this.sendCommand(t.command);break;default:t.command.reject(e)}}_getDescription(){let e;return e="path"in this.options&&this.options.path?this.options.path:this.stream&&this.stream.remoteAddress&&this.stream.remotePort?this.stream.remoteAddress+":"+this.stream.remotePort:"host"in this.options&&this.options.host?this.options.host+":"+this.options.port:"",this.options.connectionName&&(e+=` (${this.options.connectionName})`),e}resetCommandQueue(){this.commandQueue=new b}resetOfflineQueue(){this.offlineQueue=new b}parseOptions(...e){let t={},r=!1;for(let n=0;n<e.length;++n){let i=e[n];if(null!=i)if("object"==typeof i)(0,y.defaults)(t,i);else if("string"==typeof i)(0,y.defaults)(t,(0,f.parseURL)(i)),i.startsWith("rediss://")&&(r=!0);else if("number"==typeof i)t.port=i;else throw Error("Invalid argument "+i)}r&&(0,y.defaults)(t,{tls:!0}),(0,y.defaults)(t,v.defaultOptions),"string"==typeof t.port&&(t.port=parseInt(t.port,10)),"string"==typeof t.db&&(t.db=parseInt(t.db,10)),this.options=(0,f.resolveTLSProfile)(t)}setStatus(e,t){_.enabled&&_("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",e),this.status=e,process.nextTick(this.emit.bind(this,e,t))}createScanStream(e,{key:t,options:r={}}){return new p.default({objectMode:!0,key:t,redis:this,command:e,...r})}flushQueue(e,t){let r;if((t=(0,y.defaults)({},t,{offlineQueue:!0,commandQueue:!0})).offlineQueue)for(;r=this.offlineQueue.shift();)r.command.reject(e);if(t.commandQueue&&this.commandQueue.length>0)for(this.stream&&this.stream.removeAllListeners("data");r=this.commandQueue.shift();)r.command.reject(e)}_readyCheck(e){let t=this;this.info(function(r,n){if(r)return r.message&&r.message.includes("NOPERM")?(console.warn(`Skipping the ready check because INFO command fails: "${r.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`),e(null,{})):e(r);if("string"!=typeof n)return e(null,n);let i={},a=n.split("\r\n");for(let e=0;e<a.length;++e){let[t,...r]=a[e].split(":"),n=r.join(":");n&&(i[t]=n)}if(i.loading&&"0"!==i.loading){let r=1e3*(i.loading_eta_seconds||1),n=t.options.maxLoadingRetryTime&&t.options.maxLoadingRetryTime<r?t.options.maxLoadingRetryTime:r;_("Redis server still loading, trying again in "+n+"ms"),setTimeout(function(){t._readyCheck(e)},n)}else e(null,i)}).catch(y.noop)}}v.Cluster=s.default,v.Command=o.default,v.defaultOptions=d.DEFAULT_REDIS_OPTIONS,(0,m.default)(v,i.EventEmitter),(0,h.addTransactionSupport)(v.prototype),r.default=v},42512,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.print=r.ReplyError=r.SentinelIterator=r.SentinelConnector=r.AbstractConnector=r.Pipeline=r.ScanStream=r.Command=r.Cluster=r.Redis=r.default=void 0,r=t.exports=e.r(66735).default;var n=e.r(66735);Object.defineProperty(r,"default",{enumerable:!0,get:function(){return n.default}});var i=e.r(66735);Object.defineProperty(r,"Redis",{enumerable:!0,get:function(){return i.default}});var a=e.r(83252);Object.defineProperty(r,"Cluster",{enumerable:!0,get:function(){return a.default}});var s=e.r(30846);Object.defineProperty(r,"Command",{enumerable:!0,get:function(){return s.default}});var o=e.r(12749);Object.defineProperty(r,"ScanStream",{enumerable:!0,get:function(){return o.default}});var l=e.r(6135);Object.defineProperty(r,"Pipeline",{enumerable:!0,get:function(){return l.default}});var u=e.r(58451);Object.defineProperty(r,"AbstractConnector",{enumerable:!0,get:function(){return u.default}});var c=e.r(77420);Object.defineProperty(r,"SentinelConnector",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"SentinelIterator",{enumerable:!0,get:function(){return c.SentinelIterator}}),r.ReplyError=e.r(63227).ReplyError,Object.defineProperty(r,"Promise",{get:()=>(console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used."),Promise),set(e){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.")}}),r.print=function(e,t){e?console.log("Error: "+e):console.log("Reply: "+t)}},93249,(e,t,r)=>{let n;t.exports.__wbg_set_wasm=function(e){n=e};let i=new("undefined"==typeof TextDecoder?(0,t.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});i.decode();let a=null;function s(){return(null===a||0===a.byteLength)&&(a=new Uint8Array(n.memory.buffer)),a}function o(e,t){return e>>>=0,i.decode(s().subarray(e,e+t))}let l=Array(128).fill(void 0);l.push(void 0,null,!0,!1);let u=l.length;function c(e){u===l.length&&l.push(l.length+1);let t=u;return u=l[t],l[t]=e,t}function d(e,t){try{return e.apply(this,t)}catch(e){n.__wbindgen_export_0(c(e))}}function p(e){let t=l[e];return e<132||(l[e]=u,u=e),t}let h=0,f=new("undefined"==typeof TextEncoder?(0,t.require)("util").TextEncoder:TextEncoder)("utf-8"),m="function"==typeof f.encodeInto?function(e,t){return f.encodeInto(e,t)}:function(e,t){let r=f.encode(e);return t.set(r),{read:e.length,written:r.length}};function g(e,t,r){if(void 0===r){let r=f.encode(e),n=t(r.length,1)>>>0;return s().subarray(n,n+r.length).set(r),h=r.length,n}let n=e.length,i=t(n,1)>>>0,a=s(),o=0;for(;o<n;o++){let t=e.charCodeAt(o);if(t>127)break;a[i+o]=t}if(o!==n){0!==o&&(e=e.slice(o)),i=r(i,n,n=o+3*e.length,1)>>>0;let t=m(e,s().subarray(i+o,i+n));o+=t.written,i=r(i,n,o,1)>>>0}return h=o,i}let y=null;function b(){return(null===y||!0===y.buffer.detached||void 0===y.buffer.detached&&y.buffer!==n.memory.buffer)&&(y=new DataView(n.memory.buffer)),y}let _=null;function v(){return(null===_||0===_.byteLength)&&(_=new Uint32Array(n.memory.buffer)),_}function w(e,t){return e>>>=0,v().subarray(e/4,e/4+t)}function O(e,t){return e>>>=0,s().subarray(e/1,e/1+t)}t.exports.get_encoding=function(e,t){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");try{let a=n.__wbindgen_add_to_stack_pointer(-16),s=g(e,n.__wbindgen_export_1,n.__wbindgen_export_2),o=h;n.get_encoding(a,s,o,c(t));var r=b().getInt32(a+0,!0),i=b().getInt32(a+4,!0);if(b().getInt32(a+8,!0))throw p(i);return S.__wrap(r)}finally{n.__wbindgen_add_to_stack_pointer(16)}},t.exports.encoding_for_model=function(e,t){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");try{let a=n.__wbindgen_add_to_stack_pointer(-16),s=g(e,n.__wbindgen_export_1,n.__wbindgen_export_2),o=h;n.encoding_for_model(a,s,o,c(t));var r=b().getInt32(a+0,!0),i=b().getInt32(a+4,!0);if(b().getInt32(a+8,!0))throw p(i);return S.__wrap(r)}finally{n.__wbindgen_add_to_stack_pointer(16)}},t.exports.get_encoding_name_for_model=function(e){let t,r;if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");try{let d=n.__wbindgen_add_to_stack_pointer(-16),f=g(e,n.__wbindgen_export_1,n.__wbindgen_export_2),m=h;n.get_encoding_name_for_model(d,f,m);var i=b().getInt32(d+0,!0),a=b().getInt32(d+4,!0),s=b().getInt32(d+8,!0),l=b().getInt32(d+12,!0),u=i,c=a;if(l)throw u=0,c=0,p(s);return t=u,r=c,o(u,c)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_export_3(t,r,1)}};let P="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>n.__wbg_tiktoken_free(e>>>0,1));class S{constructor(e,t,r){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");let i=g(e,n.__wbindgen_export_1,n.__wbindgen_export_2),a=h,s=g(r,n.__wbindgen_export_1,n.__wbindgen_export_2),o=h,l=n.tiktoken_new(i,a,c(t),s,o);return this.__wbg_ptr=l>>>0,P.register(this,this.__wbg_ptr,this),this}get name(){try{let r,i=n.__wbindgen_add_to_stack_pointer(-16);n.tiktoken_name(i,this.__wbg_ptr);var e=b().getInt32(i+0,!0),t=b().getInt32(i+4,!0);return 0!==e&&(r=o(e,t).slice(),n.__wbindgen_export_3(e,+t,1)),r}finally{n.__wbindgen_add_to_stack_pointer(16)}}static __wrap(e){e>>>=0;let t=Object.create(S.prototype);return t.__wbg_ptr=e,P.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,P.unregister(this),e}free(){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");let e=this.__destroy_into_raw();n.__wbg_tiktoken_free(e,0)}encode(e,t,r){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");try{let l=n.__wbindgen_add_to_stack_pointer(-16),u=g(e,n.__wbindgen_export_1,n.__wbindgen_export_2),d=h;n.tiktoken_encode(l,this.__wbg_ptr,u,d,c(t),c(r));var i=b().getInt32(l+0,!0),a=b().getInt32(l+4,!0),s=b().getInt32(l+8,!0);if(b().getInt32(l+12,!0))throw p(s);var o=w(i,a).slice();return n.__wbindgen_export_3(i,4*a,4),o}finally{n.__wbindgen_add_to_stack_pointer(16)}}encode_ordinary(e){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");try{let a=n.__wbindgen_add_to_stack_pointer(-16),s=g(e,n.__wbindgen_export_1,n.__wbindgen_export_2),o=h;n.tiktoken_encode_ordinary(a,this.__wbg_ptr,s,o);var t=b().getInt32(a+0,!0),r=b().getInt32(a+4,!0),i=w(t,r).slice();return n.__wbindgen_export_3(t,4*r,4),i}finally{n.__wbindgen_add_to_stack_pointer(16)}}encode_with_unstable(e,t,r){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");try{let s=n.__wbindgen_add_to_stack_pointer(-16),o=g(e,n.__wbindgen_export_1,n.__wbindgen_export_2),l=h;n.tiktoken_encode_with_unstable(s,this.__wbg_ptr,o,l,c(t),c(r));var i=b().getInt32(s+0,!0),a=b().getInt32(s+4,!0);if(b().getInt32(s+8,!0))throw p(a);return p(i)}finally{n.__wbindgen_add_to_stack_pointer(16)}}encode_single_token(e){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");let t=function(e,t){let r=t(+e.length,1)>>>0;return s().set(e,r/1),h=e.length,r}(e,n.__wbindgen_export_1),r=h;return n.tiktoken_encode_single_token(this.__wbg_ptr,t,r)>>>0}decode(e){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");try{let a=n.__wbindgen_add_to_stack_pointer(-16),s=function(e,t){let r=t(4*e.length,4)>>>0;return v().set(e,r/4),h=e.length,r}(e,n.__wbindgen_export_1),o=h;n.tiktoken_decode(a,this.__wbg_ptr,s,o);var t=b().getInt32(a+0,!0),r=b().getInt32(a+4,!0),i=O(t,r).slice();return n.__wbindgen_export_3(t,+r,1),i}finally{n.__wbindgen_add_to_stack_pointer(16)}}decode_single_token_bytes(e){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");try{let a=n.__wbindgen_add_to_stack_pointer(-16);n.tiktoken_decode_single_token_bytes(a,this.__wbg_ptr,e);var t=b().getInt32(a+0,!0),r=b().getInt32(a+4,!0),i=O(t,r).slice();return n.__wbindgen_export_3(t,+r,1),i}finally{n.__wbindgen_add_to_stack_pointer(16)}}token_byte_values(){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");return p(n.tiktoken_token_byte_values(this.__wbg_ptr))}}t.exports.Tiktoken=S,t.exports.__wbg_parse_def2e24ef1252aff=function(){return d(function(e,t){return c(JSON.parse(o(e,t)))},arguments)},t.exports.__wbg_stringify_f7ed6987935b4a24=function(){return d(function(e){return c(JSON.stringify(l[e]))},arguments)},t.exports.__wbindgen_error_new=function(e,t){return c(Error(o(e,t)))},t.exports.__wbindgen_is_undefined=function(e){return void 0===l[e]},t.exports.__wbindgen_object_drop_ref=function(e){p(e)},t.exports.__wbindgen_string_get=function(e,t){if(null==n)throw Error("tiktoken: WASM binary has not been propery initialized.");let r=l[t],i="string"==typeof r?r:void 0;var a=null==i?0:g(i,n.__wbindgen_export_1,n.__wbindgen_export_2),s=h;b().setInt32(e+4,s,!0),b().setInt32(e+0,a,!0)},t.exports.__wbindgen_throw=function(e,t){throw Error(o(e,t))}},11867,(e,t,r)=>{let n=e.r(93249),i={};i["./tiktoken_bg.js"]=n;let a=e.r(14747),s=e.r(22734),o="/ROOT/node_modules/tiktoken".split(a.sep).reduce((e,t,r,n)=>{let i=n.slice(0,r+1).join(a.sep)+a.sep;return i.includes("node_modules"+a.sep)||e.unshift(a.join(i,"node_modules","tiktoken","","./tiktoken_bg.wasm")),e},[]);o.unshift(a.join("/ROOT/node_modules/tiktoken","./tiktoken_bg.wasm"));let l=null;for(let e of o)try{l=s.readFileSync(e);break}catch{}if(null==l)throw Error("Missing tiktoken_bg.wasm");let u=new WebAssembly.Module(l),c=new WebAssembly.Instance(u,i);n.__wbg_set_wasm(c.exports),r.get_encoding=n.get_encoding,r.encoding_for_model=n.encoding_for_model,r.get_encoding_name_for_model=n.get_encoding_name_for_model,r.Tiktoken=n.Tiktoken},85801,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),s=0;s<a.length;s++)"default"!==a[s]&&n(r,t,a[s]);return i(r,t),r}}(),s=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.countTokens=function(t){return s(this,void 0,void 0,function*(){try{let r=yield function(){return s(this,void 0,void 0,function*(){if(null!==o)return o;if(u)return null;u=!0;try{let{encoding_for_model:t}=yield Promise.resolve().then(()=>a(e.r(11867)));return o=t("gpt-4"),l=!0,console.log("[Tokenizer] tiktoken loaded successfully"),o}catch(e){return e instanceof Error&&e.message,console.warn("[Tokenizer] tiktoken not available, using fallback token estimation (1 token â‰ˆ 4 chars)"),l=!1,null}})}();if(r&&l)return r.encode(t).length}catch(e){console.warn("[Tokenizer] Error using tiktoken, falling back to estimation")}return Math.ceil(t.length/4)})},r.freeTiktoken=function(){if(o&&l)try{o.free()}catch(e){}o=null,l=!1},r.isTiktokenAvailable=function(){return l};let o=null,l=!1,u=!1},64876,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})},i=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.MemoryManager=void 0;let a=i(e.r(42512)),s=e.r(85801),o=e.r(79334);r.MemoryManager=class{constructor(e){this.MAX_CONTEXT_TOKENS=parseInt(process.env.MAX_CONTEXT_TOKENS||"30000"),this.SUMMARY_CUSHION_TOKENS=parseInt(process.env.SUMMARY_CUSHION_TOKENS||"2000"),this.REDIS_MESSAGE_LIMIT=100,this.redisUrl=e,this.redis=new a.default(e)}generateConversationId(t){if(t){let r=e.r(54799).createHash("sha256").update(t).digest("hex").substring(0,16);return`conv_${r}`}let r=e.r(54799);return`conv_${r.randomBytes(8).toString("hex")}`}countMessageTokens(e){return n(this,void 0,void 0,function*(){try{let t=yield(0,s.countTokens)(e.role),r=yield(0,s.countTokens)(e.content);return t+r+4}catch(t){return Math.ceil((e.role.length+e.content.length)/4)}})}countMessagesTokens(e){return n(this,void 0,void 0,function*(){let t=0;for(let r of e)t+=yield this.countMessageTokens(r);return t})}getContextForConversation(e){return n(this,void 0,void 0,function*(){let t=yield this.getMessages(e),r=0,n=[];for(let e=t.length-1;e>=0;e--){let i=yield this.countMessageTokens(t[e]);if(r+i<=this.MAX_CONTEXT_TOKENS)n.unshift(t[e]),r+=i;else break}return n})}getContextSummary(e){return n(this,void 0,void 0,function*(){return yield this.getTrailingSummary(e)})}addMessage(e,t){return n(this,void 0,void 0,function*(){let r=`conversations:${e}:messages`;(0,o.getDatabase)().storeMessage({conversationId:e,role:t.role,content:t.content,timestamp:new Date(t.timestamp),metadata:{}}).catch(e=>{console.warn("[Memory] Failed to save message to MongoDB:",e.message)}),yield this.redis.rpush(r,JSON.stringify(t));let n=yield this.redis.llen(r);if(n>this.REDIS_MESSAGE_LIMIT){let t=n-this.REDIS_MESSAGE_LIMIT;yield this.redis.ltrim(r,t,-1),console.log(`[Memory] Trimmed ${t} old messages from Redis cache for ${e}`)}yield this.updateMetadata(e)})}getMessages(e){return n(this,void 0,void 0,function*(){let t=`conversations:${e}:messages`,r=yield this.redis.lrange(t,0,-1);if(r.length>0)return r.map(e=>JSON.parse(e));try{let r=(0,o.getDatabase)(),n=yield r.getLastMessages(e,this.REDIS_MESSAGE_LIMIT);if(n.length>0){let r=this.redis.pipeline();for(let e of n){let n={role:e.role,content:e.content,timestamp:e.timestamp.getTime()};r.rpush(t,JSON.stringify(n))}return yield r.exec(),console.log(`[Memory] Populated Redis cache with ${n.length} messages from MongoDB for ${e}`),n.map(e=>({role:e.role,content:e.content,timestamp:e.timestamp.getTime()}))}}catch(e){console.warn("[Memory] Failed to fetch from MongoDB:",e instanceof Error?e.message:String(e))}return[]})}getAllMessagesFromDB(e){return n(this,void 0,void 0,function*(){let t=(0,o.getDatabase)();return(yield t.getMessages(e)).map(e=>({role:e.role,content:e.content,timestamp:e.timestamp.getTime()}))})}getTrailingSummary(e){return n(this,void 0,void 0,function*(){let t=`conversations:${e}:summary:trailing`;return yield this.redis.get(t)})}setTrailingSummary(e,t){return n(this,void 0,void 0,function*(){let r=`conversations:${e}:summary:trailing`,n=`conversations:${e}:metadata`;yield this.redis.set(r,t),yield this.redis.hset(n,"trailingSummaryGenerated","true"),yield this.redis.hdel(n,"needsTrailingSummaryGeneration"),yield this.redis.hdel(n,"contentToSummarize")})}getExecutiveSummary(e){return n(this,void 0,void 0,function*(){let t=`conversations:${e}:summary:executive`;return yield this.redis.get(t)})}setExecutiveSummary(e,t){return n(this,void 0,void 0,function*(){let r=`conversations:${e}:summary:executive`;yield this.redis.set(r,t),console.log(`[Memory] Updated executive summary for ${e}`)})}getMetadata(e){return n(this,void 0,void 0,function*(){let t=`conversations:${e}:metadata`,r=yield this.redis.hgetall(t);return 0===Object.keys(r).length?null:{conversationId:e,messageCount:parseInt(r.messageCount||"0"),lastUpdated:parseInt(r.lastUpdated||"0"),summaryGenerated:"true"===r.summaryGenerated,totalTokens:r.totalTokens?parseInt(r.totalTokens):void 0,title:r.title||void 0,titleSetByUser:"true"===r.titleSetByUser||void 0}})}updateMetadata(e){return n(this,void 0,void 0,function*(){let t=`conversations:${e}:metadata`,r=yield this.redis.llen(`conversations:${e}:messages`),n=yield this.getMessages(e),i=yield this.countMessagesTokens(n);yield this.redis.hset(t,{messageCount:r.toString(),lastUpdated:Date.now().toString(),totalTokens:i.toString()})})}needsSummarization(e){return n(this,void 0,void 0,function*(){let t=yield this.getMessages(e);return(yield this.countMessagesTokens(t))>this.MAX_CONTEXT_TOKENS+this.SUMMARY_CUSHION_TOKENS})}trimAndSummarize(e){return n(this,void 0,void 0,function*(){let t=yield this.getMessages(e),r=yield this.getTrailingSummary(e),n=0,i=t.length;for(let e=t.length-1;e>=0;e--){let r=yield this.countMessageTokens(t[e]);if(n+r<=this.MAX_CONTEXT_TOKENS)n+=r,i=e;else break}if(0===i)return;let a=t.slice(0,i);if(0===a.length)return;let s=t.slice(i),o=`conversations:${e}:messages`;for(let e of(yield this.redis.del(o),s))yield this.redis.rpush(o,JSON.stringify(e));let l="";r&&(l+=`Previous summary: ${r}

`),l+=a.map(e=>`${e.role.toUpperCase()}: ${e.content}`).join("\n");let u=`conversations:${e}:metadata`;yield this.redis.hset(u,"needsTrailingSummaryGeneration","true"),yield this.redis.hset(u,"contentToSummarize",l),yield this.updateMetadata(e)})}getContentToSummarize(e){return n(this,void 0,void 0,function*(){let t=`conversations:${e}:metadata`;return yield this.redis.hget(t,"contentToSummarize")})}needsSummaryGeneration(e){return n(this,void 0,void 0,function*(){let t=`conversations:${e}:metadata`;return"true"===(yield this.redis.hget(t,"needsTrailingSummaryGeneration"))})}summarizeIfNeeded(e,t){return n(this,void 0,void 0,function*(){try{if(!(yield this.needsSummarization(e)))return!1;let r=yield this.getTokenCount(e);if(console.log(`[Memory] Token limit exceeded for ${e}: ${r} tokens - trimming and summarizing...`),yield this.trimAndSummarize(e),!(yield this.needsSummaryGeneration(e)))return console.log(`[Memory] No summary generation needed for ${e}`),!1;let n=yield this.getContentToSummarize(e);if(!n)return!1;let i=this.buildSummaryPrompt(n),a=yield t(i);yield this.setTrailingSummary(e,a);let s=yield this.getTokenCount(e);return console.log(`[Memory] Summarization complete for ${e}: trimmed to ${s} tokens`),!0}catch(e){return console.error("[Memory] Summarization error:",e),!1}})}generateExecutiveSummary(e,t){return n(this,void 0,void 0,function*(){try{let r=yield this.getMessages(e);if(0===r.length)return;let n=r.map(e=>`${e.role.toUpperCase()}: ${e.content}`).join("\n"),i=`Provide a comprehensive executive summary of the following conversation. Focus on:
- User's goals and preferences
- Key topics discussed
- Important decisions or conclusions
- Context that would be useful for future interactions

Keep it concise but informative (200-400 words). Only respond with the summary itself:

${n}`,a=yield t(i);yield this.setExecutiveSummary(e,a),console.log(`[Memory] Generated executive summary for ${e}`)}catch(e){console.error("[Memory] Executive summary generation error:",e)}})}buildSummaryPrompt(e){return`Summarize the following conversation history concisely. Focus on information about the user, key topics, decisions, and important context. Retain key information from previous summaries if they exist. Only respond with the summary itself. Keep it over 500 but under 1000 words:

${e}`}getTokenCount(e){return n(this,void 0,void 0,function*(){let t=yield this.getMessages(e);return yield this.countMessagesTokens(t)})}getContextTokenCount(e){return n(this,void 0,void 0,function*(){let t=yield this.getContextForConversation(e);return yield this.countMessagesTokens(t)})}deleteConversation(e){return n(this,void 0,void 0,function*(){yield this.redis.del(`conversations:${e}:messages`),yield this.redis.del(`conversations:${e}:summary:trailing`),yield this.redis.del(`conversations:${e}:summary:executive`),yield this.redis.del(`conversations:${e}:metadata`)})}close(){return n(this,void 0,void 0,function*(){(0,s.freeTiktoken)(),yield this.redis.quit()})}}},43601,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})},i=e.e&&e.e.__await||function(e){return this instanceof i?(this.v=e,this):new i(e)},a=e.e&&e.e.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,a=r.apply(e,t||[]),s=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),n[Symbol.asyncIterator]=function(){return this},n;function o(e,t){a[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||l(e,t)})},t&&(n[e]=t(n[e])))}function l(e,t){try{var r;(r=a[e](t)).value instanceof i?Promise.resolve(r.value.v).then(u,c):d(s[0][2],r)}catch(e){d(s[0][3],e)}}function u(e){l("next",e)}function c(e){l("throw",e)}function d(e,t){e(t),s.shift(),s.length&&l(s[0][0],s[0][1])}},s=e.e&&e.e.__asyncValues||function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){var a,s,o;a=n,s=i,o=(t=e[r](t)).done,Promise.resolve(t.value).then(function(e){a({value:e,done:o})},s)})}}};Object.defineProperty(r,"__esModule",{value:!0}),r.MessageQueue=void 0,r.MessageQueue=class{constructor(e){this.STATE_TTL=3600,this.CONTENT_KEY_PREFIX="message:generating:",this.INDEX_KEY_PREFIX="conversation:generating:",this.PUBSUB_PREFIX="message:stream:",this.redis=e}startGeneration(e,t){return n(this,void 0,void 0,function*(){let r={conversationId:e,messageId:t,status:"generating",content:"",startedAt:Date.now()},n=`${this.CONTENT_KEY_PREFIX}${t}`;yield this.redis.setex(n,this.STATE_TTL,JSON.stringify(r)),yield this.redis.sadd(`${this.INDEX_KEY_PREFIX}${e}`,t),yield this.redis.expire(`${this.INDEX_KEY_PREFIX}${e}`,this.STATE_TTL),console.log(`[MessageQueue] Started generation tracking: ${t}`)})}appendContent(e,t){return n(this,void 0,void 0,function*(){let r=`${this.CONTENT_KEY_PREFIX}${e}`,n=yield this.redis.get(r);if(!n)return void console.warn(`[MessageQueue] Cannot append to non-existent message: ${e}`);let i=JSON.parse(n);i.content+=t,yield this.redis.setex(r,this.STATE_TTL,JSON.stringify(i)),yield this.redis.publish(`${this.PUBSUB_PREFIX}${e}`,JSON.stringify({type:"chunk",content:t}))})}completeGeneration(e,t){return n(this,void 0,void 0,function*(){let r=`${this.CONTENT_KEY_PREFIX}${e}`,n=yield this.redis.get(r);if(!n)return void console.warn(`[MessageQueue] Cannot complete non-existent message: ${e}`);let i=JSON.parse(n);i.status="completed",i.completedAt=Date.now(),t&&(i.metadata=t),yield this.redis.setex(r,this.STATE_TTL,JSON.stringify(i)),yield this.redis.srem(`${this.INDEX_KEY_PREFIX}${i.conversationId}`,e),yield this.redis.publish(`${this.PUBSUB_PREFIX}${e}`,JSON.stringify({type:"complete",metadata:t})),console.log(`[MessageQueue] Completed generation: ${e} (${i.content.length} chars)`)})}publishToolStatus(e,t){return n(this,void 0,void 0,function*(){yield this.redis.publish(`${this.PUBSUB_PREFIX}${e}`,JSON.stringify(Object.assign({type:"tool_status"},t))),console.log(`[MessageQueue] Published tool status for ${e}: ${t.status}`)})}publishThinking(e,t){return n(this,void 0,void 0,function*(){yield this.redis.publish(`${this.PUBSUB_PREFIX}${e}`,JSON.stringify({type:"thinking",content:t})),console.log(`[MessageQueue] Published thinking for ${e} (${t.length} chars)`)})}failGeneration(e,t){return n(this,void 0,void 0,function*(){let r=`${this.CONTENT_KEY_PREFIX}${e}`,n=yield this.redis.get(r);if(!n)return void console.warn(`[MessageQueue] Cannot fail non-existent message: ${e}`);let i=JSON.parse(n);i.status="error",i.error=t,i.completedAt=Date.now(),yield this.redis.setex(r,this.STATE_TTL,JSON.stringify(i)),yield this.redis.srem(`${this.INDEX_KEY_PREFIX}${i.conversationId}`,e),yield this.redis.publish(`${this.PUBSUB_PREFIX}${e}`,JSON.stringify({type:"error",error:t})),console.error(`[MessageQueue] Failed generation: ${e} - ${t}`)})}getMessageState(e){return n(this,void 0,void 0,function*(){let t=`${this.CONTENT_KEY_PREFIX}${e}`,r=yield this.redis.get(t);return r?JSON.parse(r):null})}getGeneratingMessages(e){return n(this,void 0,void 0,function*(){let t=yield this.redis.smembers(`${this.INDEX_KEY_PREFIX}${e}`);if(0===t.length)return[];let r=[];for(let e of t){let t=yield this.getMessageState(e);t&&r.push(t)}return r})}cleanupMessage(e){return n(this,void 0,void 0,function*(){let t=`${this.CONTENT_KEY_PREFIX}${e}`;yield this.redis.del(t)})}subscribeToMessage(e){return a(this,arguments,function*(){var t,r,o,l;let u=yield i(this.getMessageState(e));if(!u)throw Error(`Message ${e} not found`);if(u.content&&(yield yield i({type:"init",existingContent:u.content})),"completed"===u.status)return yield yield i({type:"complete",metadata:u.metadata}),yield i(void 0);if("error"===u.status)return yield yield i({type:"error",error:u.error}),yield i(void 0);let c=this.redis.duplicate();c.setMaxListeners(50);let d=`${this.PUBSUB_PREFIX}${e}`,p=this.getMessageState.bind(this),h=!1,f=()=>n(this,void 0,void 0,function*(){if(!h){h=!0;try{yield c.unsubscribe(d),yield c.quit(),console.log(`[MessageQueue] Cleaned up subscriber for ${e}`)}catch(e){}}});try{yield i(c.subscribe(d));let n=function(t){return a(this,arguments,function*(){for(;;){let r=yield i(new Promise(e=>{t.once("message",(t,r)=>{t===d&&e(r)}),setTimeout(()=>e(null),3e4)}));if(null===r){let t=yield i(p(e));if(!t||"generating"!==t.status)break;continue}yield yield i(r)}})}(c);try{for(var m,g=!0,y=s(n);!(t=(m=yield i(y.next())).done);g=!0){l=m.value,g=!1;let e=JSON.parse(l);if("chunk"===e.type)yield yield i({type:"chunk",content:e.content});else if("thinking"===e.type)yield yield i({type:"thinking",content:e.content});else if("complete"===e.type){yield yield i({type:"complete",metadata:e.metadata});break}else if("error"===e.type){yield yield i({type:"error",error:e.error});break}}}catch(e){r={error:e}}finally{try{!g&&!t&&(o=y.return)&&(yield i(o.call(y)))}finally{if(r)throw r.error}}}finally{yield i(f())}})}}},59297,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TTL=r.RedisKeys=void 0,r.RedisKeys={log:e=>`log:${e}`,generationLogs:e=>`generation:${e}:logs`,conversationLogs:e=>`conversation:${e}:logs`,generation:e=>`generation:${e}`,conversationGeneration:e=>`conversation:${e}:generation`,logChannel:e=>`logs:generation:${e}`,conversationLogChannel:e=>`logs:conversation:${e}`,allLogsChannel:"logs:all"},r.TTL={LOG:2592e3,GENERATION:2592e3,LOG_LIST:2592e3}},65207,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})},i=e.e&&e.e.__await||function(e){return this instanceof i?(this.v=e,this):new i(e)},a=e.e&&e.e.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,a=r.apply(e,t||[]),s=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),n[Symbol.asyncIterator]=function(){return this},n;function o(e,t){a[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||l(e,t)})},t&&(n[e]=t(n[e])))}function l(e,t){try{var r;(r=a[e](t)).value instanceof i?Promise.resolve(r.value.v).then(u,c):d(s[0][2],r)}catch(e){d(s[0][3],e)}}function u(e){l("next",e)}function c(e){l("throw",e)}function d(e,t){e(t),s.shift(),s.length&&l(s[0][0],s[0][1])}};Object.defineProperty(r,"__esModule",{value:!0}),r.Logger=void 0;let s=e.r(59297);r.Logger=class{constructor(e){this.redis=e,this.redis.setMaxListeners(100)}generateGenerationId(){let e=Date.now(),t=Math.random().toString(36).substring(2,11);return`gen_${e}_${t}`}generateLogId(){return`log_${Date.now()}_${Math.random().toString(36).substring(2,11)}`}startGeneration(e,t){return n(this,void 0,void 0,function*(){let r=t||this.generateGenerationId(),n=s.RedisKeys.conversationGeneration(e),i=yield this.redis.get(n);if(i){let e=JSON.parse(i);if(e.currentGenerationId){let t=s.RedisKeys.generation(e.currentGenerationId),r=yield this.redis.get(t);if(r){let t=JSON.parse(r);if("generating"===t.status){let r=Date.now()-t.startedAt;if(!(r>3e5))return console.log(`[Logger] Generation already in progress: ${e.currentGenerationId} (age: ${Math.round(r/1e3)}s)`),null;console.log(`[Logger] Cleaning up stale generation: ${e.currentGenerationId} (age: ${Math.round(r/1e3)}s)`),yield this.failGeneration(e.currentGenerationId,"Generation timed out (stale)")}}else console.log(`[Logger] Cleaning up orphaned generation state: ${e.currentGenerationId}`),e.currentGenerationId=void 0,yield this.redis.setex(n,s.TTL.GENERATION,JSON.stringify(e))}}let a={id:r,conversationId:e,status:"generating",startedAt:Date.now()};yield this.redis.setex(s.RedisKeys.generation(r),s.TTL.GENERATION,JSON.stringify(a));let o={conversationId:e,currentGenerationId:r,lastGenerationId:r,generationCount:i?JSON.parse(i).generationCount+1:1};return yield this.redis.setex(n,s.TTL.GENERATION,JSON.stringify(o)),yield this.log({level:"info",category:"generation",message:"<cyan>Generation started</cyan>",generationId:r,conversationId:e}),r})}completeGeneration(e,t){return n(this,void 0,void 0,function*(){let r=s.RedisKeys.generation(e),n=yield this.redis.get(r);if(!n)return void console.warn(`[Logger] Generation not found: ${e}`);let i=JSON.parse(n);i.status="completed",i.completedAt=Date.now(),i.response=t.response,i.thinking=t.thinking,i.route=t.route,i.toolsUsed=t.toolsUsed,i.model=t.model,i.tokens=t.tokens,yield this.redis.setex(r,s.TTL.GENERATION,JSON.stringify(i));let a=s.RedisKeys.conversationGeneration(i.conversationId),o=yield this.redis.get(a);if(o){let t=JSON.parse(o);t.currentGenerationId===e&&(t.currentGenerationId=void 0,yield this.redis.setex(a,s.TTL.GENERATION,JSON.stringify(t)))}let l=i.completedAt-i.startedAt;if(yield this.log({level:"success",category:"generation",message:`<green>Generation completed</green> <dim>(${l}ms)</dim>`,generationId:e,conversationId:i.conversationId,metadata:{duration:l,tokens:t.tokens,route:t.route,toolsUsed:t.toolsUsed}}),t.response&&"string"==typeof t.response){let r=t.response.length>1e4,n=r?t.response.slice(0,1e4):t.response;yield this.log({level:"info",category:"chat",message:n,generationId:e,conversationId:i.conversationId,metadata:{contentLength:t.response.length,truncated:r,model:t.model}})}})}failGeneration(e,t){return n(this,void 0,void 0,function*(){let r=s.RedisKeys.generation(e),n=yield this.redis.get(r);if(!n)return void console.warn(`[Logger] Generation not found: ${e}`);let i=JSON.parse(n);i.status="error",i.completedAt=Date.now(),i.error=t,yield this.redis.setex(r,s.TTL.GENERATION,JSON.stringify(i));let a=s.RedisKeys.conversationGeneration(i.conversationId),o=yield this.redis.get(a);if(o){let t=JSON.parse(o);t.currentGenerationId===e&&(t.currentGenerationId=void 0,yield this.redis.setex(a,s.TTL.GENERATION,JSON.stringify(t)))}yield this.log({level:"error",category:"generation",message:`<red>Generation failed:</red> ${t}`,generationId:e,conversationId:i.conversationId,metadata:{error:t}})})}log(e){return n(this,void 0,void 0,function*(){let t={id:this.generateLogId(),timestamp:Date.now(),level:e.level,category:e.category,message:e.message,generationId:e.generationId,conversationId:e.conversationId,metadata:e.metadata};if(yield this.redis.setex(s.RedisKeys.log(t.id),s.TTL.LOG,JSON.stringify(t)),e.generationId){let r=s.RedisKeys.generationLogs(e.generationId);yield this.redis.rpush(r,t.id),yield this.redis.expire(r,s.TTL.LOG_LIST)}if(e.conversationId){let r=s.RedisKeys.conversationLogs(e.conversationId);yield this.redis.rpush(r,t.id),yield this.redis.expire(r,s.TTL.LOG_LIST)}let r=JSON.stringify(t);e.generationId&&(yield this.redis.publish(s.RedisKeys.logChannel(e.generationId),r)),e.conversationId&&(yield this.redis.publish(s.RedisKeys.conversationLogChannel(e.conversationId),r)),yield this.redis.publish(s.RedisKeys.allLogsChannel,r)})}logThought(e){return n(this,void 0,void 0,function*(){yield this.log({level:"debug",category:"thought",message:`<dim>ðŸ’­ ${e.source} thinking:</dim>
${e.content}`,generationId:e.generationId,conversationId:e.conversationId,metadata:Object.assign({source:e.source},e.metadata)})})}getGenerationLogs(e){return n(this,void 0,void 0,function*(){let t=s.RedisKeys.generationLogs(e),r=yield this.redis.lrange(t,0,-1),n=[];for(let e of r){let t=yield this.redis.get(s.RedisKeys.log(e));t&&n.push(JSON.parse(t))}return n})}getConversationLogs(e,t){return n(this,void 0,void 0,function*(){let r=s.RedisKeys.conversationLogs(e),n=yield this.redis.lrange(r,t?-t:0,-1),i=[];for(let e of n){let t=yield this.redis.get(s.RedisKeys.log(e));t&&i.push(JSON.parse(t))}return i})}getGeneration(e){return n(this,void 0,void 0,function*(){let t=yield this.redis.get(s.RedisKeys.generation(e));return t?JSON.parse(t):null})}getConversationGenerationState(e){return n(this,void 0,void 0,function*(){let t=yield this.redis.get(s.RedisKeys.conversationGeneration(e));return t?JSON.parse(t):null})}subscribeToGeneration(e){return a(this,arguments,function*(){let t=this.redis.duplicate();t.setMaxListeners(100);let r=s.RedisKeys.logChannel(e);try{for(let n of(yield i(t.subscribe(r)),yield i(this.getGenerationLogs(e))))yield yield i(n);for(;;){let n=yield i(new Promise(e=>{t.once("message",(t,n)=>{t===r&&e(n)}),setTimeout(()=>e(null),3e4)}));if(null===n){let t=yield i(this.getGeneration(e));if(!t||"generating"!==t.status)break;continue}let a=JSON.parse(n);if(yield yield i(a),"generation"===a.category&&(a.message.includes("completed")||a.message.includes("failed")))break}}finally{yield i(t.unsubscribe(r)),yield i(t.quit())}})}subscribeToConversation(e){return a(this,arguments,function*(){let t=this.redis.duplicate();t.setMaxListeners(100);let r=s.RedisKeys.conversationLogChannel(e);try{for(yield i(t.subscribe(r));;){let e=yield i(new Promise(e=>{t.once("message",(t,n)=>{t===r&&e(n)}),setTimeout(()=>e(null),6e4)}));if(null===e)continue;let n=JSON.parse(e);yield yield i(n)}}finally{yield i(t.unsubscribe(r)),yield i(t.quit())}})}}},80088,(e,t,r)=>{"use strict";function n(e){if(void 0===e)return null;try{return JSON.parse(e)}catch(e){}let t="",r=[],n=!1,i=!1;for(let a of e){if(n)'"'!==a||i?"\n"!==a||i?i="\\"===a&&!i:a="\\n":n=!1;else if('"'===a)n=!0,i=!1;else if("{"===a)r.push("}");else if("["===a)r.push("]");else if("}"===a||"]"===a)if(!r||r[r.length-1]!==a)return null;else r.pop();t+=a}n&&(t+='"');for(let e=r.length-1;e>=0;e-=1)t+=r[e];try{return JSON.parse(t)}catch(e){return null}}Object.defineProperty(r,"__esModule",{value:!0}),r.parseJsonMarkdown=function(e,t=n){let r=(e=e.trim()).indexOf("```");if(-1===r)return t(e);let i=e.substring(r+3);i.startsWith("json\n")?i=i.substring(5):i.startsWith("json")?i=i.substring(4):i.startsWith("\n")&&(i=i.substring(1));let a=i.indexOf("```"),s=i;return -1!==a&&(s=i.substring(0,a)),t(s.trim())},r.parsePartialJson=n},83285,(e,t,r)=>{"use strict";t.exports=function(e,t){if("string"!=typeof e)throw TypeError("Expected a string");return t=void 0===t?"_":t,e.replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+t+"$2").toLowerCase()}},94380,(e,t,r)=>{"use strict";let n=/[\p{Lu}]/u,i=/[\p{Ll}]/u,a=/^[\p{Lu}](?![\p{Lu}])/gu,s=/([\p{Alpha}\p{N}_]|$)/u,o=/[_.\- ]+/,l=RegExp("^"+o.source),u=RegExp(o.source+s.source,"gu"),c=RegExp("\\d+"+s.source,"gu"),d=(e,t)=>{if(!("string"==typeof e||Array.isArray(e)))throw TypeError("Expected the input to be `string | string[]`");if(t={pascalCase:!1,preserveConsecutiveUppercase:!1,...t},0===(e=Array.isArray(e)?e.map(e=>e.trim()).filter(e=>e.length).join("-"):e.trim()).length)return"";let r=!1===t.locale?e=>e.toLowerCase():e=>e.toLocaleLowerCase(t.locale),s=!1===t.locale?e=>e.toUpperCase():e=>e.toLocaleUpperCase(t.locale);if(1===e.length)return t.pascalCase?s(e):r(e);if(e!==r(e)&&(e=((e,t,r)=>{let a=!1,s=!1,o=!1;for(let l=0;l<e.length;l++){let u=e[l];a&&n.test(u)?(e=e.slice(0,l)+"-"+e.slice(l),a=!1,o=s,s=!0,l++):s&&o&&i.test(u)?(e=e.slice(0,l-1)+"-"+e.slice(l-1),o=s,s=!1,a=!0):(a=t(u)===u&&r(u)!==u,o=s,s=r(u)===u&&t(u)!==u)}return e})(e,r,s)),e=e.replace(l,""),t.preserveConsecutiveUppercase){var o;o=e,a.lastIndex=0,e=o.replace(a,e=>r(e))}else e=r(e);return t.pascalCase&&(e=s(e.charAt(0))+e.slice(1)),((e,t)=>(u.lastIndex=0,c.lastIndex=0,e.replace(u,(e,r)=>t(r)).replace(c,e=>t(e))))(e,s)};t.exports=d,t.exports.default=d},97767,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.keyToJson=function(e,t){return t?.[e]||(0,i.default)(e)},r.keyFromJson=function(e,t){return t?.[e]||(0,a.default)(e)},r.mapKeys=function(e,t,r){let n={};for(let i in e)Object.hasOwn(e,i)&&(n[t(i,r)]=e[i]);return n};let i=n(e.r(83285)),a=n(e.r(94380))},46893,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Serializable=void 0,r.get_lc_unique_name=a;let n=e.r(97767);function i(e){return Array.isArray(e)?[...e]:{...e}}function a(e){let t=Object.getPrototypeOf(e);return"function"==typeof e.lc_name&&("function"!=typeof t.lc_name||e.lc_name()!==t.lc_name())?e.lc_name():e.name}class s{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,a(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),void 0!==this.lc_serializable_keys?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([e])=>this.lc_serializable_keys?.includes(e))):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable||this.lc_kwargs instanceof s||"object"!=typeof this.lc_kwargs||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();let e={},t={},r=Object.keys(this.lc_kwargs).reduce((e,t)=>(e[t]=t in this?this[t]:this.lc_kwargs[t],e),{});for(let n=Object.getPrototypeOf(this);n;n=Object.getPrototypeOf(n))Object.assign(e,Reflect.get(n,"lc_aliases",this)),Object.assign(t,Reflect.get(n,"lc_secrets",this)),Object.assign(r,Reflect.get(n,"lc_attributes",this));return Object.keys(t).forEach(e=>{let t=this,n=r,[i,...a]=e.split(".").reverse();for(let e of a.reverse()){if(!(e in t)||void 0===t[e])return;e in n&&void 0!==n[e]||("object"==typeof t[e]&&null!=t[e]?n[e]={}:Array.isArray(t[e])&&(n[e]=[])),t=t[e],n=n[e]}i in t&&void 0!==t[i]&&(n[i]=n[i]||t[i])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:(0,n.mapKeys)(Object.keys(t).length?function(e,t){let r=i(e);for(let[e,n]of Object.entries(t)){let[t,...a]=e.split(".").reverse(),s=r;for(let e of a.reverse()){if(void 0===s[e])break;s[e]=i(s[e]),s=s[e]}void 0!==s[t]&&(s[t]={lc:1,type:"secret",id:[n]})}return r}(r,t):r,n.keyToJson,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}r.Serializable=s},26065,(e,t,r)=>{"use strict";function n(e){return"object"==typeof e&&null!==e&&"type"in e&&"string"==typeof e.type&&"source_type"in e&&("url"===e.source_type||"base64"===e.source_type||"text"===e.source_type||"id"===e.source_type)}Object.defineProperty(r,"__esModule",{value:!0}),r.isDataContentBlock=n,r.isURLContentBlock=function(e){return n(e)&&"url"===e.source_type&&"url"in e&&"string"==typeof e.url},r.isBase64ContentBlock=function(e){return n(e)&&"base64"===e.source_type&&"data"in e&&"string"==typeof e.data},r.isPlainTextContentBlock=function(e){return n(e)&&"text"===e.source_type&&"text"in e&&"string"==typeof e.text},r.isIDContentBlock=function(e){return n(e)&&"id"===e.source_type&&"id"in e&&"string"==typeof e.id},r.convertToOpenAIImageBlock=function(e){if(n(e)){if("url"===e.source_type)return{type:"image_url",image_url:{url:e.url}};if("base64"===e.source_type){if(!e.mime_type)throw Error("mime_type key is required for base64 data.");let t=e.mime_type;return{type:"image_url",image_url:{url:`data:${t};base64,${e.data}`}}}}throw Error("Unsupported source type. Only 'url' and 'base64' are supported.")},r.parseMimeType=function(e){let t=e.split(";")[0].split("/");if(2!==t.length)throw Error(`Invalid mime type: "${e}" - does not match type/subtype format.`);let r=t[0].trim(),n=t[1].trim();if(""===r||""===n)throw Error(`Invalid mime type: "${e}" - type or subtype is empty.`);let i={};for(let t of e.split(";").slice(1)){let r=t.split("=");if(2!==r.length)throw Error(`Invalid parameter syntax in mime type: "${e}".`);let n=r[0].trim(),a=r[1].trim();if(""===n)throw Error(`Invalid parameter syntax in mime type: "${e}".`);i[n]=a}return{type:r,subtype:n,parameters:i}},r.parseBase64DataUrl=function({dataUrl:e,asTypedArray:t=!1}){let r=e.match(/^data:(\w+\/\w+);base64,([A-Za-z0-9+/]+=*)$/);if(r)return{mime_type:r[1].toLowerCase(),data:t?Uint8Array.from(atob(r[2]),e=>e.charCodeAt(0)):r[2]}},r.convertToProviderContentBlock=function(e,t){if("text"===e.type){if(!t.fromStandardTextBlock)throw Error(`Converter for ${t.providerName} does not implement \`fromStandardTextBlock\` method.`);return t.fromStandardTextBlock(e)}if("image"===e.type){if(!t.fromStandardImageBlock)throw Error(`Converter for ${t.providerName} does not implement \`fromStandardImageBlock\` method.`);return t.fromStandardImageBlock(e)}if("audio"===e.type){if(!t.fromStandardAudioBlock)throw Error(`Converter for ${t.providerName} does not implement \`fromStandardAudioBlock\` method.`);return t.fromStandardAudioBlock(e)}if("file"===e.type){if(!t.fromStandardFileBlock)throw Error(`Converter for ${t.providerName} does not implement \`fromStandardFileBlock\` method.`);return t.fromStandardFileBlock(e)}throw Error(`Unable to convert content block type '${e.type}' to provider-specific format: not recognized.`)}},98508,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseMessageChunk=r.BaseMessage=void 0,r.mergeContent=function(e,t){return"string"==typeof e?""===e?t:"string"==typeof t?e+t:Array.isArray(t)&&t.some(e=>(0,i.isDataContentBlock)(e))?[{type:"text",source_type:"text",text:e},...t]:[{type:"text",text:e},...t]:Array.isArray(t)?o(e,t)??[...e,...t]:""===t?e:Array.isArray(e)&&e.some(e=>(0,i.isDataContentBlock)(e))?[...e,{type:"file",source_type:"text",text:t}]:[...e,{type:"text",text:t}]},r._mergeStatus=function(e,t){return"error"===e||"error"===t?"error":"success"},r.isOpenAIToolCallArray=function(e){return Array.isArray(e)&&e.every(e=>"number"==typeof e.index)},r._mergeDicts=s,r._mergeLists=o,r._mergeObj=function(e,t){if(!e&&!t)throw Error("Cannot merge two undefined objects.");if(!e||!t)return e||t;if(typeof e!=typeof t)throw Error(`Cannot merge objects of different types.
Left ${typeof e}
Right ${typeof t}`);if("string"==typeof e&&"string"==typeof t)return e+t;if(Array.isArray(e)&&Array.isArray(t))return o(e,t);if("object"==typeof e&&"object"==typeof t)return s(e,t);else if(e===t)return e;else throw Error(`Can not merge objects of different types.
Left ${e}
Right ${t}`)},r._isMessageFieldWithRole=function(e){return"string"==typeof e.role},r.isBaseMessage=l,r.isBaseMessageChunk=function(e){return l(e)&&"function"==typeof e.concat};let n=e.r(46893),i=e.r(26065);class a extends n.Serializable{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return"string"==typeof this.content?this.content:Array.isArray(this.content)?this.content.map(e=>"string"==typeof e?e:"text"===e.type?e.text:"").join(""):""}getType(){return this._getType()}constructor(e,t){"string"==typeof e&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){var t,r;if(null===e)return this;let n=(t=this._printableFields,r=Math.max(4,e),JSON.stringify(function e(t,n){if("object"!=typeof t||null==t)return t;if(n>=r)return Array.isArray(t)?"[Array]":"[Object]";if(Array.isArray(t))return t.map(t=>e(t,n+1));let i={};for(let r of Object.keys(t))i[r]=e(t[r],n+1);return i}(t,0),null,2));return`${this.constructor.lc_name()} ${n}`}}function s(e,t){let r={...e};for(let[e,n]of Object.entries(t))if(null==r[e])r[e]=n;else if(null==n)continue;else if(typeof r[e]!=typeof n||Array.isArray(r[e])!==Array.isArray(n))throw Error(`field[${e}] already exists in the message chunk, but with a different type.`);else if("string"==typeof r[e])if("type"===e)continue;else["id","name","output_version","model_provider"].includes(e)?r[e]=n:r[e]+=n;else if("object"!=typeof r[e]||Array.isArray(r[e]))if(Array.isArray(r[e]))r[e]=o(r[e],n);else{if(r[e]===n)continue;console.warn(`field[${e}] already exists in this message chunk and value has unsupported type.`)}else r[e]=s(r[e],n);return r}function o(e,t){if(void 0!==e||void 0!==t){if(void 0===e||void 0===t)return e||t;let r=[...e];for(let e of t)if("object"==typeof e&&null!==e&&"index"in e&&"number"==typeof e.index){let t=r.findIndex(t=>{let r="object"==typeof t,n="index"in t&&t.index===e.index,i="id"in t&&"id"in e&&t?.id===e?.id,a=!("id"in t)||!t?.id||!("id"in e)||!e?.id;return r&&n&&(i||a)});-1!==t&&"object"==typeof r[t]&&null!==r[t]?r[t]=s(r[t],e):r.push(e)}else{if("object"==typeof e&&null!==e&&"text"in e&&""===e.text)continue;r.push(e)}return r}}function l(e){return"function"==typeof e?._getType}r.BaseMessage=a,r.BaseMessageChunk=class extends a{}},85257,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ToolMessageChunk=r.ToolMessage=void 0,r.isDirectToolOutput=function(e){return null!=e&&"object"==typeof e&&"lc_direct_tool_output"in e&&!0===e.lc_direct_tool_output},r.defaultToolCallParser=function(e){let t=[],r=[];for(let n of e)if(!n.function)continue;else{let e=n.function.name;try{let r=JSON.parse(n.function.arguments),i={name:e||"",args:r||{},id:n.id};t.push(i)}catch(t){r.push({name:e,args:n.function.arguments,id:n.id,error:"Malformed args."})}}return[t,r]},r.isToolMessage=function(e){return"tool"===e._getType()},r.isToolMessageChunk=function(e){return"tool"===e._getType()};let n=e.r(98508);class i extends n.BaseMessage{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,t,r){"string"==typeof e&&(e={content:e,name:r,tool_call_id:t}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status,this.metadata=e.metadata}_getType(){return"tool"}static isInstance(e){return"tool"===e._getType()}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}r.ToolMessage=i;class a extends n.BaseMessageChunk{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new a({content:(0,n.mergeContent)(this.content,e.content),additional_kwargs:(0,n._mergeDicts)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,n._mergeDicts)(this.response_metadata,e.response_metadata),artifact:(0,n._mergeObj)(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:(0,n._mergeStatus)(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}r.ToolMessageChunk=a},46404,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AIMessageChunk=r.AIMessage=void 0,r.isAIMessage=function(e){return"ai"===e._getType()},r.isAIMessageChunk=function(e){return"ai"===e._getType()};let n=e.r(80088),i=e.r(98508),a=e.r(85257);class s extends i.BaseMessage{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,t){let r;if("string"==typeof e)r={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:t??{}};else{r=e;let t=r.additional_kwargs?.tool_calls,n=r.tool_calls;null!=t&&t.length>0&&(void 0===n||0===n.length)&&console.warn("New LangChain packages are available that more efficiently handle tool calling.\n\nPlease upgrade your packages to versions that set message tool calls. e.g., `yarn add @langchain/anthropic`, yarn add @langchain/openai`, etc.");try{if(null!=t&&void 0===n){let[e,n]=(0,a.defaultToolCallParser)(t);r.tool_calls=e??[],r.invalid_tool_calls=n??[]}else r.tool_calls=r.tool_calls??[],r.invalid_tool_calls=r.invalid_tool_calls??[]}catch(e){r.tool_calls=[],r.invalid_tool_calls=[]}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),"string"!=typeof r&&(this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=r.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}r.AIMessage=s;class o extends i.BaseMessageChunk{constructor(e){let t;if("string"==typeof e)t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(void 0===e.tool_call_chunks)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:void 0!==e.usage_metadata?e.usage_metadata:void 0};else{let r=e.tool_call_chunks.reduce((e,t)=>{let r=e.findIndex(([e])=>"id"in t&&t.id&&"index"in t&&void 0!==t.index?t.id===e.id&&t.index===e.index:"id"in t&&t.id?t.id===e.id:"index"in t&&void 0!==t.index&&t.index===e.index);return -1!==r?e[r].push(t):e.push([t]),e},[]),i=[],a=[];for(let e of r){let t={},r=e[0]?.name??"",s=e.map(e=>e.args||"").join(""),o=s.length?s:"{}",l=e[0]?.id;try{if(t=(0,n.parsePartialJson)(o),!l||null===t||"object"!=typeof t||Array.isArray(t))throw Error("Malformed tool call chunk args.");i.push({name:r,args:t,id:l,type:"tool_call"})}catch(e){a.push({name:r,args:o,id:l,error:"Malformed args.",type:"invalid_tool_call"})}}t={...e,tool_calls:i,invalid_tool_calls:a,usage_metadata:void 0!==e.usage_metadata?e.usage_metadata:void 0}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){let t={content:(0,i.mergeContent)(this.content,e.content),additional_kwargs:(0,i._mergeDicts)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,i._mergeDicts)(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(void 0!==this.tool_call_chunks||void 0!==e.tool_call_chunks){let r=(0,i._mergeLists)(this.tool_call_chunks,e.tool_call_chunks);void 0!==r&&r.length>0&&(t.tool_call_chunks=r)}if(void 0!==this.usage_metadata||void 0!==e.usage_metadata){let r={...(this.usage_metadata?.input_token_details?.audio!==void 0||e.usage_metadata?.input_token_details?.audio!==void 0)&&{audio:(this.usage_metadata?.input_token_details?.audio??0)+(e.usage_metadata?.input_token_details?.audio??0)},...(this.usage_metadata?.input_token_details?.cache_read!==void 0||e.usage_metadata?.input_token_details?.cache_read!==void 0)&&{cache_read:(this.usage_metadata?.input_token_details?.cache_read??0)+(e.usage_metadata?.input_token_details?.cache_read??0)},...(this.usage_metadata?.input_token_details?.cache_creation!==void 0||e.usage_metadata?.input_token_details?.cache_creation!==void 0)&&{cache_creation:(this.usage_metadata?.input_token_details?.cache_creation??0)+(e.usage_metadata?.input_token_details?.cache_creation??0)}},n={...(this.usage_metadata?.output_token_details?.audio!==void 0||e.usage_metadata?.output_token_details?.audio!==void 0)&&{audio:(this.usage_metadata?.output_token_details?.audio??0)+(e.usage_metadata?.output_token_details?.audio??0)},...(this.usage_metadata?.output_token_details?.reasoning!==void 0||e.usage_metadata?.output_token_details?.reasoning!==void 0)&&{reasoning:(this.usage_metadata?.output_token_details?.reasoning??0)+(e.usage_metadata?.output_token_details?.reasoning??0)}},i=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},a=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0};t.usage_metadata={input_tokens:i.input_tokens+a.input_tokens,output_tokens:i.output_tokens+a.output_tokens,total_tokens:i.total_tokens+a.total_tokens,...Object.keys(r).length>0&&{input_token_details:r},...Object.keys(n).length>0&&{output_token_details:n}}}return new o(t)}}r.AIMessageChunk=o},57845,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChatMessageChunk=r.ChatMessage=void 0,r.isChatMessage=function(e){return"generic"===e._getType()},r.isChatMessageChunk=function(e){return"generic"===e._getType()};let n=e.r(98508);class i extends n.BaseMessage{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return i}constructor(e,t){"string"==typeof e&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return"generic"===e._getType()}get _printableFields(){return{...super._printableFields,role:this.role}}}r.ChatMessage=i;class a extends n.BaseMessageChunk{static lc_name(){return"ChatMessageChunk"}constructor(e,t){"string"==typeof e&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new a({content:(0,n.mergeContent)(this.content,e.content),additional_kwargs:(0,n._mergeDicts)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,n._mergeDicts)(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}r.ChatMessageChunk=a},96040,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FunctionMessageChunk=r.FunctionMessage=void 0,r.isFunctionMessage=function(e){return"function"===e._getType()},r.isFunctionMessageChunk=function(e){return"function"===e._getType()};let n=e.r(98508);class i extends n.BaseMessage{static lc_name(){return"FunctionMessage"}constructor(e,t){"string"==typeof e&&(e={content:e,name:t}),super(e)}_getType(){return"function"}}r.FunctionMessage=i;class a extends n.BaseMessageChunk{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new a({content:(0,n.mergeContent)(this.content,e.content),additional_kwargs:(0,n._mergeDicts)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,n._mergeDicts)(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}r.FunctionMessageChunk=a},61785,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.HumanMessageChunk=r.HumanMessage=void 0,r.isHumanMessage=function(e){return"human"===e.getType()},r.isHumanMessageChunk=function(e){return"human"===e.getType()};let n=e.r(98508);class i extends n.BaseMessage{static lc_name(){return"HumanMessage"}_getType(){return"human"}constructor(e,t){super(e,t)}}r.HumanMessage=i;class a extends n.BaseMessageChunk{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}constructor(e,t){super(e,t)}concat(e){return new a({content:(0,n.mergeContent)(this.content,e.content),additional_kwargs:(0,n._mergeDicts)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,n._mergeDicts)(this.response_metadata,e.response_metadata),id:this.id??e.id})}}r.HumanMessageChunk=a},11839,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SystemMessageChunk=r.SystemMessage=void 0,r.isSystemMessage=function(e){return"system"===e._getType()},r.isSystemMessageChunk=function(e){return"system"===e._getType()};let n=e.r(98508);class i extends n.BaseMessage{static lc_name(){return"SystemMessage"}_getType(){return"system"}constructor(e,t){super(e,t)}}r.SystemMessage=i;class a extends n.BaseMessageChunk{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}constructor(e,t){super(e,t)}concat(e){return new a({content:(0,n.mergeContent)(this.content,e.content),additional_kwargs:(0,n._mergeDicts)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,n._mergeDicts)(this.response_metadata,e.response_metadata),id:this.id??e.id})}}r.SystemMessageChunk=a},97898,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.addLangChainErrorFields=function(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/
`,e}},25951,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ToolInputParsingException=void 0,r._isToolCall=function(e){return!!(e&&"object"==typeof e&&"type"in e&&"tool_call"===e.type)},r._configHasToolCallId=function(e){return!!(e&&"object"==typeof e&&"toolCall"in e&&null!=e.toolCall&&"object"==typeof e.toolCall&&"id"in e.toolCall&&"string"==typeof e.toolCall.id)},r.ToolInputParsingException=class extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}}},2758,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RemoveMessage=void 0;let n=e.r(98508);class i extends n.BaseMessage{constructor(e){super({...e,content:""}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=e.id}_getType(){return"remove"}get _printableFields(){return{...super._printableFields,id:this.id}}}r.RemoveMessage=i},12556,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.coerceMessageLikeToMessage=function(e){if("string"==typeof e)return new u.HumanMessage(e);if((0,s.isBaseMessage)(e))return e;if(Array.isArray(e)){let[t,r]=e;return f({type:t,content:r})}if(!(0,s._isMessageFieldWithRole)(e))return f(e);{let{role:t,...r}=e;return f({...r,type:t})}},r.getBufferString=function(e,t="Human",r="AI"){let n=[];for(let i of e){let e;if("human"===i._getType())e=t;else if("ai"===i._getType())e=r;else if("system"===i._getType())e="System";else if("function"===i._getType())e="Function";else if("tool"===i._getType())e="Tool";else if("generic"===i._getType())e=i.role;else throw Error(`Got unsupported message type: ${i._getType()}`);let a=i.name?`${i.name}, `:"",s="string"==typeof i.content?i.content:JSON.stringify(i.content,null,2);n.push(`${e}: ${a}${s}`)}return n.join("\n")},r.mapStoredMessageToChatMessage=m,r.mapStoredMessagesToChatMessages=function(e){return e.map(m)},r.mapChatMessagesToStoredMessages=function(e){return e.map(e=>e.toDict())},r.convertToChunk=function(e){let t=e._getType();if("human"===t)return new u.HumanMessageChunk({...e});if("ai"===t){let t={...e};return"tool_calls"in t&&(t={...t,tool_call_chunks:t.tool_calls?.map(e=>({...e,type:"tool_call_chunk",index:void 0,args:JSON.stringify(e.args)}))}),new a.AIMessageChunk({...t})}if("system"===t)return new d.SystemMessageChunk({...e});if("function"===t)return new l.FunctionMessageChunk({...e});if(o.ChatMessage.isInstance(e))return new o.ChatMessageChunk({...e});else throw Error("Unknown message type.")};let n=e.r(97898),i=e.r(25951),a=e.r(46404),s=e.r(98508),o=e.r(57845),l=e.r(96040),u=e.r(61785),c=e.r(2758),d=e.r(11839),p=e.r(85257);function h(e){return(0,i._isToolCall)(e)?e:"string"==typeof e.id&&"function"===e.type&&"object"==typeof e.function&&null!==e.function&&"arguments"in e.function&&"string"==typeof e.function.arguments&&"name"in e.function&&"string"==typeof e.function.name?{id:e.id,args:JSON.parse(e.function.arguments),name:e.function.name,type:"tool_call"}:e}function f(e){let t,r;if("object"==typeof e&&null!=e&&1===e.lc&&Array.isArray(e.id)&&null!=e.kwargs&&"object"==typeof e.kwargs){let n=e.id.at(-1);t="HumanMessage"===n||"HumanMessageChunk"===n?"user":"AIMessage"===n||"AIMessageChunk"===n?"assistant":"SystemMessage"===n||"SystemMessageChunk"===n?"system":"FunctionMessage"===n||"FunctionMessageChunk"===n?"function":"ToolMessage"===n||"ToolMessageChunk"===n?"tool":"unknown",r=e.kwargs}else{let{type:n,...i}=e;t=n,r=i}if("human"===t||"user"===t)return new u.HumanMessage(r);if("ai"===t||"assistant"===t){let{tool_calls:e,...t}=r;if(!Array.isArray(e))return new a.AIMessage(r);let n=e.map(h);return new a.AIMessage({...t,tool_calls:n})}if("system"===t)return new d.SystemMessage(r);if("developer"===t)return new d.SystemMessage({...r,additional_kwargs:{...r.additional_kwargs,__openai_role__:"developer"}});if("tool"===t&&"tool_call_id"in r)return new p.ToolMessage({...r,content:r.content,tool_call_id:r.tool_call_id,name:r.name});if("remove"===t&&"id"in r&&"string"==typeof r.id)return new c.RemoveMessage({...r,id:r.id});throw(0,n.addLangChainErrorFields)(Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(e,null,2)}`),"MESSAGE_COERCION_FAILURE")}function m(e){let t=void 0!==e.data?e:{type:e.type,data:{content:e.text,role:e.role,name:void 0,tool_call_id:void 0}};switch(t.type){case"human":return new u.HumanMessage(t.data);case"ai":return new a.AIMessage(t.data);case"system":return new d.SystemMessage(t.data);case"function":if(void 0===t.data.name)throw Error("Name must be defined for function messages");return new l.FunctionMessage(t.data);case"tool":if(void 0===t.data.tool_call_id)throw Error("Tool call ID must be defined for tool messages");return new p.ToolMessage(t.data);case"generic":if(void 0===t.data.role)throw Error("Role must be defined for chat messages");return new o.ChatMessage(t.data);default:throw Error(`Got unexpected type: ${t.type}`)}}},49852,(e,t,r)=>{"use strict";var n,i;Object.defineProperty(r,"__esModule",{value:!0}),r.getParsedType=r.ZodParsedType=r.objectUtil=r.util=void 0,function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},e.getValidEnumValues=t=>{let r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),n={};for(let e of r)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(let r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(n||(r.util=n={})),(i||(r.objectUtil=i={})).mergeShapes=(e,t)=>({...e,...t}),r.ZodParsedType=n.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),r.getParsedType=e=>{switch(typeof e){case"undefined":return r.ZodParsedType.undefined;case"string":return r.ZodParsedType.string;case"number":return Number.isNaN(e)?r.ZodParsedType.nan:r.ZodParsedType.number;case"boolean":return r.ZodParsedType.boolean;case"function":return r.ZodParsedType.function;case"bigint":return r.ZodParsedType.bigint;case"symbol":return r.ZodParsedType.symbol;case"object":if(Array.isArray(e))return r.ZodParsedType.array;if(null===e)return r.ZodParsedType.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return r.ZodParsedType.promise;if("undefined"!=typeof Map&&e instanceof Map)return r.ZodParsedType.map;if("undefined"!=typeof Set&&e instanceof Set)return r.ZodParsedType.set;if("undefined"!=typeof Date&&e instanceof Date)return r.ZodParsedType.date;return r.ZodParsedType.object;default:return r.ZodParsedType.unknown}}},48372,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ZodError=r.quotelessJson=r.ZodIssueCode=void 0;let n=e.r(49852);r.ZodIssueCode=n.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),r.quotelessJson=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class i extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(let i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(n);else if("invalid_return_type"===i.code)n(i.returnTypeError);else if("invalid_arguments"===i.code)n(i.argumentsError);else if(0===i.path.length)r._errors.push(t(i));else{let e=r,n=0;for(;n<i.path.length;){let r=i.path[n];n===i.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(i))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}static assert(e){if(!(e instanceof i))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,n.util.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let n of this.issues)if(n.path.length>0){let r=n.path[0];t[r]=t[r]||[],t[r].push(e(n))}else r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}r.ZodError=i,i.create=e=>new i(e)},75121,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(48372),i=e.r(49852);r.default=(e,t)=>{let r;switch(e.code){case n.ZodIssueCode.invalid_type:r=e.received===i.ZodParsedType.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case n.ZodIssueCode.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,i.util.jsonStringifyReplacer)}`;break;case n.ZodIssueCode.unrecognized_keys:r=`Unrecognized key(s) in object: ${i.util.joinValues(e.keys,", ")}`;break;case n.ZodIssueCode.invalid_union:r="Invalid input";break;case n.ZodIssueCode.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${i.util.joinValues(e.options)}`;break;case n.ZodIssueCode.invalid_enum_value:r=`Invalid enum value. Expected ${i.util.joinValues(e.options)}, received '${e.received}'`;break;case n.ZodIssueCode.invalid_arguments:r="Invalid function arguments";break;case n.ZodIssueCode.invalid_return_type:r="Invalid function return type";break;case n.ZodIssueCode.invalid_date:r="Invalid date";break;case n.ZodIssueCode.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:i.util.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case n.ZodIssueCode.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case n.ZodIssueCode.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case n.ZodIssueCode.custom:r="Invalid input";break;case n.ZodIssueCode.invalid_intersection_types:r="Intersection results could not be merged";break;case n.ZodIssueCode.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case n.ZodIssueCode.not_finite:r="Number must be finite";break;default:r=t.defaultError,i.util.assertNever(e)}return{message:r}}},81754,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.defaultErrorMap=void 0,r.setErrorMap=function(e){a=e},r.getErrorMap=function(){return a};let i=n(e.r(75121));r.defaultErrorMap=i.default;let a=i.default},49552,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.isAsync=r.isValid=r.isDirty=r.isAborted=r.OK=r.DIRTY=r.INVALID=r.ParseStatus=r.EMPTY_PATH=r.makeIssue=void 0,r.addIssueToContext=function(e,t){let n=(0,i.getErrorMap)(),s=(0,r.makeIssue)({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===a.default?void 0:a.default].filter(e=>!!e)});e.common.issues.push(s)};let i=e.r(81754),a=n(e.r(75121));r.makeIssue=e=>{let{data:t,path:r,errorMaps:n,issueData:i}=e,a=[...r,...i.path||[]],s={...i,path:a};if(void 0!==i.message)return{...i,path:a,message:i.message};let o="";for(let e of n.filter(e=>!!e).slice().reverse())o=e(s,{data:t,defaultError:o}).message;return{...i,path:a,message:o}},r.EMPTY_PATH=[];class s{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let i of t){if("aborted"===i.status)return r.INVALID;"dirty"===i.status&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,n=await e.value;r.push({key:t,value:n})}return s.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let n={};for(let i of t){let{key:t,value:a}=i;if("aborted"===t.status||"aborted"===a.status)return r.INVALID;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==a.value||i.alwaysSet)&&(n[t.value]=a.value)}return{status:e.value,value:n}}}r.ParseStatus=s,r.INVALID=Object.freeze({status:"aborted"}),r.DIRTY=e=>({status:"dirty",value:e}),r.OK=e=>({status:"valid",value:e}),r.isAborted=e=>"aborted"===e.status,r.isDirty=e=>"dirty"===e.status,r.isValid=e=>"valid"===e.status,r.isAsync=e=>"undefined"!=typeof Promise&&e instanceof Promise},43825,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},49847,(e,t,r)=>{"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.errorUtil=void 0,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(n||(r.errorUtil=n={}))},90386,(e,t,r)=>{"use strict";var n;let i;Object.defineProperty(r,"__esModule",{value:!0}),r.discriminatedUnion=r.date=r.boolean=r.bigint=r.array=r.any=r.coerce=r.ZodFirstPartyTypeKind=r.late=r.ZodSchema=r.Schema=r.ZodReadonly=r.ZodPipeline=r.ZodBranded=r.BRAND=r.ZodNaN=r.ZodCatch=r.ZodDefault=r.ZodNullable=r.ZodOptional=r.ZodTransformer=r.ZodEffects=r.ZodPromise=r.ZodNativeEnum=r.ZodEnum=r.ZodLiteral=r.ZodLazy=r.ZodFunction=r.ZodSet=r.ZodMap=r.ZodRecord=r.ZodTuple=r.ZodIntersection=r.ZodDiscriminatedUnion=r.ZodUnion=r.ZodObject=r.ZodArray=r.ZodVoid=r.ZodNever=r.ZodUnknown=r.ZodAny=r.ZodNull=r.ZodUndefined=r.ZodSymbol=r.ZodDate=r.ZodBoolean=r.ZodBigInt=r.ZodNumber=r.ZodString=r.ZodType=void 0,r.NEVER=r.void=r.unknown=r.union=r.undefined=r.tuple=r.transformer=r.symbol=r.string=r.strictObject=r.set=r.record=r.promise=r.preprocess=r.pipeline=r.ostring=r.optional=r.onumber=r.oboolean=r.object=r.number=r.nullable=r.null=r.never=r.nativeEnum=r.nan=r.map=r.literal=r.lazy=r.intersection=r.instanceof=r.function=r.enum=r.effect=void 0,r.datetimeRegex=j,r.custom=ey;let a=e.r(48372),s=e.r(81754),o=e.r(49847),l=e.r(49552),u=e.r(49852);class c{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let d=(e,t)=>{if((0,l.isValid)(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new a.ZodError(e.common.issues);return this._error=t,this._error}}};function p(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:n,description:i}=e;if(t&&(r||n))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:i}:{errorMap:(t,i)=>{let{message:a}=e;return"invalid_enum_value"===t.code?{message:a??i.defaultError}:void 0===i.data?{message:a??n??i.defaultError}:"invalid_type"!==t.code?{message:i.defaultError}:{message:a??r??i.defaultError}},description:i}}class h{get description(){return this._def.description}_getType(e){return(0,u.getParsedType)(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:(0,u.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new l.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,u.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if((0,l.isAsync)(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,u.getParsedType)(e)},n=this._parseSync({data:e,path:r.path,parent:r});return d(r,n)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,u.getParsedType)(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return(0,l.isValid)(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>(0,l.isValid)(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,u.getParsedType)(e)},n=this._parse({data:e,path:r.path,parent:r});return d(r,await ((0,l.isAsync)(n)?n:Promise.resolve(n)))}refine(e,t){return this._refinement((r,n)=>{let i=e(r),s=()=>n.addIssue({code:a.ZodIssueCode.custom,..."string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(r):t});return"undefined"!=typeof Promise&&i instanceof Promise?i.then(e=>!!e||(s(),!1)):!!i||(s(),!1)})}refinement(e,t){return this._refinement((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1))}_refinement(e){return new eo({schema:this,typeName:n.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return el.create(this,this._def)}nullable(){return eu.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Z.create(this)}promise(){return es.create(this,this._def)}or(e){return V.create([this,e],this._def)}and(e){return q.create(this,e,this._def)}transform(e){return new eo({...p(this._def),schema:this,typeName:n.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new ec({...p(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:n.ZodDefault})}brand(){return new eh({typeName:n.ZodBranded,type:this,...p(this._def)})}catch(e){return new ed({...p(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:n.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return ef.create(this,e)}readonly(){return em.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}r.ZodType=h,r.Schema=h,r.ZodSchema=h;let f=/^c[^\s-]{8,}$/i,m=/^[0-9a-z]+$/,g=/^[0-9A-HJKMNP-TV-Z]{26}$/i,y=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,b=/^[a-z0-9_-]{21}$/i,_=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,v=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,w=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,O=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,P=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,S=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,E=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,k=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,I=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,A="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",T=RegExp(`^${A}$`);function C(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function j(e){let t=`${A}T${C(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)}class x extends h{_parse(e){var t,r,n,s;let o;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==u.ZodParsedType.string){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.string,received:t.parsedType}),l.INVALID}let c=new l.ParseStatus;for(let d of this._def.checks)if("min"===d.kind)e.data.length<d.value&&(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:a.ZodIssueCode.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),c.dirty());else if("max"===d.kind)e.data.length>d.value&&(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:a.ZodIssueCode.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),c.dirty());else if("length"===d.kind){let t=e.data.length>d.value,r=e.data.length<d.value;(t||r)&&(o=this._getOrReturnCtx(e,o),t?(0,l.addIssueToContext)(o,{code:a.ZodIssueCode.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}):r&&(0,l.addIssueToContext)(o,{code:a.ZodIssueCode.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}),c.dirty())}else if("email"===d.kind)w.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"email",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty());else if("emoji"===d.kind)i||(i=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),i.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"emoji",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty());else if("uuid"===d.kind)y.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"uuid",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty());else if("nanoid"===d.kind)b.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"nanoid",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty());else if("cuid"===d.kind)f.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"cuid",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty());else if("cuid2"===d.kind)m.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"cuid2",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty());else if("ulid"===d.kind)g.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"ulid",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty());else if("url"===d.kind)try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"url",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty()}else"regex"===d.kind?(d.regex.lastIndex=0,d.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"regex",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty())):"trim"===d.kind?e.data=e.data.trim():"includes"===d.kind?e.data.includes(d.value,d.position)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:{includes:d.value,position:d.position},message:d.message}),c.dirty()):"toLowerCase"===d.kind?e.data=e.data.toLowerCase():"toUpperCase"===d.kind?e.data=e.data.toUpperCase():"startsWith"===d.kind?e.data.startsWith(d.value)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:{startsWith:d.value},message:d.message}),c.dirty()):"endsWith"===d.kind?e.data.endsWith(d.value)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:{endsWith:d.value},message:d.message}),c.dirty()):"datetime"===d.kind?j(d).test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:"datetime",message:d.message}),c.dirty()):"date"===d.kind?T.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:"date",message:d.message}),c.dirty()):"time"===d.kind?RegExp(`^${C(d)}$`).test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:"time",message:d.message}),c.dirty()):"duration"===d.kind?v.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"duration",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty()):"ip"===d.kind?(t=e.data,!(("v4"===(r=d.version)||!r)&&O.test(t)||("v6"===r||!r)&&S.test(t))&&1&&(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"ip",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty())):"jwt"===d.kind?!function(e,t){if(!_.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),i=JSON.parse(atob(n));if("object"!=typeof i||null===i||"typ"in i&&i?.typ!=="JWT"||!i.alg||t&&i.alg!==t)return!1;return!0}catch{return!1}}(e.data,d.alg)&&(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"jwt",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty()):"cidr"===d.kind?(n=e.data,!(("v4"===(s=d.version)||!s)&&P.test(n)||("v6"===s||!s)&&E.test(n))&&1&&(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"cidr",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty())):"base64"===d.kind?k.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"base64",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty()):"base64url"===d.kind?I.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,l.addIssueToContext)(o,{validation:"base64url",code:a.ZodIssueCode.invalid_string,message:d.message}),c.dirty()):u.util.assertNever(d);return{status:c.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:a.ZodIssueCode.invalid_string,...o.errorUtil.errToObj(r)})}_addCheck(e){return new x({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...o.errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...o.errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...o.errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...o.errorUtil.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...o.errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...o.errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...o.errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...o.errorUtil.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...o.errorUtil.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...o.errorUtil.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...o.errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...o.errorUtil.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...o.errorUtil.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...o.errorUtil.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...o.errorUtil.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...o.errorUtil.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...o.errorUtil.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...o.errorUtil.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...o.errorUtil.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...o.errorUtil.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...o.errorUtil.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...o.errorUtil.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...o.errorUtil.errToObj(t)})}nonempty(e){return this.min(1,o.errorUtil.errToObj(e))}trim(){return new x({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new x({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new x({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}r.ZodString=x,x.create=e=>new x({checks:[],typeName:n.ZodString,coerce:e?.coerce??!1,...p(e)});class $ extends h{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==u.ZodParsedType.number){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.number,received:t.parsedType}),l.INVALID}let r=new l.ParseStatus;for(let n of this._def.checks)"int"===n.kind?u.util.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"multipleOf"===n.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,i=r>n?r:n;return Number.parseInt(e.toFixed(i).replace(".",""))%Number.parseInt(t.toFixed(i).replace(".",""))/10**i}(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.not_finite,message:n.message}),r.dirty()):u.util.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,o.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,o.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,o.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,o.errorUtil.toString(t))}setLimit(e,t,r,n){return new $({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:o.errorUtil.toString(n)}]})}_addCheck(e){return new $({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:o.errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:o.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:o.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:o.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:o.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:o.errorUtil.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:o.errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:o.errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:o.errorUtil.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&u.util.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks)if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;else"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value);return Number.isFinite(t)&&Number.isFinite(e)}}r.ZodNumber=$,$.create=e=>new $({checks:[],typeName:n.ZodNumber,coerce:e?.coerce||!1,...p(e)});class N extends h{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==u.ZodParsedType.bigint)return this._getInvalidInput(e);let r=new l.ParseStatus;for(let n of this._def.checks)"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):u.util.assertNever(n);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.bigint,received:t.parsedType}),l.INVALID}gte(e,t){return this.setLimit("min",e,!0,o.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,o.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,o.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,o.errorUtil.toString(t))}setLimit(e,t,r,n){return new N({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:o.errorUtil.toString(n)}]})}_addCheck(e){return new N({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:o.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:o.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:o.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:o.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:o.errorUtil.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}r.ZodBigInt=N,N.create=e=>new N({checks:[],typeName:n.ZodBigInt,coerce:e?.coerce??!1,...p(e)});class R extends h{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==u.ZodParsedType.boolean){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.boolean,received:t.parsedType}),l.INVALID}return(0,l.OK)(e.data)}}r.ZodBoolean=R,R.create=e=>new R({typeName:n.ZodBoolean,coerce:e?.coerce||!1,...p(e)});class M extends h{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==u.ZodParsedType.date){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.date,received:t.parsedType}),l.INVALID}if(Number.isNaN(e.data.getTime())){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_date}),l.INVALID}let r=new l.ParseStatus;for(let n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),r.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(t=this._getOrReturnCtx(e,t),(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),r.dirty()):u.util.assertNever(n);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new M({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:o.errorUtil.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:o.errorUtil.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}r.ZodDate=M,M.create=e=>new M({checks:[],coerce:e?.coerce||!1,typeName:n.ZodDate,...p(e)});class D extends h{_parse(e){if(this._getType(e)!==u.ZodParsedType.symbol){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.symbol,received:t.parsedType}),l.INVALID}return(0,l.OK)(e.data)}}r.ZodSymbol=D,D.create=e=>new D({typeName:n.ZodSymbol,...p(e)});class L extends h{_parse(e){if(this._getType(e)!==u.ZodParsedType.undefined){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.undefined,received:t.parsedType}),l.INVALID}return(0,l.OK)(e.data)}}r.ZodUndefined=L,L.create=e=>new L({typeName:n.ZodUndefined,...p(e)});class U extends h{_parse(e){if(this._getType(e)!==u.ZodParsedType.null){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.null,received:t.parsedType}),l.INVALID}return(0,l.OK)(e.data)}}r.ZodNull=U,U.create=e=>new U({typeName:n.ZodNull,...p(e)});class F extends h{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,l.OK)(e.data)}}r.ZodAny=F,F.create=e=>new F({typeName:n.ZodAny,...p(e)});class z extends h{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,l.OK)(e.data)}}r.ZodUnknown=z,z.create=e=>new z({typeName:n.ZodUnknown,...p(e)});class B extends h{_parse(e){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.never,received:t.parsedType}),l.INVALID}}r.ZodNever=B,B.create=e=>new B({typeName:n.ZodNever,...p(e)});class G extends h{_parse(e){if(this._getType(e)!==u.ZodParsedType.undefined){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.void,received:t.parsedType}),l.INVALID}return(0,l.OK)(e.data)}}r.ZodVoid=G,G.create=e=>new G({typeName:n.ZodVoid,...p(e)});class Z extends h{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==u.ZodParsedType.array)return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.array,received:t.parsedType}),l.INVALID;if(null!==n.exactLength){let e=t.data.length>n.exactLength.value,i=t.data.length<n.exactLength.value;(e||i)&&((0,l.addIssueToContext)(t,{code:e?a.ZodIssueCode.too_big:a.ZodIssueCode.too_small,minimum:i?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&((0,l.addIssueToContext)(t,{code:a.ZodIssueCode.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&((0,l.addIssueToContext)(t,{code:a.ZodIssueCode.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>n.type._parseAsync(new c(t,e,t.path,r)))).then(e=>l.ParseStatus.mergeArray(r,e));let i=[...t.data].map((e,r)=>n.type._parseSync(new c(t,e,t.path,r)));return l.ParseStatus.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new Z({...this._def,minLength:{value:e,message:o.errorUtil.toString(t)}})}max(e,t){return new Z({...this._def,maxLength:{value:e,message:o.errorUtil.toString(t)}})}length(e,t){return new Z({...this._def,exactLength:{value:e,message:o.errorUtil.toString(t)}})}nonempty(e){return this.min(1,e)}}r.ZodArray=Z,Z.create=(e,t)=>new Z({type:e,minLength:null,maxLength:null,exactLength:null,typeName:n.ZodArray,...p(t)});class K extends h{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=u.util.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==u.ZodParsedType.object){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.object,received:t.parsedType}),l.INVALID}let{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),s=[];if(!(this._def.catchall instanceof B&&"strip"===this._def.unknownKeys))for(let e in r.data)i.includes(e)||s.push(e);let o=[];for(let e of i){let t=n[e],i=r.data[e];o.push({key:{status:"valid",value:e},value:t._parse(new c(r,i,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof B){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of s)o.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)s.length>0&&((0,l.addIssueToContext)(r,{code:a.ZodIssueCode.unrecognized_keys,keys:s}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of s){let n=r.data[t];o.push({key:{status:"valid",value:t},value:e._parse(new c(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of o){let r=await t.key,n=await t.value;e.push({key:r,value:n,alwaysSet:t.alwaysSet})}return e}).then(e=>l.ParseStatus.mergeObjectSync(t,e)):l.ParseStatus.mergeObjectSync(t,o)}get shape(){return this._def.shape()}strict(e){return o.errorUtil.errToObj,new K({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{let n=this._def.errorMap?.(t,r).message??r.defaultError;return"unrecognized_keys"===t.code?{message:o.errorUtil.errToObj(e).message??n}:{message:n}}}:{}})}strip(){return new K({...this._def,unknownKeys:"strip"})}passthrough(){return new K({...this._def,unknownKeys:"passthrough"})}extend(e){return new K({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new K({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:n.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new K({...this._def,catchall:e})}pick(e){let t={};for(let r of u.util.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new K({...this._def,shape:()=>t})}omit(e){let t={};for(let r of u.util.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new K({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof K){let r={};for(let n in t.shape){let i=t.shape[n];r[n]=el.create(e(i))}return new K({...t._def,shape:()=>r})}if(t instanceof Z)return new Z({...t._def,type:e(t.element)});if(t instanceof el)return el.create(e(t.unwrap()));if(t instanceof eu)return eu.create(e(t.unwrap()));if(t instanceof J)return J.create(t.items.map(t=>e(t)));else return t}(this)}partial(e){let t={};for(let r of u.util.objectKeys(this.shape)){let n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()}return new K({...this._def,shape:()=>t})}required(e){let t={};for(let r of u.util.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof el;)e=e._def.innerType;t[r]=e}return new K({...this._def,shape:()=>t})}keyof(){return en(u.util.objectKeys(this.shape))}}r.ZodObject=K,K.create=(e,t)=>new K({shape:()=>e,unknownKeys:"strip",catchall:B.create(),typeName:n.ZodObject,...p(t)}),K.strictCreate=(e,t)=>new K({shape:()=>e,unknownKeys:"strict",catchall:B.create(),typeName:n.ZodObject,...p(t)}),K.lazycreate=(e,t)=>new K({shape:e,unknownKeys:"strip",catchall:B.create(),typeName:n.ZodObject,...p(t)});class V extends h{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new a.ZodError(e.ctx.common.issues));return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_union,unionErrors:r}),l.INVALID});{let e,n=[];for(let i of r){let r={...t,common:{...t.common,issues:[]},parent:null},a=i._parseSync({data:t.data,path:t.path,parent:r});if("valid"===a.status)return a;"dirty"!==a.status||e||(e={result:a,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let i=n.map(e=>new a.ZodError(e));return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_union,unionErrors:i}),l.INVALID}}get options(){return this._def.options}}r.ZodUnion=V,V.create=(e,t)=>new V({options:e,typeName:n.ZodUnion,...p(t)});let H=e=>{if(e instanceof et)return H(e.schema);if(e instanceof eo)return H(e.innerType());if(e instanceof er)return[e.value];if(e instanceof ei)return e.options;if(e instanceof ea)return u.util.objectValues(e.enum);else if(e instanceof ec)return H(e._def.innerType);else if(e instanceof L)return[void 0];else if(e instanceof U)return[null];else if(e instanceof el)return[void 0,...H(e.unwrap())];else if(e instanceof eu)return[null,...H(e.unwrap())];else if(e instanceof eh)return H(e.unwrap());else if(e instanceof em)return H(e.unwrap());else if(e instanceof ed)return H(e._def.innerType);else return[]};class W extends h{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==u.ZodParsedType.object)return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.object,received:t.parsedType}),l.INVALID;let r=this.discriminator,n=t.data[r],i=this.optionsMap.get(n);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):((0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),l.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let i=new Map;for(let r of t){let t=H(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let n of t){if(i.has(n))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(n)}`);i.set(n,r)}}return new W({typeName:n.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...p(r)})}}r.ZodDiscriminatedUnion=W;class q extends h{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if((0,l.isAborted)(e)||(0,l.isAborted)(n))return l.INVALID;let i=function e(t,r){let n=(0,u.getParsedType)(t),i=(0,u.getParsedType)(r);if(t===r)return{valid:!0,data:t};if(n===u.ZodParsedType.object&&i===u.ZodParsedType.object){let n=u.util.objectKeys(r),i=u.util.objectKeys(t).filter(e=>-1!==n.indexOf(e)),a={...t,...r};for(let n of i){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1};a[n]=i.data}return{valid:!0,data:a}}if(n===u.ZodParsedType.array&&i===u.ZodParsedType.array){if(t.length!==r.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let a=e(t[i],r[i]);if(!a.valid)return{valid:!1};n.push(a.data)}return{valid:!0,data:n}}if(n===u.ZodParsedType.date&&i===u.ZodParsedType.date&&+t==+r)return{valid:!0,data:t};return{valid:!1}}(e.value,n.value);return i.valid?(((0,l.isDirty)(e)||(0,l.isDirty)(n))&&t.dirty(),{status:t.value,value:i.data}):((0,l.addIssueToContext)(r,{code:a.ZodIssueCode.invalid_intersection_types}),l.INVALID)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>n(e,t)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}r.ZodIntersection=q,q.create=(e,t,r)=>new q({left:e,right:t,typeName:n.ZodIntersection,...p(r)});class J extends h{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==u.ZodParsedType.array)return(0,l.addIssueToContext)(r,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.array,received:r.parsedType}),l.INVALID;if(r.data.length<this._def.items.length)return(0,l.addIssueToContext)(r,{code:a.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),l.INVALID;!this._def.rest&&r.data.length>this._def.items.length&&((0,l.addIssueToContext)(r,{code:a.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let n=[...r.data].map((e,t)=>{let n=this._def.items[t]||this._def.rest;return n?n._parse(new c(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(n).then(e=>l.ParseStatus.mergeArray(t,e)):l.ParseStatus.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new J({...this._def,rest:e})}}r.ZodTuple=J,J.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new J({items:e,typeName:n.ZodTuple,rest:null,...p(t)})};class Y extends h{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==u.ZodParsedType.object)return(0,l.addIssueToContext)(r,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.object,received:r.parsedType}),l.INVALID;let n=[],i=this._def.keyType,s=this._def.valueType;for(let e in r.data)n.push({key:i._parse(new c(r,e,r.path,e)),value:s._parse(new c(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?l.ParseStatus.mergeObjectAsync(t,n):l.ParseStatus.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return new Y(t instanceof h?{keyType:e,valueType:t,typeName:n.ZodRecord,...p(r)}:{keyType:x.create(),valueType:e,typeName:n.ZodRecord,...p(t)})}}r.ZodRecord=Y;class Q extends h{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==u.ZodParsedType.map)return(0,l.addIssueToContext)(r,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.map,received:r.parsedType}),l.INVALID;let n=this._def.keyType,i=this._def.valueType,s=[...r.data.entries()].map(([e,t],a)=>({key:n._parse(new c(r,e,r.path,[a,"key"])),value:i._parse(new c(r,t,r.path,[a,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of s){let n=await r.key,i=await r.value;if("aborted"===n.status||"aborted"===i.status)return l.INVALID;("dirty"===n.status||"dirty"===i.status)&&t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of s){let n=r.key,i=r.value;if("aborted"===n.status||"aborted"===i.status)return l.INVALID;("dirty"===n.status||"dirty"===i.status)&&t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}}}}r.ZodMap=Q,Q.create=(e,t,r)=>new Q({valueType:t,keyType:e,typeName:n.ZodMap,...p(r)});class X extends h{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==u.ZodParsedType.set)return(0,l.addIssueToContext)(r,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.set,received:r.parsedType}),l.INVALID;let n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&((0,l.addIssueToContext)(r,{code:a.ZodIssueCode.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&((0,l.addIssueToContext)(r,{code:a.ZodIssueCode.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());let i=this._def.valueType;function s(e){let r=new Set;for(let n of e){if("aborted"===n.status)return l.INVALID;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}let o=[...r.data.values()].map((e,t)=>i._parse(new c(r,e,r.path,t)));return r.common.async?Promise.all(o).then(e=>s(e)):s(o)}min(e,t){return new X({...this._def,minSize:{value:e,message:o.errorUtil.toString(t)}})}max(e,t){return new X({...this._def,maxSize:{value:e,message:o.errorUtil.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}r.ZodSet=X,X.create=(e,t)=>new X({valueType:e,minSize:null,maxSize:null,typeName:n.ZodSet,...p(t)});class ee extends h{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==u.ZodParsedType.function)return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.function,received:t.parsedType}),l.INVALID;function r(e,r){return(0,l.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,s.getErrorMap)(),s.defaultErrorMap].filter(e=>!!e),issueData:{code:a.ZodIssueCode.invalid_arguments,argumentsError:r}})}function n(e,r){return(0,l.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,s.getErrorMap)(),s.defaultErrorMap].filter(e=>!!e),issueData:{code:a.ZodIssueCode.invalid_return_type,returnTypeError:r}})}let i={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof es){let e=this;return(0,l.OK)(async function(...t){let s=new a.ZodError([]),l=await e._def.args.parseAsync(t,i).catch(e=>{throw s.addIssue(r(t,e)),s}),u=await Reflect.apply(o,this,l);return await e._def.returns._def.type.parseAsync(u,i).catch(e=>{throw s.addIssue(n(u,e)),s})})}{let e=this;return(0,l.OK)(function(...t){let s=e._def.args.safeParse(t,i);if(!s.success)throw new a.ZodError([r(t,s.error)]);let l=Reflect.apply(o,this,s.data),u=e._def.returns.safeParse(l,i);if(!u.success)throw new a.ZodError([n(l,u.error)]);return u.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ee({...this._def,args:J.create(e).rest(z.create())})}returns(e){return new ee({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new ee({args:e||J.create([]).rest(z.create()),returns:t||z.create(),typeName:n.ZodFunction,...p(r)})}}r.ZodFunction=ee;class et extends h{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}r.ZodLazy=et,et.create=(e,t)=>new et({getter:e,typeName:n.ZodLazy,...p(t)});class er extends h{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{received:t.data,code:a.ZodIssueCode.invalid_literal,expected:this._def.value}),l.INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}function en(e,t){return new ei({values:e,typeName:n.ZodEnum,...p(t)})}r.ZodLiteral=er,er.create=(e,t)=>new er({value:e,typeName:n.ZodLiteral,...p(t)});class ei extends h{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return(0,l.addIssueToContext)(t,{expected:u.util.joinValues(r),received:t.parsedType,code:a.ZodIssueCode.invalid_type}),l.INVALID}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return(0,l.addIssueToContext)(t,{received:t.data,code:a.ZodIssueCode.invalid_enum_value,options:r}),l.INVALID}return(0,l.OK)(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ei.create(e,{...this._def,...t})}exclude(e,t=this._def){return ei.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}r.ZodEnum=ei,ei.create=en;class ea extends h{_parse(e){let t=u.util.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==u.ZodParsedType.string&&r.parsedType!==u.ZodParsedType.number){let e=u.util.objectValues(t);return(0,l.addIssueToContext)(r,{expected:u.util.joinValues(e),received:r.parsedType,code:a.ZodIssueCode.invalid_type}),l.INVALID}if(this._cache||(this._cache=new Set(u.util.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=u.util.objectValues(t);return(0,l.addIssueToContext)(r,{received:r.data,code:a.ZodIssueCode.invalid_enum_value,options:e}),l.INVALID}return(0,l.OK)(e.data)}get enum(){return this._def.values}}r.ZodNativeEnum=ea,ea.create=(e,t)=>new ea({values:e,typeName:n.ZodNativeEnum,...p(t)});class es extends h{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==u.ZodParsedType.promise&&!1===t.common.async)return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.promise,received:t.parsedType}),l.INVALID;let r=t.parsedType===u.ZodParsedType.promise?t.data:Promise.resolve(t.data);return(0,l.OK)(r.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}r.ZodPromise=es,es.create=(e,t)=>new es({type:e,typeName:n.ZodPromise,...p(t)});class eo extends h{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===n.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:e=>{(0,l.addIssueToContext)(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===n.type){let e=n.transform(r.data,i);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return l.INVALID;let n=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===n.status?l.INVALID:"dirty"===n.status||"dirty"===t.value?(0,l.DIRTY)(n.value):n});{if("aborted"===t.value)return l.INVALID;let n=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===n.status?l.INVALID:"dirty"===n.status||"dirty"===t.value?(0,l.DIRTY)(n.value):n}}if("refinement"===n.type){let e=e=>{let t=n.refinement(e,i);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?l.INVALID:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?l.INVALID:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}}if("transform"===n.type)if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>(0,l.isValid)(e)?Promise.resolve(n.transform(e.value,i)).then(e=>({status:t.value,value:e})):l.INVALID);else{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!(0,l.isValid)(e))return l.INVALID;let a=n.transform(e.value,i);if(a instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}u.util.assertNever(n)}}r.ZodEffects=eo,r.ZodTransformer=eo,eo.create=(e,t,r)=>new eo({schema:e,typeName:n.ZodEffects,effect:t,...p(r)}),eo.createWithPreprocess=(e,t,r)=>new eo({schema:t,effect:{type:"preprocess",transform:e},typeName:n.ZodEffects,...p(r)});class el extends h{_parse(e){return this._getType(e)===u.ZodParsedType.undefined?(0,l.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}r.ZodOptional=el,el.create=(e,t)=>new el({innerType:e,typeName:n.ZodOptional,...p(t)});class eu extends h{_parse(e){return this._getType(e)===u.ZodParsedType.null?(0,l.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}r.ZodNullable=eu,eu.create=(e,t)=>new eu({innerType:e,typeName:n.ZodNullable,...p(t)});class ec extends h{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===u.ZodParsedType.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}r.ZodDefault=ec,ec.create=(e,t)=>new ec({innerType:e,typeName:n.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...p(t)});class ed extends h{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return(0,l.isAsync)(n)?n.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new a.ZodError(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new a.ZodError(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}r.ZodCatch=ed,ed.create=(e,t)=>new ed({innerType:e,typeName:n.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...p(t)});class ep extends h{_parse(e){if(this._getType(e)!==u.ZodParsedType.nan){let t=this._getOrReturnCtx(e);return(0,l.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:u.ZodParsedType.nan,received:t.parsedType}),l.INVALID}return{status:"valid",value:e.data}}}r.ZodNaN=ep,ep.create=e=>new ep({typeName:n.ZodNaN,...p(e)}),r.BRAND=Symbol("zod_brand");class eh extends h{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}r.ZodBranded=eh;class ef extends h{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?l.INVALID:"dirty"===e.status?(t.dirty(),(0,l.DIRTY)(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?l.INVALID:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new ef({in:e,out:t,typeName:n.ZodPipeline})}}r.ZodPipeline=ef;class em extends h{_parse(e){let t=this._def.innerType._parse(e),r=e=>((0,l.isValid)(e)&&(e.value=Object.freeze(e.value)),e);return(0,l.isAsync)(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}function eg(e,t){let r="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof r?{message:r}:r}function ey(e,t={},r){return e?F.create().superRefine((n,i)=>{let a=e(n);if(a instanceof Promise)return a.then(e=>{if(!e){let e=eg(t,n),a=e.fatal??r??!0;i.addIssue({code:"custom",...e,fatal:a})}});if(!a){let e=eg(t,n),a=e.fatal??r??!0;i.addIssue({code:"custom",...e,fatal:a})}}):F.create()}r.ZodReadonly=em,em.create=(e,t)=>new em({innerType:e,typeName:n.ZodReadonly,...p(t)}),r.late={object:K.lazycreate},function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(n||(r.ZodFirstPartyTypeKind=n={})),r.instanceof=(e,t={message:`Input not instance of ${e.name}`})=>ey(t=>t instanceof e,t);let eb=x.create;r.string=eb;let e_=$.create;r.number=e_,r.nan=ep.create,r.bigint=N.create;let ev=R.create;r.boolean=ev,r.date=M.create,r.symbol=D.create,r.undefined=L.create,r.null=U.create,r.any=F.create,r.unknown=z.create,r.never=B.create,r.void=G.create,r.array=Z.create,r.object=K.create,r.strictObject=K.strictCreate,r.union=V.create,r.discriminatedUnion=W.create,r.intersection=q.create,r.tuple=J.create,r.record=Y.create,r.map=Q.create,r.set=X.create,r.function=ee.create,r.lazy=et.create,r.literal=er.create,r.enum=ei.create,r.nativeEnum=ea.create,r.promise=es.create;let ew=eo.create;r.effect=ew,r.transformer=ew,r.optional=el.create,r.nullable=eu.create,r.preprocess=eo.createWithPreprocess,r.pipeline=ef.create,r.ostring=()=>eb().optional(),r.onumber=()=>e_().optional(),r.oboolean=()=>ev().optional(),r.coerce={string:e=>x.create({...e,coerce:!0}),number:e=>$.create({...e,coerce:!0}),boolean:e=>R.create({...e,coerce:!0}),bigint:e=>N.create({...e,coerce:!0}),date:e=>M.create({...e,coerce:!0})},r.NEVER=l.INVALID},29302,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(81754),r),i(e.r(49552),r),i(e.r(43825),r),i(e.r(49852),r),i(e.r(90386),r),i(e.r(48372),r)},32770,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.z=void 0;let o=a(e.r(29302));r.z=o,s(e.r(29302),r),r.default=o},38047,(e,t,r)=>{function n(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}t.exports=n,n.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},n.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},n.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(void 0===r)if(!this._cachedTimeouts)return!1;else this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0},n.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},n.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},n.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},n.prototype.start=n.prototype.try,n.prototype.errors=function(){return this._errors},n.prototype.attempts=function(){return this._attempts},n.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],a=i.message,s=(e[a]||0)+1;e[a]=s,s>=r&&(t=i,r=s)}return t}},18263,(e,t,r)=>{var n=e.r(38047);r.operation=function(e){return new n(r.timeouts(e),{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},r.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw Error("minTimeout is greater than maxTimeout");for(var n=[],i=0;i<t.retries;i++)n.push(this.createTimeout(i,t));return e&&e.forever&&!n.length&&n.push(this.createTimeout(i,t)),n.sort(function(e,t){return e-t}),n},r.createTimeout=function(e,t){var r=Math.round((t.randomize?Math.random()+1:1)*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return Math.min(r,t.maxTimeout)},r.wrap=function(e,t,n){if(t instanceof Array&&(n=t,t=null),!n)for(var i in n=[],e)"function"==typeof e[i]&&n.push(i);for(var a=0;a<n.length;a++){var s=n[a],o=e[s];e[s]=(function(n){var i=r.operation(t),a=Array.prototype.slice.call(arguments,1),s=a.pop();a.push(function(e){i.retry(e)||(e&&(arguments[0]=i.mainError()),s.apply(this,arguments))}),i.attempt(function(){n.apply(e,a)})}).bind(e,o),e[s].options=t}}},74167,(e,t,r)=>{t.exports=e.r(18263)},36850,(e,t,r)=>{"use strict";let n=e.r(74167),i=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class a extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}let s=(e,t)=>new Promise((r,s)=>{t={onFailedAttempt:()=>{},retries:10,...t};let o=n.operation(t);o.attempt(async n=>{try{r(await e(n))}catch(e){if(!(e instanceof Error))return void s(TypeError(`Non-error was thrown: "${e}". You should only throw errors.`));if(e instanceof a)o.stop(),s(e.originalError);else{let r;if(e instanceof TypeError&&(r=e.message,!i.includes(r)))o.stop(),s(e);else{((e,t,r)=>{let n=r.retries-(t-1);return e.attemptNumber=t,e.retriesLeft=n})(e,n,t);try{await t.onFailedAttempt(e)}catch(e){s(e);return}o.retry(e)||s(o.mainError())}}}})});t.exports=s,t.exports.default=s,t.exports.AbortError=a},66680,(e,t,r)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},79403,e=>{"use strict";let t,r;e.s(["MAX",()=>n,"NIL",()=>i,"parse",()=>o,"stringify",()=>c,"v1",()=>y,"v1ToV6",()=>b,"v3",()=>v,"v4",()=>O,"v5",()=>P,"v6",()=>S,"v6ToV1",()=>E,"v7",()=>T,"validate",()=>s,"version",()=>C],79403),e.s([],55276),e.i(55276);let n="ffffffff-ffff-ffff-ffff-ffffffffffff",i="00000000-0000-0000-0000-000000000000",a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i,s=function(e){return"string"==typeof e&&a.test(e)},o=function(e){let t;if(!s(e))throw TypeError("Invalid UUID");let r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/0x10000000000&255,r[11]=t/0x100000000&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r},l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));function u(e,t=0){return(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase()}let c=function(e,t=0){let r=u(e,t);if(!s(r))throw TypeError("Stringified UUID is invalid");return r};var d=e.i(66680);let p=new Uint8Array(256),h=p.length;function f(){return h>p.length-16&&(d.default.randomFillSync(p),h=0),p.slice(h,h+=16)}let m=0,g=0,y=function(e,n,i){let a=n&&i||0,s=n||Array(16),o=(e=e||{}).node,l=e.clockseq;if(e._v6||(o||(o=t),null==l&&(l=r)),null==o||null==l){let n=e.random||(e.rng||f)();null==o&&(o=[n[0],n[1],n[2],n[3],n[4],n[5]],t||e._v6||(o[0]|=1,t=o)),null==l&&(l=(n[6]<<8|n[7])&16383,void 0!==r||e._v6||(r=l))}let c=void 0!==e.msecs?e.msecs:Date.now(),d=void 0!==e.nsecs?e.nsecs:g+1,p=c-m+(d-g)/1e4;if(p<0&&void 0===e.clockseq&&(l=l+1&16383),(p<0||c>m)&&void 0===e.nsecs&&(d=0),d>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");m=c,g=d,r=l;let h=((0xfffffff&(c+=122192928e5))*1e4+d)%0x100000000;s[a++]=h>>>24&255,s[a++]=h>>>16&255,s[a++]=h>>>8&255,s[a++]=255&h;let y=c/0x100000000*1e4&0xfffffff;s[a++]=y>>>8&255,s[a++]=255&y,s[a++]=y>>>24&15|16,s[a++]=y>>>16&255,s[a++]=l>>>8|128,s[a++]=255&l;for(let e=0;e<6;++e)s[a+e]=o[e];return n||u(s)};function b(e){let t=function(e,t=!1){return Uint8Array.of((15&e[6])<<4|e[7]>>4&15,(15&e[7])<<4|(240&e[4])>>4,(15&e[4])<<4|(240&e[5])>>4,(15&e[5])<<4|(240&e[0])>>4,(15&e[0])<<4|(240&e[1])>>4,(15&e[1])<<4|(240&e[2])>>4,96|15&e[2],e[3],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}("string"==typeof e?o(e):e);return"string"==typeof e?u(t):t}function _(e,t,r){function n(e,n,i,a){var s;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=o(n)),(null==(s=n)?void 0:s.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+e.length);if(l.set(n),l.set(e,n.length),(l=r(l))[6]=15&l[6]|t,l[8]=63&l[8]|128,i){a=a||0;for(let e=0;e<16;++e)i[a+e]=l[e];return i}return u(l)}try{n.name=e}catch(e){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}let v=_("v3",48,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),d.default.createHash("md5").update(e).digest()}),w={randomUUID:d.default.randomUUID},O=function(e,t,r){if(w.randomUUID&&!t&&!e)return w.randomUUID();let n=(e=e||{}).random||(e.rng||f)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return u(n)},P=_("v5",80,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),d.default.createHash("sha1").update(e).digest()});function S(e={},t,r=0){let n=y({...e,_v6:!0},new Uint8Array(16));if(n=b(n),t){for(let e=0;e<16;e++)t[r+e]=n[e];return t}return u(n)}function E(e){var t;let r=(t="string"==typeof e?o(e):e,Uint8Array.of((15&t[3])<<4|t[4]>>4&15,(15&t[4])<<4|(240&t[5])>>4,(15&t[5])<<4|15&t[6],t[7],(15&t[1])<<4|(240&t[2])>>4,(15&t[2])<<4|(240&t[3])>>4,16|(240&t[0])>>4,(15&t[0])<<4|(240&t[1])>>4,t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]));return"string"==typeof e?u(r):r}let k=null,I=null,A=0,T=function(e,t,r){e=e||{};let n=t&&r||0,i=t||new Uint8Array(16),a=e.random||(e.rng||f)(),s=void 0!==e.msecs?e.msecs:Date.now(),o=void 0!==e.seq?e.seq:null,l=I,c=k;return s>A&&void 0===e.msecs&&(A=s,null!==o&&(l=null,c=null)),null!==o&&(o>0x7fffffff&&(o=0x7fffffff),l=o>>>19&4095,c=524287&o),(null===l||null===c)&&(l=(l=127&a[6])<<8|a[7],c=(c=(c=63&a[8])<<8|a[9])<<5|a[10]>>>3),s+1e4>A&&null===o?++c>524287&&(c=0,++l>4095&&(l=0,A++)):A=s,I=l,k=c,i[n++]=A/0x10000000000&255,i[n++]=A/0x100000000&255,i[n++]=A/0x1000000&255,i[n++]=A/65536&255,i[n++]=A/256&255,i[n++]=255&A,i[n++]=l>>>4&15|112,i[n++]=255&l,i[n++]=c>>>13&63|128,i[n++]=c>>>5&255,i[n++]=c<<3&255|7&a[10],i[n++]=a[11],i[n++]=a[12],i[n++]=a[13],i[n++]=a[14],i[n++]=a[15],t||u(i)},C=function(e){if(!s(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},74641,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ROOT=r.AsyncLocalStorageProviderSingleton=void 0,r.getCurrentRunTree=function(e=!1){let t=r.AsyncLocalStorageProviderSingleton.getInstance().getStore();if(!e&&void 0===t)throw Error("Could not get the current run tree.\n\nPlease make sure you are calling this method within a traceable function and that tracing is enabled.");return t},r.withRunTree=function(e,t){let n=r.AsyncLocalStorageProviderSingleton.getInstance();return new Promise((r,i)=>{n.run(e,()=>void Promise.resolve(t()).then(r).catch(i))})},r.isTraceableFunction=function(e){return"function"==typeof e&&"langsmith:traceable"in e};let n=Symbol.for("ls:tracing_async_local_storage"),i=new class{getStore(){}run(e,t){return t()}};r.AsyncLocalStorageProviderSingleton=new class{getInstance(){return globalThis[n]??i}initializeGlobalInstance(e){void 0===globalThis[n]&&(globalThis[n]=e)}},r.ROOT=Symbol.for("langsmith:traceable:root")},65740,(e,t,r)=>{t.exports=e.r(74641)},56339,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PatchError=void 0,r.hasOwnProperty=i,r._objectKeys=a,r._deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},r.isInteger=function(e){let t,r=0,n=e.length;for(;r<n;){if((t=e.charCodeAt(r))>=48&&t<=57){r++;continue}return!1}return!0},r.escapePathComponent=s,r.unescapePathComponent=function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")},r._getPathRecursive=o,r.getPath=function(e,t){if(e===t)return"/";let r=o(e,t);if(""===r)throw Error("Object not found in root");return`/${r}`},r.hasUndefined=function e(t){if(void 0===t)return!0;if(t){if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(e(t[r]))return!0}else if("object"==typeof t){let n=a(t),i=n.length;for(var r=0;r<i;r++)if(e(t[n[r]]))return!0}}return!1};let n=Object.prototype.hasOwnProperty;function i(e,t){return n.call(e,t)}function a(e){if(Array.isArray(e)){let t=Array(e.length);for(let e=0;e<t.length;e++)t[e]=""+e;return t}if(Object.keys)return Object.keys(e);let t=[];for(let r in e)i(e,r)&&t.push(r);return t}function s(e){return -1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function o(e,t){let r;for(let n in e)if(i(e,n)){if(e[n]===t)return s(n)+"/";else if("object"==typeof e[n]&&""!=(r=o(e[n],t)))return s(n)+"/"+r}return""}function l(e,t){let r=[e];for(let e in t){let n="object"==typeof t[e]?JSON.stringify(t[e],null,2):t[e];void 0!==n&&r.push(`${e}: ${n}`)}return r.join("\n")}r.PatchError=class extends Error{constructor(e,t,r,n,i){super(l(e,{name:t,index:r,operation:n,tree:i})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.setPrototypeOf(this,new.target.prototype),this.message=l(e,{name:t,index:r,operation:n,tree:i})}}},44374,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deepClone=r.JsonPatchError=void 0,r.getValueByPointer=s,r.applyOperation=o,r.applyPatch=l,r.applyReducer=function(e,t,n){let i=o(e,t);if(!1===i.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument},r.validator=u,r.validate=c,r._areEquals=d;let n=e.r(56339);r.JsonPatchError=n.PatchError,r.deepClone=n._deepClone;let i={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){let i=s(r,this.path);i&&(i=(0,n._deepClone)(i));let a=o(r,{op:"remove",path:this.from}).removed;return o(r,{op:"add",path:this.path,value:a}),{newDocument:r,removed:i}},copy:function(e,t,r){let i=s(r,this.from);return o(r,{op:"add",path:this.path,value:(0,n._deepClone)(i)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:d(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}};var a={add:function(e,t,r){return(0,n.isInteger)(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:i.move,copy:i.copy,test:i.test,_get:i._get};function s(e,t){if(""==t)return e;var r={op:"_get",path:t};return o(e,r),r.value}function o(e,t,l=!1,c=!0,p=!0,h=0){if(l&&("function"==typeof l?l(t,0,e,t.path):u(t,0)),""===t.path){let n={newDocument:e};if("add"===t.op)return n.newDocument=t.value,n;if("replace"===t.op)return n.newDocument=t.value,n.removed=e,n;if("move"===t.op||"copy"===t.op)return n.newDocument=s(e,t.from),"move"===t.op&&(n.removed=e),n;else if("test"===t.op){if(n.test=d(e,t.value),!1===n.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",h,t,e);return n.newDocument=e,n}else if("remove"===t.op)return n.removed=e,n.newDocument=null,n;else if("_get"===t.op)return t.value=e,n;else if(!l)return n;else throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",h,t,e)}{let s,o,d;c||(e=(0,n._deepClone)(e));let f=(t.path||"").split("/"),m=e,g=1,y=f.length;for(o="function"==typeof l?l:u;;){if((s=f[g])&&-1!=s.indexOf("~")&&(s=(0,n.unescapePathComponent)(s)),p&&("__proto__"==s||"prototype"==s&&g>0&&"constructor"==f[g-1]))throw TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(l&&void 0===d&&(void 0===m[s]?d=f.slice(0,g).join("/"):g==y-1&&(d=t.path),void 0!==d&&o(t,0,e,d)),g++,Array.isArray(m)){if("-"===s)s=m.length;else if(l&&!(0,n.isInteger)(s))throw new r.JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",h,t,e);else(0,n.isInteger)(s)&&(s=~~s);if(g>=y){if(l&&"add"===t.op&&s>m.length)throw new r.JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",h,t,e);let n=a[t.op].call(t,m,s,e);if(!1===n.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",h,t,e);return n}}else if(g>=y){let n=i[t.op].call(t,m,s,e);if(!1===n.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",h,t,e);return n}if(m=m[s],l&&g<y&&(!m||"object"!=typeof m))throw new r.JsonPatchError("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",h,t,e)}}}function l(e,t,i,a=!0,s=!0){if(i&&!Array.isArray(t))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");a||(e=(0,n._deepClone)(e));let u=Array(t.length);for(let r=0,n=t.length;r<n;r++)u[r]=o(e,t[r],i,!0,s,r),e=u[r].newDocument;return u.newDocument=e,u}function u(e,t,a,s){if("object"!=typeof e||null===e||Array.isArray(e))throw new r.JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,a);if(i[e.op]){if("string"!=typeof e.path)throw new r.JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,a);else if(0!==e.path.indexOf("/")&&e.path.length>0)throw new r.JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,a);else if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new r.JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,a);else if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,a);else if(("add"===e.op||"replace"===e.op||"test"===e.op)&&(0,n.hasUndefined)(e.value))throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,a);else if(a){if("add"==e.op){var o=e.path.split("/").length,l=s.split("/").length;if(o!==l+1&&o!==l)throw new r.JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,a)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==s)throw new r.JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,a)}else if("move"===e.op||"copy"===e.op){var u=c([{op:"_get",path:e.from,value:void 0}],a);if(u&&"OPERATION_PATH_UNRESOLVABLE"===u.name)throw new r.JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,a)}}}else throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,a)}function c(e,t,i){try{if(!Array.isArray(e))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)l((0,n._deepClone)(t),(0,n._deepClone)(e),i||!0);else{i=i||u;for(var a=0;a<e.length;a++)i(e[a],a,t,void 0)}}catch(e){if(e instanceof r.JsonPatchError)return e;throw e}}function d(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,n,i,a=Array.isArray(e),s=Array.isArray(t);if(a&&s){if((n=e.length)!=t.length)return!1;for(r=n;0!=r--;)if(!d(e[r],t[r]))return!1;return!0}if(a!=s)return!1;var o=Object.keys(e);if((n=o.length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!t.hasOwnProperty(o[r]))return!1;for(r=n;0!=r--;)if(!d(e[i=o[r]],t[i]))return!1;return!0}return e!=e&&t!=t}},50335,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.unobserve=function(e,t){t.unobserve()},r.observe=function(e,t){var r,i=a.get(e);if(i){let e=i.observers.get(t);r=e&&e.observer}else i=new s(e),a.set(e,i);return r||(r={},i.value=(0,n._deepClone)(e),t&&(r.callback=t,r.next=null),r.patches=[],r.object=e,r.unobserve=()=>{var e,t;l(r),clearTimeout(r.next),e=i,t=r,e.observers.delete(t.callback)},i.observers.set(t,new o(t,r))),r},r.generate=l,r.compare=function(e,t,r=!1){var n=[];return u(e,t,n,"",r),n};let n=e.r(56339),i=e.r(44374);var a=new WeakMap;class s{constructor(e){Object.defineProperty(this,"obj",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observers",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.obj=e}}class o{constructor(e,t){Object.defineProperty(this,"callback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callback=e,this.observer=t}}function l(e,t=!1){var r=a.get(e.object);u(r.value,e.object,e.patches,"",t),e.patches.length&&(0,i.applyPatch)(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function u(e,t,r,i,a){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var s=(0,n._objectKeys)(t),o=(0,n._objectKeys)(e),l=!1,c=o.length-1;c>=0;c--){var d=o[c],p=e[d];if((0,n.hasOwnProperty)(t,d)&&(void 0!==t[d]||void 0===p||!1!==Array.isArray(t))){var h=t[d];"object"==typeof p&&null!=p&&"object"==typeof h&&null!=h&&Array.isArray(p)===Array.isArray(h)?u(p,h,r,i+"/"+(0,n.escapePathComponent)(d),a):p!==h&&(a&&r.push({op:"test",path:i+"/"+(0,n.escapePathComponent)(d),value:(0,n._deepClone)(p)}),r.push({op:"replace",path:i+"/"+(0,n.escapePathComponent)(d),value:(0,n._deepClone)(h)}))}else Array.isArray(e)===Array.isArray(t)?(a&&r.push({op:"test",path:i+"/"+(0,n.escapePathComponent)(d),value:(0,n._deepClone)(p)}),r.push({op:"remove",path:i+"/"+(0,n.escapePathComponent)(d)}),l=!0):(a&&r.push({op:"test",path:i,value:e}),r.push({op:"replace",path:i,value:t}))}if(l||s.length!=o.length)for(var c=0;c<s.length;c++){var d=s[c];(0,n.hasOwnProperty)(e,d)||void 0===t[d]||r.push({op:"add",path:i+"/"+(0,n.escapePathComponent)(d),value:(0,n._deepClone)(t[d])})}}}},10539,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},s=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),s=0;s<a.length;s++)"default"!==a[s]&&n(r,t,a[s]);return i(r,t),r}}();Object.defineProperty(r,"__esModule",{value:!0}),r.unescapePathComponent=r.escapePathComponent=r.deepClone=r.JsonPatchError=void 0,a(e.r(44374),r),a(e.r(50335),r);var o=e.r(56339);Object.defineProperty(r,"JsonPatchError",{enumerable:!0,get:function(){return o.PatchError}}),Object.defineProperty(r,"deepClone",{enumerable:!0,get:function(){return o._deepClone}}),Object.defineProperty(r,"escapePathComponent",{enumerable:!0,get:function(){return o.escapePathComponent}}),Object.defineProperty(r,"unescapePathComponent",{enumerable:!0,get:function(){return o.unescapePathComponent}});let l=s(e.r(44374)),u=e.r(56339);r.default={...l,JsonPatchError:u.PatchError,deepClone:u._deepClone,escapePathComponent:u.escapePathComponent,unescapePathComponent:u.unescapePathComponent}},47059,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AI_SDK_TOOL_OPERATIONS=r.AI_SDK_LLM_OPERATIONS=r.GEN_AI_CHOICE=r.GEN_AI_ASSISTANT_MESSAGE=r.GEN_AI_USER_MESSAGE=r.GEN_AI_SYSTEM_MESSAGE=r.LANGSMITH_TRACEABLE_PARENT_OTEL_SPAN_ID=r.LANGSMITH_IS_ROOT=r.LANGSMITH_TRACEABLE=r.LANGSMITH_REFERENCE_EXAMPLE_ID=r.LANGSMITH_USAGE_METADATA=r.LANGSMITH_PARENT_RUN_ID=r.LANGSMITH_DOTTED_ORDER=r.LANGSMITH_TRACE_ID=r.LANGSMITH_RUN_ID=r.LANGSMITH_REQUEST_HEADERS=r.LANGSMITH_REQUEST_STREAMING=r.LANGSMITH_RUNTIME=r.LANGSMITH_TAGS=r.LANGSMITH_METADATA=r.LANGSMITH_NAME=r.LANGSMITH_RUN_TYPE=r.LANGSMITH_SESSION_NAME=r.LANGSMITH_SESSION_ID=r.GEN_AI_USAGE_OUTPUT_TOKEN_DETAILS=r.GEN_AI_USAGE_INPUT_TOKEN_DETAILS=r.GEN_AI_RESPONSE_SYSTEM_FINGERPRINT=r.GEN_AI_RESPONSE_SERVICE_TIER=r.GEN_AI_RESPONSE_ID=r.GEN_AI_SERIALIZED_DOC=r.GEN_AI_SERIALIZED_SIGNATURE=r.GEN_AI_SERIALIZED_NAME=r.GEN_AI_REQUEST_EXTRA_BODY=r.GEN_AI_REQUEST_EXTRA_QUERY=r.GENAI_COMPLETION=r.GENAI_PROMPT=r.GEN_AI_RESPONSE_FINISH_REASONS=r.GEN_AI_REQUEST_PRESENCE_PENALTY=r.GEN_AI_REQUEST_FREQUENCY_PENALTY=r.GEN_AI_REQUEST_TOP_P=r.GEN_AI_REQUEST_TEMPERATURE=r.GEN_AI_REQUEST_MAX_TOKENS=r.GEN_AI_USAGE_TOTAL_TOKENS=r.GEN_AI_USAGE_OUTPUT_TOKENS=r.GEN_AI_USAGE_INPUT_TOKENS=r.GEN_AI_RESPONSE_MODEL=r.GEN_AI_REQUEST_MODEL=r.GEN_AI_SYSTEM=r.GEN_AI_OPERATION_NAME=void 0,r.GEN_AI_OPERATION_NAME="gen_ai.operation.name",r.GEN_AI_SYSTEM="gen_ai.system",r.GEN_AI_REQUEST_MODEL="gen_ai.request.model",r.GEN_AI_RESPONSE_MODEL="gen_ai.response.model",r.GEN_AI_USAGE_INPUT_TOKENS="gen_ai.usage.input_tokens",r.GEN_AI_USAGE_OUTPUT_TOKENS="gen_ai.usage.output_tokens",r.GEN_AI_USAGE_TOTAL_TOKENS="gen_ai.usage.total_tokens",r.GEN_AI_REQUEST_MAX_TOKENS="gen_ai.request.max_tokens",r.GEN_AI_REQUEST_TEMPERATURE="gen_ai.request.temperature",r.GEN_AI_REQUEST_TOP_P="gen_ai.request.top_p",r.GEN_AI_REQUEST_FREQUENCY_PENALTY="gen_ai.request.frequency_penalty",r.GEN_AI_REQUEST_PRESENCE_PENALTY="gen_ai.request.presence_penalty",r.GEN_AI_RESPONSE_FINISH_REASONS="gen_ai.response.finish_reasons",r.GENAI_PROMPT="gen_ai.prompt",r.GENAI_COMPLETION="gen_ai.completion",r.GEN_AI_REQUEST_EXTRA_QUERY="gen_ai.request.extra_query",r.GEN_AI_REQUEST_EXTRA_BODY="gen_ai.request.extra_body",r.GEN_AI_SERIALIZED_NAME="gen_ai.serialized.name",r.GEN_AI_SERIALIZED_SIGNATURE="gen_ai.serialized.signature",r.GEN_AI_SERIALIZED_DOC="gen_ai.serialized.doc",r.GEN_AI_RESPONSE_ID="gen_ai.response.id",r.GEN_AI_RESPONSE_SERVICE_TIER="gen_ai.response.service_tier",r.GEN_AI_RESPONSE_SYSTEM_FINGERPRINT="gen_ai.response.system_fingerprint",r.GEN_AI_USAGE_INPUT_TOKEN_DETAILS="gen_ai.usage.input_token_details",r.GEN_AI_USAGE_OUTPUT_TOKEN_DETAILS="gen_ai.usage.output_token_details",r.LANGSMITH_SESSION_ID="langsmith.trace.session_id",r.LANGSMITH_SESSION_NAME="langsmith.trace.session_name",r.LANGSMITH_RUN_TYPE="langsmith.span.kind",r.LANGSMITH_NAME="langsmith.trace.name",r.LANGSMITH_METADATA="langsmith.metadata",r.LANGSMITH_TAGS="langsmith.span.tags",r.LANGSMITH_RUNTIME="langsmith.span.runtime",r.LANGSMITH_REQUEST_STREAMING="langsmith.request.streaming",r.LANGSMITH_REQUEST_HEADERS="langsmith.request.headers",r.LANGSMITH_RUN_ID="langsmith.span.id",r.LANGSMITH_TRACE_ID="langsmith.trace.id",r.LANGSMITH_DOTTED_ORDER="langsmith.span.dotted_order",r.LANGSMITH_PARENT_RUN_ID="langsmith.span.parent_id",r.LANGSMITH_USAGE_METADATA="langsmith.usage_metadata",r.LANGSMITH_REFERENCE_EXAMPLE_ID="langsmith.reference_example_id",r.LANGSMITH_TRACEABLE="langsmith.traceable",r.LANGSMITH_IS_ROOT="langsmith.is_root",r.LANGSMITH_TRACEABLE_PARENT_OTEL_SPAN_ID="langsmith.traceable_parent_otel_span_id",r.GEN_AI_SYSTEM_MESSAGE="gen_ai.system.message",r.GEN_AI_USER_MESSAGE="gen_ai.user.message",r.GEN_AI_ASSISTANT_MESSAGE="gen_ai.assistant.message",r.GEN_AI_CHOICE="gen_ai.choice",r.AI_SDK_LLM_OPERATIONS=["ai.generateText.doGenerate","ai.streamText.doStream","ai.generateObject.doGenerate","ai.streamObject.doStream"],r.AI_SDK_TOOL_OPERATIONS=["ai.toolCall"]},78785,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r._getFetchImplementation=r._globalFetchImplementationIsNodeFetch=r.clearFetchImplementation=r.overrideFetchImplementation=void 0;let n=e.r(27081),i=Symbol.for("ls:fetch_implementation");r.overrideFetchImplementation=e=>{globalThis[i]=e},r.clearFetchImplementation=()=>{delete globalThis[i]},r._globalFetchImplementationIsNodeFetch=()=>{let e=globalThis[i];return!!e&&"function"==typeof e&&"Headers"in e&&"Request"in e&&"Response"in e},r._getFetchImplementation=e=>async(...t)=>{if(e||"true"===(0,n.getLangSmithEnvironmentVariable)("DEBUG")){let[e,r]=t;console.log(`â†’ ${r?.method||"GET"} ${e}`)}let r=await (globalThis[i]??((...e)=>fetch(...e)))(...t);return(e||"true"===(0,n.getLangSmithEnvironmentVariable)("DEBUG"))&&console.log(`â† ${r.status} ${r.statusText} ${r.url}`),r}},16770,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaultProjectName=void 0;let n=e.r(27081);r.getDefaultProjectName=()=>(0,n.getLangSmithEnvironmentVariable)("PROJECT")??(0,n.getEnvironmentVariable)("LANGCHAIN_SESSION")??"default"},64949,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.__version__=r.getDefaultProjectName=r.overrideFetchImplementation=r.RunTree=r.Client=void 0;var n=e.r(92913);Object.defineProperty(r,"Client",{enumerable:!0,get:function(){return n.Client}});var i=e.r(97175);Object.defineProperty(r,"RunTree",{enumerable:!0,get:function(){return i.RunTree}});var a=e.r(78785);Object.defineProperty(r,"overrideFetchImplementation",{enumerable:!0,get:function(){return a.overrideFetchImplementation}});var s=e.r(16770);Object.defineProperty(r,"getDefaultProjectName",{enumerable:!0,get:function(){return s.getDefaultProjectName}}),r.__version__="0.3.72"},27081,(e,t,r)=>{"use strict";let n,i,a;Object.defineProperty(r,"__esModule",{value:!0}),r.getEnv=r.isNode=r.isDeno=r.isJsDom=r.isWebWorker=r.isBrowser=void 0,r.getRuntimeEnvironment=function(){if(void 0===i){let e=(0,r.getEnv)(),t=c();i={library:"langsmith",runtime:e,sdk:"langsmith-js",sdk_version:s.__version__,...t}}return i},r.getLangChainEnvVars=function(){let e=o()||{},t={};for(let[r,n]of Object.entries(e))r.startsWith("LANGCHAIN_")&&"string"==typeof n&&(t[r]=n);for(let e in t)if((e.toLowerCase().includes("key")||e.toLowerCase().includes("secret")||e.toLowerCase().includes("token"))&&"string"==typeof t[e]){let r=t[e];t[e]=r.slice(0,2)+"*".repeat(r.length-4)+r.slice(-2)}return t},r.getLangChainEnvVarsMetadata=function(){let e=o()||{},t={},r=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(let[n,i]of Object.entries(e))(n.startsWith("LANGCHAIN_")||n.startsWith("LANGSMITH_"))&&"string"==typeof i&&!r.includes(n)&&!n.toLowerCase().includes("key")&&!n.toLowerCase().includes("secret")&&!n.toLowerCase().includes("token")&&("LANGCHAIN_REVISION_ID"===n?t.revision_id=i:t[n]=i);return t},r.getEnvironmentVariables=o,r.getEnvironmentVariable=l,r.getLangSmithEnvironmentVariable=u,r.setEnvironmentVariable=function(e,t){"undefined"!=typeof process&&(process.env[e]=t)},r.getShas=c,r.getOtelEnabled=function(){return"true"===l("OTEL_ENABLED")||"true"===u("OTEL_ENABLED")};let s=e.r(64949);function o(){try{if("undefined"!=typeof process&&process.env)return Object.entries(process.env).reduce((e,[t,r])=>(e[t]=String(r),e),{});return}catch(e){return}}function l(e){try{return"undefined"!=typeof process?process.env?.[e]:void 0}catch(e){return}}function u(e){return l(`LANGSMITH_${e}`)||l(`LANGCHAIN_${e}`)}function c(){if(void 0!==a)return a;let e={};for(let t of["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"]){let r=l(t);void 0!==r&&(e[t]=r)}return a=e,e}r.isBrowser=()=>!1,r.isWebWorker=()=>"object"==typeof globalThis&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name,r.isJsDom=()=>"undefined"!=typeof navigator&&navigator.userAgent.includes("jsdom"),r.isDeno=()=>"undefined"!=typeof Deno,r.isNode=()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node&&!(0,r.isDeno)(),r.getEnv=()=>n||(n="undefined"!=typeof Bun?"bun":(0,r.isBrowser)()?"browser":(0,r.isNode)()?"node":(0,r.isWebWorker)()?"webworker":(0,r.isJsDom)()?"jsdom":(0,r.isDeno)()?"deno":"other")},40594,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.OTELProviderSingleton=void 0,r.getOTELTrace=function(){return r.OTELProviderSingleton.getTraceInstance()},r.getOTELContext=function(){return r.OTELProviderSingleton.getContextInstance()},r.setOTELInstances=function(e){r.OTELProviderSingleton.initializeGlobalInstances(e)},r.setDefaultOTLPTracerComponents=function(e){r.OTELProviderSingleton.setDefaultOTLPTracerComponents(e)},r.getDefaultOTLPTracerComponents=function(){return r.OTELProviderSingleton.getDefaultOTLPTracerComponents()};let n=e.r(27081);class i{constructor(){Object.defineProperty(this,"hasWarned",{enumerable:!0,configurable:!0,writable:!0,value:!1})}startActiveSpan(e,...t){let r;if(!this.hasWarned&&(0,n.getOtelEnabled)()&&(console.warn('You have enabled OTEL export via the `OTEL_ENABLED` or `LANGSMITH_OTEL_ENABLED` environment variable, but have not initialized the required OTEL instances. Please add:\n```\nimport { initializeOTEL } from "langsmith/experimental/otel/setup";\ninitializeOTEL();\n```\nat the beginning of your code.'),this.hasWarned=!0),1===t.length&&"function"==typeof t[0]?r=t[0]:2===t.length&&"function"==typeof t[1]?r=t[1]:3===t.length&&"function"==typeof t[2]&&(r=t[2]),"function"==typeof r)return r()}}let a=Symbol.for("ls:otel_trace"),s=Symbol.for("ls:otel_context"),o=Symbol.for("ls:otel_get_default_otlp_tracer_provider"),l=new class{constructor(){Object.defineProperty(this,"mockTracer",{enumerable:!0,configurable:!0,writable:!0,value:new i})}getTracer(e,t){return this.mockTracer}getActiveSpan(){}setSpan(e,t){return e}getSpan(e){}setSpanContext(e,t){return e}getTracerProvider(){}setGlobalTracerProvider(e){return!1}},u=new class{active(){return{}}with(e,t){return t()}};r.OTELProviderSingleton=new class{getTraceInstance(){return globalThis[a]??l}getContextInstance(){return globalThis[s]??u}initializeGlobalInstances(e){void 0===globalThis[a]&&(globalThis[a]=e.trace),void 0===globalThis[s]&&(globalThis[s]=e.context)}setDefaultOTLPTracerComponents(e){globalThis[o]=e}getDefaultOTLPTracerComponents(){return globalThis[o]??void 0}}},55549,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),s=0;s<a.length;s++)"default"!==a[s]&&n(r,t,a[s]);return i(r,t),r}}();Object.defineProperty(r,"__esModule",{value:!0}),r.LangSmithToOTELTranslator=void 0;let s=a(e.r(47059)),o=e.r(40594),l={llm:"chat",tool:"execute_tool",retriever:"embeddings",embedding:"embeddings",prompt:"chat"};r.LangSmithToOTELTranslator=class{constructor(){Object.defineProperty(this,"spans",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}exportBatch(e,t){for(let r of e)try{if(!r.run)continue;if("post"===r.operation){let e=this.createSpanForRun(r,r.run,t.get(r.id));e&&!r.run.end_time&&this.spans.set(r.id,e)}else this.updateSpanForRun(r,r.run)}catch(e){console.error(`Error processing operation ${r.id}:`,e)}}createSpanForRun(e,t,r){let n=r&&(0,o.getOTELTrace)().getSpan(r);if(n)try{return this.finishSpanSetup(n,t,e)}catch(t){console.error(`Failed to create span for run ${e.id}:`,t);return}}finishSpanSetup(e,t,r){return this.setSpanAttributes(e,t,r),t.error?(e.setStatus({code:2}),e.recordException(Error(t.error))):e.setStatus({code:1}),t.end_time&&e.end(new Date(t.end_time)),e}updateSpanForRun(e,t){try{let r=this.spans.get(e.id);if(!r)return void console.debug(`No span found for run ${e.id} during update`);this.setSpanAttributes(r,t,e),t.error?(r.setStatus({code:2}),r.recordException(Error(t.error))):r.setStatus({code:1});let n=t.end_time;n&&(r.end(new Date(n)),this.spans.delete(e.id))}catch(t){console.error(`Failed to update span for run ${e.id}:`,t)}}extractModelName(e){if(e.extra?.metadata){let t=e.extra.metadata;if(t.ls_model_name)return t.ls_model_name;if(t.invocation_params){let e=t.invocation_params;if(e.model)return e.model;if(e.model_name)return e.model_name}}}setSpanAttributes(e,t,r){if("run_type"in t&&t.run_type){var n;e.setAttribute(s.LANGSMITH_RUN_TYPE,t.run_type);let r=l[n=t.run_type||"chain"]||n;e.setAttribute(s.GEN_AI_OPERATION_NAME,r)}"name"in t&&t.name&&e.setAttribute(s.LANGSMITH_NAME,t.name),"session_id"in t&&t.session_id&&e.setAttribute(s.LANGSMITH_SESSION_ID,t.session_id),"session_name"in t&&t.session_name&&e.setAttribute(s.LANGSMITH_SESSION_NAME,t.session_name),this.setGenAiSystem(e,t);let i=this.extractModelName(t);for(let[r,n]of(i&&e.setAttribute(s.GEN_AI_REQUEST_MODEL,i),"prompt_tokens"in t&&"number"==typeof t.prompt_tokens&&e.setAttribute(s.GEN_AI_USAGE_INPUT_TOKENS,t.prompt_tokens),"completion_tokens"in t&&"number"==typeof t.completion_tokens&&e.setAttribute(s.GEN_AI_USAGE_OUTPUT_TOKENS,t.completion_tokens),"total_tokens"in t&&"number"==typeof t.total_tokens&&e.setAttribute(s.GEN_AI_USAGE_TOTAL_TOKENS,t.total_tokens),this.setInvocationParameters(e,t),Object.entries(t.extra?.metadata||{})))null!=n&&e.setAttribute(`${s.LANGSMITH_METADATA}.${r}`,String(n));let a=t.tags;if(a&&Array.isArray(a)?e.setAttribute(s.LANGSMITH_TAGS,a.join(", ")):a&&e.setAttribute(s.LANGSMITH_TAGS,String(a)),"serialized"in t&&"object"==typeof t.serialized){let r=t.serialized;r.name&&e.setAttribute(s.GEN_AI_SERIALIZED_NAME,String(r.name)),r.signature&&e.setAttribute(s.GEN_AI_SERIALIZED_SIGNATURE,String(r.signature)),r.doc&&e.setAttribute(s.GEN_AI_SERIALIZED_DOC,String(r.doc))}this.setIOAttributes(e,r)}setGenAiSystem(e,t){let r="langchain",n=this.extractModelName(t);if(n){let e=n.toLowerCase();e.includes("anthropic")||e.startsWith("claude")?r="anthropic":e.includes("bedrock")?r="aws.bedrock":e.includes("azure")&&e.includes("openai")?r="az.ai.openai":e.includes("azure")&&e.includes("inference")?r="az.ai.inference":e.includes("cohere")?r="cohere":e.includes("deepseek")?r="deepseek":e.includes("gemini")?r="gemini":e.includes("groq")?r="groq":e.includes("watson")||e.includes("ibm")?r="ibm.watsonx.ai":e.includes("mistral")?r="mistral_ai":e.includes("gpt")||e.includes("openai")?r="openai":e.includes("perplexity")||e.includes("sonar")?r="perplexity":e.includes("vertex")?r="vertex_ai":(e.includes("xai")||e.includes("grok"))&&(r="xai")}e.setAttribute(s.GEN_AI_SYSTEM,r)}setInvocationParameters(e,t){if(!t.extra?.metadata?.invocation_params)return;let r=t.extra.metadata.invocation_params;void 0!==r.max_tokens&&e.setAttribute(s.GEN_AI_REQUEST_MAX_TOKENS,r.max_tokens),void 0!==r.temperature&&e.setAttribute(s.GEN_AI_REQUEST_TEMPERATURE,r.temperature),void 0!==r.top_p&&e.setAttribute(s.GEN_AI_REQUEST_TOP_P,r.top_p),void 0!==r.frequency_penalty&&e.setAttribute(s.GEN_AI_REQUEST_FREQUENCY_PENALTY,r.frequency_penalty),void 0!==r.presence_penalty&&e.setAttribute(s.GEN_AI_REQUEST_PRESENCE_PENALTY,r.presence_penalty)}setIOAttributes(e,t){if(t.run.inputs)try{let r=t.run.inputs;"object"==typeof r&&null!==r&&(r.model&&Array.isArray(r.messages)&&e.setAttribute(s.GEN_AI_REQUEST_MODEL,r.model),void 0!==r.stream&&e.setAttribute(s.LANGSMITH_REQUEST_STREAMING,r.stream),r.extra_headers&&e.setAttribute(s.LANGSMITH_REQUEST_HEADERS,JSON.stringify(r.extra_headers)),r.extra_query&&e.setAttribute(s.GEN_AI_REQUEST_EXTRA_QUERY,JSON.stringify(r.extra_query)),r.extra_body&&e.setAttribute(s.GEN_AI_REQUEST_EXTRA_BODY,JSON.stringify(r.extra_body))),e.setAttribute(s.GENAI_PROMPT,JSON.stringify(r))}catch(e){console.debug(`Failed to process inputs for run ${t.id}`,e)}if(t.run.outputs)try{let r=t.run.outputs,n=this.getUnifiedRunTokens(r);if(n&&(e.setAttribute(s.GEN_AI_USAGE_INPUT_TOKENS,n[0]),e.setAttribute(s.GEN_AI_USAGE_OUTPUT_TOKENS,n[1]),e.setAttribute(s.GEN_AI_USAGE_TOTAL_TOKENS,n[0]+n[1])),r&&"object"==typeof r){if(r.model&&e.setAttribute(s.GEN_AI_RESPONSE_MODEL,String(r.model)),r.id&&e.setAttribute(s.GEN_AI_RESPONSE_ID,r.id),r.choices&&Array.isArray(r.choices)){let t=r.choices.map(e=>e.finish_reason).filter(e=>e).map(String);t.length>0&&e.setAttribute(s.GEN_AI_RESPONSE_FINISH_REASONS,t.join(", "))}if(r.service_tier&&e.setAttribute(s.GEN_AI_RESPONSE_SERVICE_TIER,r.service_tier),r.system_fingerprint&&e.setAttribute(s.GEN_AI_RESPONSE_SYSTEM_FINGERPRINT,r.system_fingerprint),r.usage_metadata&&"object"==typeof r.usage_metadata){let t=r.usage_metadata;t.input_token_details&&e.setAttribute(s.GEN_AI_USAGE_INPUT_TOKEN_DETAILS,JSON.stringify(t.input_token_details)),t.output_token_details&&e.setAttribute(s.GEN_AI_USAGE_OUTPUT_TOKEN_DETAILS,JSON.stringify(t.output_token_details))}}e.setAttribute(s.GENAI_COMPLETION,JSON.stringify(r))}catch(e){console.debug(`Failed to process outputs for run ${t.id}`,e)}}getUnifiedRunTokens(e){if(!e)return null;let t=this.extractUnifiedRunTokens(e.usage_metadata);if(t)return t;for(let r of Object.keys(e)){let n=e[r];if(n&&"object"==typeof n&&((t=this.extractUnifiedRunTokens(n.usage_metadata))||1===n.lc&&n.kwargs&&"object"==typeof n.kwargs&&(t=this.extractUnifiedRunTokens(n.kwargs.usage_metadata))))return t}let r=e.generations||[];if(!Array.isArray(r))return null;for(let e of Array.isArray(r[0])?r.flat():r)if("object"==typeof e&&e.message&&"object"==typeof e.message&&e.message.kwargs&&"object"==typeof e.message.kwargs&&(t=this.extractUnifiedRunTokens(e.message.kwargs.usage_metadata)))return t;return null}extractUnifiedRunTokens(e){return e&&"object"==typeof e&&"number"==typeof e.input_tokens&&"number"==typeof e.output_tokens?[e.input_tokens,e.output_tokens]:null}}},48271,(e,t,r)=>{"use strict";var n=Object.prototype.hasOwnProperty,i="~";function a(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,r,n,a){if("function"!=typeof r)throw TypeError("The listener must be a function");var o=new s(r,n||e,a),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function u(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(i=!1)),u.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},u.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,a=r.length,s=Array(a);n<a;n++)s[n]=r[n].fn;return s},u.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},u.prototype.emit=function(e,t,r,n,a,s){var o=i?i+e:e;if(!this._events[o])return!1;var l,u,c=this._events[o],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,n),!0;case 5:return c.fn.call(c.context,t,r,n,a),!0;case 6:return c.fn.call(c.context,t,r,n,a,s),!0}for(u=1,l=Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var p,h=c.length;for(u=0;u<h;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,n);break;default:if(!l)for(p=1,l=Array(d-1);p<d;p++)l[p-1]=arguments[p];c[u].fn.apply(c[u].context,l)}}return!0},u.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,r,n){var a=i?i+e:e;if(!this._events[a])return this;if(!t)return l(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||n&&!s.once||r&&s.context!==r||l(this,a);else{for(var o=0,u=[],c=s.length;o<c;o++)(s[o].fn!==t||n&&!s[o].once||r&&s[o].context!==r)&&u.push(s[o]);u.length?this._events[a]=1===u.length?u[0]:u:l(this,a)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&l(this,t)):(this._events=new a,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,t.exports=u},52933,(e,t,r)=>{"use strict";t.exports=(e,t)=>(t=t||(()=>{}),e.then(e=>new Promise(e=>{e(t())}).then(()=>e),e=>new Promise(e=>{e(t())}).then(()=>{throw e})))},76469,(e,t,r)=>{"use strict";let n=e.r(52933);class i extends Error{constructor(e){super(e),this.name="TimeoutError"}}let a=(e,t,r)=>new Promise((a,s)=>{if("number"!=typeof t||t<0)throw TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void a(e);let o=setTimeout(()=>{if("function"==typeof r){try{a(r())}catch(e){s(e)}return}let n="string"==typeof r?r:`Promise timed out after ${t} milliseconds`,o=r instanceof Error?r:new i(n);"function"==typeof e.cancel&&e.cancel(),s(o)},t);n(e.then(a,s),()=>{clearTimeout(o)})});t.exports=a,t.exports.default=a,t.exports.TimeoutError=i},6362,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){let n=0,i=e.length;for(;i>0;){let a=i/2|0,s=n+a;0>=r(e[s],t)?(n=++s,i-=a+1):i=a}return n}},4264,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(6362);r.default=class{constructor(){this._queue=[]}enqueue(e,t){let r={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(r);let i=n.default(this._queue,r,(e,t)=>t.priority-e.priority);this._queue.splice(i,0,r)}dequeue(){let e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(e=>e.run)}get size(){return this._queue.length}}},55747,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(48271),i=e.r(76469),a=e.r(4264),s=()=>{},o=new i.TimeoutError;r.default=class extends n{constructor(e){var t,r,n,i;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=s,this._resolveIdle=s,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:a.default},e)).intervalCap&&e.intervalCap>=1))throw TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!=(r=null==(t=e.intervalCap)?void 0:t.toString())?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!=(i=null==(n=e.interval)?void 0:n.toString())?i:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=s,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=s,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(void 0===this._intervalId){let t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((r,n)=>{let a=async()=>{this._pendingCount++,this._intervalCount++;try{let a=void 0===this._timeout&&void 0===t.timeout?e():i.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&n(o)});r(await a)}catch(e){n(e)}this._next()};this._queue.enqueue(a,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async e=>this.add(e,t)))}start(){return this._isPaused&&(this._isPaused=!1,this._processQueue()),this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},34376,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.AsyncCaller=void 0;let i=n(e.r(36850)),a=n(e.r(55747)),s=[429,500,502,503,504];r.AsyncCaller=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,"default"in a.default?this.queue=new a.default.default({concurrency:this.maxConcurrency}):this.queue=new a.default({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e?.onFailedResponseHook}call(e,...t){let r=this.onFailedResponseHook;return this.queue.add(()=>(0,i.default)(()=>e(...t).catch(e=>{if(e instanceof Error)throw e;throw Error(e)}),{async onFailedAttempt(e){if(e.message.startsWith("Cancel")||e.message.startsWith("TimeoutError")||"TimeoutError"===e.name||e.message.startsWith("AbortError")||e?.code==="ECONNABORTED")throw e;let t=e?.response;if(r&&await r(t))return;let n=t?.status??e?.status;if(n&&!s.includes(+n))throw e},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((t,r)=>{e.signal?.addEventListener("abort",()=>{r(Error("AbortError"))})})]):this.call(t,...r)}}},36853,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isLangChainMessage=function(e){return"function"==typeof e?._getType},r.convertLangChainMessageToExample=function(e){let t={type:e._getType(),data:{content:e.content}};return e?.additional_kwargs&&Object.keys(e.additional_kwargs).length>0&&(t.data.additional_kwargs={...e.additional_kwargs}),t}},89544,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.assertUuid=function(e,t){if(!n.test(e))throw Error(void 0!==t?`Invalid UUID for ${t}: ${e}`:`Invalid UUID: ${e}`);return e};let n=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i},65113,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.warnOnce=function(e){n[e]||(console.warn(e),n[e]=!0)};let n={}},38703,(e,t,r)=>{"use strict";t.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||0x1fffffffffffff,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},91130,(e,t,r)=>{"use strict";t.exports="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{}},70547,(e,t,r)=>{"use strict";let{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:a}=e.r(38703),s=e.r(91130),o=(r=t.exports={}).re=[],l=r.safeRe=[],u=r.src=[],c=r.safeSrc=[],d=r.t={},p=0,h="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",a],[h,i]],m=(e,t,r)=>{let n=(e=>{for(let[t,r]of f)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),i=p++;s(e,i,t),d[e]=i,u[i]=t,c[i]=n,o[i]=new RegExp(t,r?"g":void 0),l[i]=new RegExp(n,r?"g":void 0)};m("NUMERICIDENTIFIER","0|[1-9]\\d*"),m("NUMERICIDENTIFIERLOOSE","\\d+"),m("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),m("MAINVERSION",`(${u[d.NUMERICIDENTIFIER]})\\.(${u[d.NUMERICIDENTIFIER]})\\.(${u[d.NUMERICIDENTIFIER]})`),m("MAINVERSIONLOOSE",`(${u[d.NUMERICIDENTIFIERLOOSE]})\\.(${u[d.NUMERICIDENTIFIERLOOSE]})\\.(${u[d.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASEIDENTIFIER",`(?:${u[d.NONNUMERICIDENTIFIER]}|${u[d.NUMERICIDENTIFIER]})`),m("PRERELEASEIDENTIFIERLOOSE",`(?:${u[d.NONNUMERICIDENTIFIER]}|${u[d.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASE",`(?:-(${u[d.PRERELEASEIDENTIFIER]}(?:\\.${u[d.PRERELEASEIDENTIFIER]})*))`),m("PRERELEASELOOSE",`(?:-?(${u[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[d.PRERELEASEIDENTIFIERLOOSE]})*))`),m("BUILDIDENTIFIER",`${h}+`),m("BUILD",`(?:\\+(${u[d.BUILDIDENTIFIER]}(?:\\.${u[d.BUILDIDENTIFIER]})*))`),m("FULLPLAIN",`v?${u[d.MAINVERSION]}${u[d.PRERELEASE]}?${u[d.BUILD]}?`),m("FULL",`^${u[d.FULLPLAIN]}$`),m("LOOSEPLAIN",`[v=\\s]*${u[d.MAINVERSIONLOOSE]}${u[d.PRERELEASELOOSE]}?${u[d.BUILD]}?`),m("LOOSE",`^${u[d.LOOSEPLAIN]}$`),m("GTLT","((?:<|>)?=?)"),m("XRANGEIDENTIFIERLOOSE",`${u[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),m("XRANGEIDENTIFIER",`${u[d.NUMERICIDENTIFIER]}|x|X|\\*`),m("XRANGEPLAIN",`[v=\\s]*(${u[d.XRANGEIDENTIFIER]})(?:\\.(${u[d.XRANGEIDENTIFIER]})(?:\\.(${u[d.XRANGEIDENTIFIER]})(?:${u[d.PRERELEASE]})?${u[d.BUILD]}?)?)?`),m("XRANGEPLAINLOOSE",`[v=\\s]*(${u[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[d.XRANGEIDENTIFIERLOOSE]})(?:${u[d.PRERELEASELOOSE]})?${u[d.BUILD]}?)?)?`),m("XRANGE",`^${u[d.GTLT]}\\s*${u[d.XRANGEPLAIN]}$`),m("XRANGELOOSE",`^${u[d.GTLT]}\\s*${u[d.XRANGEPLAINLOOSE]}$`),m("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),m("COERCE",`${u[d.COERCEPLAIN]}(?:$|[^\\d])`),m("COERCEFULL",u[d.COERCEPLAIN]+`(?:${u[d.PRERELEASE]})?`+`(?:${u[d.BUILD]})?`+"(?:$|[^\\d])"),m("COERCERTL",u[d.COERCE],!0),m("COERCERTLFULL",u[d.COERCEFULL],!0),m("LONETILDE","(?:~>?)"),m("TILDETRIM",`(\\s*)${u[d.LONETILDE]}\\s+`,!0),r.tildeTrimReplace="$1~",m("TILDE",`^${u[d.LONETILDE]}${u[d.XRANGEPLAIN]}$`),m("TILDELOOSE",`^${u[d.LONETILDE]}${u[d.XRANGEPLAINLOOSE]}$`),m("LONECARET","(?:\\^)"),m("CARETTRIM",`(\\s*)${u[d.LONECARET]}\\s+`,!0),r.caretTrimReplace="$1^",m("CARET",`^${u[d.LONECARET]}${u[d.XRANGEPLAIN]}$`),m("CARETLOOSE",`^${u[d.LONECARET]}${u[d.XRANGEPLAINLOOSE]}$`),m("COMPARATORLOOSE",`^${u[d.GTLT]}\\s*(${u[d.LOOSEPLAIN]})$|^$`),m("COMPARATOR",`^${u[d.GTLT]}\\s*(${u[d.FULLPLAIN]})$|^$`),m("COMPARATORTRIM",`(\\s*)${u[d.GTLT]}\\s*(${u[d.LOOSEPLAIN]}|${u[d.XRANGEPLAIN]})`,!0),r.comparatorTrimReplace="$1$2$3",m("HYPHENRANGE",`^\\s*(${u[d.XRANGEPLAIN]})\\s+-\\s+(${u[d.XRANGEPLAIN]})\\s*$`),m("HYPHENRANGELOOSE",`^\\s*(${u[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[d.XRANGEPLAINLOOSE]})\\s*$`),m("STAR","(<|>)?=?\\s*\\*"),m("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),m("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},82789,(e,t,r)=>{"use strict";let n=Object.freeze({loose:!0}),i=Object.freeze({});t.exports=e=>e?"object"!=typeof e?n:e:i},18429,(e,t,r)=>{"use strict";let n=/^[0-9]+$/,i=(e,t)=>{let r=n.test(e),i=n.test(t);return r&&i&&(e*=1,t*=1),e===t?0:r&&!i?-1:i&&!r?1:e<t?-1:1};t.exports={compareIdentifiers:i,rcompareIdentifiers:(e,t)=>i(t,e)}},20326,(e,t,r)=>{"use strict";let n=e.r(91130),{MAX_LENGTH:i,MAX_SAFE_INTEGER:a}=e.r(38703),{safeRe:s,t:o}=e.r(70547),l=e.r(82789),{compareIdentifiers:u}=e.r(18429);class c{constructor(e,t){if(t=l(t),e instanceof c)if(!!t.loose===e.loose&&!!t.includePrerelease===e.includePrerelease)return e;else e=e.version;else if("string"!=typeof e)throw TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw TypeError(`version is longer than ${i} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?s[o.LOOSE]:s[o.FULL]);if(!r)throw TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>a||this.major<0)throw TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){let t=+e;if(t>=0&&t<a)return t}return e}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if("string"==typeof e&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return -1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],i=e.prerelease[t];if(n("prerelease compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return -1;else if(r===i)continue;else return u(r,i)}while(++t)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let t=0;do{let r=this.build[t],i=e.build[t];if(n("build compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return -1;else if(r===i)continue;else return u(r,i)}while(++t)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&!1===r)throw Error("invalid increment argument: identifier is empty");if(t){let e=`-${t}`.match(this.options.loose?s[o.PRERELEASELOOSE]:s[o.PRERELEASE]);if(!e||e[1]!==t)throw Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(0===this.prerelease.length)throw Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{let e=+!!Number(r);if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===r)throw Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let n=[t,e];!1===r&&(n=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n}break}default:throw Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}t.exports=c},35759,(e,t,r)=>{"use strict";let n=e.r(20326);t.exports=(e,t,r=!1)=>{if(e instanceof n)return e;try{return new n(e,t)}catch(e){if(!r)return null;throw e}}},32,(e,t,r)=>{"use strict";let n=e.r(35759);t.exports=(e,t)=>{let r=n(e,t);return r?r.version:null}},76730,(e,t,r)=>{"use strict";let n=e.r(35759);t.exports=(e,t)=>{let r=n(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},96161,(e,t,r)=>{"use strict";let n=e.r(20326);t.exports=(e,t,r,i,a)=>{"string"==typeof r&&(a=i,i=r,r=void 0);try{return new n(e instanceof n?e.version:e,r).inc(t,i,a).version}catch(e){return null}}},16022,(e,t,r)=>{"use strict";let n=e.r(35759);t.exports=(e,t)=>{let r=n(e,null,!0),i=n(t,null,!0),a=r.compare(i);if(0===a)return null;let s=a>0,o=s?r:i,l=s?i:r,u=!!o.prerelease.length;if(l.prerelease.length&&!u){if(!l.patch&&!l.minor)return"major";if(0===l.compareMain(o))return l.minor&&!l.patch?"minor":"patch"}let c=u?"pre":"";return r.major!==i.major?c+"major":r.minor!==i.minor?c+"minor":r.patch!==i.patch?c+"patch":"prerelease"}},8645,(e,t,r)=>{"use strict";let n=e.r(20326);t.exports=(e,t)=>new n(e,t).major},62196,(e,t,r)=>{"use strict";let n=e.r(20326);t.exports=(e,t)=>new n(e,t).minor},52686,(e,t,r)=>{"use strict";let n=e.r(20326);t.exports=(e,t)=>new n(e,t).patch},13523,(e,t,r)=>{"use strict";let n=e.r(35759);t.exports=(e,t)=>{let r=n(e,t);return r&&r.prerelease.length?r.prerelease:null}},4668,(e,t,r)=>{"use strict";let n=e.r(20326);t.exports=(e,t,r)=>new n(e,r).compare(new n(t,r))},60808,(e,t,r)=>{"use strict";let n=e.r(4668);t.exports=(e,t,r)=>n(t,e,r)},98480,(e,t,r)=>{"use strict";let n=e.r(4668);t.exports=(e,t)=>n(e,t,!0)},79552,(e,t,r)=>{"use strict";let n=e.r(20326);t.exports=(e,t,r)=>{let i=new n(e,r),a=new n(t,r);return i.compare(a)||i.compareBuild(a)}},18817,(e,t,r)=>{"use strict";let n=e.r(79552);t.exports=(e,t)=>e.sort((e,r)=>n(e,r,t))},27314,(e,t,r)=>{"use strict";let n=e.r(79552);t.exports=(e,t)=>e.sort((e,r)=>n(r,e,t))},56381,(e,t,r)=>{"use strict";let n=e.r(4668);t.exports=(e,t,r)=>n(e,t,r)>0},99583,(e,t,r)=>{"use strict";let n=e.r(4668);t.exports=(e,t,r)=>0>n(e,t,r)},66010,(e,t,r)=>{"use strict";let n=e.r(4668);t.exports=(e,t,r)=>0===n(e,t,r)},9282,(e,t,r)=>{"use strict";let n=e.r(4668);t.exports=(e,t,r)=>0!==n(e,t,r)},87709,(e,t,r)=>{"use strict";let n=e.r(4668);t.exports=(e,t,r)=>n(e,t,r)>=0},48467,(e,t,r)=>{"use strict";let n=e.r(4668);t.exports=(e,t,r)=>0>=n(e,t,r)},36269,(e,t,r)=>{"use strict";let n=e.r(66010),i=e.r(9282),a=e.r(56381),s=e.r(87709),o=e.r(99583),l=e.r(48467);t.exports=(e,t,r,u)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return n(e,r,u);case"!=":return i(e,r,u);case">":return a(e,r,u);case">=":return s(e,r,u);case"<":return o(e,r,u);case"<=":return l(e,r,u);default:throw TypeError(`Invalid operator: ${t}`)}}},64166,(e,t,r)=>{"use strict";let n=e.r(20326),i=e.r(35759),{safeRe:a,t:s}=e.r(70547);t.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){let n,i=t.includePrerelease?a[s.COERCERTLFULL]:a[s.COERCERTL];for(;(n=i.exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&n.index+n[0].length===r.index+r[0].length||(r=n),i.lastIndex=n.index+n[1].length+n[2].length;i.lastIndex=-1}else r=e.match(t.includePrerelease?a[s.COERCEFULL]:a[s.COERCE]);if(null===r)return null;let o=r[2],l=r[3]||"0",u=r[4]||"0",c=t.includePrerelease&&r[5]?`-${r[5]}`:"",d=t.includePrerelease&&r[6]?`+${r[6]}`:"";return i(`${o}.${l}.${u}${c}${d}`,t)}},80661,(e,t,r)=>{"use strict";t.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(void 0!==t)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){let e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},93006,(e,t,r)=>{"use strict";let n=/\s+/g;class i{constructor(e,t){if(t=s(t),e instanceof i)if(!!t.loose===e.loose&&!!t.includePrerelease===e.includePrerelease)return e;else return new i(e.raw,t);if(e instanceof o)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(n," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let e=this.set[0];if(this.set=this.set.filter(e=>!y(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1){for(let e of this.set)if(1===e.length&&b(e[0])){this.set=[e];break}}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let t=((this.options.includePrerelease&&m)|(this.options.loose&&g))+":"+e,r=a.get(t);if(r)return r;let n=this.options.loose,i=n?c[d.HYPHENRANGELOOSE]:c[d.HYPHENRANGE];l("hyphen replace",e=e.replace(i,C(this.options.includePrerelease))),l("comparator trim",e=e.replace(c[d.COMPARATORTRIM],p)),l("tilde trim",e=e.replace(c[d.TILDETRIM],h)),l("caret trim",e=e.replace(c[d.CARETTRIM],f));let s=e.split(" ").map(e=>v(e,this.options)).join(" ").split(/\s+/).map(e=>T(e,this.options));n&&(s=s.filter(e=>(l("loose invalid filter",e,this.options),!!e.match(c[d.COMPARATORLOOSE])))),l("range list",s);let u=new Map;for(let e of s.map(e=>new o(e,this.options))){if(y(e))return[e];u.set(e.value,e)}u.size>1&&u.has("")&&u.delete("");let b=[...u.values()];return a.set(t,b),b}intersects(e,t){if(!(e instanceof i))throw TypeError("a Range is required");return this.set.some(r=>_(r,t)&&e.set.some(e=>_(e,t)&&r.every(r=>e.every(e=>r.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(j(this.set[t],e,this.options))return!0;return!1}}t.exports=i;let a=new(e.r(80661)),s=e.r(82789),o=e.r(21984),l=e.r(91130),u=e.r(20326),{safeRe:c,t:d,comparatorTrimReplace:p,tildeTrimReplace:h,caretTrimReplace:f}=e.r(70547),{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:g}=e.r(38703),y=e=>"<0.0.0-0"===e.value,b=e=>""===e.value,_=(e,t)=>{let r=!0,n=e.slice(),i=n.pop();for(;r&&n.length;)r=n.every(e=>i.intersects(e,t)),i=n.pop();return r},v=(e,t)=>(l("comp",e,t),l("caret",e=S(e,t)),l("tildes",e=O(e,t)),l("xrange",e=k(e,t)),l("stars",e=A(e,t)),e),w=e=>!e||"x"===e.toLowerCase()||"*"===e,O=(e,t)=>e.trim().split(/\s+/).map(e=>P(e,t)).join(" "),P=(e,t)=>{let r=t.loose?c[d.TILDELOOSE]:c[d.TILDE];return e.replace(r,(t,r,n,i,a)=>{let s;return l("tilde",e,t,r,n,i,a),w(r)?s="":w(n)?s=`>=${r}.0.0 <${+r+1}.0.0-0`:w(i)?s=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:a?(l("replaceTilde pr",a),s=`>=${r}.${n}.${i}-${a} <${r}.${+n+1}.0-0`):s=`>=${r}.${n}.${i} <${r}.${+n+1}.0-0`,l("tilde return",s),s})},S=(e,t)=>e.trim().split(/\s+/).map(e=>E(e,t)).join(" "),E=(e,t)=>{l("caret",e,t);let r=t.loose?c[d.CARETLOOSE]:c[d.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,(t,r,i,a,s)=>{let o;return l("caret",e,t,r,i,a,s),w(r)?o="":w(i)?o=`>=${r}.0.0${n} <${+r+1}.0.0-0`:w(a)?o="0"===r?`>=${r}.${i}.0${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.0${n} <${+r+1}.0.0-0`:s?(l("replaceCaret pr",s),o="0"===r?"0"===i?`>=${r}.${i}.${a}-${s} <${r}.${i}.${+a+1}-0`:`>=${r}.${i}.${a}-${s} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${a}-${s} <${+r+1}.0.0-0`):(l("no pr"),o="0"===r?"0"===i?`>=${r}.${i}.${a}${n} <${r}.${i}.${+a+1}-0`:`>=${r}.${i}.${a}${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${a} <${+r+1}.0.0-0`),l("caret return",o),o})},k=(e,t)=>(l("replaceXRanges",e,t),e.split(/\s+/).map(e=>I(e,t)).join(" ")),I=(e,t)=>{e=e.trim();let r=t.loose?c[d.XRANGELOOSE]:c[d.XRANGE];return e.replace(r,(r,n,i,a,s,o)=>{l("xRange",e,r,n,i,a,s,o);let u=w(i),c=u||w(a),d=c||w(s);return"="===n&&d&&(n=""),o=t.includePrerelease?"-0":"",u?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&d?(c&&(a=0),s=0,">"===n?(n=">=",c?(i=+i+1,a=0):a=+a+1,s=0):"<="===n&&(n="<",c?i=+i+1:a=+a+1),"<"===n&&(o="-0"),r=`${n+i}.${a}.${s}${o}`):c?r=`>=${i}.0.0${o} <${+i+1}.0.0-0`:d&&(r=`>=${i}.${a}.0${o} <${i}.${+a+1}.0-0`),l("xRange return",r),r})},A=(e,t)=>(l("replaceStars",e,t),e.trim().replace(c[d.STAR],"")),T=(e,t)=>(l("replaceGTE0",e,t),e.trim().replace(c[t.includePrerelease?d.GTE0PRE:d.GTE0],"")),C=e=>(t,r,n,i,a,s,o,l,u,c,d,p)=>(r=w(n)?"":w(i)?`>=${n}.0.0${e?"-0":""}`:w(a)?`>=${n}.${i}.0${e?"-0":""}`:s?`>=${r}`:`>=${r}${e?"-0":""}`,l=w(u)?"":w(c)?`<${+u+1}.0.0-0`:w(d)?`<${u}.${+c+1}.0-0`:p?`<=${u}.${c}.${d}-${p}`:e?`<${u}.${c}.${+d+1}-0`:`<=${l}`,`${r} ${l}`.trim()),j=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(l(e[r].semver),e[r].semver!==o.ANY&&e[r].semver.prerelease.length>0){let n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},21984,(e,t,r)=>{"use strict";let n=Symbol("SemVer ANY");class i{static get ANY(){return n}constructor(e,t){if(t=a(t),e instanceof i)if(!!t.loose===e.loose)return e;else e=e.value;u("comparator",e=e.trim().split(/\s+/).join(" "),t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(e){let t=this.options.loose?s[o.COMPARATORLOOSE]:s[o.COMPARATOR],r=e.match(t);if(!r)throw TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new c(r[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(u("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof i))throw TypeError("a Comparator is required");return""===this.operator?""===this.value||new d(e.value,t).test(this.value):""===e.operator?""===e.value||new d(this.value,t).test(e.semver):!((t=a(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||l(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||l(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">"))}}t.exports=i;let a=e.r(82789),{safeRe:s,t:o}=e.r(70547),l=e.r(36269),u=e.r(91130),c=e.r(20326),d=e.r(93006)},70482,(e,t,r)=>{"use strict";let n=e.r(93006);t.exports=(e,t,r)=>{try{t=new n(t,r)}catch(e){return!1}return t.test(e)}},87095,(e,t,r)=>{"use strict";let n=e.r(93006);t.exports=(e,t)=>new n(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},92685,(e,t,r)=>{"use strict";let n=e.r(20326),i=e.r(93006);t.exports=(e,t,r)=>{let a=null,s=null,o=null;try{o=new i(t,r)}catch(e){return null}return e.forEach(e=>{o.test(e)&&(!a||-1===s.compare(e))&&(s=new n(a=e,r))}),a}},92500,(e,t,r)=>{"use strict";let n=e.r(20326),i=e.r(93006);t.exports=(e,t,r)=>{let a=null,s=null,o=null;try{o=new i(t,r)}catch(e){return null}return e.forEach(e=>{o.test(e)&&(!a||1===s.compare(e))&&(s=new n(a=e,r))}),a}},56388,(e,t,r)=>{"use strict";let n=e.r(20326),i=e.r(93006),a=e.r(56381);t.exports=(e,t)=>{e=new i(e,t);let r=new n("0.0.0");if(e.test(r)||(r=new n("0.0.0-0"),e.test(r)))return r;r=null;for(let t=0;t<e.set.length;++t){let i=e.set[t],s=null;i.forEach(e=>{let t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":(!s||a(t,s))&&(s=t);break;case"<":case"<=":break;default:throw Error(`Unexpected operation: ${e.operator}`)}}),s&&(!r||a(r,s))&&(r=s)}return r&&e.test(r)?r:null}},4934,(e,t,r)=>{"use strict";let n=e.r(93006);t.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},66294,(e,t,r)=>{"use strict";let n=e.r(20326),i=e.r(21984),{ANY:a}=i,s=e.r(93006),o=e.r(70482),l=e.r(56381),u=e.r(99583),c=e.r(48467),d=e.r(87709);t.exports=(e,t,r,p)=>{let h,f,m,g,y;switch(e=new n(e,p),t=new s(t,p),r){case">":h=l,f=c,m=u,g=">",y=">=";break;case"<":h=u,f=d,m=l,g="<",y="<=";break;default:throw TypeError('Must provide a hilo val of "<" or ">"')}if(o(e,t,p))return!1;for(let r=0;r<t.set.length;++r){let n=t.set[r],s=null,o=null;if(n.forEach(e=>{e.semver===a&&(e=new i(">=0.0.0")),s=s||e,o=o||e,h(e.semver,s.semver,p)?s=e:m(e.semver,o.semver,p)&&(o=e)}),s.operator===g||s.operator===y||(!o.operator||o.operator===g)&&f(e,o.semver)||o.operator===y&&m(e,o.semver))return!1}return!0}},78757,(e,t,r)=>{"use strict";let n=e.r(66294);t.exports=(e,t,r)=>n(e,t,">",r)},56605,(e,t,r)=>{"use strict";let n=e.r(66294);t.exports=(e,t,r)=>n(e,t,"<",r)},15029,(e,t,r)=>{"use strict";let n=e.r(93006);t.exports=(e,t,r)=>(e=new n(e,r),t=new n(t,r),e.intersects(t,r))},87138,(e,t,r)=>{"use strict";let n=e.r(70482),i=e.r(4668);t.exports=(e,t,r)=>{let a=[],s=null,o=null,l=e.sort((e,t)=>i(e,t,r));for(let e of l)n(e,t,r)?(o=e,s||(s=e)):(o&&a.push([s,o]),o=null,s=null);s&&a.push([s,null]);let u=[];for(let[e,t]of a)e===t?u.push(e):t||e!==l[0]?t?e===l[0]?u.push(`<=${t}`):u.push(`${e} - ${t}`):u.push(`>=${e}`):u.push("*");let c=u.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return c.length<d.length?c:t}},70414,(e,t,r)=>{"use strict";let n=e.r(93006),i=e.r(21984),{ANY:a}=i,s=e.r(70482),o=e.r(4668),l=[new i(">=0.0.0-0")],u=[new i(">=0.0.0")],c=(e,t,r)=>{let n,i,c,h,f,m,g;if(e===t)return!0;if(1===e.length&&e[0].semver===a)if(1===t.length&&t[0].semver===a)return!0;else e=r.includePrerelease?l:u;if(1===t.length&&t[0].semver===a)if(r.includePrerelease)return!0;else t=u;let y=new Set;for(let t of e)">"===t.operator||">="===t.operator?n=d(n,t,r):"<"===t.operator||"<="===t.operator?i=p(i,t,r):y.add(t.semver);if(y.size>1)return null;if(n&&i&&((c=o(n.semver,i.semver,r))>0||0===c&&(">="!==n.operator||"<="!==i.operator)))return null;for(let e of y){if(n&&!s(e,String(n),r)||i&&!s(e,String(i),r))return null;for(let n of t)if(!s(e,String(n),r))return!1;return!0}let b=!!i&&!r.includePrerelease&&!!i.semver.prerelease.length&&i.semver,_=!!n&&!r.includePrerelease&&!!n.semver.prerelease.length&&n.semver;for(let e of(b&&1===b.prerelease.length&&"<"===i.operator&&0===b.prerelease[0]&&(b=!1),t)){if(g=g||">"===e.operator||">="===e.operator,m=m||"<"===e.operator||"<="===e.operator,n){if(_&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===_.major&&e.semver.minor===_.minor&&e.semver.patch===_.patch&&(_=!1),">"===e.operator||">="===e.operator){if((h=d(n,e,r))===e&&h!==n)return!1}else if(">="===n.operator&&!s(n.semver,String(e),r))return!1}if(i){if(b&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===b.major&&e.semver.minor===b.minor&&e.semver.patch===b.patch&&(b=!1),"<"===e.operator||"<="===e.operator){if((f=p(i,e,r))===e&&f!==i)return!1}else if("<="===i.operator&&!s(i.semver,String(e),r))return!1}if(!e.operator&&(i||n)&&0!==c)return!1}return(!n||!m||!!i||0===c)&&(!i||!g||!!n||0===c)&&!_&&!b&&!0},d=(e,t,r)=>{if(!e)return t;let n=o(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},p=(e,t,r)=>{if(!e)return t;let n=o(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};t.exports=(e,t,r={})=>{if(e===t)return!0;e=new n(e,r),t=new n(t,r);let i=!1;e:for(let n of e.set){for(let e of t.set){let t=c(n,e,r);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},48680,(e,t,r)=>{"use strict";let n=e.r(70547),i=e.r(38703),a=e.r(20326),s=e.r(18429),o=e.r(35759),l=e.r(32),u=e.r(76730),c=e.r(96161),d=e.r(16022),p=e.r(8645),h=e.r(62196),f=e.r(52686),m=e.r(13523),g=e.r(4668),y=e.r(60808),b=e.r(98480),_=e.r(79552),v=e.r(18817),w=e.r(27314),O=e.r(56381),P=e.r(99583),S=e.r(66010),E=e.r(9282),k=e.r(87709),I=e.r(48467),A=e.r(36269),T=e.r(64166),C=e.r(21984),j=e.r(93006),x=e.r(70482),$=e.r(87095),N=e.r(92685),R=e.r(92500),M=e.r(56388),D=e.r(4934),L=e.r(66294),U=e.r(78757),F=e.r(56605),z=e.r(15029);t.exports={parse:o,valid:l,clean:u,inc:c,diff:d,major:p,minor:h,patch:f,prerelease:m,compare:g,rcompare:y,compareLoose:b,compareBuild:_,sort:v,rsort:w,gt:O,lt:P,eq:S,neq:E,gte:k,lte:I,cmp:A,coerce:T,Comparator:C,Range:j,satisfies:x,toComparators:$,maxSatisfying:N,minSatisfying:R,minVersion:M,validRange:D,outside:L,gtr:U,ltr:F,intersects:z,simplifyRange:e.r(87138),subset:e.r(70414),SemVer:a,re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:s.compareIdentifiers,rcompareIdentifiers:s.rcompareIdentifiers}},56952,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isVersionGreaterOrEqual=function(e,t){let r=(0,n.parse)(e),i=(0,n.parse)(t);if(!r||!i)throw Error("Invalid version format.");return r.compare(i)>=0},r.parsePromptIdentifier=function(e){if(!e||e.split("/").length>2||e.startsWith("/")||e.endsWith("/")||e.split(":").length>2)throw Error(`Invalid identifier format: ${e}`);let[t,r]=e.split(":"),n=r||"latest";if(t.includes("/")){let[r,i]=t.split("/",2);if(!r||!i)throw Error(`Invalid identifier format: ${e}`);return[r,i,n]}if(!t)throw Error(`Invalid identifier format: ${e}`);return["-",t,n]};let n=e.r(48680)},91461,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ConflictingEndpointsError=r.LangSmithConflictError=void 0,r.printErrorStackTrace=function(e){let t=function(e){if("object"!=typeof e||null==e||!("stack"in e)||"string"!=typeof e.stack)return;let t=e.stack,r=`${e}`;return t.startsWith(r)&&(t=t.slice(r.length)),t.startsWith("\n")&&(t=t.slice(1)),t}(e);null!=t&&console.error(t)},r.raiseForStatus=i,r.isConflictingEndpointsError=function(e){return"object"==typeof e&&null!==e&&e.code===a};class n extends Error{constructor(e){super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="LangSmithConflictError",this.status=409}}async function i(e,t,r){let i;if(e.ok){r&&(i=await e.text());return}if(403===e.status)try{let t=await e.json(),r=t?.error;"org_scoped_key_requires_workspace"===r&&(i="This API key is org-scoped and requires workspace specification. Please provide 'workspaceId' parameter, or set LANGSMITH_WORKSPACE_ID environment variable.")}catch(r){let t=Error(`${e.status} ${e.statusText}`);throw t.status=e?.status,t}if(void 0===i)try{i=await e.text()}catch(e){i=""}let a=`Failed to ${t}. Received status [${e.status}]: ${e.statusText}. Message: ${i}`;if(409===e.status)throw new n(a);let s=Error(a);throw s.status=e.status,s}r.LangSmithConflictError=n;let a="ERR_CONFLICTING_ENDPOINTS";r.ConflictingEndpointsError=class extends Error{constructor(){super("You cannot provide both LANGSMITH_ENDPOINT / LANGCHAIN_ENDPOINT and LANGSMITH_RUNS_ENDPOINTS."),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:a}),this.name="ConflictingEndpointsError"}}},54912,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.serialize=function(e,t,r,l,p){try{let t=JSON.stringify(e,function(e,t){if(r){let n=r.call(this,e,t);if(void 0!==n)return n}return c(t)},l);return u(t)}catch(m){let f;if(!m.message?.includes("Converting circular structure to JSON"))return console.warn(`[WARNING]: LangSmith received unserializable value.${t?`
Context: ${t}`:""}`),u("[Unserializable]");"true"!==(0,n.getLangSmithEnvironmentVariable)("SUPPRESS_CIRCULAR_JSON_WARNINGS")&&console.warn(`[WARNING]: LangSmith received circular JSON. This will decrease tracer performance. ${t?`
Context: ${t}`:""}`),void 0===p&&(p={depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}),function e(t,r,n,s,o,l,u){if(l+=1,"object"==typeof t&&null!==t){for(p=0;p<s.length;p++)if(s[p]===t)return void d(a,t,r,o);if(void 0!==u.depthLimit&&l>u.depthLimit||void 0!==u.edgesLimit&&n+1>u.edgesLimit)return void d(i,t,r,o);if(s.push(t),Array.isArray(t))for(p=0;p<t.length;p++)e(t[p],p,p,s,t,l,u);else{var p,h=Object.keys(t=c(t));for(p=0;p<h.length;p++){var f=h[p];e(t[f],f,p,s,t,l,u)}}s.pop()}}(e,"",0,[],void 0,0,p);try{var h;f=0===o.length?JSON.stringify(e,r,l):JSON.stringify(e,(h=r,h=void 0!==h?h:function(e,t){return t},function(e,t){if(o.length>0)for(var r=0;r<o.length;r++){var n=o[r];if(n[1]===e&&n[0]===t){t=n[2],o.splice(r,1);break}}return h.call(this,e,t)}),l)}catch(e){return u("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==s.length;){let e=s.pop();4===e.length?Object.defineProperty(e[0],e[1],e[3]):e[0][e[1]]=e[2]}}return u(f)}};let n=e.r(27081);var i="[...]",a={result:"[Circular]"},s=[],o=[];let l=new TextEncoder;function u(e){return l.encode(e)}function c(e){if(e&&"object"==typeof e&&null!==e){if(e instanceof Map)return Object.fromEntries(e);else if(e instanceof Set)return Array.from(e);else if(e instanceof Date)return e.toISOString();else if(e instanceof RegExp)return e.toString();else if(e instanceof Error)return{name:e.name,message:e.message}}else if("bigint"==typeof e)return e.toString();return e}function d(e,t,r,n){var i=Object.getOwnPropertyDescriptor(n,r);void 0!==i.get?i.configurable?(Object.defineProperty(n,r,{value:e}),s.push([n,r,t,i])):o.push([t,r,e]):(n[r]=e,s.push([n,r,t]))}},92913,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),s=0;s<a.length;s++)"default"!==a[s]&&n(r,t,a[s]);return i(r,t),r}}();Object.defineProperty(r,"__esModule",{value:!0}),r.Client=r.DEFAULT_UNCOMPRESSED_BATCH_SIZE_LIMIT_BYTES=r.AutoBatchQueue=void 0,r.mergeRuntimeEnvIntoRun=_;let s=a(e.r(79403)),o=e.r(55549),l=e.r(40594),u=e.r(34376),c=e.r(36853),d=e.r(27081),p=e.r(64949),h=e.r(89544),f=e.r(65113),m=e.r(56952),g=e.r(91461),y=e.r(78785),b=e.r(54912);function _(e){let t=(0,d.getRuntimeEnvironment)(),r=(0,d.getLangChainEnvVarsMetadata)(),n=e.extra??{},i=n.metadata;return e.extra={...n,runtime:{...t,...n?.runtime},metadata:{...r,...r.revision_id||"revision_id"in e&&e.revision_id?{revision_id:("revision_id"in e?e.revision_id:void 0)??r.revision_id}:{},...i}},e}async function v(e){let t=[];for await(let r of e)t.push(r);return t}function w(e){if(void 0!==e)return e.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}let O=async e=>{if(e?.status===429){let t=1e3*parseInt(e.headers.get("retry-after")??"10",10);if(t>0)return await new Promise(e=>setTimeout(e,t)),!0}return!1};function P(e){return"number"==typeof e?Number(e.toFixed(4)):e}class S{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let t,r=new Promise(e=>{t=e}),n=(0,b.serialize)(e.item,`Serializing run with id: ${e.item.id}`).length;return this.items.push({action:e.action,payload:e.item,otelContext:e.otelContext,apiKey:e.apiKey,apiUrl:e.apiUrl,itemPromiseResolve:t,itemPromise:r,size:n}),this.sizeBytes+=n,r}pop({upToSizeBytes:e,upToSize:t}){if(e<1)throw Error("Number of bytes to pop off may not be less than 1.");let r=[],n=0;for(;n+(this.peek()?.size??0)<e&&this.items.length>0&&r.length<t;){let e=this.items.shift();e&&(r.push(e),n+=e.size,this.sizeBytes-=e.size)}if(0===r.length&&this.items.length>0){let e=this.items.shift();r.push(e),n+=e.size,this.sizeBytes-=e.size}return[r.map(e=>({action:e.action,item:e.payload,otelContext:e.otelContext,apiKey:e.apiKey,apiUrl:e.apiUrl})),()=>r.forEach(e=>e.itemPromiseResolve())]}}r.AutoBatchQueue=S,r.DEFAULT_UNCOMPRESSED_BATCH_SIZE_LIMIT_BYTES=0x1800000;let E="https://api.smith.langchain.com";class k{get _fetch(){return this.fetchImplementation||(0,y._getFetchImplementation)(this.debug)}constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workspaceId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new S}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSizeLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:"false"===(0,d.getEnvironmentVariable)("LANGSMITH_TRACING_BACKGROUND")}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"langSmithToOTELTranslator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchImplementation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"multipartStreamingDisabled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:"true"===(0,d.getEnvironmentVariable)("LANGSMITH_DEBUG")});let t=k.getDefaultClientConfig();if(this.tracingSampleRate=(e=>{let t=e?.toString()??(0,d.getLangSmithEnvironmentVariable)("TRACING_SAMPLING_RATE");if(void 0===t)return;let r=parseFloat(t);if(r<0||r>1)throw Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${r}`);return r})(e.tracingSamplingRate),this.apiUrl=w(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=w(e.apiKey??t.apiKey),this.webUrl=w(e.webUrl??t.webUrl),this.webUrl?.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.workspaceId=w(e.workspaceId??(0,d.getLangSmithEnvironmentVariable)("WORKSPACE_ID")),this.timeout_ms=e.timeout_ms??9e4,this.caller=new u.AsyncCaller({...e.callerOptions??{},maxRetries:4,debug:e.debug??this.debug}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw Error("Trace batch concurrency must be positive.");this.debug=e.debug??this.debug,this.fetchImplementation=e.fetchImplementation,this.batchIngestCaller=new u.AsyncCaller({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:O,debug:e.debug??this.debug}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.batchSizeLimit=e.batchSizeLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode,(0,d.getOtelEnabled)()&&(this.langSmithToOTELTranslator=new o.LangSmithToOTELTranslator)}static getDefaultClientConfig(){let e=(0,d.getLangSmithEnvironmentVariable)("API_KEY"),t=(0,d.getLangSmithEnvironmentVariable)("ENDPOINT")??E;return{apiUrl:t,apiKey:e,webUrl:void 0,hideInputs:"true"===(0,d.getLangSmithEnvironmentVariable)("HIDE_INPUTS"),hideOutputs:"true"===(0,d.getLangSmithEnvironmentVariable)("HIDE_OUTPUTS")}}getHostUrl(){if(this.webUrl)return this.webUrl;if((e=>{let t=e.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return"localhost"===t||"127.0.0.1"===t||"::1"===t})(this.apiUrl))return this.webUrl="http://localhost:3000",this.webUrl;if(this.apiUrl.endsWith("/api/v1"))return this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl;if(this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api"))return this.webUrl=this.apiUrl.replace("/api",""),this.webUrl;if(this.apiUrl.split(".",1)[0].includes("dev"))return this.webUrl="https://dev.smith.langchain.com",this.webUrl;else if(this.apiUrl.split(".",1)[0].includes("eu"))return this.webUrl="https://eu.smith.langchain.com",this.webUrl;else if(this.apiUrl.split(".",1)[0].includes("beta"))return this.webUrl="https://beta.smith.langchain.com",this.webUrl;else return this.webUrl="https://smith.langchain.com",this.webUrl}get headers(){let e={"User-Agent":`langsmith-js/${p.__version__}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),this.workspaceId&&(e["x-tenant-id"]=this.workspaceId),e}_getPlatformEndpointPath(e){return"/v1"!==this.apiUrl.slice(-3)&&"/v1/"!==this.apiUrl.slice(-4)?`/v1/platform/${e}`:`/platform/${e}`}async processInputs(e){return!1===this.hideInputs?e:!0===this.hideInputs?{}:"function"==typeof this.hideInputs?this.hideInputs(e):e}async processOutputs(e){return!1===this.hideOutputs?e:!0===this.hideOutputs?{}:"function"==typeof this.hideOutputs?this.hideOutputs(e):e}async prepareRunCreateOrUpdateInputs(e){let t={...e};return void 0!==t.inputs&&(t.inputs=await this.processInputs(t.inputs)),void 0!==t.outputs&&(t.outputs=await this.processOutputs(t.outputs)),t}async _getResponse(e,t){let r=t?.toString()??"",n=`${this.apiUrl}${e}?${r}`;return await this.caller.call(async()=>{let t=await this._fetch(n,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,`fetch ${e}`),t})}async _get(e,t){return(await this._getResponse(e,t)).json()}async *_getPaginated(e,t=new URLSearchParams,r){let n=Number(t.get("offset"))||0,i=Number(t.get("limit"))||100;for(;;){t.set("offset",String(n)),t.set("limit",String(i));let a=`${this.apiUrl}${e}?${t}`,s=await this.caller.call(async()=>{let t=await this._fetch(a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,`fetch ${e}`),t}),o=r?r(await s.json()):await s.json();if(0===o.length||(yield o,o.length<i))break;n+=o.length}}async *_getCursorPaginatedList(e,t=null,r="POST",n="runs"){let i=t?{...t}:{};for(;;){let t=JSON.stringify(i),a=await this.caller.call(async()=>{let n=await this._fetch(`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:t});return await (0,g.raiseForStatus)(n,`fetch ${e}`),n}),s=await a.json();if(!s||!s[n])break;yield s[n];let o=s.cursors;if(!o||!o.next)break;i.cursor=o.next}}_shouldSample(){return void 0===this.tracingSampleRate||Math.random()<this.tracingSampleRate}_filterForSampling(e,t=!1){if(void 0===this.tracingSampleRate)return e;if(t){let t=[];for(let r of e)this.filteredPostUuids.has(r.trace_id)?r.id===r.trace_id&&this.filteredPostUuids.delete(r.trace_id):t.push(r);return t}{let t=[];for(let r of e){let e=r.trace_id??r.id;this.filteredPostUuids.has(e)||(r.id===e?this._shouldSample()?t.push(r):this.filteredPostUuids.add(e):t.push(r))}return t}}async _getBatchSizeLimitBytes(){let e=await this._ensureServerInfo();return this.batchSizeBytesLimit??e.batch_ingest_config?.size_limit_bytes??r.DEFAULT_UNCOMPRESSED_BATCH_SIZE_LIMIT_BYTES}async _getBatchSizeLimit(){let e=await this._ensureServerInfo();return this.batchSizeLimit??e.batch_ingest_config?.size_limit??100}async _getDatasetExamplesMultiPartSupport(){let e=await this._ensureServerInfo();return e.instance_flags?.dataset_examples_multipart_enabled??!1}drainAutoBatchQueue({batchSizeLimitBytes:e,batchSizeLimit:t}){let r=[];for(;this.autoBatchQueue.items.length>0;){let[n,i]=this.autoBatchQueue.pop({upToSizeBytes:e,upToSize:t});if(!n.length){i();break}let a=n.reduce((e,t)=>{let r=t.apiUrl??this.apiUrl,n=t.apiKey??this.apiKey,i=t.apiKey===this.apiKey&&t.apiUrl===this.apiUrl?"default":`${r}|${n}`;return e[i]||(e[i]=[]),e[i].push(t),e},{}),s=[];for(let[e,t]of Object.entries(a)){let r=this._processBatch(t,{apiUrl:"default"===e?void 0:e.split("|")[0],apiKey:"default"===e?void 0:e.split("|")[1]});s.push(r)}let o=Promise.all(s).finally(i);r.push(o)}return Promise.all(r)}async _processBatch(e,t){if(e.length)try{if(void 0!==this.langSmithToOTELTranslator)this._sendBatchToOTELTranslator(e);else{let r={runCreates:e.filter(e=>"create"===e.action).map(e=>e.item),runUpdates:e.filter(e=>"update"===e.action).map(e=>e.item)},n=await this._ensureServerInfo();if(n?.batch_ingest_config?.use_multipart_endpoint){let e=n?.instance_flags?.gzip_body_enabled;await this.multipartIngestRuns(r,{...t,useGzip:e})}else await this.batchIngestRuns(r,t)}}catch(e){console.error("Error exporting batch:",e)}}_sendBatchToOTELTranslator(e){if(void 0!==this.langSmithToOTELTranslator){let t=new Map,r=[];for(let n of e)n.item.id&&n.otelContext&&(t.set(n.item.id,n.otelContext),"create"===n.action?r.push({operation:"post",id:n.item.id,trace_id:n.item.trace_id??n.item.id,run:n.item}):r.push({operation:"patch",id:n.item.id,trace_id:n.item.trace_id??n.item.id,run:n.item}));this.langSmithToOTELTranslator.exportBatch(r,t)}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.item=_(e.item);let t=this.autoBatchQueue.push(e);if(this.manualFlushMode)return t;let r=await this._getBatchSizeLimitBytes(),n=await this._getBatchSizeLimit();return(this.autoBatchQueue.sizeBytes>r||this.autoBatchQueue.items.length>n)&&this.drainAutoBatchQueue({batchSizeLimitBytes:r,batchSizeLimit:n}),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue({batchSizeLimitBytes:r,batchSizeLimit:n})},this.autoBatchAggregationDelayMs)),t}async _getServerInfo(){let e=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(1e4),...this.fetchOptions});return await (0,g.raiseForStatus)(e,"get server info"),e}),t=await e.json();return this.debug&&console.log("\n=== LangSmith Server Configuration ===\n"+JSON.stringify(t,null,2)+"\n"),t}async _ensureServerInfo(){return void 0===this._getServerInfoPromise&&(this._getServerInfoPromise=(async()=>{if(void 0===this._serverInfo)try{this._serverInfo=await this._getServerInfo()}catch(e){console.warn(`[LANGSMITH]: Failed to fetch info on supported operations. Falling back to batch operations and default limits. Info: ${e.status??"Unspecified status code"} ${e.message}`)}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(void 0===this._serverInfo&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){let e=await this._getBatchSizeLimitBytes(),t=await this._getBatchSizeLimit();await this.drainAutoBatchQueue({batchSizeLimitBytes:e,batchSizeLimit:t})}_cloneCurrentOTELContext(){let e=(0,l.getOTELTrace)(),t=(0,l.getOTELContext)();if(void 0!==this.langSmithToOTELTranslator){let r=e.getActiveSpan();if(r)return e.setSpan(t.active(),r)}}async createRun(e,t){if(!this._filterForSampling([e]).length)return;let r={...this.headers,"Content-Type":"application/json"},n=e.project_name;delete e.project_name;let i=await this.prepareRunCreateOrUpdateInputs({session_name:n,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&void 0!==i.trace_id&&void 0!==i.dotted_order){let e=this._cloneCurrentOTELContext();this.processRunOperation({action:"create",item:i,otelContext:e,apiKey:t?.apiKey,apiUrl:t?.apiUrl}).catch(console.error);return}let a=_(i);t?.apiKey!==void 0&&(r["x-api-key"]=t.apiKey),t?.workspaceId!==void 0&&(r["x-tenant-id"]=t.workspaceId);let s=(0,b.serialize)(a,`Creating run with id: ${a.id}`);await this.caller.call(async()=>{let e=await this._fetch(`${t?.apiUrl??this.apiUrl}/runs`,{method:"POST",headers:r,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:s});return await (0,g.raiseForStatus)(e,"create run",!0),e})}async batchIngestRuns({runCreates:e,runUpdates:t},r){if(void 0===e&&void 0===t)return;let n=await Promise.all(e?.map(e=>this.prepareRunCreateOrUpdateInputs(e))??[]),i=await Promise.all(t?.map(e=>this.prepareRunCreateOrUpdateInputs(e))??[]);if(n.length>0&&i.length>0){let e=n.reduce((e,t)=>(t.id&&(e[t.id]=t),e),{}),t=[];for(let r of i)void 0!==r.id&&e[r.id]?e[r.id]={...e[r.id],...r}:t.push(r);n=Object.values(e),i=t}let a={post:n,patch:i};if(!a.post.length&&!a.patch.length)return;let s={post:[],patch:[]};for(let e of["post","patch"]){let t=a[e].reverse(),r=t.pop();for(;void 0!==r;)s[e].push(r),r=t.pop()}if(s.post.length>0||s.patch.length>0){let e=s.post.map(e=>e.id).concat(s.patch.map(e=>e.id)).join(",");await this._postBatchIngestRuns((0,b.serialize)(s,`Ingesting runs with ids: ${e}`),r)}}async _postBatchIngestRuns(e,t){let r={...this.headers,"Content-Type":"application/json",Accept:"application/json"};t?.apiKey!==void 0&&(r["x-api-key"]=t.apiKey),await this.batchIngestCaller.call(async()=>{let n=await this._fetch(`${t?.apiUrl??this.apiUrl}/runs/batch`,{method:"POST",headers:r,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:e});return await (0,g.raiseForStatus)(n,"batch create run",!0),n})}async multipartIngestRuns({runCreates:e,runUpdates:t},r){if(void 0===e&&void 0===t)return;let n={},i=[];for(let t of e??[]){let e=await this.prepareRunCreateOrUpdateInputs(t);void 0!==e.id&&void 0!==e.attachments&&(n[e.id]=e.attachments),delete e.attachments,i.push(e)}let a=[];for(let e of t??[])a.push(await this.prepareRunCreateOrUpdateInputs(e));if(void 0!==i.find(e=>void 0===e.trace_id||void 0===e.dotted_order))throw Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(void 0!==a.find(e=>void 0===e.trace_id||void 0===e.dotted_order))throw Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(i.length>0&&a.length>0){let e=i.reduce((e,t)=>(t.id&&(e[t.id]=t),e),{}),t=[];for(let r of a)void 0!==r.id&&e[r.id]?e[r.id]={...e[r.id],...r}:t.push(r);i=Object.values(e),a=t}if(0===i.length&&0===a.length)return;let s=[],o=[];for(let[e,t]of[["post",i],["patch",a]])for(let r of t){let{inputs:t,outputs:i,events:a,extra:l,error:u,serialized:c,attachments:d,...p}=r,h={inputs:t,outputs:i,events:a,extra:l,error:u,serialized:c},f=(0,b.serialize)(p,`Serializing for multipart ingestion of run with id: ${p.id}`);for(let[t,r]of(o.push({name:`${e}.${p.id}`,payload:new Blob([f],{type:`application/json; length=${f.length}`})}),Object.entries(h))){if(void 0===r)continue;let n=(0,b.serialize)(r,`Serializing ${t} for multipart ingestion of run with id: ${p.id}`);o.push({name:`${e}.${p.id}.${t}`,payload:new Blob([n],{type:`application/json; length=${n.length}`})})}if(void 0!==p.id){let e=n[p.id];if(e)for(let[t,r]of(delete n[p.id],Object.entries(e))){let e,n;if(Array.isArray(r)?[e,n]=r:(e=r.mimeType,n=r.data),t.includes(".")){console.warn(`Skipping attachment '${t}' for run ${p.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}o.push({name:`attachment.${p.id}.${t}`,payload:new Blob([n],{type:`${e}; length=${n.byteLength}`})})}}s.push(`trace=${p.trace_id},id=${p.id}`)}await this._sendMultipartRequest(o,s.join("; "),r)}async _createNodeFetchBody(e,t){let r=[];for(let n of e)r.push(new Blob([`--${t}\r
`])),r.push(new Blob([`Content-Disposition: form-data; name="${n.name}"\r
`,`Content-Type: ${n.payload.type}\r
\r
`])),r.push(n.payload),r.push(new Blob(["\r\n"]));r.push(new Blob([`--${t}--\r
`]));let n=new Blob(r);return await n.arrayBuffer()}async _createMultipartStream(e,t){let r=new TextEncoder;return new ReadableStream({async start(n){let i=async e=>{"string"==typeof e?n.enqueue(r.encode(e)):n.enqueue(e)};for(let r of e){await i(`--${t}\r
`),await i(`Content-Disposition: form-data; name="${r.name}"\r
`),await i(`Content-Type: ${r.payload.type}\r
\r
`);let e=r.payload.stream().getReader();try{let t;for(;!(t=await e.read()).done;)n.enqueue(t.value)}finally{e.releaseLock()}await i("\r\n")}await i(`--${t}--\r
`),n.close()}})}async _sendMultipartRequest(e,t,r){let n="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),i=(0,y._globalFetchImplementationIsNodeFetch)(),a=()=>this._createNodeFetchBody(e,n),s=()=>this._createMultipartStream(e,n),o=async e=>this.batchIngestCaller.call(async()=>{let t=await e(),i={...this.headers,"Content-Type":`multipart/form-data; boundary=${n}`};r?.apiKey!==void 0&&(i["x-api-key"]=r.apiKey);let a=t;r?.useGzip&&"object"==typeof t&&"pipeThrough"in t&&(a=t.pipeThrough(new CompressionStream("gzip")),i["Content-Encoding"]="gzip");let s=await this._fetch(`${r?.apiUrl??this.apiUrl}/runs/multipart`,{method:"POST",headers:i,body:a,duplex:"half",signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(s,"Failed to send multipart request",!0),s});try{let e,n=!1;i||this.multipartStreamingDisabled||"bun"===(0,d.getEnv)()?e=await o(a):(n=!0,e=await o(s)),(!this.multipartStreamingDisabled||n)&&422===e.status&&(r?.apiUrl??this.apiUrl)!==E&&(console.warn(`Streaming multipart upload to ${r?.apiUrl??this.apiUrl}/runs/multipart failed. This usually means the host does not support chunked uploads. Retrying with a buffered upload for operation "${t}".`),this.multipartStreamingDisabled=!0,e=await o(a))}catch(e){console.warn(`${e.message.trim()}

Context: ${t}`)}}async updateRun(e,t,r){(0,h.assertUuid)(e),t.inputs&&(t.inputs=await this.processInputs(t.inputs)),t.outputs&&(t.outputs=await this.processOutputs(t.outputs));let n={...t,id:e};if(!this._filterForSampling([n],!0).length)return;if(this.autoBatchTracing&&void 0!==n.trace_id&&void 0!==n.dotted_order){let e=this._cloneCurrentOTELContext();return void 0!==t.end_time&&void 0===n.parent_run_id&&this.blockOnRootRunFinalization&&!this.manualFlushMode?void await this.processRunOperation({action:"update",item:n,otelContext:e,apiKey:r?.apiKey,apiUrl:r?.apiUrl}).catch(console.error):void this.processRunOperation({action:"update",item:n,otelContext:e,apiKey:r?.apiKey,apiUrl:r?.apiUrl}).catch(console.error)}let i={...this.headers,"Content-Type":"application/json"};r?.apiKey!==void 0&&(i["x-api-key"]=r.apiKey),r?.workspaceId!==void 0&&(i["x-tenant-id"]=r.workspaceId);let a=(0,b.serialize)(t,`Serializing payload to update run with id: ${e}`);await this.caller.call(async()=>{let t=await this._fetch(`${r?.apiUrl??this.apiUrl}/runs/${e}`,{method:"PATCH",headers:i,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await (0,g.raiseForStatus)(t,"update run",!0),t})}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){(0,h.assertUuid)(e);let r=await this._get(`/runs/${e}`);return t&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:t,projectOpts:r}){if(void 0!==t){let e;e=t.session_id?t.session_id:r?.projectName?(await this.readProject({projectName:r?.projectName})).id:r?.projectId?r?.projectId:(await this.readProject({projectName:(0,d.getLangSmithEnvironmentVariable)("PROJECT")||"default"})).id;let n=await this._getTenantId();return`${this.getHostUrl()}/o/${n}/projects/p/${e}/r/${t.id}?poll=true`}if(void 0!==e){let t=await this.readRun(e);if(!t.app_path)throw Error(`Run ${e} has no app_path`);let r=this.getHostUrl();return`${r}${t.app_path}`}throw Error("Must provide either runId or run")}async _loadChildRuns(e){let t=await v(this.listRuns({isRoot:!1,projectId:e.session_id,traceId:e.trace_id})),r={},n={};for(let i of(t.sort((e,t)=>(e?.dotted_order??"").localeCompare(t?.dotted_order??"")),t)){if(null===i.parent_run_id||void 0===i.parent_run_id)throw Error(`Child run ${i.id} has no parent`);i.dotted_order?.startsWith(e.dotted_order??"")&&i.id!==e.id&&(i.parent_run_id in r||(r[i.parent_run_id]=[]),r[i.parent_run_id].push(i),n[i.id]=i)}for(let t in e.child_runs=r[e.id]||[],r)t!==e.id&&(n[t].child_runs=r[t]);return e}async *listRuns(e){let{projectId:t,projectName:r,parentRunId:n,traceId:i,referenceExampleId:a,startTime:s,executionOrder:o,isRoot:l,runType:u,error:c,id:d,query:p,filter:h,traceFilter:f,treeFilter:m,limit:g,select:y,order:b}=e,_=[];if(t&&(_=Array.isArray(t)?t:[t]),r){let e=Array.isArray(r)?r:[r],t=await Promise.all(e.map(e=>this.readProject({projectName:e}).then(e=>e.id)));_.push(...t)}let v={session:_.length?_:null,run_type:u,reference_example:a,query:p,filter:h,trace_filter:f,tree_filter:m,execution_order:o,parent_run:n,start_time:s?s.toISOString():null,error:c,id:d,limit:g,trace:i,select:y||["app_path","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],is_root:l,order:b},w=0;for await(let e of this._getCursorPaginatedList("/runs/query",v))if(g){if(w>=g)break;if(e.length+w>g){let t=e.slice(0,g-w);yield*t;break}w+=e.length,yield*e}else yield*e}async *listGroupRuns(e){let{projectId:t,projectName:r,groupBy:n,filter:i,startTime:a,endTime:s,limit:o,offset:l}=e,u={session_id:t||(await this.readProject({projectName:r})).id,group_by:n,filter:i,start_time:a?a.toISOString():null,end_time:s?s.toISOString():null,limit:Number(o)||100},c=Number(l)||0,d="/runs/group",p=`${this.apiUrl}${d}`;for(;;){let e=JSON.stringify(Object.fromEntries(Object.entries({...u,offset:c}).filter(([e,t])=>void 0!==t))),t=await this.caller.call(async()=>{let t=await this._fetch(p,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:e});return await (0,g.raiseForStatus)(t,`Failed to fetch ${d}`),t}),{groups:r,total:n}=await t.json();if(0===r.length)break;for(let e of r)yield e;if((c+=r.length)>=n)break}}async getRunStats({id:e,trace:t,parentRun:r,runType:n,projectNames:i,projectIds:a,referenceExampleIds:s,startTime:o,endTime:l,error:u,query:c,filter:d,traceFilter:p,treeFilter:h,isRoot:f,dataSourceType:m}){let y=a||[];i&&(y=[...a||[],...await Promise.all(i.map(e=>this.readProject({projectName:e}).then(e=>e.id)))]);let b=JSON.stringify(Object.fromEntries(Object.entries({id:e,trace:t,parent_run:r,run_type:n,session:y,reference_example:s,start_time:o,end_time:l,error:u,query:c,filter:d,trace_filter:p,tree_filter:h,is_root:f,data_source_type:m}).filter(([e,t])=>void 0!==t))),_=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/runs/stats`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:b});return await (0,g.raiseForStatus)(e,"get run stats"),e});return await _.json()}async shareRun(e,{shareId:t}={}){let r={run_id:e,share_token:t||s.v4()};(0,h.assertUuid)(e);let n=JSON.stringify(r),i=await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:n});return await (0,g.raiseForStatus)(t,"share run"),t}),a=await i.json();if(null===a||!("share_token"in a))throw Error("Invalid response from server");return`${this.getHostUrl()}/public/${a.share_token}/r`}async unshareRun(e){(0,h.assertUuid)(e),await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,"unshare run",!0),t})}async readRunSharedLink(e){(0,h.assertUuid)(e);let t=await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,"read run shared link"),t}),r=await t.json();if(null!==r&&"share_token"in r)return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:t}={}){let r=new URLSearchParams({share_token:e});if(void 0!==t)for(let e of t)r.append("id",e);(0,h.assertUuid)(e);let n=await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,"list shared runs"),t});return await n.json()}async readDatasetSharedSchema(e,t){if(!e&&!t)throw Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id),(0,h.assertUuid)(e);let r=await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,"read dataset shared schema"),t}),n=await r.json();return n.url=`${this.getHostUrl()}/public/${n.share_token}/d`,n}async shareDataset(e,t){if(!e&&!t)throw Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id);let r={dataset_id:e};(0,h.assertUuid)(e);let n=JSON.stringify(r),i=await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:n});return await (0,g.raiseForStatus)(t,"share dataset"),t}),a=await i.json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async unshareDataset(e){(0,h.assertUuid)(e),await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,"unshare dataset",!0),t})}async readSharedDataset(e){(0,h.assertUuid)(e);let t=await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,"read shared dataset"),t});return await t.json()}async listSharedExamples(e,t){let r={};t?.exampleIds&&(r.id=t.exampleIds);let n=new URLSearchParams;Object.entries(r).forEach(([e,t])=>{Array.isArray(t)?t.forEach(t=>n.append(e,t)):n.append(e,t)});let i=await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/public/${e}/examples?${n.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,"list shared examples"),t}),a=await i.json();if(!i.ok){if("detail"in a)throw Error(`Failed to list shared examples.
Status: ${i.status}
Message: ${Array.isArray(a.detail)?a.detail.join("\n"):"Unspecified error"}`);throw Error(`Failed to list shared examples: ${i.status} ${i.statusText}`)}return a.map(e=>({...e,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:t=null,metadata:r=null,upsert:n=!1,projectExtra:i=null,referenceDatasetId:a=null}){let s=`${this.apiUrl}/sessions${n?"?upsert=true":""}`,o=i||{};r&&(o.metadata=r);let l={name:e,extra:o,description:t};null!==a&&(l.reference_dataset_id=a);let u=JSON.stringify(l),c=await this.caller.call(async()=>{let e=await this._fetch(s,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:u});return await (0,g.raiseForStatus)(e,"create project"),e});return await c.json()}async updateProject(e,{name:t=null,description:r=null,metadata:n=null,projectExtra:i=null,endTime:a=null}){let s=`${this.apiUrl}/sessions/${e}`,o=i;n&&(o={...o||{},metadata:n});let l=JSON.stringify({name:t,extra:o,description:r,end_time:a?new Date(a).toISOString():null}),u=await this.caller.call(async()=>{let e=await this._fetch(s,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await (0,g.raiseForStatus)(e,"update project"),e});return await u.json()}async hasProject({projectId:e,projectName:t}){let r="/sessions",n=new URLSearchParams;if(void 0!==e&&void 0!==t)throw Error("Must provide either projectName or projectId, not both");if(void 0!==e)(0,h.assertUuid)(e),r+=`/${e}`;else if(void 0!==t)n.append("name",t);else throw Error("Must provide projectName or projectId");let i=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}${r}?${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(e,"has project"),e});try{let e=await i.json();if(!i.ok)return!1;if(Array.isArray(e))return e.length>0;return!0}catch(e){return!1}}async readProject({projectId:e,projectName:t,includeStats:r}){let n,i="/sessions",a=new URLSearchParams;if(void 0!==e&&void 0!==t)throw Error("Must provide either projectName or projectId, not both");if(void 0!==e)(0,h.assertUuid)(e),i+=`/${e}`;else if(void 0!==t)a.append("name",t);else throw Error("Must provide projectName or projectId");void 0!==r&&a.append("include_stats",r.toString());let s=await this._get(i,a);if(Array.isArray(s)){if(0===s.length)throw Error(`Project[id=${e}, name=${t}] not found`);n=s[0]}else n=s;return n}async getProjectUrl({projectId:e,projectName:t}){if(void 0===e&&void 0===t)throw Error("Must provide either projectName or projectId");let r=await this.readProject({projectId:e,projectName:t}),n=await this._getTenantId();return`${this.getHostUrl()}/o/${n}/projects/p/${r.id}`}async getDatasetUrl({datasetId:e,datasetName:t}){if(void 0===e&&void 0===t)throw Error("Must provide either datasetName or datasetId");let r=await this.readDataset({datasetId:e,datasetName:t}),n=await this._getTenantId();return`${this.getHostUrl()}/o/${n}/datasets/${r.id}`}async _getTenantId(){if(null!==this._tenantId)return this._tenantId;let e=new URLSearchParams({limit:"1"});for await(let t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw Error("No projects found to resolve tenant.")}async *listProjects({projectIds:e,name:t,nameContains:r,referenceDatasetId:n,referenceDatasetName:i,includeStats:a,datasetVersion:s,referenceFree:o,metadata:l}={}){let u=new URLSearchParams;if(void 0!==e)for(let t of e)u.append("id",t);if(void 0!==t&&u.append("name",t),void 0!==r&&u.append("name_contains",r),void 0!==n)u.append("reference_dataset",n);else if(void 0!==i){let e=await this.readDataset({datasetName:i});u.append("reference_dataset",e.id)}for await(let e of(void 0!==a&&u.append("include_stats",a.toString()),void 0!==s&&u.append("dataset_version",s),void 0!==o&&u.append("reference_free",o.toString()),void 0!==l&&u.append("metadata",JSON.stringify(l)),this._getPaginated("/sessions",u)))yield*e}async deleteProject({projectId:e,projectName:t}){let r;if(void 0===e&&void 0===t)throw Error("Must provide projectName or projectId");if(void 0!==e&&void 0!==t)throw Error("Must provide either projectName or projectId, not both");r=void 0===e?(await this.readProject({projectName:t})).id:e,(0,h.assertUuid)(r),await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(e,`delete session ${r} (${t})`,!0),e})}async uploadCsv({csvFile:e,fileName:t,inputKeys:r,outputKeys:n,description:i,dataType:a,name:s}){let o=`${this.apiUrl}/datasets/upload`,l=new FormData;l.append("file",e,t),r.forEach(e=>{l.append("input_keys",e)}),n.forEach(e=>{l.append("output_keys",e)}),i&&l.append("description",i),a&&l.append("data_type",a),s&&l.append("name",s);let u=await this.caller.call(async()=>{let e=await this._fetch(o,{method:"POST",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await (0,g.raiseForStatus)(e,"upload CSV"),e});return await u.json()}async createDataset(e,{description:t,dataType:r,inputsSchema:n,outputsSchema:i,metadata:a}={}){let s={name:e,description:t,extra:a?{metadata:a}:void 0};r&&(s.data_type=r),n&&(s.inputs_schema_definition=n),i&&(s.outputs_schema_definition=i);let o=JSON.stringify(s),l=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:o});return await (0,g.raiseForStatus)(e,"create dataset"),e});return await l.json()}async readDataset({datasetId:e,datasetName:t}){let r,n="/datasets",i=new URLSearchParams({limit:"1"});if(e&&t)throw Error("Must provide either datasetName or datasetId, not both");if(e)(0,h.assertUuid)(e),n+=`/${e}`;else if(t)i.append("name",t);else throw Error("Must provide datasetName or datasetId");let a=await this._get(n,i);if(Array.isArray(a)){if(0===a.length)throw Error(`Dataset[id=${e}, name=${t}] not found`);r=a[0]}else r=a;return r}async hasDataset({datasetId:e,datasetName:t}){try{return await this.readDataset({datasetId:e,datasetName:t}),!0}catch(e){if(e instanceof Error&&e.message.toLocaleLowerCase().includes("not found"))return!1;throw e}}async diffDatasetVersions({datasetId:e,datasetName:t,fromVersion:r,toVersion:n}){let i=e;if(void 0===i&&void 0===t)throw Error("Must provide either datasetName or datasetId");if(void 0!==i&&void 0!==t)throw Error("Must provide either datasetName or datasetId, not both");void 0===i&&(i=(await this.readDataset({datasetName:t})).id);let a=new URLSearchParams({from_version:"string"==typeof r?r:r.toISOString(),to_version:"string"==typeof n?n:n.toISOString()});return await this._get(`/datasets/${i}/versions/diff`,a)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:t}){if(void 0!==e);else if(void 0!==t)e=(await this.readDataset({datasetName:t})).id;else throw Error("Must provide either datasetName or datasetId");let r=await this._getResponse(`/datasets/${e}/openai_ft`);return(await r.text()).trim().split("\n").map(e=>JSON.parse(e))}async *listDatasets({limit:e=100,offset:t=0,datasetIds:r,datasetName:n,datasetNameContains:i,metadata:a}={}){let s=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(void 0!==r)for(let e of r)s.append("id",e);for await(let e of(void 0!==n&&s.append("name",n),void 0!==i&&s.append("name_contains",i),void 0!==a&&s.append("metadata",JSON.stringify(a)),this._getPaginated("/datasets",s)))yield*e}async updateDataset(e){let{datasetId:t,datasetName:r,...n}=e;if(!t&&!r)throw Error("Must provide either datasetName or datasetId");let i=t??(await this.readDataset({datasetName:r})).id;(0,h.assertUuid)(i);let a=JSON.stringify(n),s=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/datasets/${i}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await (0,g.raiseForStatus)(e,"update dataset"),e});return await s.json()}async updateDatasetTag(e){let{datasetId:t,datasetName:r,asOf:n,tag:i}=e;if(!t&&!r)throw Error("Must provide either datasetName or datasetId");let a=t??(await this.readDataset({datasetName:r})).id;(0,h.assertUuid)(a);let s=JSON.stringify({as_of:"string"==typeof n?n:n.toISOString(),tag:i});await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/datasets/${a}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:s});return await (0,g.raiseForStatus)(e,"update dataset tags",!0),e})}async deleteDataset({datasetId:e,datasetName:t}){let r="/datasets",n=e;if(void 0!==e&&void 0!==t)throw Error("Must provide either datasetName or datasetId, not both");if(void 0!==t&&(n=(await this.readDataset({datasetName:t})).id),void 0!==n)(0,h.assertUuid)(n),r+=`/${n}`;else throw Error("Must provide datasetName or datasetId");await this.caller.call(async()=>{let e=await this._fetch(this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(e,`delete ${r}`,!0),e})}async indexDataset({datasetId:e,datasetName:t,tag:r}){let n=e;if(n||t)if(n&&t)throw Error("Must provide either datasetName or datasetId, not both");else n||(n=(await this.readDataset({datasetName:t})).id);else throw Error("Must provide either datasetName or datasetId");(0,h.assertUuid)(n);let i=JSON.stringify({tag:r}),a=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/datasets/${n}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:i});return await (0,g.raiseForStatus)(e,"index dataset"),e});await a.json()}async similarExamples(e,t,r,{filter:n}={}){let i={limit:r,inputs:e};void 0!==n&&(i.filter=n),(0,h.assertUuid)(t);let a=JSON.stringify(i),s=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/datasets/${t}/search`,{headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,method:"POST",body:a});return await (0,g.raiseForStatus)(e,"fetch similar examples"),e});return(await s.json()).examples}async createExample(e,t,r){let n;if(I(e)&&(void 0!==t||void 0!==r))throw Error("Cannot provide outputs or options when using ExampleCreate object");let i=t?r?.datasetId:e.dataset_id,a=t?r?.datasetName:e.dataset_name;if(void 0===i&&void 0===a)throw Error("Must provide either datasetName or datasetId");if(void 0!==i&&void 0!==a)throw Error("Must provide either datasetName or datasetId, not both");void 0===i&&(i=(await this.readDataset({datasetName:a})).id);let o=(t?r?.createdAt:e.created_at)||new Date;n=I(e)?e:{inputs:e,outputs:t,created_at:o?.toISOString(),id:r?.exampleId,metadata:r?.metadata,split:r?.split,source_run_id:r?.sourceRunId,use_source_run_io:r?.useSourceRunIO,use_source_run_attachments:r?.useSourceRunAttachments,attachments:r?.attachments};let l=await this._uploadExamplesMultipart(i,[n]);return await this.readExample(l.example_ids?.[0]??s.v4())}async createExamples(e){if(Array.isArray(e)){if(0===e.length)return[];let t=e[0].dataset_id,r=e[0].dataset_name;if(void 0===t&&void 0===r)throw Error("Must provide either datasetName or datasetId");if(void 0!==t&&void 0!==r)throw Error("Must provide either datasetName or datasetId, not both");void 0===t&&(t=(await this.readDataset({datasetName:r})).id);let n=await this._uploadExamplesMultipart(t,e);return await Promise.all(n.example_ids.map(e=>this.readExample(e)))}let{inputs:t,outputs:r,metadata:n,splits:i,sourceRunIds:a,useSourceRunIOs:s,useSourceRunAttachments:o,attachments:l,exampleIds:u,datasetId:c,datasetName:d}=e;if(void 0===t)throw Error("Must provide inputs when using legacy parameters");let p=c;if(void 0===p&&void 0===d)throw Error("Must provide either datasetName or datasetId");if(void 0!==p&&void 0!==d)throw Error("Must provide either datasetName or datasetId, not both");void 0===p&&(p=(await this.readDataset({datasetName:d})).id);let h=t.map((e,t)=>({dataset_id:p,inputs:e,outputs:r?.[t],metadata:n?.[t],split:i?.[t],id:u?.[t],attachments:l?.[t],source_run_id:a?.[t],use_source_run_io:s?.[t],use_source_run_attachments:o?.[t]})),f=await this._uploadExamplesMultipart(p,h);return await Promise.all(f.example_ids.map(e=>this.readExample(e)))}async createLLMExample(e,t,r){return this.createExample({input:e},{output:t},r)}async createChatExample(e,t,r){let n=e.map(e=>(0,c.isLangChainMessage)(e)?(0,c.convertLangChainMessageToExample)(e):e),i=(0,c.isLangChainMessage)(t)?(0,c.convertLangChainMessageToExample)(t):t;return this.createExample({input:n},{output:i},r)}async readExample(e){(0,h.assertUuid)(e);let t=`/examples/${e}`,{attachment_urls:r,...n}=await this._get(t);return r&&(n.attachments=Object.entries(r).reduce((e,[t,r])=>(e[t.slice(11)]={presigned_url:r.presigned_url,mime_type:r.mime_type},e),{})),n}async *listExamples({datasetId:e,datasetName:t,exampleIds:r,asOf:n,splits:i,inlineS3Urls:a,metadata:s,limit:o,offset:l,filter:u,includeAttachments:c}={}){let d;if(void 0!==e&&void 0!==t)throw Error("Must provide either datasetName or datasetId, not both");if(void 0!==e)d=e;else if(void 0!==t)d=(await this.readDataset({datasetName:t})).id;else throw Error("Must provide a datasetName or datasetId");let p=new URLSearchParams({dataset:d}),h=n?"string"==typeof n?n:n?.toISOString():void 0;if(h&&p.append("as_of",h),p.append("inline_s3_urls",(a??!0).toString()),void 0!==r)for(let e of r)p.append("id",e);if(void 0!==i)for(let e of i)p.append("splits",e);if(void 0!==s){let e=JSON.stringify(s);p.append("metadata",e)}void 0!==o&&p.append("limit",o.toString()),void 0!==l&&p.append("offset",l.toString()),void 0!==u&&p.append("filter",u),!0===c&&["attachment_urls","outputs","metadata"].forEach(e=>p.append("select",e));let f=0;for await(let e of this._getPaginated("/examples",p)){for(let t of e){let{attachment_urls:e,...r}=t;e&&(r.attachments=Object.entries(e).reduce((e,[t,r])=>(e[t.slice(11)]={presigned_url:r.presigned_url,mime_type:r.mime_type||void 0},e),{})),yield r,f++}if(void 0!==o&&f>=o)break}}async deleteExample(e){(0,h.assertUuid)(e);let t=`/examples/${e}`;await this.caller.call(async()=>{let e=await this._fetch(this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(e,`delete ${t}`,!0),e})}async updateExample(e,t){let r,n,i;return r=t?e:e.id,(0,h.assertUuid)(r),i=void 0!==(n=t?{id:r,...t}:e).dataset_id?n.dataset_id:(await this.readExample(r)).dataset_id,this._updateExamplesMultipart(i,[n])}async updateExamples(e){let t;return t=void 0===e[0].dataset_id?(await this.readExample(e[0].id)).dataset_id:e[0].dataset_id,this._updateExamplesMultipart(t,e)}async readDatasetVersion({datasetId:e,datasetName:t,asOf:r,tag:n}){let i;if(i=e||(await this.readDataset({datasetName:t})).id,(0,h.assertUuid)(i),r&&n||!r&&!n)throw Error("Exactly one of asOf and tag must be specified.");let a=new URLSearchParams;void 0!==r&&a.append("as_of","string"==typeof r?r:r.toISOString()),void 0!==n&&a.append("tag",n);let s=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/datasets/${i}/version?${a.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(e,"read dataset version"),e});return await s.json()}async listDatasetSplits({datasetId:e,datasetName:t,asOf:r}){let n;if(void 0===e&&void 0===t)throw Error("Must provide dataset name or ID");if(void 0!==e&&void 0!==t)throw Error("Must provide either datasetName or datasetId, not both");n=void 0===e?(await this.readDataset({datasetName:t})).id:e,(0,h.assertUuid)(n);let i=new URLSearchParams,a=r?"string"==typeof r?r:r?.toISOString():void 0;return a&&i.append("as_of",a),await this._get(`/datasets/${n}/splits`,i)}async updateDatasetSplits({datasetId:e,datasetName:t,splitName:r,exampleIds:n,remove:i=!1}){let a;if(void 0===e&&void 0===t)throw Error("Must provide dataset name or ID");if(void 0!==e&&void 0!==t)throw Error("Must provide either datasetName or datasetId, not both");a=void 0===e?(await this.readDataset({datasetName:t})).id:e,(0,h.assertUuid)(a);let s=JSON.stringify({split_name:r,examples:n.map(e=>((0,h.assertUuid)(e),e)),remove:i});await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/datasets/${a}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:s});return await (0,g.raiseForStatus)(e,"update dataset splits",!0),e})}async evaluateRun(e,t,{sourceInfo:r,loadChildRuns:n,referenceExample:i}={loadChildRuns:!1}){let a;if((0,f.warnOnce)("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead."),"string"==typeof e)a=await this.readRun(e,{loadChildRuns:n});else if("object"==typeof e&&"id"in e)a=e;else throw Error(`Invalid run type: ${typeof e}`);null!==a.reference_example_id&&void 0!==a.reference_example_id&&(i=await this.readExample(a.reference_example_id));let s=await t.evaluateRun(a,i),[o,l]=await this._logEvaluationFeedback(s,a,r);return l[0]}async createFeedback(e,t,{score:r,value:n,correction:i,comment:a,sourceInfo:o,feedbackSourceType:l="api",sourceRunId:u,feedbackId:c,feedbackConfig:d,projectId:p,comparativeExperimentId:f}){if(!e&&!p)throw Error("One of runId or projectId must be provided");if(e&&p)throw Error("Only one of runId or projectId can be provided");let m={type:l??"api",metadata:o??{}};void 0===u||m?.metadata===void 0||m.metadata.__run||(m.metadata.__run={run_id:u}),m?.metadata!==void 0&&m.metadata.__run?.run_id!==void 0&&(0,h.assertUuid)(m.metadata.__run.run_id);let y={id:c??s.v4(),run_id:e,key:t,score:P(r),value:n,correction:i,comment:a,feedback_source:m,comparative_experiment_id:f,feedbackConfig:d,session_id:p},b=JSON.stringify(y),_=`${this.apiUrl}/feedback`;return await this.caller.call(async()=>{let e=await this._fetch(_,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:b});return await (0,g.raiseForStatus)(e,"create feedback",!0),e}),y}async updateFeedback(e,{score:t,value:r,correction:n,comment:i}){let a={};null!=t&&(a.score=P(t)),null!=r&&(a.value=r),null!=n&&(a.correction=n),null!=i&&(a.comment=i),(0,h.assertUuid)(e);let s=JSON.stringify(a);await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:s});return await (0,g.raiseForStatus)(t,"update feedback",!0),t})}async readFeedback(e){(0,h.assertUuid)(e);let t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){(0,h.assertUuid)(e);let t=`/feedback/${e}`;await this.caller.call(async()=>{let e=await this._fetch(this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(e,`delete ${t}`,!0),e})}async *listFeedback({runIds:e,feedbackKeys:t,feedbackSourceTypes:r}={}){let n=new URLSearchParams;if(e)for(let t of e)(0,h.assertUuid)(t),n.append("run",t);if(t)for(let e of t)n.append("key",e);if(r)for(let e of r)n.append("source",e);for await(let e of this._getPaginated("/feedback",n))yield*e}async createPresignedFeedbackToken(e,t,{expiration:r,feedbackConfig:n}={}){let i={run_id:e,feedback_key:t,feedback_config:n};r?"string"==typeof r?i.expires_at=r:(r?.hours||r?.minutes||r?.days)&&(i.expires_in=r):i.expires_in={hours:3};let a=JSON.stringify(i),s=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await (0,g.raiseForStatus)(e,"create presigned feedback token"),e});return await s.json()}async createComparativeExperiment({name:e,experimentIds:t,referenceDatasetId:r,createdAt:n,description:i,metadata:a,id:s}){if(0===t.length)throw Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:t[0]})).reference_dataset_id),null==!r)throw Error("A reference dataset is required");let o={id:s,name:e,experiment_ids:t,reference_dataset_id:r,description:i,created_at:(n??new Date)?.toISOString(),extra:{}};a&&(o.extra.metadata=a);let l=JSON.stringify(o);return(await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await (0,g.raiseForStatus)(e,"create comparative experiment"),e})).json()}async *listPresignedFeedbackTokens(e){(0,h.assertUuid)(e);let t=new URLSearchParams({run_id:e});for await(let e of this._getPaginated("/feedback/tokens",t))yield*e}_selectEvalResults(e){return"results"in e?e.results:Array.isArray(e)?e:[e]}async _logEvaluationFeedback(e,t,r){let n=this._selectEvalResults(e),i=[];for(let e of n){let n=r||{};e.evaluatorInfo&&(n={...e.evaluatorInfo,...n});let a=null;e.targetRunId?a=e.targetRunId:t&&(a=t.id),i.push(await this.createFeedback(a,e.key,{score:e.score,value:e.value,comment:e.comment,correction:e.correction,sourceInfo:n,sourceRunId:e.sourceRunId,feedbackConfig:e.feedbackConfig,feedbackSourceType:"model"}))}return[n,i]}async logEvaluationFeedback(e,t,r){let[n]=await this._logEvaluationFeedback(e,t,r);return n}async *listAnnotationQueues(e={}){let{queueIds:t,name:r,nameContains:n,limit:i}=e,a=new URLSearchParams;t&&t.forEach((e,t)=>{(0,h.assertUuid)(e,`queueIds[${t}]`),a.append("ids",e)}),r&&a.append("name",r),n&&a.append("name_contains",n),a.append("limit",(void 0!==i?Math.min(i,100):100).toString());let s=0;for await(let e of this._getPaginated("/annotation-queues",a))if(yield*e,s++,void 0!==i&&s>=i)break}async createAnnotationQueue(e){let{name:t,description:r,queueId:n,rubricInstructions:i}=e,a=JSON.stringify(Object.fromEntries(Object.entries({name:t,description:r,id:n||s.v4(),rubric_instructions:i}).filter(([e,t])=>void 0!==t)));return(await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await (0,g.raiseForStatus)(e,"create annotation queue"),e})).json()}async readAnnotationQueue(e){return(await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/annotation-queues/${(0,h.assertUuid)(e,"queueId")}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,"read annotation queue"),t})).json()}async updateAnnotationQueue(e,t){let{name:r,description:n,rubricInstructions:i}=t,a=JSON.stringify({name:r,description:n,rubric_instructions:i});await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/annotation-queues/${(0,h.assertUuid)(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await (0,g.raiseForStatus)(t,"update annotation queue",!0),t})}async deleteAnnotationQueue(e){await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/annotation-queues/${(0,h.assertUuid)(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,"delete annotation queue",!0),t})}async addRunsToAnnotationQueue(e,t){let r=JSON.stringify(t.map((e,t)=>(0,h.assertUuid)(e,`runIds[${t}]`).toString()));await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/annotation-queues/${(0,h.assertUuid)(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await (0,g.raiseForStatus)(t,"add runs to annotation queue",!0),t})}async getRunFromAnnotationQueue(e,t){let r=`/annotation-queues/${(0,h.assertUuid)(e,"queueId")}/run`;return(await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}${r}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(e,"get run from annotation queue"),e})).json()}async deleteRunFromAnnotationQueue(e,t){await this.caller.call(async()=>{let r=await this._fetch(`${this.apiUrl}/annotation-queues/${(0,h.assertUuid)(e,"queueId")}/runs/${(0,h.assertUuid)(t,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(r,"delete run from annotation queue",!0),r})}async getSizeFromAnnotationQueue(e){return(await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/annotation-queues/${(0,h.assertUuid)(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,"get size from annotation queue"),t})).json()}async _currentTenantIsOwner(e){let t=await this._getSettings();return"-"==e||t.tenant_handle===e}async _ownerConflictError(e,t){let r=await this._getSettings();return Error(`Cannot ${e} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${t}`)}async _getLatestCommitHash(e){let t=await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(t,"get latest commit hash"),t}),r=await t.json();if(0!==r.commits.length)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){let[r,n,i]=(0,m.parsePromptIdentifier)(e),a=JSON.stringify({like:t});return(await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/likes/${r}/${n}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await (0,g.raiseForStatus)(e,`${t?"like":"unlike"} prompt`),e})).json()}async _getPromptUrl(e){let[t,r,n]=(0,m.parsePromptIdentifier)(e);if(await this._currentTenantIsOwner(t)){let e=await this._getSettings();return"latest"!==n?`${this.getHostUrl()}/prompts/${r}/${n.substring(0,8)}?organizationId=${e.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${e.id}`}return"latest"!==n?`${this.getHostUrl()}/hub/${t}/${r}/${n.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${r}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async *listCommits(e){for await(let t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,e=>e.commits))yield*t}async *listPrompts(e){let t=new URLSearchParams;for await(let r of(t.append("sort_field",e?.sortField??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!e?.isArchived).toString()),e?.isPublic!==void 0&&t.append("is_public",e.isPublic.toString()),e?.query&&t.append("query",e.query),this._getPaginated("/repos",t,e=>e.repos)))yield*r}async getPrompt(e){let[t,r,n]=(0,m.parsePromptIdentifier)(e),i=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/repos/${t}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return e?.status===404?null:(await (0,g.raiseForStatus)(e,"get prompt"),e)}),a=await i?.json();return a?.repo?a.repo:null}async createPrompt(e,t){let r=await this._getSettings();if(t?.isPublic&&!r.tenant_handle)throw Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle.
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);let[n,i,a]=(0,m.parsePromptIdentifier)(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("create a prompt",n);let s=JSON.stringify({repo_handle:i,...t?.description&&{description:t.description},...t?.readme&&{readme:t.readme},...t?.tags&&{tags:t.tags},is_public:!!t?.isPublic}),o=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:s});return await (0,g.raiseForStatus)(e,"create prompt"),e}),{repo:l}=await o.json();return l}async createCommit(e,t,r){if(!await this.promptExists(e))throw Error("Prompt does not exist, you must create it first.");let[n,i,a]=(0,m.parsePromptIdentifier)(e),s=r?.parentCommitHash!=="latest"&&r?.parentCommitHash?r?.parentCommitHash:await this._getLatestCommitHash(`${n}/${i}`),o=JSON.stringify({manifest:JSON.parse(JSON.stringify(t)),parent_commit:s}),l=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/commits/${n}/${i}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:o});return await (0,g.raiseForStatus)(e,"create commit"),e}),u=await l.json();return this._getPromptUrl(`${n}/${i}${u.commit_hash?`:${u.commit_hash}`:""}`)}async updateExamplesMultipart(e,t=[]){return this._updateExamplesMultipart(e,t)}async _updateExamplesMultipart(e,t=[]){if(!await this._getDatasetExamplesMultiPartSupport())throw Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");let r=new FormData;for(let e of t){let t=e.id,n={...e.metadata&&{metadata:e.metadata},...e.split&&{split:e.split}},i=new Blob([(0,b.serialize)(n,`Serializing body for example with id: ${t}`)],{type:"application/json"});if(r.append(t,i),e.inputs){let n=new Blob([(0,b.serialize)(e.inputs,`Serializing inputs for example with id: ${t}`)],{type:"application/json"});r.append(`${t}.inputs`,n)}if(e.outputs){let n=new Blob([(0,b.serialize)(e.outputs,`Serializing outputs whle updating example with id: ${t}`)],{type:"application/json"});r.append(`${t}.outputs`,n)}if(e.attachments)for(let[n,i]of Object.entries(e.attachments)){let e,a;Array.isArray(i)?[e,a]=i:(e=i.mimeType,a=i.data);let s=new Blob([a],{type:`${e}; length=${a.byteLength}`});r.append(`${t}.attachment.${n}`,s)}if(e.attachments_operations){let n=new Blob([(0,b.serialize)(e.attachments_operations,`Serializing attachments while updating example with id: ${t}`)],{type:"application/json"});r.append(`${t}.attachments_operations`,n)}}let n=e??t[0]?.dataset_id;return(await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${n}/examples`)}`,{method:"PATCH",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await (0,g.raiseForStatus)(e,"update examples"),e})).json()}async uploadExamplesMultipart(e,t=[]){return this._uploadExamplesMultipart(e,t)}async _uploadExamplesMultipart(e,t=[]){if(!await this._getDatasetExamplesMultiPartSupport())throw Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");let r=new FormData;for(let e of t){let t=(e.id??s.v4()).toString(),n={created_at:e.created_at,...e.metadata&&{metadata:e.metadata},...e.split&&{split:e.split},...e.source_run_id&&{source_run_id:e.source_run_id},...e.use_source_run_io&&{use_source_run_io:e.use_source_run_io},...e.use_source_run_attachments&&{use_source_run_attachments:e.use_source_run_attachments}},i=new Blob([(0,b.serialize)(n,`Serializing body for uploaded example with id: ${t}`)],{type:"application/json"});if(r.append(t,i),e.inputs){let n=new Blob([(0,b.serialize)(e.inputs,`Serializing inputs for uploaded example with id: ${t}`)],{type:"application/json"});r.append(`${t}.inputs`,n)}if(e.outputs){let n=new Blob([(0,b.serialize)(e.outputs,`Serializing outputs for uploaded example with id: ${t}`)],{type:"application/json"});r.append(`${t}.outputs`,n)}if(e.attachments)for(let[n,i]of Object.entries(e.attachments)){let e,a;Array.isArray(i)?[e,a]=i:(e=i.mimeType,a=i.data);let s=new Blob([a],{type:`${e}; length=${a.byteLength}`});r.append(`${t}.attachment.${n}`,s)}}return(await this.caller.call(async()=>{let t=await this._fetch(`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${e}/examples`)}`,{method:"POST",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await (0,g.raiseForStatus)(t,"upload examples"),t})).json()}async updatePrompt(e,t){if(!await this.promptExists(e))throw Error("Prompt does not exist, you must create it first.");let[r,n]=(0,m.parsePromptIdentifier)(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);let i={};if(t?.description!==void 0&&(i.description=t.description),t?.readme!==void 0&&(i.readme=t.readme),t?.tags!==void 0&&(i.tags=t.tags),t?.isPublic!==void 0&&(i.is_public=t.isPublic),t?.isArchived!==void 0&&(i.is_archived=t.isArchived),0===Object.keys(i).length)throw Error("No valid update options provided");let a=JSON.stringify(i);return(await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/repos/${r}/${n}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await (0,g.raiseForStatus)(e,"update prompt"),e})).json()}async deletePrompt(e){if(!await this.promptExists(e))throw Error("Prompt does not exist, you must create it first.");let[t,r,n]=(0,m.parsePromptIdentifier)(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);return(await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/repos/${t}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(e,"delete prompt"),e})).json()}async pullPromptCommit(e,t){let[r,n,i]=(0,m.parsePromptIdentifier)(e),a=await this.caller.call(async()=>{let e=await this._fetch(`${this.apiUrl}/commits/${r}/${n}/${i}${t?.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await (0,g.raiseForStatus)(e,"pull prompt commit"),e}),s=await a.json();return{owner:r,repo:n,commit_hash:s.commit_hash,manifest:s.manifest,examples:s.examples}}async _pullPrompt(e,t){return JSON.stringify((await this.pullPromptCommit(e,{includeModel:t?.includeModel})).manifest)}async pushPrompt(e,t){return(await this.promptExists(e)?t&&Object.keys(t).some(e=>"object"!==e)&&await this.updatePrompt(e,{description:t?.description,readme:t?.readme,tags:t?.tags,isPublic:t?.isPublic}):await this.createPrompt(e,{description:t?.description,readme:t?.readme,tags:t?.tags,isPublic:t?.isPublic}),t?.object)?await this.createCommit(e,t?.object,{parentCommitHash:t?.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,t={}){let{sourceApiUrl:r=this.apiUrl,datasetName:n}=t,[i,a]=this.parseTokenOrUrl(e,r),s=new k({apiUrl:i,apiKey:"placeholder"}),o=await s.readSharedDataset(a),l=n||o.name;try{if(await this.hasDataset({datasetId:l}))return void console.log(`Dataset ${l} already exists in your tenant. Skipping.`)}catch(e){}let u=await s.listSharedExamples(a),c=await this.createDataset(l,{description:o.description,dataType:o.data_type||"kv",inputsSchema:o.inputs_schema_definition??void 0,outputsSchema:o.outputs_schema_definition??void 0});try{await this.createExamples({inputs:u.map(e=>e.inputs),outputs:u.flatMap(e=>e.outputs?[e.outputs]:[]),datasetId:c.id})}catch(e){throw console.error(`An error occurred while creating dataset ${l}. You should delete it manually.`),e}}parseTokenOrUrl(e,t,r=2,n="dataset"){try{return(0,h.assertUuid)(e),[t,e]}catch(e){}try{let i=new URL(e).pathname.split("/").filter(e=>""!==e);if(i.length>=r){let e=i[i.length-r];return[t,e]}throw Error(`Invalid public ${n} URL: ${e}`)}catch(t){throw Error(`Invalid public ${n} URL or token: ${e}`)}}async awaitPendingTraceBatches(){if(this.manualFlushMode)return console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve();await Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()]),void 0!==this.langSmithToOTELTranslator&&await (0,l.getDefaultOTLPTracerComponents)()?.DEFAULT_LANGSMITH_SPAN_PROCESSOR?.forceFlush()}}function I(e){return"dataset_id"in e||"dataset_name"in e}r.Client=k},96386,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isTracingEnabled=void 0;let n=e.r(27081);r.isTracingEnabled=e=>void 0!==e?e:!!["TRACING_V2","TRACING"].find(e=>"true"===(0,n.getLangSmithEnvironmentVariable)(e))},48296,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r._LC_CONTEXT_VARIABLES_KEY=void 0,r._LC_CONTEXT_VARIABLES_KEY=Symbol.for("lc:context_variables")},97175,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),s=0;s<a.length;s++)"default"!==a[s]&&n(r,t,a[s]);return i(r,t),r}}();Object.defineProperty(r,"__esModule",{value:!0}),r.RunTree=void 0,r.convertToDottedOrderFormat=m,r.isRunTree=b,r.isRunnableConfigLike=w;let s=a(e.r(79403)),o=e.r(92913),l=e.r(96386),u=e.r(91461),c=e.r(48296),d=e.r(27081),p=e.r(16770),h=e.r(27081),f=e.r(65113);function m(e,t,r=1){let n=r.toFixed(0).slice(0,3).padStart(3,"0"),i=`${new Date(e).toISOString().slice(0,-1)}${n}Z`;return{dottedOrder:i.replace(/[-:.]/g,"")+t,microsecondPrecisionDatestring:i}}class g{constructor(e,t,r,n){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t,this.project_name=r,this.replicas=n}static fromHeader(e){let t,r,n=e.split(","),i={},a=[];for(let e of n){let[n,s]=e.split("="),o=decodeURIComponent(s);"langsmith-metadata"===n?i=JSON.parse(o):"langsmith-tags"===n?a=o.split(","):"langsmith-project"===n?t=o:"langsmith-replicas"===n&&(r=JSON.parse(o))}return new g(i,a,t,r)}toHeader(){let e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),this.project_name&&e.push(`langsmith-project=${encodeURIComponent(this.project_name)}`),e.join(",")}}class y{constructor(e){if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_serialized_start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),b(e))return void Object.assign(this,{...e});let t=y.getDefaultConfig(),{metadata:r,...n}=e,i=n.client??y.getSharedClient(),a={...r,...n?.extra?.metadata};if(n.extra={...n.extra,metadata:a},Object.assign(this,{...t,...n,client:i}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.replicas=function(e){return e?e.map(e=>Array.isArray(e)?{projectName:e[0],updates:e[1]}:e):function(){let e=(0,d.getEnvironmentVariable)("LANGSMITH_RUNS_ENDPOINTS");if(!e)return[];try{let r=JSON.parse(e);if(Array.isArray(r)){let e=[];for(let t of r){if("object"!=typeof t||null===t){console.warn(`Invalid item type in LANGSMITH_RUNS_ENDPOINTS: expected object, got ${typeof t}`);continue}if("string"!=typeof t.api_url){console.warn(`Invalid api_url type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof t.api_url}`);continue}if("string"!=typeof t.api_key){console.warn(`Invalid api_key type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof t.api_key}`);continue}e.push({apiUrl:t.api_url.replace(/\/$/,""),apiKey:t.api_key})}return e}if("object"!=typeof r||null===r)return console.warn(`Invalid LANGSMITH_RUNS_ENDPOINTS â€“ must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey, got ${typeof r}`),[];{var t=r;if(Object.keys(t).length>0&&(0,h.getLangSmithEnvironmentVariable)("ENDPOINT"))throw new u.ConflictingEndpointsError;let e=[];for(let[t,n]of Object.entries(r)){let r=t.replace(/\/$/,"");if("string"==typeof n)e.push({apiUrl:r,apiKey:n});else{console.warn(`Invalid value type in LANGSMITH_RUNS_ENDPOINTS for URL ${t}: expected string, got ${typeof n}`);continue}}return e}}catch(e){if((0,u.isConflictingEndpointsError)(e))throw e;return console.warn("Invalid LANGSMITH_RUNS_ENDPOINTS â€“ must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey"),[]}}()}(this.replicas),this.execution_order??=1,this.child_execution_order??=1,!this.dotted_order){let{dottedOrder:e,microsecondPrecisionDatestring:t}=m(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+e:this.dotted_order=e,this._serialized_start_time=t}}set metadata(e){this.extra={...this.extra,metadata:{...this.extra?.metadata,...e}}}get metadata(){return this.extra?.metadata}static getDefaultConfig(){return{id:s.v4(),run_type:"chain",project_name:(0,p.getDefaultProjectName)(),child_runs:[],api_url:(0,d.getEnvironmentVariable)("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:(0,d.getEnvironmentVariable)("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return y.sharedClient||(y.sharedClient=new o.Client),y.sharedClient}createChild(e){let t=this.child_execution_order+1,r=new y({...e,parent_run:this,project_name:this.project_name,replicas:this.replicas,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:t,child_execution_order:t});c._LC_CONTEXT_VARIABLES_KEY in this&&(r[c._LC_CONTEXT_VARIABLES_KEY]=this[c._LC_CONTEXT_VARIABLES_KEY]);let n=Symbol.for("lc:child_config"),i=e.extra?.[n]??this.extra[n];if(w(i)){var a;let e={...i},t="object"==typeof(a=e.callbacks)&&null!=a&&Array.isArray(a.handlers)?e.callbacks.copy?.():void 0;t&&(Object.assign(t,{_parentRunId:r.id}),t.handlers?.find(_)?.updateFromRunTree?.(r),e.callbacks=t),r.extra[n]=e}let s=new Set,o=this;for(;null!=o&&!s.has(o.id);)s.add(o.id),o.child_execution_order=Math.max(o.child_execution_order,t),o=o.parent_run;return this.child_runs.push(r),r}async end(e,t,r=Date.now(),n){this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??r,n&&Object.keys(n).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...n}}:{metadata:n})}_convertToCreate(e,t,r=!0){let n,i,a=e.extra??{};if(a?.runtime?.library===void 0&&(a.runtime||(a.runtime={}),t))for(let[e,r]of Object.entries(t))a.runtime[e]||(a.runtime[e]=r);return r?(i=e.parent_run?.id??e.parent_run_id,n=[]):(n=e.child_runs.map(e=>this._convertToCreate(e,t,r)),i=void 0),{id:e.id,name:e.name,start_time:e._serialized_start_time??e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:a,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:n,parent_run_id:i,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments,events:e.events}}_remapForProject(e,t,r=!0){let n,i=this._convertToCreate(this,t,r);if(e===this.project_name)return i;let a=t=>s.v5(`${t}:${e}`,s.v5.DNS),o=a(i.id),l=i.trace_id?a(i.trace_id):void 0,u=i.parent_run_id?a(i.parent_run_id):void 0;if(i.dotted_order){let e=i.dotted_order.split(".").map(e=>{let t=e.slice(0,-36),r=e.slice(-36),n=parseInt(t.slice(0,4)),i=parseInt(t.slice(4,6))-1,a=parseInt(t.slice(6,8)),s=parseInt(t.slice(9,11)),o=parseInt(t.slice(11,13));return[new Date(n,i,a,s,o,parseInt(t.slice(13,15)),parseInt(t.slice(15,21))/1e3),r]}),t=[];for(let r=0;r<e.length-1;r++){let[n,i]=e[r],s=a(i);t.push(n.toISOString().replace(/[-:]/g,"").replace(".","")+s)}let[r]=e[e.length-1];t.push(r.toISOString().replace(/[-:]/g,"").replace(".","")+o),n=t.join(".")}else n=void 0;return{...i,id:o,trace_id:l,parent_run_id:u,dotted_order:n,session_name:e}}async postRun(e=!0){try{let t=(0,d.getRuntimeEnvironment)();if(this.replicas&&this.replicas.length>0)for(let{projectName:e,apiKey:r,apiUrl:n,workspaceId:i}of this.replicas){let a=this._remapForProject(e??this.project_name,t,!0);await this.client.createRun(a,{apiKey:r,apiUrl:n,workspaceId:i})}else{let r=this._convertToCreate(this,t,e);await this.client.createRun(r)}if(!e)for(let e of((0,f.warnOnce)("Posting with excludeChildRuns=false is deprecated and will be removed in a future version."),this.child_runs))await e.postRun(!1)}catch(e){console.error(`Error in postRun for run ${this.id}:`,e)}}async patchRun(e){if(this.replicas&&this.replicas.length>0)for(let{projectName:t,apiKey:r,apiUrl:n,workspaceId:i,updates:a}of this.replicas){let s=this._remapForProject(t??this.project_name),o={id:s.id,outputs:s.outputs,error:s.error,parent_run_id:s.parent_run_id,session_name:s.session_name,reference_example_id:s.reference_example_id,end_time:s.end_time,dotted_order:s.dotted_order,trace_id:s.trace_id,events:s.events,tags:s.tags,extra:s.extra,attachments:this.attachments,...a};e?.excludeInputs||(o.inputs=s.inputs),await this.client.updateRun(s.id,o,{apiKey:r,apiUrl:n,workspaceId:i})}else try{let t={end_time:this.end_time,error:this.error,outputs:this.outputs,parent_run_id:this.parent_run?.id??this.parent_run_id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments,session_name:this.project_name};e?.excludeInputs||(t.inputs=this.inputs),await this.client.updateRun(this.id,t)}catch(e){console.error(`Error in patchRun for run ${this.id}`,e)}}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(e){this.events||(this.events=[]),"string"==typeof e?this.events.push({name:"event",time:new Date().toISOString(),message:e}):this.events.push({...e,time:e.time??new Date().toISOString()})}static fromRunnableConfig(e,t){let r,n,i,a=e?.callbacks,s=(0,l.isTracingEnabled)();if(a){let e=a?.getParentRunId?.()??"",t=a?.handlers?.find(e=>e?.name=="langchain_tracer");r=t?.getRun?.(e),n=t?.projectName,i=t?.client,s=s||!!t}return r?new y({name:r.name,id:r.id,trace_id:r.trace_id,dotted_order:r.dotted_order,client:i,tracingEnabled:s,project_name:n,tags:[...new Set((r?.tags??[]).concat(e?.tags??[]))],extra:{metadata:{...r?.extra?.metadata,...e?.metadata}}}).createChild(t):new y({...t,client:i,tracingEnabled:s,project_name:n})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){let r="get"in e&&"function"==typeof e.get?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,n=r["langsmith-trace"];if(!n||"string"!=typeof n)return;let i=n.trim(),a=i.split(".").map(e=>{let[t,r]=e.split("Z");return{strTime:t,time:Date.parse(t+"Z"),uuid:r}}),s=a[0].uuid,o={...t,name:t?.name??"parent",run_type:t?.run_type??"chain",start_time:t?.start_time??Date.now(),id:a.at(-1)?.uuid,trace_id:s,dotted_order:i};if(r.baggage&&"string"==typeof r.baggage){let e=g.fromHeader(r.baggage);o.metadata=e.metadata,o.tags=e.tags,o.project_name=e.project_name,o.replicas=e.replicas}return new y(o)}toHeaders(e){let t={"langsmith-trace":this.dotted_order,baggage:new g(this.extra?.metadata,this.tags,this.project_name,this.replicas).toHeader()};if(e)for(let[r,n]of Object.entries(t))e.set(r,n);return t}}function b(e){return null!=e&&"function"==typeof e.createChild&&"function"==typeof e.postRun}function _(e){return"object"==typeof e&&null!=e&&"string"==typeof e.name&&"langchain_tracer"===e.name}function v(e){return Array.isArray(e)&&e.some(e=>_(e))}function w(e){return null!=e&&"object"==typeof e.callbacks&&(v(e.callbacks?.handlers)||v(e.callbacks))}r.RunTree=y,Object.defineProperty(y,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null})},98309,(e,t,r)=>{t.exports=e.r(97175)},73718,(e,t,r)=>{"use strict";let n;async function i(){return a()}function a(){return void 0===n&&(n={library:"langchain-js",runtime:(0,r.getEnv)()}),n}Object.defineProperty(r,"__esModule",{value:!0}),r.getEnv=r.isNode=r.isDeno=r.isJsDom=r.isWebWorker=r.isBrowser=void 0,r.getRuntimeEnvironment=i,r.getRuntimeEnvironmentSync=a,r.getEnvironmentVariable=function(e){try{if("undefined"!=typeof process)return process.env?.[e];if((0,r.isDeno)())return Deno?.env.get(e);return}catch(e){return}},r.isBrowser=()=>!1,r.isWebWorker=()=>"object"==typeof globalThis&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name,r.isJsDom=()=>"undefined"!=typeof navigator&&navigator.userAgent.includes("jsdom"),r.isDeno=()=>"undefined"!=typeof Deno,r.isNode=()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node&&!(0,r.isDeno)(),r.getEnv=()=>(0,r.isBrowser)()?"browser":(0,r.isNode)()?"node":(0,r.isWebWorker)()?"webworker":(0,r.isJsDom)()?"jsdom":(0,r.isDeno)()?"deno":"other"},9255,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),s=0;s<a.length;s++)"default"!==a[s]&&n(r,t,a[s]);return i(r,t),r}}();Object.defineProperty(r,"__esModule",{value:!0}),r.isBaseCallbackHandler=r.BaseCallbackHandler=void 0,r.callbackHandlerPrefersStreaming=function(e){return"lc_prefer_streaming"in e&&e.lc_prefer_streaming};let s=a(e.r(79403)),o=e.r(46893),l=e.r(73718);class u{}class c extends u{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,(0,o.get_lc_unique_name)(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:"false"===(0,l.getEnvironmentVariable)("LANGCHAIN_CALLBACKS_BACKGROUND")}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return o.Serializable.prototype.toJSON.call(this)}toJSONNotImplemented(){return o.Serializable.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){return new class extends c{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:s.v4()}),Object.assign(this,e)}}}}r.BaseCallbackHandler=c,r.isBaseCallbackHandler=e=>void 0!==e&&"function"==typeof e.copy&&"string"==typeof e.name&&"boolean"==typeof e.awaitHandlers},25032,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseTracer=void 0,r.isBaseTracer=function(e){return"function"==typeof e._addRunToRunMap};let n=e.r(98309),i=e.r(9255),a=e.r(73718);function s(e,t){return e&&!Array.isArray(e)&&"object"==typeof e?e:{[t]:e}}class o extends i.BaseCallbackHandler{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"runTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"usesRunTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:!1})}copy(){return this}getRunById(e){if(void 0!==e)return this.usesRunTreeMap?(e=>{if(e)return e.events=e.events??[],e.child_runs=e.child_runs??[],e})(this.runTreeMap.get(e)):this.runMap.get(e)}stringifyError(e){return e instanceof Error?e.message+(e?.stack?`

${e.stack}`:""):"string"==typeof e?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){let{dottedOrder:t,microsecondPrecisionDatestring:r}=(0,n.convertToDottedOrderFormat)(new Date(e.start_time).getTime(),e.id,e.execution_order),i={...e},s=this.getRunById(i.parent_run_id);if(void 0!==i.parent_run_id?s&&(this._addChildRun(s,i),s.child_execution_order=Math.max(s.child_execution_order,i.child_execution_order),i.trace_id=s.trace_id,void 0!==s.dotted_order&&(i.dotted_order=[s.dotted_order,t].join("."),i._serialized_start_time=r)):(i.trace_id=i.id,i.dotted_order=t,i._serialized_start_time=r),this.usesRunTreeMap){let e=function e(t,r){if(t)return new n.RunTree({...t,start_time:t._serialized_start_time??t.start_time,parent_run:e(r),child_runs:t.child_runs.map(t=>e(t)).filter(e=>void 0!==e),extra:{...t.extra,runtime:(0,a.getRuntimeEnvironmentSync)()},tracingEnabled:!1})}(i,s);void 0!==e&&this.runTreeMap.set(i.id,e)}else this.runMap.set(i.id,i);return i}async _endTrace(e){let t=void 0!==e.parent_run_id&&this.getRunById(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),await this.onRunUpdate?.(e),this.usesRunTreeMap?this.runTreeMap.delete(e.id):this.runMap.delete(e.id)}_getExecutionOrder(e){let t=void 0!==e&&this.getRunById(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,r,n,i,a,s,o){let l=this._getExecutionOrder(n),u=Date.now(),c=s?{...i,metadata:s}:i,d={id:r,name:o??e.id[e.id.length-1],parent_run_id:n,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{prompts:t},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:c??{},tags:a||[]};return this._addRunToRunMap(d)}async handleLLMStart(e,t,r,n,i,a,s,o){let l=this.getRunById(r)??this._createRunForLLMStart(e,t,r,n,i,a,s,o);return await this.onRunCreate?.(l),await this.onLLMStart?.(l),l}_createRunForChatModelStart(e,t,r,n,i,a,s,o){let l=this._getExecutionOrder(n),u=Date.now(),c=s?{...i,metadata:s}:i,d={id:r,name:o??e.id[e.id.length-1],parent_run_id:n,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{messages:t},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:c??{},tags:a||[]};return this._addRunToRunMap(d)}async handleChatModelStart(e,t,r,n,i,a,s,o){let l=this.getRunById(r)??this._createRunForChatModelStart(e,t,r,n,i,a,s,o);return await this.onRunCreate?.(l),await this.onLLMStart?.(l),l}async handleLLMEnd(e,t,r,n,i){let a=this.getRunById(t);if(!a||a?.run_type!=="llm")throw Error("No LLM run to end.");return a.end_time=Date.now(),a.outputs=e,a.events.push({name:"end",time:new Date(a.end_time).toISOString()}),a.extra={...a.extra,...i},await this.onLLMEnd?.(a),await this._endTrace(a),a}async handleLLMError(e,t,r,n,i){let a=this.getRunById(t);if(!a||a?.run_type!=="llm")throw Error("No LLM run to end.");return a.end_time=Date.now(),a.error=this.stringifyError(e),a.events.push({name:"error",time:new Date(a.end_time).toISOString()}),a.extra={...a.extra,...i},await this.onLLMError?.(a),await this._endTrace(a),a}_createRunForChainStart(e,t,r,n,i,a,s,o){let l=this._getExecutionOrder(n),u=Date.now(),c={id:r,name:o??e.id[e.id.length-1],parent_run_id:n,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:t,execution_order:l,child_execution_order:l,run_type:s??"chain",child_runs:[],extra:a?{metadata:a}:{},tags:i||[]};return this._addRunToRunMap(c)}async handleChainStart(e,t,r,n,i,a,s,o){let l=this.getRunById(r)??this._createRunForChainStart(e,t,r,n,i,a,s,o);return await this.onRunCreate?.(l),await this.onChainStart?.(l),l}async handleChainEnd(e,t,r,n,i){let a=this.getRunById(t);if(!a)throw Error("No chain run to end.");return a.end_time=Date.now(),a.outputs=s(e,"output"),a.events.push({name:"end",time:new Date(a.end_time).toISOString()}),i?.inputs!==void 0&&(a.inputs=s(i.inputs,"input")),await this.onChainEnd?.(a),await this._endTrace(a),a}async handleChainError(e,t,r,n,i){let a=this.getRunById(t);if(!a)throw Error("No chain run to end.");return a.end_time=Date.now(),a.error=this.stringifyError(e),a.events.push({name:"error",time:new Date(a.end_time).toISOString()}),i?.inputs!==void 0&&(a.inputs=s(i.inputs,"input")),await this.onChainError?.(a),await this._endTrace(a),a}_createRunForToolStart(e,t,r,n,i,a,s){let o=this._getExecutionOrder(n),l=Date.now(),u={id:r,name:s??e.id[e.id.length-1],parent_run_id:n,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{input:t},execution_order:o,child_execution_order:o,run_type:"tool",child_runs:[],extra:a?{metadata:a}:{},tags:i||[]};return this._addRunToRunMap(u)}async handleToolStart(e,t,r,n,i,a,s){let o=this.getRunById(r)??this._createRunForToolStart(e,t,r,n,i,a,s);return await this.onRunCreate?.(o),await this.onToolStart?.(o),o}async handleToolEnd(e,t){let r=this.getRunById(t);if(!r||r?.run_type!=="tool")throw Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await this.onToolEnd?.(r),await this._endTrace(r),r}async handleToolError(e,t){let r=this.getRunById(t);if(!r||r?.run_type!=="tool")throw Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await this.onToolError?.(r),await this._endTrace(r),r}async handleAgentAction(e,t){let r=this.getRunById(t);r&&r?.run_type==="chain"&&(r.actions=r.actions||[],r.actions.push(e),r.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentAction?.(r))}async handleAgentEnd(e,t){let r=this.getRunById(t);r&&r?.run_type==="chain"&&(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentEnd?.(r))}_createRunForRetrieverStart(e,t,r,n,i,a,s){let o=this._getExecutionOrder(n),l=Date.now(),u={id:r,name:s??e.id[e.id.length-1],parent_run_id:n,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{query:t},execution_order:o,child_execution_order:o,run_type:"retriever",child_runs:[],extra:a?{metadata:a}:{},tags:i||[]};return this._addRunToRunMap(u)}async handleRetrieverStart(e,t,r,n,i,a,s){let o=this.getRunById(r)??this._createRunForRetrieverStart(e,t,r,n,i,a,s);return await this.onRunCreate?.(o),await this.onRetrieverStart?.(o),o}async handleRetrieverEnd(e,t){let r=this.getRunById(t);if(!r||r?.run_type!=="retriever")throw Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await this.onRetrieverEnd?.(r),await this._endTrace(r),r}async handleRetrieverError(e,t){let r=this.getRunById(t);if(!r||r?.run_type!=="retriever")throw Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await this.onRetrieverError?.(r),await this._endTrace(r),r}async handleText(e,t){let r=this.getRunById(t);r&&r?.run_type==="chain"&&(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await this.onText?.(r))}async handleLLMNewToken(e,t,r,n,i,a){let s=this.getRunById(r);if(!s||s?.run_type!=="llm")throw Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return s.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:a?.chunk}}),await this.onLLMNewToken?.(s,e,{chunk:a?.chunk}),s}}r.BaseTracer=o},4567,(e,t,r)=>{"use strict";let n=(e=0)=>t=>`\u001B[${38+e};5;${t}m`,i=(e=0)=>(t,r,n)=>`\u001B[${38+e};2;${t};${r};${n}m`;Object.defineProperty(t,"exports",{enumerable:!0,get:function(){let e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};for(let[r,n]of(t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright,Object.entries(t))){for(let[r,i]of Object.entries(n))t[r]={open:`\u001B[${i[0]}m`,close:`\u001B[${i[1]}m`},n[r]=t[r],e.set(i[0],i[1]);Object.defineProperty(t,r,{value:n,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="\x1b[39m",t.bgColor.close="\x1b[49m",t.color.ansi256=n(),t.color.ansi16m=i(),t.bgColor.ansi256=n(10),t.bgColor.ansi16m=i(10),Object.defineProperties(t,{rgbToAnsi256:{value:(e,t,r)=>e===t&&t===r?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(r/255*5),enumerable:!1},hexToRgb:{value:e=>{let t=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(e.toString(16));if(!t)return[0,0,0];let{colorString:r}=t.groups;3===r.length&&(r=r.split("").map(e=>e+e).join(""));let n=Number.parseInt(r,16);return[n>>16&255,n>>8&255,255&n]},enumerable:!1},hexToAnsi256:{value:e=>t.rgbToAnsi256(...t.hexToRgb(e)),enumerable:!1}}),t}})},50181,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.ConsoleCallbackHandler=void 0;let i=n(e.r(4567)),a=e.r(25032);function s(e,t){return`${e.open}${t}${e.close}`}function o(e,t){try{return JSON.stringify(e,null,2)}catch(e){return t}}function l(e){return"string"==typeof e?e.trim():null==e?e:o(e,e.toString())}function u(e){if(!e.end_time)return"";let t=e.end_time-e.start_time;return t<1e3?`${t}ms`:`${(t/1e3).toFixed(2)}s`}let{color:c}=i.default;class d extends a.BaseTracer{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){let t=[],r=e;for(;r.parent_run_id;){let e=this.runMap.get(r.parent_run_id);if(e)t.push(e),r=e;else break}return t}getBreadcrumbs(e){let t=[...this.getParents(e).reverse(),e].map((e,t,r)=>{let n=`${e.execution_order}:${e.run_type}:${e.name}`;return t===r.length-1?s(i.default.bold,n):n}).join(" > ");return s(c.grey,t)}onChainStart(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.green,"[chain/start]")} [${t}] Entering Chain run with input: ${o(e.inputs,"[inputs]")}`)}onChainEnd(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.cyan,"[chain/end]")} [${t}] [${u(e)}] Exiting Chain run with output: ${o(e.outputs,"[outputs]")}`)}onChainError(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.red,"[chain/error]")} [${t}] [${u(e)}] Chain run errored with error: ${o(e.error,"[error]")}`)}onLLMStart(e){let t=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(e=>e.trim())}:e.inputs;console.log(`${s(c.green,"[llm/start]")} [${t}] Entering LLM run with input: ${o(r,"[inputs]")}`)}onLLMEnd(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.cyan,"[llm/end]")} [${t}] [${u(e)}] Exiting LLM run with output: ${o(e.outputs,"[response]")}`)}onLLMError(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.red,"[llm/error]")} [${t}] [${u(e)}] LLM run errored with error: ${o(e.error,"[error]")}`)}onToolStart(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.green,"[tool/start]")} [${t}] Entering Tool run with input: "${l(e.inputs.input)}"`)}onToolEnd(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.cyan,"[tool/end]")} [${t}] [${u(e)}] Exiting Tool run with output: "${l(e.outputs?.output)}"`)}onToolError(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.red,"[tool/error]")} [${t}] [${u(e)}] Tool run errored with error: ${o(e.error,"[error]")}`)}onRetrieverStart(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${o(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.cyan,"[retriever/end]")} [${t}] [${u(e)}] Exiting Retriever run with output: ${o(e.outputs,"[outputs]")}`)}onRetrieverError(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.red,"[retriever/error]")} [${t}] [${u(e)}] Retriever run errored with error: ${o(e.error,"[error]")}`)}onAgentAction(e){let t=this.getBreadcrumbs(e);console.log(`${s(c.blue,"[agent/action]")} [${t}] Agent selected action: ${o(e.actions[e.actions.length-1],"[action]")}`)}}r.ConsoleCallbackHandler=d},68350,(e,t,r)=>{t.exports=e.r(64949)},79878,(e,t,r)=>{"use strict";let n;Object.defineProperty(r,"__esModule",{value:!0}),r.setDefaultLangChainClientSingleton=r.getDefaultLangChainClientSingleton=void 0;let i=e.r(68350),a=e.r(73718);r.getDefaultLangChainClientSingleton=()=>{if(void 0===n){let e="false"===(0,a.getEnvironmentVariable)("LANGCHAIN_CALLBACKS_BACKGROUND")?{blockOnRootRunFinalization:!0}:{};n=new i.Client(e)}return n},r.setDefaultLangChainClientSingleton=e=>{n=e}},64462,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LangChainTracer=void 0;let n=e.r(68350),i=e.r(98309),a=e.r(65740),s=e.r(25032),o=e.r(79878);class l extends s.BaseTracer{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usesRunTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:!0});let{exampleId:t,projectName:r,client:i,replicas:a}=e;this.projectName=r??(0,n.getDefaultProjectName)(),this.replicas=a,this.exampleId=t,this.client=i??(0,o.getDefaultLangChainClientSingleton)();let s=l.getTraceableRunTree();s&&this.updateFromRunTree(s)}async persistRun(e){}async onRunCreate(e){let t=this.getRunTreeWithTracingConfig(e.id);await t?.postRun()}async onRunUpdate(e){let t=this.getRunTreeWithTracingConfig(e.id);await t?.patchRun()}getRun(e){return this.runTreeMap.get(e)}updateFromRunTree(e){this.runTreeMap.set(e.id,e);let t=e,r=new Set;for(;t.parent_run&&!r.has(t.id)&&(r.add(t.id),t.parent_run);){;t=t.parent_run}r.clear();let n=[t];for(;n.length>0;){let e=n.shift();!(!e||r.has(e.id))&&(r.add(e.id),this.runTreeMap.set(e.id,e),e.child_runs&&n.push(...e.child_runs))}this.client=e.client??this.client,this.replicas=e.replicas??this.replicas,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}getRunTreeWithTracingConfig(e){let t=this.runTreeMap.get(e);if(t)return new i.RunTree({...t,client:this.client,project_name:this.projectName,replicas:this.replicas,reference_example_id:this.exampleId,tracingEnabled:!0})}static getTraceableRunTree(){try{return a.getCurrentRunTree(!0)}catch{return}}}r.LangChainTracer=l},2503,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getGlobalAsyncLocalStorageInstance=r.setGlobalAsyncLocalStorageInstance=r._CONTEXT_VARIABLES_KEY=r.TRACING_ALS_KEY=void 0,r.TRACING_ALS_KEY=Symbol.for("ls:tracing_async_local_storage"),r._CONTEXT_VARIABLES_KEY=Symbol.for("lc:context_variables"),r.setGlobalAsyncLocalStorageInstance=e=>{globalThis[r.TRACING_ALS_KEY]=e},r.getGlobalAsyncLocalStorageInstance=()=>globalThis[r.TRACING_ALS_KEY]},4075,(e,t,r)=>{"use strict";let n;var i=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.getQueue=l,r.consumeCallback=u,r.awaitAllCallbacks=c;let a=i(e.r(55747)),s=e.r(2503),o=e.r(79878);function l(){return void 0===n&&(n=new("default"in a.default?a.default.default:a.default)({autoStart:!0,concurrency:1})),n}async function u(e,t){if(!0===t){let t=(0,s.getGlobalAsyncLocalStorageInstance)();void 0!==t?await t.run(void 0,async()=>e()):await e()}else(n=l()).add(async()=>{let t=(0,s.getGlobalAsyncLocalStorageInstance)();void 0!==t?await t.run(void 0,async()=>e()):await e()})}async function c(){let e=(0,o.getDefaultLangChainClientSingleton)();await Promise.allSettled([void 0!==n?n.onIdle():Promise.resolve(),e.awaitPendingTraceBatches()])}},34372,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.consumeCallback=r.awaitAllCallbacks=void 0;let n=e.r(4075);Object.defineProperty(r,"awaitAllCallbacks",{enumerable:!0,get:function(){return n.awaitAllCallbacks}}),Object.defineProperty(r,"consumeCallback",{enumerable:!0,get:function(){return n.consumeCallback}})},9405,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isTracingEnabled=void 0;let n=e.r(73718);r.isTracingEnabled=e=>void 0!==e?e:!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(e=>"true"===(0,n.getEnvironmentVariable)(e))},77961,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.registerConfigureHook=r._getConfigureHooks=void 0,r.setContextVariable=a,r.getContextVariable=s;let n=e.r(98309),i=e.r(2503);function a(e,t){let r=(0,i.getGlobalAsyncLocalStorageInstance)();if(void 0===r)throw Error("Internal error: Global shared async local storage instance has not been initialized.");let a=r.getStore(),s={...a?.[i._CONTEXT_VARIABLES_KEY]};s[e]=t;let o={};(0,n.isRunTree)(a)&&(o=new n.RunTree(a)),o[i._CONTEXT_VARIABLES_KEY]=s,r.enterWith(o)}function s(e){let t=(0,i.getGlobalAsyncLocalStorageInstance)();if(void 0===t)return;let r=t.getStore();return r?.[i._CONTEXT_VARIABLES_KEY]?.[e]}let o=Symbol("lc:configure_hooks");r._getConfigureHooks=()=>s(o)||[],r.registerConfigureHook=e=>{if(e.envVar&&!e.handlerClass)throw Error("If envVar is set, handlerClass must also be set to a non-None value.");a(o,[...(0,r._getConfigureHooks)(),e])}},75622,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TraceGroup=r.CallbackManager=r.CallbackManagerForToolRun=r.CallbackManagerForChainRun=r.CallbackManagerForLLMRun=r.CallbackManagerForRetrieverRun=r.BaseRunManager=r.BaseCallbackManager=void 0,r.parseCallbackConfigArg=function(e){return e?Array.isArray(e)||"name"in e?{callbacks:e}:e:{}},r.ensureHandler=v,r.traceAsGroup=O;let n=e.r(79403),i=e.r(9255),a=e.r(50181),s=e.r(12556),o=e.r(73718),l=e.r(64462),u=e.r(34372),c=e.r(9405),d=e.r(25032),p=e.r(77961);class h{setHandler(e){return this.setHandlers([e])}}r.BaseCallbackManager=h;class f{constructor(e,t,r,n,i,a,s,o){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:o})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(t=>(0,u.consumeCallback)(async()=>{try{await t.handleText?.(e,this.runId,this._parentRunId,this.tags)}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${e}`),t.raiseError)throw e}},t.awaitHandlers)))}async handleCustomEvent(e,t,r,n,i){await Promise.all(this.handlers.map(r=>(0,u.consumeCallback)(async()=>{try{await r.handleCustomEvent?.(e,t,this.runId,this.tags,this.metadata)}catch(e){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleCustomEvent: ${e}`),r.raiseError)throw e}},r.awaitHandlers)))}}r.BaseRunManager=f;class m extends f{getChild(e){let t=new _(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>(0,u.consumeCallback)(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw e}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>(0,u.consumeCallback)(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverError?.(e,this.runId,this._parentRunId,this.tags)}catch(r){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${r}`),t.raiseError)throw e}},t.awaitHandlers)))}}r.CallbackManagerForRetrieverRun=m;class g extends f{async handleLLMNewToken(e,t,r,n,i,a){await Promise.all(this.handlers.map(r=>(0,u.consumeCallback)(async()=>{if(!r.ignoreLLM)try{await r.handleLLMNewToken?.(e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,a)}catch(e){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleLLMNewToken: ${e}`),r.raiseError)throw e}},r.awaitHandlers)))}async handleLLMError(e,t,r,n,i){await Promise.all(this.handlers.map(t=>(0,u.consumeCallback)(async()=>{if(!t.ignoreLLM)try{await t.handleLLMError?.(e,this.runId,this._parentRunId,this.tags,i)}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleLLMError: ${e}`),t.raiseError)throw e}},t.awaitHandlers)))}async handleLLMEnd(e,t,r,n,i){await Promise.all(this.handlers.map(t=>(0,u.consumeCallback)(async()=>{if(!t.ignoreLLM)try{await t.handleLLMEnd?.(e,this.runId,this._parentRunId,this.tags,i)}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleLLMEnd: ${e}`),t.raiseError)throw e}},t.awaitHandlers)))}}r.CallbackManagerForLLMRun=g;class y extends f{getChild(e){let t=new _(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,r,n,i){await Promise.all(this.handlers.map(t=>(0,u.consumeCallback)(async()=>{if(!t.ignoreChain)try{await t.handleChainError?.(e,this.runId,this._parentRunId,this.tags,i)}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleChainError: ${e}`),t.raiseError)throw e}},t.awaitHandlers)))}async handleChainEnd(e,t,r,n,i){await Promise.all(this.handlers.map(t=>(0,u.consumeCallback)(async()=>{if(!t.ignoreChain)try{await t.handleChainEnd?.(e,this.runId,this._parentRunId,this.tags,i)}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleChainEnd: ${e}`),t.raiseError)throw e}},t.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>(0,u.consumeCallback)(async()=>{if(!t.ignoreAgent)try{await t.handleAgentAction?.(e,this.runId,this._parentRunId,this.tags)}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${e}`),t.raiseError)throw e}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>(0,u.consumeCallback)(async()=>{if(!t.ignoreAgent)try{await t.handleAgentEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${e}`),t.raiseError)throw e}},t.awaitHandlers)))}}r.CallbackManagerForChainRun=y;class b extends f{getChild(e){let t=new _(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>(0,u.consumeCallback)(async()=>{if(!t.ignoreAgent)try{await t.handleToolError?.(e,this.runId,this._parentRunId,this.tags)}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${e}`),t.raiseError)throw e}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>(0,u.consumeCallback)(async()=>{if(!t.ignoreAgent)try{await t.handleToolEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${e}`),t.raiseError)throw e}},t.awaitHandlers)))}}r.CallbackManagerForToolRun=b;class _ extends h{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=t?.handlers??this.handlers,this.inheritableHandlers=t?.inheritableHandlers??this.inheritableHandlers,this.tags=t?.tags??this.tags,this.inheritableTags=t?.inheritableTags??this.inheritableTags,this.metadata=t?.metadata??this.metadata,this.inheritableMetadata=t?.inheritableMetadata??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t,r,i,a,s,o,l){return Promise.all(t.map(async(t,i)=>{let s=0===i&&r?r:(0,n.v4)();return await Promise.all(this.handlers.map(r=>{if(!r.ignoreLLM)return(0,d.isBaseTracer)(r)&&r._createRunForLLMStart(e,[t],s,this._parentRunId,a,this.tags,this.metadata,l),(0,u.consumeCallback)(async()=>{try{await r.handleLLMStart?.(e,[t],s,this._parentRunId,a,this.tags,this.metadata,l)}catch(e){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleLLMStart: ${e}`),r.raiseError)throw e}},r.awaitHandlers)})),new g(s,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,r,i,a,o,l,c){return Promise.all(t.map(async(t,i)=>{let o=0===i&&r?r:(0,n.v4)();return await Promise.all(this.handlers.map(r=>{if(!r.ignoreLLM)return(0,d.isBaseTracer)(r)&&r._createRunForChatModelStart(e,[t],o,this._parentRunId,a,this.tags,this.metadata,c),(0,u.consumeCallback)(async()=>{try{if(r.handleChatModelStart)await r.handleChatModelStart?.(e,[t],o,this._parentRunId,a,this.tags,this.metadata,c);else if(r.handleLLMStart){let n=(0,s.getBufferString)(t);await r.handleLLMStart?.(e,[n],o,this._parentRunId,a,this.tags,this.metadata,c)}}catch(e){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleLLMStart: ${e}`),r.raiseError)throw e}},r.awaitHandlers)})),new g(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,r=(0,n.v4)(),i,a,s,o){return await Promise.all(this.handlers.map(n=>{if(!n.ignoreChain)return(0,d.isBaseTracer)(n)&&n._createRunForChainStart(e,t,r,this._parentRunId,this.tags,this.metadata,i,o),(0,u.consumeCallback)(async()=>{try{await n.handleChainStart?.(e,t,r,this._parentRunId,this.tags,this.metadata,i,o)}catch(e){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleChainStart: ${e}`),n.raiseError)throw e}},n.awaitHandlers)})),new y(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=(0,n.v4)(),i,a,s,o){return await Promise.all(this.handlers.map(n=>{if(!n.ignoreAgent)return(0,d.isBaseTracer)(n)&&n._createRunForToolStart(e,t,r,this._parentRunId,this.tags,this.metadata,o),(0,u.consumeCallback)(async()=>{try{await n.handleToolStart?.(e,t,r,this._parentRunId,this.tags,this.metadata,o)}catch(e){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleToolStart: ${e}`),n.raiseError)throw e}},n.awaitHandlers)})),new b(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,r=(0,n.v4)(),i,a,s,o){return await Promise.all(this.handlers.map(n=>{if(!n.ignoreRetriever)return(0,d.isBaseTracer)(n)&&n._createRunForRetrieverStart(e,t,r,this._parentRunId,this.tags,this.metadata,o),(0,u.consumeCallback)(async()=>{try{await n.handleRetrieverStart?.(e,t,r,this._parentRunId,this.tags,this.metadata,o)}catch(e){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleRetrieverStart: ${e}`),n.raiseError)throw e}},n.awaitHandlers)})),new m(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,t,r,n,i){await Promise.all(this.handlers.map(n=>(0,u.consumeCallback)(async()=>{if(!n.ignoreCustomEvent)try{await n.handleCustomEvent?.(e,t,r,this.tags,this.metadata)}catch(e){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleCustomEvent: ${e}`),n.raiseError)throw e}},n.awaitHandlers)))}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){for(let r of(this.handlers=[],this.inheritableHandlers=[],e))this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(let t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){let r=new _(this._parentRunId);for(let e of this.handlers){let t=this.inheritableHandlers.includes(e);r.addHandler(e,t)}for(let e of this.tags){let t=this.inheritableTags.includes(e);r.addTags([e],t)}for(let e of Object.keys(this.metadata)){let t=Object.keys(this.inheritableMetadata).includes(e);r.addMetadata({[e]:this.metadata[e]},t)}for(let n of e)r.handlers.filter(e=>"console_callback_handler"===e.name).some(e=>e.name===n.name)||r.addHandler(n,t);return r}static fromHandlers(e){class t extends i.BaseCallbackHandler{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:(0,n.v4)()}),Object.assign(this,e)}}let r=new this;return r.addHandler(new t),r}static configure(e,t,r,n,i,a,s){return this._configureSync(e,t,r,n,i,a,s)}static _configureSync(e,t,r,n,s,u,d){let h;(e||t)&&(Array.isArray(e)||!e?(h=new _).setHandlers(e?.map(v)??[],!0):h=e,h=h.copy(Array.isArray(t)?t.map(v):t?.handlers,!1));let f="true"===(0,o.getEnvironmentVariable)("LANGCHAIN_VERBOSE")||d?.verbose,m=l.LangChainTracer.getTraceableRunTree()?.tracingEnabled||(0,c.isTracingEnabled)(),g=m||((0,o.getEnvironmentVariable)("LANGCHAIN_TRACING")??!1);if(f||g){if(h||(h=new _),f&&!h.handlers.some(e=>e.name===a.ConsoleCallbackHandler.prototype.name)){let e=new a.ConsoleCallbackHandler;h.addHandler(e,!0)}if(g&&!h.handlers.some(e=>"langchain_tracer"===e.name)&&m){let e=new l.LangChainTracer;h.addHandler(e,!0)}if(m){let e=l.LangChainTracer.getTraceableRunTree();if(e&&void 0===h._parentRunId){h._parentRunId=e.id;let t=h.handlers.find(e=>"langchain_tracer"===e.name);t?.updateFromRunTree(e)}}}for(let{contextVar:e,inheritable:t=!0,handlerClass:r,envVar:n}of(0,p._getConfigureHooks)()){let a,s=n&&"true"===(0,o.getEnvironmentVariable)(n)&&r,l=void 0!==e?(0,p.getContextVariable)(e):void 0;l&&(0,i.isBaseCallbackHandler)(l)?a=l:s&&(a=new r({})),void 0!==a&&(h||(h=new _),h.handlers.some(e=>e.name===a.name)||h.addHandler(a,t))}return(r||n)&&h&&(h.addTags(r??[]),h.addTags(n??[],!1)),(s||u)&&h&&(h.addMetadata(s??{}),h.addMetadata(u??{},!1)),h}}function v(e){return"name"in e?e:i.BaseCallbackHandler.fromMethods(e)}r.CallbackManager=_;class w{constructor(e,t){Object.defineProperty(this,"groupName",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"runManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async getTraceGroupCallbackManager(e,t,r){let n=new l.LangChainTracer(r),i=await _.configure([n]),a=await i?.handleChainStart({lc:1,type:"not_implemented",id:["langchain","callbacks","groups",e]},t??{});if(!a)throw Error("Failed to create run group callback manager.");return a}async start(e){return this.runManager||(this.runManager=await this.getTraceGroupCallbackManager(this.groupName,e,this.options)),this.runManager.getChild()}async error(e){this.runManager&&(await this.runManager.handleChainError(e),this.runManager=void 0)}async end(e){this.runManager&&(await this.runManager.handleChainEnd(e??{}),this.runManager=void 0)}}async function O(e,t,...r){let n=new w(e.name,e),i=await n.start({...r});try{let e=await t(i,...r);return await n.end(e&&!Array.isArray(e)&&"object"==typeof e?e:{output:e}),e}catch(e){throw await n.error(e),e}}r.TraceGroup=w},35744,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AsyncLocalStorageProviderSingleton=r.MockAsyncLocalStorage=void 0;let n=e.r(68350),i=e.r(2503),a=e.r(75622);class s{getStore(){}run(e,t){return t()}enterWith(e){}}r.MockAsyncLocalStorage=s;let o=new s,l=Symbol.for("lc:child_config");r.AsyncLocalStorageProviderSingleton=new class{getInstance(){return(0,i.getGlobalAsyncLocalStorageInstance)()??o}getRunnableConfig(){let e=this.getInstance();return e.getStore()?.extra?.[l]}runWithConfig(e,t,r){let s,o=a.CallbackManager._configureSync(e?.callbacks,void 0,e?.tags,void 0,e?.metadata),u=this.getInstance(),c=u.getStore(),d=o?.getParentRunId(),p=o?.handlers?.find(e=>e?.name==="langchain_tracer");return p&&d?s=p.getRunTreeWithTracingConfig(d):r||(s=new n.RunTree({name:"<runnable_lambda>",tracingEnabled:!1})),s&&(s.extra={...s.extra,[l]:e}),void 0!==c&&void 0!==c[i._CONTEXT_VARIABLES_KEY]&&(void 0===s&&(s={}),s[i._CONTEXT_VARIABLES_KEY]=c[i._CONTEXT_VARIABLES_KEY]),u.run(s,t)}initializeGlobalInstance(e){void 0===(0,i.getGlobalAsyncLocalStorageInstance)()&&(0,i.setGlobalAsyncLocalStorageInstance)(e)}}},18807,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r._CONTEXT_VARIABLES_KEY=r.MockAsyncLocalStorage=r.AsyncLocalStorageProviderSingleton=void 0;let n=e.r(35744);Object.defineProperty(r,"AsyncLocalStorageProviderSingleton",{enumerable:!0,get:function(){return n.AsyncLocalStorageProviderSingleton}}),Object.defineProperty(r,"MockAsyncLocalStorage",{enumerable:!0,get:function(){return n.MockAsyncLocalStorage}});let i=e.r(2503);Object.defineProperty(r,"_CONTEXT_VARIABLES_KEY",{enumerable:!0,get:function(){return i._CONTEXT_VARIABLES_KEY}})},81425,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_RECURSION_LIMIT=void 0,r.getCallbackManagerForConfig=a,r.mergeConfigs=function(...e){let t={};for(let r of e.filter(e=>!!e))for(let e of Object.keys(r))if("metadata"===e)t[e]={...t[e],...r[e]};else if("tags"===e){let n=t[e]??[];t[e]=[...new Set(n.concat(r[e]??[]))]}else if("configurable"===e)t[e]={...t[e],...r[e]};else if("timeout"===e)void 0===t.timeout?t.timeout=r.timeout:void 0!==r.timeout&&(t.timeout=Math.min(t.timeout,r.timeout));else if("signal"===e)void 0===t.signal?t.signal=r.signal:void 0!==r.signal&&("any"in AbortSignal?t.signal=AbortSignal.any([t.signal,r.signal]):t.signal=r.signal);else if("callbacks"===e){let e=t.callbacks,i=r.callbacks;if(Array.isArray(i))if(e)if(Array.isArray(e))t.callbacks=e.concat(i);else{let r=e.copy();for(let e of i)r.addHandler((0,n.ensureHandler)(e),!0);t.callbacks=r}else t.callbacks=i;else if(i)if(e)if(Array.isArray(e)){let r=i.copy();for(let t of e)r.addHandler((0,n.ensureHandler)(t),!0);t.callbacks=r}else t.callbacks=new n.CallbackManager(i._parentRunId,{handlers:e.handlers.concat(i.handlers),inheritableHandlers:e.inheritableHandlers.concat(i.inheritableHandlers),tags:Array.from(new Set(e.tags.concat(i.tags))),inheritableTags:Array.from(new Set(e.inheritableTags.concat(i.inheritableTags))),metadata:{...e.metadata,...i.metadata}});else t.callbacks=i}else t[e]=r[e]??t[e];return t},r.ensureConfig=o,r.patchConfig=function(e={},{callbacks:t,maxConcurrency:r,recursionLimit:n,runName:i,configurable:a,runId:s}={}){let l=o(e);return void 0!==t&&(delete l.runName,l.callbacks=t),void 0!==n&&(l.recursionLimit=n),void 0!==r&&(l.maxConcurrency=r),void 0!==i&&(l.runName=i),void 0!==a&&(l.configurable={...l.configurable,...a}),void 0!==s&&delete l.runId,l},r.pickRunnableConfigKeys=function(e){return e?{configurable:e.configurable,recursionLimit:e.recursionLimit,callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,maxConcurrency:e.maxConcurrency,timeout:e.timeout,signal:e.signal}:void 0};let n=e.r(75622),i=e.r(18807);async function a(e){return n.CallbackManager._configureSync(e?.callbacks,void 0,e?.tags,void 0,e?.metadata)}r.DEFAULT_RECURSION_LIMIT=25;let s=new Set(["string","number","boolean"]);function o(e){let t=i.AsyncLocalStorageProviderSingleton.getRunnableConfig(),r={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(t){let{runId:e,runName:n,...i}=t;r=Object.entries(i).reduce((e,[t,r])=>(void 0!==r&&(e[t]=r),e),r)}if(e&&(r=Object.entries(e).reduce((e,[t,r])=>(void 0!==r&&(e[t]=r),e),r)),r?.configurable)for(let e of Object.keys(r.configurable))s.has(typeof r.configurable[e])&&!r.metadata?.[e]&&(r.metadata||(r.metadata={}),r.metadata[e]=r.configurable[e]);if(void 0!==r.timeout){if(r.timeout<=0)throw Error("Timeout must be a positive number");let e=AbortSignal.timeout(r.timeout);void 0!==r.signal?"any"in AbortSignal&&(r.signal=AbortSignal.any([r.signal,e])):r.signal=e,delete r.timeout}return r}},87510,(e,t,r)=>{"use strict";async function n(e,t){let r;return void 0===t?e:Promise.race([e.catch(e=>{if(!t?.aborted)throw e}),new Promise((e,n)=>{r=()=>{n(Error("Aborted"))},t.addEventListener("abort",r),t.aborted&&n(Error("Aborted"))})]).finally(()=>t.removeEventListener("abort",r))}Object.defineProperty(r,"__esModule",{value:!0}),r.raceWithSignal=n},62350,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AsyncGeneratorWithSetup=r.IterableReadableStream=void 0,r.atee=function(e,t=2){let r=Array.from({length:t},()=>[]);return r.map(async function*(t){for(;;)if(0===t.length){let t=await e.next();for(let e of r)e.push(t)}else{if(t[0].done)return;yield t.shift().value}})},r.concat=function e(t,r){if(Array.isArray(t)&&Array.isArray(r))return t.concat(r);if("string"==typeof t&&"string"==typeof r)return t+r;if("number"==typeof t&&"number"==typeof r)return t+r;if("concat"in t&&"function"==typeof t.concat)return t.concat(r);if("object"==typeof t&&"object"==typeof r){let n={...t};for(let[t,i]of Object.entries(r))t in n&&!Array.isArray(n[t])?n[t]=e(n[t],i):n[t]=i;return n}else throw Error(`Cannot concat ${typeof t} and ${typeof r}`)},r.pipeGeneratorWithSetup=l;let n=e.r(81425),i=e.r(18807),a=e.r(87510);class s extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{let e=await this.reader.read();if(e.done)return this.reader.releaseLock(),{done:!0,value:void 0};return{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){let e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){let e=this.reader.cancel();this.reader.releaseLock(),await e}throw e}[Symbol.asyncIterator](){return this}async [Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){let t=e.getReader();return new s({start:e=>(function r(){return t.read().then(({done:t,value:n})=>t?void e.close():(e.enqueue(n),r()))})(),cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new s({async pull(t){let{value:r,done:n}=await e.next();n&&t.close(),t.enqueue(r)},async cancel(t){await e.return(t)}})}}r.IterableReadableStream=s;class o{constructor(e){Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??this.config?.signal,this.setup=new Promise((t,r)=>{i.AsyncLocalStorageProviderSingleton.runWithConfig((0,n.pickRunnableConfigKeys)(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(t,r):this.firstResult.then(e=>t(void 0),r)},!0)})}async next(...e){return(this.signal?.throwIfAborted(),this.firstResultUsed)?i.AsyncLocalStorageProviderSingleton.runWithConfig((0,n.pickRunnableConfigKeys)(this.config),this.signal?async()=>(0,a.raceWithSignal)(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async [Symbol.asyncDispose](){await this.return()}}async function l(e,t,r,n,...i){let a=new o({generator:t,startSetup:r,signal:n}),s=await a.setup;return{output:e(a,s,...i),setup:s}}r.AsyncGeneratorWithSetup=o},1529,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LogStreamCallbackHandler=r.isLogStreamHandler=r.RunLog=r.RunLogPatch=void 0;let n=e.r(10539),i=e.r(25032),a=e.r(62350),s=e.r(46404);class o{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){let t=this.ops.concat(e.ops),r=(0,n.applyPatch)({},t);return new l({ops:t,state:r[r.length-1].newDocument})}}r.RunLogPatch=o;class l extends o{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){let t=this.ops.concat(e.ops),r=(0,n.applyPatch)(this.state,e.ops);return new l({ops:t,state:r[r.length-1].newDocument})}static fromRunLogPatch(e){let t=(0,n.applyPatch)({},e.ops);return new l({ops:e.ops,state:t[t.length-1].newDocument})}}async function u(e,t){if("original"===t)throw Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");let{inputs:r}=e;return["retriever","llm","prompt"].includes(e.run_type)?r:1!==Object.keys(r).length||r?.input!==""?r.input:void 0}async function c(e,t){let{outputs:r}=e;return"original"===t||["retriever","llm","prompt"].includes(e.run_type)?r:void 0!==r&&1===Object.keys(r).length&&r?.output!==void 0?r.output:r}r.RunLog=l,r.isLogStreamHandler=e=>"log_stream_tracer"===e.name;class d extends i.BaseTracer{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this._schemaFormat=e?._schemaFormat??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=a.IterableReadableStream.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;let t=e.tags??[],r=void 0===this.includeNames&&void 0===this.includeTags&&void 0===this.includeTypes;return void 0!==this.includeNames&&(r=r||this.includeNames.includes(e.name)),void 0!==this.includeTypes&&(r=r||this.includeTypes.includes(e.run_type)),void 0!==this.includeTags&&(r=r||void 0!==t.find(e=>this.includeTags?.includes(e))),void 0!==this.excludeNames&&(r=r&&!this.excludeNames.includes(e.name)),void 0!==this.excludeTypes&&(r=r&&!this.excludeTypes.includes(e.run_type)),void 0!==this.excludeTags&&(r=r&&t.every(e=>!this.excludeTags?.includes(e))),r}async *tapOutputIterable(e,t){for await(let r of t){if(e!==this.rootId){let t=this.keyMapByRunId[e];t&&await this.writer.write(new o({ops:[{op:"add",path:`/logs/${t}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){if(void 0===this.rootId&&(this.rootId=e.id,await this.writer.write(new o({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;void 0===this.counterMapByRunName[e.name]&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;let t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=1===t?e.name:`${e.name}:${t}`;let r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:e.extra?.metadata??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};"streaming_events"===this._schemaFormat&&(r.inputs=await u(e,this._schemaFormat)),await this.writer.write(new o({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{let t=this.keyMapByRunId[e.id];if(void 0===t)return;let r=[];"streaming_events"===this._schemaFormat&&r.push({op:"replace",path:`/logs/${t}/inputs`,value:await u(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${t}/final_output`,value:await c(e,this._schemaFormat)}),void 0!==e.end_time&&r.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});let n=new o({ops:r});await this.writer.write(n)}finally{if(e.id===this.rootId){let t=new o({ops:[{op:"replace",path:"/final_output",value:await c(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,r){let n,i=this.keyMapByRunId[e.id];if(void 0===i)return;if(void 0!==e.inputs.messages){var a;n=void 0!==(a=r?.chunk)&&void 0!==a.message?r?.chunk:new s.AIMessageChunk({id:`run-${e.id}`,content:t})}else n=t;let l=new o({ops:[{op:"add",path:`/logs/${i}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${i}/streamed_output/-`,value:n}]});await this.writer.write(l)}}r.LogStreamCallbackHandler=d},13583,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChatGenerationChunk=r.GenerationChunk=r.RUN_KEY=void 0,r.RUN_KEY="__run";class n{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new n({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}r.GenerationChunk=n;class i extends n{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new i({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}r.ChatGenerationChunk=i},37556,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EventStreamCallbackHandler=r.isStreamEventsHandler=void 0;let n=e.r(25032),i=e.r(62350),a=e.r(46404),s=e.r(13583);function o({name:e,serialized:t}){return void 0!==e?e:t?.name!==void 0?t.name:t?.id!==void 0&&Array.isArray(t?.id)?t.id[t.id.length-1]:"Unnamed"}r.isStreamEventsHandler=e=>"event_stream_tracer"===e.name;class l extends n.BaseTracer{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=i.IterableReadableStream.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){let t=e.tags??[],r=void 0===this.includeNames&&void 0===this.includeTags&&void 0===this.includeTypes;return void 0!==this.includeNames&&(r=r||this.includeNames.includes(e.name)),void 0!==this.includeTypes&&(r=r||this.includeTypes.includes(e.runType)),void 0!==this.includeTags&&(r=r||void 0!==t.find(e=>this.includeTags?.includes(e))),void 0!==this.excludeNames&&(r=r&&!this.excludeNames.includes(e.name)),void 0!==this.excludeTypes&&(r=r&&!this.excludeTypes.includes(e.runType)),void 0!==this.excludeTags&&(r=r&&t.every(e=>!this.excludeTags?.includes(e))),r}async *tapOutputIterable(e,t){let r=await t.next();if(r.done)return;let n=this.runInfoMap.get(e);if(void 0===n)return void(yield r.value);function i(e,t){return"llm"===e&&"string"==typeof t?new s.GenerationChunk({text:t}):t}let a=this.tappedPromises.get(e);if(void 0===a){let s;a=new Promise(e=>{s=e}),this.tappedPromises.set(e,a);try{let a={event:`on_${n.runType}_stream`,run_id:e,name:n.name,tags:n.tags,metadata:n.metadata,data:{}};for await(let e of(await this.send({...a,data:{chunk:i(n.runType,r.value)}},n),yield r.value,t))"tool"!==n.runType&&"retriever"!==n.runType&&await this.send({...a,data:{chunk:i(n.runType,e)}},n),yield e}finally{s()}}else for await(let e of(yield r.value,t))yield e}async send(e,t){this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){let r=this.tappedPromises.get(e.run_id);void 0!==r?r.then(()=>{this.send(e,t)}):await this.send(e,t)}async onLLMStart(e){let t=o(e),r=void 0!==e.inputs.messages?"chat_model":"llm",n={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:r,inputs:e.inputs};this.runInfoMap.set(e.id,n);let i=`on_${r}_start`;await this.send({event:i,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},n)}async onLLMNewToken(e,t,r){let n,i,o=this.runInfoMap.get(e.id);if(void 0===o)throw Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(1!==this.runInfoMap.size){if("chat_model"===o.runType)i="on_chat_model_stream",n=r?.chunk===void 0?new a.AIMessageChunk({content:t,id:`run-${e.id}`}):r.chunk.message;else if("llm"===o.runType)i="on_llm_stream",n=r?.chunk===void 0?new s.GenerationChunk({text:t}):r.chunk;else throw Error(`Unexpected run type ${o.runType}`);await this.send({event:i,data:{chunk:n},run_id:e.id,name:o.name,tags:o.tags,metadata:o.metadata},o)}}async onLLMEnd(e){let t,r,n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),void 0===n)throw Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);let i=e.outputs?.generations;if("chat_model"===n.runType){for(let e of i??[]){if(void 0!==r)break;r=e[0]?.message}t="on_chat_model_end"}else if("llm"===n.runType)r={generations:i?.map(e=>e.map(e=>({text:e.text,generationInfo:e.generationInfo}))),llmOutput:e.outputs?.llmOutput??{}},t="on_llm_end";else throw Error(`onLLMEnd: Unexpected run type: ${n.runType}`);await this.sendEndEvent({event:t,data:{output:r,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async onChainStart(e){let t=o(e),r=e.run_type??"chain",n={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:e.run_type},i={};""===e.inputs.input&&1===Object.keys(e.inputs).length?(i={},n.inputs={}):void 0!==e.inputs.input?(i.input=e.inputs.input,n.inputs=e.inputs.input):(i.input=e.inputs,n.inputs=e.inputs),this.runInfoMap.set(e.id,n),await this.send({event:`on_${r}_start`,data:i,name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},n)}async onChainEnd(e){let t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),void 0===t)throw Error(`onChainEnd: Run ID ${e.id} not found in run map.`);let r=`on_${e.run_type}_end`,n=e.inputs??t.inputs??{},i={output:e.outputs?.output??e.outputs,input:n};n.input&&1===Object.keys(n).length&&(i.input=n.input,t.inputs=n.input),await this.sendEndEvent({event:r,data:i,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){let t=o(e),r={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,r),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:e.extra?.metadata??{}},r)}async onToolEnd(e){let t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),void 0===t)throw Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(void 0===t.inputs)throw Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);let r=e.outputs?.output===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:r,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){let t=o(e),r={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,r),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},r)}async onRetrieverEnd(e){let t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),void 0===t)throw Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:e.outputs?.documents??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,r){let n=this.runInfoMap.get(r);if(void 0===n)throw Error(`handleCustomEvent: Run ID ${r} not found in run map.`);await this.send({event:"on_custom_event",run_id:r,name:e,tags:n.tags,metadata:n.metadata,data:t},n)}async finish(){Promise.all([...this.tappedPromises.values()]).finally(()=>{this.writer.close()})}}r.EventStreamCallbackHandler=l},1344,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.AsyncCaller=void 0;let i=n(e.r(36850)),a=n(e.r(55747)),s=[400,401,402,403,404,405,406,407,409],o=e=>{if(e.message.startsWith("Cancel")||e.message.startsWith("AbortError")||"AbortError"===e.name||e?.code==="ECONNABORTED")throw e;let t=e?.response?.status??e?.status;if(t&&s.includes(+t))throw e;if(e?.error?.code==="insufficient_quota"){let t=Error(e?.message);throw t.name="InsufficientQuotaError",t}};r.AsyncCaller=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??o;let t="default"in a.default?a.default.default:a.default;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>(0,i.default)(()=>e(...t).catch(e=>{if(e instanceof Error)throw e;throw Error(e)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((t,r)=>{e.signal?.addEventListener("abort",()=>{r(Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>fetch(...e).then(e=>e.ok?e:Promise.reject(e)))}}},7978,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RootListenersTracer=void 0;let n=e.r(25032);class i extends n.BaseTracer{constructor({config:e,onStart:t,onEnd:r,onError:n}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=t,this.argOnEnd=r,this.argOnError=n}persistRun(e){return Promise.resolve()}async onRunCreate(e){!this.rootId&&(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}r.RootListenersTracer=i},92933,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r._RootEventFilter=void 0,r.isRunnableInterface=function(e){return!!e&&e.lc_runnable},r._RootEventFilter=class{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let r=void 0===this.includeNames&&void 0===this.includeTypes&&void 0===this.includeTags,n=e.tags??[];return void 0!==this.includeNames&&(r=r||this.includeNames.includes(e.name)),void 0!==this.includeTypes&&(r=r||this.includeTypes.includes(t)),void 0!==this.includeTags&&(r=r||n.some(e=>this.includeTags?.includes(e))),void 0!==this.excludeNames&&(r=r&&!this.excludeNames.includes(e.name)),void 0!==this.excludeTypes&&(r=r&&!this.excludeTypes.includes(t)),void 0!==this.excludeTags&&(r=r&&n.every(e=>!this.excludeTags?.includes(e))),r}}},75713,(e,t,r)=>{"use strict";function n(e){return e.replace(/[^a-zA-Z-_0-9]/g,"_")}Object.defineProperty(r,"__esModule",{value:!0}),r.drawMermaid=function(e,t,r){let{firstNode:a,lastNode:s,nodeColors:o,withStyles:l=!0,curveStyle:u="linear",wrapLabelNWords:c=9}=r??{},d=l?`%%{init: {'flowchart': {'curve': '${u}'}}}%%
graph TD;
`:"graph TD;\n";if(l){let t="default",r={[t]:"{0}({1})"};for(let[o,l]of(void 0!==a&&(r[a]="{0}([{1}]):::first"),void 0!==s&&(r[s]="{0}([{1}]):::last"),Object.entries(e))){let e=l.name.split(":").pop()??"",a=i.some(t=>e.startsWith(t)&&e.endsWith(t))?`<p>${e}</p>`:e;Object.keys(l.metadata??{}).length&&(a+=`<hr/><small><em>${Object.entries(l.metadata??{}).map(([e,t])=>`${e} = ${t}`).join("\n")}</em></small>`);let s=(r[o]??r[t]).replace("{0}",n(o)).replace("{1}",a);d+=`	${s}
`}}let p={};for(let e of t){let t=e.source.split(":"),r=e.target.split(":"),n=t.filter((e,t)=>e===r[t]).join(":");p[n]||(p[n]=[]),p[n].push(e)}let h=new Set;function f(e,t){let r=1===e.length&&e[0].source===e[0].target;if(t&&!r){let e=t.split(":").pop();if(h.has(e))throw Error(`Found duplicate subgraph '${e}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);h.add(e),d+=`	subgraph ${e}
`}for(let t of e){let{source:e,target:r,data:i,conditional:a}=t,s="";if(void 0!==i){let e=i,t=e.split(" ");t.length>c&&(e=Array.from({length:Math.ceil(t.length/c)},(e,r)=>t.slice(r*c,(r+1)*c).join(" ")).join("&nbsp;<br>&nbsp;")),s=a?` -. &nbsp;${e}&nbsp; .-> `:` -- &nbsp;${e}&nbsp; --> `}else s=a?" -.-> ":" --> ";d+=`	${n(e)}${s}${n(r)};
`}for(let e in p)e.startsWith(`${t}:`)&&e!==t&&f(p[e],e);t&&!r&&(d+="	end\n")}for(let e in f(p[""]??[],""),p)e.includes(":")||""===e||f(p[e],e);return l&&(d+=function(e){let t="";for(let[r,n]of Object.entries(e))t+=`	classDef ${r} ${n};
`;return t}(o??{})),d},r.drawMermaidPng=a,r.drawMermaidImage=s;let i=["*","_","`"];async function a(e,t){return s(e,{...t,imageType:"png"})}async function s(e,t){let r=t?.backgroundColor??"white",n=t?.imageType??"png",i=btoa(e);void 0!==r&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(r)||(r=`!${r}`));let a=`https://mermaid.ink/img/${i}?bgColor=${r}&type=${n}`,s=await fetch(a);if(!s.ok)throw Error(`Failed to render the graph using the Mermaid.INK API.
Status code: ${s.status}
Status text: ${s.statusText}`);return await s.blob()}},65320,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.globalConfig=r.$ZodAsyncError=r.$brand=r.NEVER=void 0,r.$constructor=function(e,t,r){function n(r,n){var i;for(let a in Object.defineProperty(r,"_zod",{value:r._zod??{},enumerable:!1}),(i=r._zod).traits??(i.traits=new Set),r._zod.traits.add(e),t(r,n),s.prototype)a in r||Object.defineProperty(r,a,{value:s.prototype[a].bind(r)});r._zod.constr=s,r._zod.def=n}let i=r?.Parent??Object;class a extends i{}function s(e){var t;let i=r?.Parent?new a:this;for(let r of(n(i,e),(t=i._zod).deferred??(t.deferred=[]),i._zod.deferred))r();return i}return Object.defineProperty(a,"name",{value:e}),Object.defineProperty(s,"init",{value:n}),Object.defineProperty(s,Symbol.hasInstance,{value:t=>!!r?.Parent&&t instanceof r.Parent||t?._zod?.traits?.has(e)}),Object.defineProperty(s,"name",{value:e}),s},r.config=function(e){return e&&Object.assign(r.globalConfig,e),r.globalConfig},r.NEVER=Object.freeze({status:"aborted"}),r.$brand=Symbol("zod_brand"),r.$ZodAsyncError=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},r.globalConfig={}},25896,(e,t,r)=>{"use strict";function n(e){return{get value(){{let t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function i(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function a(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function s(e){if(!1===a(e))return!1;let t=e.constructor;if(void 0===t)return!0;let r=t.prototype;return!1!==a(r)&&!1!==Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")}function o(e,t,r){let n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function l(e){return"bigint"==typeof e?e.toString()+"n":"string"==typeof e?`"${e}"`:`${e}`}function u(e){return"string"==typeof e?e:e?.message}Object.defineProperty(r,"__esModule",{value:!0}),r.Class=r.BIGINT_FORMAT_RANGES=r.NUMBER_FORMAT_RANGES=r.primitiveTypes=r.propertyKeyTypes=r.getParsedType=r.allowsEval=r.captureStackTrace=void 0,r.assertEqual=function(e){return e},r.assertNotEqual=function(e){return e},r.assertIs=function(e){},r.assertNever=function(e){throw Error()},r.assert=function(e){},r.getEnumValues=function(e){let t=Object.values(e).filter(e=>"number"==typeof e);return Object.entries(e).filter(([e,r])=>-1===t.indexOf(+e)).map(([e,t])=>t)},r.joinValues=function(e,t="|"){return e.map(e=>l(e)).join(t)},r.jsonStringifyReplacer=function(e,t){return"bigint"==typeof t?t.toString():t},r.cached=n,r.nullish=function(e){return null==e},r.cleanRegex=function(e){let t=+!!e.startsWith("^"),r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)},r.floatSafeRemainder=function(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,i=r>n?r:n;return Number.parseInt(e.toFixed(i).replace(".",""))%Number.parseInt(t.toFixed(i).replace(".",""))/10**i},r.defineLazy=function(e,t,r){Object.defineProperty(e,t,{get(){{let n=r();return e[t]=n,n}},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})},r.assignProp=i,r.getElementAtPath=function(e,t){return t?t.reduce((e,t)=>e?.[t],e):e},r.promiseAllObject=function(e){let t=Object.keys(e);return Promise.all(t.map(t=>e[t])).then(e=>{let r={};for(let n=0;n<t.length;n++)r[t[n]]=e[n];return r})},r.randomString=function(e=10){let t="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r},r.esc=function(e){return JSON.stringify(e)},r.isObject=a,r.isPlainObject=s,r.numKeys=function(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t},r.escapeRegex=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},r.clone=o,r.normalizeParams=function(e){if(!e)return{};if("string"==typeof e)return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");e.error=e.message}return(delete e.message,"string"==typeof e.error)?{...e,error:()=>e.error}:e},r.createTransparentProxy=function(e){let t;return new Proxy({},{get:(r,n,i)=>(t??(t=e()),Reflect.get(t,n,i)),set:(r,n,i,a)=>(t??(t=e()),Reflect.set(t,n,i,a)),has:(r,n)=>(t??(t=e()),Reflect.has(t,n)),deleteProperty:(r,n)=>(t??(t=e()),Reflect.deleteProperty(t,n)),ownKeys:r=>(t??(t=e()),Reflect.ownKeys(t)),getOwnPropertyDescriptor:(r,n)=>(t??(t=e()),Reflect.getOwnPropertyDescriptor(t,n)),defineProperty:(r,n,i)=>(t??(t=e()),Reflect.defineProperty(t,n,i))})},r.stringifyPrimitive=l,r.optionalKeys=function(e){return Object.keys(e).filter(t=>"optional"===e[t]._zod.optin&&"optional"===e[t]._zod.optout)},r.pick=function(e,t){let r={},n=e._zod.def;for(let e in t){if(!(e in n.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&(r[e]=n.shape[e])}return o(e,{...e._zod.def,shape:r,checks:[]})},r.omit=function(e,t){let r={...e._zod.def.shape},n=e._zod.def;for(let e in t){if(!(e in n.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&delete r[e]}return o(e,{...e._zod.def,shape:r,checks:[]})},r.extend=function(e,t){if(!s(t))throw Error("Invalid input to extend: expected a plain object");let r={...e._zod.def,get shape(){let r={...e._zod.def.shape,...t};return i(this,"shape",r),r},checks:[]};return o(e,r)},r.merge=function(e,t){return o(e,{...e._zod.def,get shape(){let r={...e._zod.def.shape,...t._zod.def.shape};return i(this,"shape",r),r},catchall:t._zod.def.catchall,checks:[]})},r.partial=function(e,t,r){let n=t._zod.def.shape,i={...n};if(r)for(let t in r){if(!(t in n))throw Error(`Unrecognized key: "${t}"`);r[t]&&(i[t]=e?new e({type:"optional",innerType:n[t]}):n[t])}else for(let t in n)i[t]=e?new e({type:"optional",innerType:n[t]}):n[t];return o(t,{...t._zod.def,shape:i,checks:[]})},r.required=function(e,t,r){let n=t._zod.def.shape,i={...n};if(r)for(let t in r){if(!(t in i))throw Error(`Unrecognized key: "${t}"`);r[t]&&(i[t]=new e({type:"nonoptional",innerType:n[t]}))}else for(let t in n)i[t]=new e({type:"nonoptional",innerType:n[t]});return o(t,{...t._zod.def,shape:i,checks:[]})},r.aborted=function(e,t=0){for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1},r.prefixIssues=function(e,t){return t.map(t=>(t.path??(t.path=[]),t.path.unshift(e),t))},r.unwrapMessage=u,r.finalizeIssue=function(e,t,r){let n={...e,path:e.path??[]};return e.message||(n.message=u(e.inst?._zod.def?.error?.(e))??u(t?.error?.(e))??u(r.customError?.(e))??u(r.localeError?.(e))??"Invalid input"),delete n.inst,delete n.continue,t?.reportInput||delete n.input,n},r.getSizableOrigin=function(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"},r.getLengthableOrigin=function(e){return Array.isArray(e)?"array":"string"==typeof e?"string":"unknown"},r.issue=function(...e){let[t,r,n]=e;return"string"==typeof t?{message:t,code:"custom",input:r,inst:n}:{...t}},r.cleanEnum=function(e){return Object.entries(e).filter(([e,t])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])},r.captureStackTrace=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{},r.allowsEval=n(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(e){return!1}}),r.getParsedType=e=>{let t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return"promise";if("undefined"!=typeof Map&&e instanceof Map)return"map";if("undefined"!=typeof Set&&e instanceof Set)return"set";if("undefined"!=typeof Date&&e instanceof Date)return"date";if("undefined"!=typeof File&&e instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${t}`)}},r.propertyKeyTypes=new Set(["string","number","symbol"]),r.primitiveTypes=new Set(["string","number","bigint","boolean","symbol","undefined"]),r.NUMBER_FORMAT_RANGES={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},r.BIGINT_FORMAT_RANGES={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]},r.Class=class{constructor(...e){}}},18161,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.$ZodRealError=r.$ZodError=void 0,r.flattenError=function(e,t=e=>e.message){let r={},n=[];for(let i of e.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(t(i))):n.push(t(i));return{formErrors:n,fieldErrors:r}},r.formatError=function(e,t){let r=t||function(e){return e.message},n={_errors:[]},i=e=>{for(let t of e.issues)if("invalid_union"===t.code&&t.errors.length)t.errors.map(e=>i({issues:e}));else if("invalid_key"===t.code)i({issues:t.issues});else if("invalid_element"===t.code)i({issues:t.issues});else if(0===t.path.length)n._errors.push(r(t));else{let e=n,i=0;for(;i<t.path.length;){let n=t.path[i];i===t.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(r(t))):e[n]=e[n]||{_errors:[]},e=e[n],i++}}};return i(e),n},r.treeifyError=function(e,t){let r=t||function(e){return e.message},n={errors:[]},i=(e,t=[])=>{var a,s;for(let o of e.issues)if("invalid_union"===o.code&&o.errors.length)o.errors.map(e=>i({issues:e},o.path));else if("invalid_key"===o.code)i({issues:o.issues},o.path);else if("invalid_element"===o.code)i({issues:o.issues},o.path);else{let e=[...t,...o.path];if(0===e.length){n.errors.push(r(o));continue}let i=n,l=0;for(;l<e.length;){let t=e[l],n=l===e.length-1;"string"==typeof t?(i.properties??(i.properties={}),(a=i.properties)[t]??(a[t]={errors:[]}),i=i.properties[t]):(i.items??(i.items=[]),(s=i.items)[t]??(s[t]={errors:[]}),i=i.items[t]),n&&i.errors.push(r(o)),l++}}};return i(e),n},r.toDotPath=u,r.prettifyError=function(e){let t=[];for(let r of[...e.issues].sort((e,t)=>e.path.length-t.path.length))t.push(`âœ– ${r.message}`),r.path?.length&&t.push(`  â†’ at ${u(r.path)}`);return t.join("\n")};let s=e.r(65320),o=a(e.r(25896)),l=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get:()=>JSON.stringify(t,o.jsonStringifyReplacer,2),enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})};function u(e){let t=[];for(let r of e)"number"==typeof r?t.push(`[${r}]`):"symbol"==typeof r?t.push(`[${JSON.stringify(String(r))}]`):/[^\w$]/.test(r)?t.push(`[${JSON.stringify(r)}]`):(t.length&&t.push("."),t.push(r));return t.join("")}r.$ZodError=(0,s.$constructor)("$ZodError",l),r.$ZodRealError=(0,s.$constructor)("$ZodError",l,{Parent:Error})},23881,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.safeParseAsync=r._safeParseAsync=r.safeParse=r._safeParse=r.parseAsync=r._parseAsync=r.parse=r._parse=void 0;let s=a(e.r(65320)),o=a(e.r(18161)),l=a(e.r(25896));r._parse=e=>(t,r,n,i)=>{let a=n?Object.assign(n,{async:!1}):{async:!1},o=t._zod.run({value:r,issues:[]},a);if(o instanceof Promise)throw new s.$ZodAsyncError;if(o.issues.length){let t=new(i?.Err??e)(o.issues.map(e=>l.finalizeIssue(e,a,s.config())));throw l.captureStackTrace(t,i?.callee),t}return o.value},r.parse=(0,r._parse)(o.$ZodRealError),r._parseAsync=e=>async(t,r,n,i)=>{let a=n?Object.assign(n,{async:!0}):{async:!0},o=t._zod.run({value:r,issues:[]},a);if(o instanceof Promise&&(o=await o),o.issues.length){let t=new(i?.Err??e)(o.issues.map(e=>l.finalizeIssue(e,a,s.config())));throw l.captureStackTrace(t,i?.callee),t}return o.value},r.parseAsync=(0,r._parseAsync)(o.$ZodRealError),r._safeParse=e=>(t,r,n)=>{let i=n?{...n,async:!1}:{async:!1},a=t._zod.run({value:r,issues:[]},i);if(a instanceof Promise)throw new s.$ZodAsyncError;return a.issues.length?{success:!1,error:new(e??o.$ZodError)(a.issues.map(e=>l.finalizeIssue(e,i,s.config())))}:{success:!0,data:a.value}},r.safeParse=(0,r._safeParse)(o.$ZodRealError),r._safeParseAsync=e=>async(t,r,n)=>{let i=n?Object.assign(n,{async:!0}):{async:!0},a=t._zod.run({value:r,issues:[]},i);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new e(a.issues.map(e=>l.finalizeIssue(e,i,s.config())))}:{success:!0,data:a.value}},r.safeParseAsync=(0,r._safeParseAsync)(o.$ZodRealError)},44987,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.uppercase=r.lowercase=r.undefined=r.null=r.boolean=r.number=r.integer=r.bigint=r.string=r.date=r.e164=r.domain=r.hostname=r.base64url=r.base64=r.cidrv6=r.cidrv4=r.ipv6=r.ipv4=r._emoji=r.browserEmail=r.unicodeEmail=r.rfc5322Email=r.html5Email=r.email=r.uuid7=r.uuid6=r.uuid4=r.uuid=r.guid=r.extendedDuration=r.duration=r.nanoid=r.ksuid=r.xid=r.ulid=r.cuid2=r.cuid=void 0,r.emoji=function(){return RegExp(r._emoji,"u")},r.time=function(e){return RegExp(`^${i(e)}$`)},r.datetime=function(e){let t=i({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-]\\d{2}:\\d{2})");let a=`${t}(?:${r.join("|")})`;return RegExp(`^${n}T(?:${a})$`)},r.cuid=/^[cC][^\s-]{8,}$/,r.cuid2=/^[0-9a-z]+$/,r.ulid=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,r.xid=/^[0-9a-vA-V]{20}$/,r.ksuid=/^[A-Za-z0-9]{27}$/,r.nanoid=/^[a-zA-Z0-9_-]{21}$/,r.duration=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,r.extendedDuration=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,r.guid=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,r.uuid=e=>e?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,r.uuid4=(0,r.uuid)(4),r.uuid6=(0,r.uuid)(6),r.uuid7=(0,r.uuid)(7),r.email=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,r.html5Email=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,r.rfc5322Email=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,r.unicodeEmail=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u,r.browserEmail=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,r._emoji="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",r.ipv4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,r.ipv6=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,r.cidrv4=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,r.cidrv6=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,r.base64=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,r.base64url=/^[A-Za-z0-9_-]*$/,r.hostname=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,r.domain=/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,r.e164=/^\+(?:[0-9]){6,14}[0-9]$/;let n="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))";function i(e){let t="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof e.precision?-1===e.precision?`${t}`:0===e.precision?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}r.date=RegExp(`^${n}$`),r.string=e=>{let t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${t}$`)},r.bigint=/^\d+n?$/,r.integer=/^\d+$/,r.number=/^-?\d+(?:\.\d+)?/i,r.boolean=/true|false/i,r.null=/null/i,r.undefined=/undefined/i,r.lowercase=/^[^A-Z]*$/,r.uppercase=/^[^a-z]*$/},86512,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.$ZodCheckOverwrite=r.$ZodCheckMimeType=r.$ZodCheckProperty=r.$ZodCheckEndsWith=r.$ZodCheckStartsWith=r.$ZodCheckIncludes=r.$ZodCheckUpperCase=r.$ZodCheckLowerCase=r.$ZodCheckRegex=r.$ZodCheckStringFormat=r.$ZodCheckLengthEquals=r.$ZodCheckMinLength=r.$ZodCheckMaxLength=r.$ZodCheckSizeEquals=r.$ZodCheckMinSize=r.$ZodCheckMaxSize=r.$ZodCheckBigIntFormat=r.$ZodCheckNumberFormat=r.$ZodCheckMultipleOf=r.$ZodCheckGreaterThan=r.$ZodCheckLessThan=r.$ZodCheck=void 0;let s=a(e.r(65320)),o=a(e.r(44987)),l=a(e.r(25896));r.$ZodCheck=s.$constructor("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])});let u={number:"number",bigint:"bigint",object:"date"};function c(e,t,r){e.issues.length&&t.issues.push(...l.prefixIssues(r,e.issues))}r.$ZodCheckLessThan=s.$constructor("$ZodCheckLessThan",(e,t)=>{r.$ZodCheck.init(e,t);let n=u[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,n=(t.inclusive?r.maximum:r.exclusiveMaximum)??1/0;t.value<n&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value<=t.value:r.value<t.value)||r.issues.push({origin:n,code:"too_big",maximum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),r.$ZodCheckGreaterThan=s.$constructor("$ZodCheckGreaterThan",(e,t)=>{r.$ZodCheck.init(e,t);let n=u[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,n=(t.inclusive?r.minimum:r.exclusiveMinimum)??-1/0;t.value>n&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value>=t.value:r.value>t.value)||r.issues.push({origin:n,code:"too_small",minimum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),r.$ZodCheckMultipleOf=s.$constructor("$ZodCheckMultipleOf",(e,t)=>{r.$ZodCheck.init(e,t),e._zod.onattach.push(e=>{var r;(r=e._zod.bag).multipleOf??(r.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof r.value?r.value%t.value===BigInt(0):0===l.floatSafeRemainder(r.value,t.value))||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),r.$ZodCheckNumberFormat=s.$constructor("$ZodCheckNumberFormat",(e,t)=>{r.$ZodCheck.init(e,t),t.format=t.format||"float64";let n=t.format?.includes("int"),i=n?"int":"number",[a,s]=l.NUMBER_FORMAT_RANGES[t.format];e._zod.onattach.push(e=>{let r=e._zod.bag;r.format=t.format,r.minimum=a,r.maximum=s,n&&(r.pattern=o.integer)}),e._zod.check=r=>{let o=r.value;if(n){if(!Number.isInteger(o))return void r.issues.push({expected:i,format:t.format,code:"invalid_type",input:o,inst:e});if(!Number.isSafeInteger(o))return void(o>0?r.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,continue:!t.abort}):r.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,continue:!t.abort}))}o<a&&r.issues.push({origin:"number",input:o,code:"too_small",minimum:a,inclusive:!0,inst:e,continue:!t.abort}),o>s&&r.issues.push({origin:"number",input:o,code:"too_big",maximum:s,inst:e})}}),r.$ZodCheckBigIntFormat=s.$constructor("$ZodCheckBigIntFormat",(e,t)=>{r.$ZodCheck.init(e,t);let[n,i]=l.BIGINT_FORMAT_RANGES[t.format];e._zod.onattach.push(e=>{let r=e._zod.bag;r.format=t.format,r.minimum=n,r.maximum=i}),e._zod.check=r=>{let a=r.value;a<n&&r.issues.push({origin:"bigint",input:a,code:"too_small",minimum:n,inclusive:!0,inst:e,continue:!t.abort}),a>i&&r.issues.push({origin:"bigint",input:a,code:"too_big",maximum:i,inst:e})}}),r.$ZodCheckMaxSize=s.$constructor("$ZodCheckMaxSize",(e,t)=>{var n;r.$ZodCheck.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!l.nullish(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??1/0;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let n=r.value;n.size<=t.maximum||r.issues.push({origin:l.getSizableOrigin(n),code:"too_big",maximum:t.maximum,input:n,inst:e,continue:!t.abort})}}),r.$ZodCheckMinSize=s.$constructor("$ZodCheckMinSize",(e,t)=>{var n;r.$ZodCheck.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!l.nullish(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??-1/0;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let n=r.value;n.size>=t.minimum||r.issues.push({origin:l.getSizableOrigin(n),code:"too_small",minimum:t.minimum,input:n,inst:e,continue:!t.abort})}}),r.$ZodCheckSizeEquals=s.$constructor("$ZodCheckSizeEquals",(e,t)=>{var n;r.$ZodCheck.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!l.nullish(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.size,r.maximum=t.size,r.size=t.size}),e._zod.check=r=>{let n=r.value,i=n.size;if(i===t.size)return;let a=i>t.size;r.issues.push({origin:l.getSizableOrigin(n),...a?{code:"too_big",maximum:t.size}:{code:"too_small",minimum:t.size},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),r.$ZodCheckMaxLength=s.$constructor("$ZodCheckMaxLength",(e,t)=>{var n;r.$ZodCheck.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!l.nullish(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??1/0;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let n=r.value;if(n.length<=t.maximum)return;let i=l.getLengthableOrigin(n);r.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),r.$ZodCheckMinLength=s.$constructor("$ZodCheckMinLength",(e,t)=>{var n;r.$ZodCheck.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!l.nullish(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??-1/0;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let n=r.value;if(n.length>=t.minimum)return;let i=l.getLengthableOrigin(n);r.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),r.$ZodCheckLengthEquals=s.$constructor("$ZodCheckLengthEquals",(e,t)=>{var n;r.$ZodCheck.init(e,t),(n=e._zod.def).when??(n.when=e=>{let t=e.value;return!l.nullish(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=r=>{let n=r.value,i=n.length;if(i===t.length)return;let a=l.getLengthableOrigin(n),s=i>t.length;r.issues.push({origin:a,...s?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),r.$ZodCheckStringFormat=s.$constructor("$ZodCheckStringFormat",(e,t)=>{var n,i;r.$ZodCheck.init(e,t),e._zod.onattach.push(e=>{let r=e._zod.bag;r.format=t.format,t.pattern&&(r.patterns??(r.patterns=new Set),r.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(i=e._zod).check??(i.check=()=>{})}),r.$ZodCheckRegex=s.$constructor("$ZodCheckRegex",(e,t)=>{r.$ZodCheckStringFormat.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),r.$ZodCheckLowerCase=s.$constructor("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=o.lowercase),r.$ZodCheckStringFormat.init(e,t)}),r.$ZodCheckUpperCase=s.$constructor("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=o.uppercase),r.$ZodCheckStringFormat.init(e,t)}),r.$ZodCheckIncludes=s.$constructor("$ZodCheckIncludes",(e,t)=>{r.$ZodCheck.init(e,t);let n=l.escapeRegex(t.includes),i=new RegExp("number"==typeof t.position?`^.{${t.position}}${n}`:n);t.pattern=i,e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(i)}),e._zod.check=r=>{r.value.includes(t.includes,t.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:r.value,inst:e,continue:!t.abort})}}),r.$ZodCheckStartsWith=s.$constructor("$ZodCheckStartsWith",(e,t)=>{r.$ZodCheck.init(e,t);let n=RegExp(`^${l.escapeRegex(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(n)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),r.$ZodCheckEndsWith=s.$constructor("$ZodCheckEndsWith",(e,t)=>{r.$ZodCheck.init(e,t);let n=RegExp(`.*${l.escapeRegex(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(n)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}}),r.$ZodCheckProperty=s.$constructor("$ZodCheckProperty",(e,t)=>{r.$ZodCheck.init(e,t),e._zod.check=e=>{let r=t.schema._zod.run({value:e.value[t.property],issues:[]},{});if(r instanceof Promise)return r.then(r=>c(r,e,t.property));c(r,e,t.property)}}),r.$ZodCheckMimeType=s.$constructor("$ZodCheckMimeType",(e,t)=>{r.$ZodCheck.init(e,t);let n=new Set(t.mime);e._zod.onattach.push(e=>{e._zod.bag.mime=t.mime}),e._zod.check=r=>{n.has(r.value.type)||r.issues.push({code:"invalid_value",values:t.mime,input:r.value.type,inst:e})}}),r.$ZodCheckOverwrite=s.$constructor("$ZodCheckOverwrite",(e,t)=>{r.$ZodCheck.init(e,t),e._zod.check=e=>{e.value=t.tx(e.value)}})},71449,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Doc=void 0,r.Doc=class{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if("function"==typeof e){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let t=e.split("\n").filter(e=>e),r=Math.min(...t.map(e=>e.length-e.trimStart().length));for(let e of t.map(e=>e.slice(r)).map(e=>" ".repeat(2*this.indent)+e))this.content.push(e)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(e=>`  ${e}`)].join("\n"))}}},9431,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.version=void 0,r.version={major:4,minor:0,patch:0}},23513,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.$ZodSet=r.$ZodMap=r.$ZodRecord=r.$ZodTuple=r.$ZodIntersection=r.$ZodDiscriminatedUnion=r.$ZodUnion=r.$ZodObject=r.$ZodArray=r.$ZodDate=r.$ZodVoid=r.$ZodNever=r.$ZodUnknown=r.$ZodAny=r.$ZodNull=r.$ZodUndefined=r.$ZodSymbol=r.$ZodBigIntFormat=r.$ZodBigInt=r.$ZodBoolean=r.$ZodNumberFormat=r.$ZodNumber=r.$ZodCustomStringFormat=r.$ZodJWT=r.$ZodE164=r.$ZodBase64URL=r.$ZodBase64=r.$ZodCIDRv6=r.$ZodCIDRv4=r.$ZodIPv6=r.$ZodIPv4=r.$ZodISODuration=r.$ZodISOTime=r.$ZodISODate=r.$ZodISODateTime=r.$ZodKSUID=r.$ZodXID=r.$ZodULID=r.$ZodCUID2=r.$ZodCUID=r.$ZodNanoID=r.$ZodEmoji=r.$ZodURL=r.$ZodEmail=r.$ZodUUID=r.$ZodGUID=r.$ZodStringFormat=r.$ZodString=r.clone=r.$ZodType=void 0,r.$ZodCustom=r.$ZodLazy=r.$ZodPromise=r.$ZodTemplateLiteral=r.$ZodReadonly=r.$ZodPipe=r.$ZodNaN=r.$ZodCatch=r.$ZodSuccess=r.$ZodNonOptional=r.$ZodPrefault=r.$ZodDefault=r.$ZodNullable=r.$ZodOptional=r.$ZodTransform=r.$ZodFile=r.$ZodLiteral=r.$ZodEnum=void 0,r.isValidBase64=f,r.isValidBase64URL=m,r.isValidJWT=g;let s=a(e.r(86512)),o=a(e.r(65320)),l=e.r(71449),u=e.r(23881),c=a(e.r(44987)),d=a(e.r(25896)),p=e.r(9431);r.$ZodType=o.$constructor("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=p.version;let n=[...e._zod.def.checks??[]];for(let t of(e._zod.traits.has("$ZodCheck")&&n.unshift(e),n))for(let r of t._zod.onattach)r(e);if(0===n.length)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{let t=(e,t,r)=>{let n,i=d.aborted(e);for(let a of t){if(a._zod.def.when){if(!a._zod.def.when(e))continue}else if(i)continue;let t=e.issues.length,s=a._zod.check(e);if(s instanceof Promise&&r?.async===!1)throw new o.$ZodAsyncError;if(n||s instanceof Promise)n=(n??Promise.resolve()).then(async()=>{await s,e.issues.length!==t&&(i||(i=d.aborted(e,t)))});else{if(e.issues.length===t)continue;i||(i=d.aborted(e,t))}}return n?n.then(()=>e):e};e._zod.run=(r,i)=>{let a=e._zod.parse(r,i);if(a instanceof Promise){if(!1===i.async)throw new o.$ZodAsyncError;return a.then(e=>t(e,n,i))}return t(a,n,i)}}e["~standard"]={validate:t=>{try{let r=(0,u.safeParse)(e,t);return r.success?{value:r.data}:{issues:r.error?.issues}}catch(r){return(0,u.safeParseAsync)(e,t).then(e=>e.success?{value:e.data}:{issues:e.error?.issues})}},vendor:"zod",version:1}});var h=e.r(25896);function f(e){if(""===e)return!0;if(e.length%4!=0)return!1;try{return atob(e),!0}catch{return!1}}function m(e){if(!c.base64url.test(e))return!1;let t=e.replace(/[-_]/g,e=>"-"===e?"+":"/");return f(t.padEnd(4*Math.ceil(t.length/4),"="))}function g(e,t=null){try{let r=e.split(".");if(3!==r.length)return!1;let[n]=r;if(!n)return!1;let i=JSON.parse(atob(n));if("typ"in i&&i?.typ!=="JWT"||!i.alg||t&&(!("alg"in i)||i.alg!==t))return!1;return!0}catch{return!1}}function y(e,t,r){e.issues.length&&t.issues.push(...d.prefixIssues(r,e.issues)),t.value[r]=e.value}function b(e,t,r){e.issues.length&&t.issues.push(...d.prefixIssues(r,e.issues)),t.value[r]=e.value}function _(e,t,r,n){e.issues.length?void 0===n[r]?r in n?t.value[r]=void 0:t.value[r]=e.value:t.issues.push(...d.prefixIssues(r,e.issues)):void 0===e.value?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function v(e,t,r,n){for(let r of e)if(0===r.issues.length)return t.value=r.value,t;return t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(e=>e.issues.map(e=>d.finalizeIssue(e,n,o.config())))}),t}function w(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),d.aborted(e))return e;let n=function e(t,r){if(t===r||t instanceof Date&&r instanceof Date&&+t==+r)return{valid:!0,data:t};if(d.isPlainObject(t)&&d.isPlainObject(r)){let n=Object.keys(r),i=Object.keys(t).filter(e=>-1!==n.indexOf(e)),a={...t,...r};for(let n of i){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};a[n]=i.data}return{valid:!0,data:a}}if(Array.isArray(t)&&Array.isArray(r)){if(t.length!==r.length)return{valid:!1,mergeErrorPath:[]};let n=[];for(let i=0;i<t.length;i++){let a=e(t[i],r[i]);if(!a.valid)return{valid:!1,mergeErrorPath:[i,...a.mergeErrorPath]};n.push(a.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}(t.value,r.value);if(!n.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}function O(e,t,r){e.issues.length&&t.issues.push(...d.prefixIssues(r,e.issues)),t.value[r]=e.value}function P(e,t,r,n,i,a,s){e.issues.length&&(d.propertyKeyTypes.has(typeof n)?r.issues.push(...d.prefixIssues(n,e.issues)):r.issues.push({origin:"map",code:"invalid_key",input:i,inst:a,issues:e.issues.map(e=>d.finalizeIssue(e,s,o.config()))})),t.issues.length&&(d.propertyKeyTypes.has(typeof n)?r.issues.push(...d.prefixIssues(n,t.issues)):r.issues.push({origin:"map",code:"invalid_element",input:i,inst:a,key:n,issues:t.issues.map(e=>d.finalizeIssue(e,s,o.config()))})),r.value.set(e.value,t.value)}function S(e,t){e.issues.length&&t.issues.push(...e.issues),t.value.add(e.value)}function E(e,t){return void 0===e.value&&(e.value=t.defaultValue),e}function k(e,t){return e.issues.length||void 0!==e.value||e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}function I(e,t,r){return d.aborted(e)?e:t.out._zod.run({value:e.value,issues:e.issues},r)}function A(e){return e.value=Object.freeze(e.value),e}function T(e,t,r,n){if(!e){let e={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(e.params=n._zod.def.params),t.issues.push(d.issue(e))}}Object.defineProperty(r,"clone",{enumerable:!0,get:function(){return h.clone}}),r.$ZodString=o.$constructor("$ZodString",(e,t)=>{r.$ZodType.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??c.string(e._zod.bag),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=String(r.value)}catch(e){}return"string"==typeof r.value||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),r.$ZodStringFormat=o.$constructor("$ZodStringFormat",(e,t)=>{s.$ZodCheckStringFormat.init(e,t),r.$ZodString.init(e,t)}),r.$ZodGUID=o.$constructor("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=c.guid),r.$ZodStringFormat.init(e,t)}),r.$ZodUUID=o.$constructor("$ZodUUID",(e,t)=>{if(t.version){let e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(void 0===e)throw Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=c.uuid(e))}else t.pattern??(t.pattern=c.uuid());r.$ZodStringFormat.init(e,t)}),r.$ZodEmail=o.$constructor("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=c.email),r.$ZodStringFormat.init(e,t)}),r.$ZodURL=o.$constructor("$ZodURL",(e,t)=>{r.$ZodStringFormat.init(e,t),e._zod.check=r=>{try{let n=r.value,i=new URL(n),a=i.href;t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:c.hostname.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),!n.endsWith("/")&&a.endsWith("/")?r.value=a.slice(0,-1):r.value=a;return}catch(n){r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),r.$ZodEmoji=o.$constructor("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=c.emoji()),r.$ZodStringFormat.init(e,t)}),r.$ZodNanoID=o.$constructor("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=c.nanoid),r.$ZodStringFormat.init(e,t)}),r.$ZodCUID=o.$constructor("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=c.cuid),r.$ZodStringFormat.init(e,t)}),r.$ZodCUID2=o.$constructor("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=c.cuid2),r.$ZodStringFormat.init(e,t)}),r.$ZodULID=o.$constructor("$ZodULID",(e,t)=>{t.pattern??(t.pattern=c.ulid),r.$ZodStringFormat.init(e,t)}),r.$ZodXID=o.$constructor("$ZodXID",(e,t)=>{t.pattern??(t.pattern=c.xid),r.$ZodStringFormat.init(e,t)}),r.$ZodKSUID=o.$constructor("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=c.ksuid),r.$ZodStringFormat.init(e,t)}),r.$ZodISODateTime=o.$constructor("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=c.datetime(t)),r.$ZodStringFormat.init(e,t)}),r.$ZodISODate=o.$constructor("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=c.date),r.$ZodStringFormat.init(e,t)}),r.$ZodISOTime=o.$constructor("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=c.time(t)),r.$ZodStringFormat.init(e,t)}),r.$ZodISODuration=o.$constructor("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=c.duration),r.$ZodStringFormat.init(e,t)}),r.$ZodIPv4=o.$constructor("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=c.ipv4),r.$ZodStringFormat.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.format="ipv4"})}),r.$ZodIPv6=o.$constructor("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=c.ipv6),r.$ZodStringFormat.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.format="ipv6"}),e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),r.$ZodCIDRv4=o.$constructor("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=c.cidrv4),r.$ZodStringFormat.init(e,t)}),r.$ZodCIDRv6=o.$constructor("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=c.cidrv6),r.$ZodStringFormat.init(e,t),e._zod.check=r=>{let[n,i]=r.value.split("/");try{if(!i)throw Error();let e=Number(i);if(`${e}`!==i||e<0||e>128)throw Error();new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}}),r.$ZodBase64=o.$constructor("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=c.base64),r.$ZodStringFormat.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64"}),e._zod.check=r=>{f(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}}),r.$ZodBase64URL=o.$constructor("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=c.base64url),r.$ZodStringFormat.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64url"}),e._zod.check=r=>{m(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),r.$ZodE164=o.$constructor("$ZodE164",(e,t)=>{t.pattern??(t.pattern=c.e164),r.$ZodStringFormat.init(e,t)}),r.$ZodJWT=o.$constructor("$ZodJWT",(e,t)=>{r.$ZodStringFormat.init(e,t),e._zod.check=r=>{g(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),r.$ZodCustomStringFormat=o.$constructor("$ZodCustomStringFormat",(e,t)=>{r.$ZodStringFormat.init(e,t),e._zod.check=r=>{t.fn(r.value)||r.issues.push({code:"invalid_format",format:t.format,input:r.value,inst:e,continue:!t.abort})}}),r.$ZodNumber=o.$constructor("$ZodNumber",(e,t)=>{r.$ZodType.init(e,t),e._zod.pattern=e._zod.bag.pattern??c.number,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch(e){}let i=r.value;if("number"==typeof i&&!Number.isNaN(i)&&Number.isFinite(i))return r;let a="number"==typeof i?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:e,...a?{received:a}:{}}),r}}),r.$ZodNumberFormat=o.$constructor("$ZodNumber",(e,t)=>{s.$ZodCheckNumberFormat.init(e,t),r.$ZodNumber.init(e,t)}),r.$ZodBoolean=o.$constructor("$ZodBoolean",(e,t)=>{r.$ZodType.init(e,t),e._zod.pattern=c.boolean,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=!!r.value}catch(e){}let i=r.value;return"boolean"==typeof i||r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:e}),r}}),r.$ZodBigInt=o.$constructor("$ZodBigInt",(e,t)=>{r.$ZodType.init(e,t),e._zod.pattern=c.bigint,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=BigInt(r.value)}catch(e){}return"bigint"==typeof r.value||r.issues.push({expected:"bigint",code:"invalid_type",input:r.value,inst:e}),r}}),r.$ZodBigIntFormat=o.$constructor("$ZodBigInt",(e,t)=>{s.$ZodCheckBigIntFormat.init(e,t),r.$ZodBigInt.init(e,t)}),r.$ZodSymbol=o.$constructor("$ZodSymbol",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return"symbol"==typeof n||t.issues.push({expected:"symbol",code:"invalid_type",input:n,inst:e}),t}}),r.$ZodUndefined=o.$constructor("$ZodUndefined",(e,t)=>{r.$ZodType.init(e,t),e._zod.pattern=c.undefined,e._zod.values=new Set([void 0]),e._zod.optin="optional",e._zod.optout="optional",e._zod.parse=(t,r)=>{let n=t.value;return void 0===n||t.issues.push({expected:"undefined",code:"invalid_type",input:n,inst:e}),t}}),r.$ZodNull=o.$constructor("$ZodNull",(e,t)=>{r.$ZodType.init(e,t),e._zod.pattern=c.null,e._zod.values=new Set([null]),e._zod.parse=(t,r)=>{let n=t.value;return null===n||t.issues.push({expected:"null",code:"invalid_type",input:n,inst:e}),t}}),r.$ZodAny=o.$constructor("$ZodAny",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=e=>e}),r.$ZodUnknown=o.$constructor("$ZodUnknown",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=e=>e}),r.$ZodNever=o.$constructor("$ZodNever",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(t,r)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:e}),t)}),r.$ZodVoid=o.$constructor("$ZodVoid",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return void 0===n||t.issues.push({expected:"void",code:"invalid_type",input:n,inst:e}),t}}),r.$ZodDate=o.$constructor("$ZodDate",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=new Date(r.value)}catch(e){}let i=r.value,a=i instanceof Date;return a&&!Number.isNaN(i.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:i,...a?{received:"Invalid Date"}:{},inst:e}),r}}),r.$ZodArray=o.$constructor("$ZodArray",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:e}),r;r.value=Array(i.length);let a=[];for(let e=0;e<i.length;e++){let s=i[e],o=t.element._zod.run({value:s,issues:[]},n);o instanceof Promise?a.push(o.then(t=>y(t,r,e))):y(o,r,e)}return a.length?Promise.all(a).then(()=>r):r}}),r.$ZodObject=o.$constructor("$ZodObject",(e,t)=>{let n,i;r.$ZodType.init(e,t);let a=d.cached(()=>{let e=Object.keys(t.shape);for(let n of e)if(!(t.shape[n]instanceof r.$ZodType))throw Error(`Invalid element at key "${n}": expected a Zod schema`);let n=d.optionalKeys(t.shape);return{shape:t.shape,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(n)}});d.defineLazy(e._zod,"propValues",()=>{let e=t.shape,r={};for(let t in e){let n=e[t]._zod;if(n.values)for(let e of(r[t]??(r[t]=new Set),n.values))r[t].add(e)}return r});let s=d.isObject,u=!o.globalConfig.jitless,c=d.allowsEval,p=u&&c.value,h=t.catchall;e._zod.parse=(r,o)=>{i??(i=a.value);let c=r.value;if(!s(c))return r.issues.push({expected:"object",code:"invalid_type",input:c,inst:e}),r;let f=[];if(u&&p&&o?.async===!1&&!0!==o.jitless)n||(n=(e=>{let t=new l.Doc(["shape","payload","ctx"]),r=a.value,n=e=>{let t=d.esc(e);return`shape[${t}]._zod.run({ value: input[${t}], issues: [] }, ctx)`};t.write("const input = payload.value;");let i=Object.create(null),s=0;for(let e of r.keys)i[e]=`key_${s++}`;for(let e of(t.write("const newResult = {}"),r.keys))if(r.optionalKeys.has(e)){let r=i[e];t.write(`const ${r} = ${n(e)};`);let a=d.esc(e);t.write(`
        if (${r}.issues.length) {
          if (input[${a}] === undefined) {
            if (${a} in input) {
              newResult[${a}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${r}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${a}, ...iss.path] : [${a}],
              }))
            );
          }
        } else if (${r}.value === undefined) {
          if (${a} in input) newResult[${a}] = undefined;
        } else {
          newResult[${a}] = ${r}.value;
        }
        `)}else{let r=i[e];t.write(`const ${r} = ${n(e)};`),t.write(`
          if (${r}.issues.length) payload.issues = payload.issues.concat(${r}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${d.esc(e)}, ...iss.path] : [${d.esc(e)}]
          })));`),t.write(`newResult[${d.esc(e)}] = ${r}.value`)}t.write("payload.value = newResult;"),t.write("return payload;");let o=t.compile();return(t,r)=>o(e,t,r)})(t.shape)),r=n(r,o);else{r.value={};let e=i.shape;for(let t of i.keys){let n=e[t],i=n._zod.run({value:c[t],issues:[]},o),a="optional"===n._zod.optin&&"optional"===n._zod.optout;i instanceof Promise?f.push(i.then(e=>a?_(e,r,t,c):b(e,r,t))):a?_(i,r,t,c):b(i,r,t)}}if(!h)return f.length?Promise.all(f).then(()=>r):r;let m=[],g=i.keySet,y=h._zod,v=y.def.type;for(let e of Object.keys(c)){if(g.has(e))continue;if("never"===v){m.push(e);continue}let t=y.run({value:c[e],issues:[]},o);t instanceof Promise?f.push(t.then(t=>b(t,r,e))):b(t,r,e)}return(m.length&&r.issues.push({code:"unrecognized_keys",keys:m,input:c,inst:e}),f.length)?Promise.all(f).then(()=>r):r}}),r.$ZodUnion=o.$constructor("$ZodUnion",(e,t)=>{r.$ZodType.init(e,t),d.defineLazy(e._zod,"optin",()=>t.options.some(e=>"optional"===e._zod.optin)?"optional":void 0),d.defineLazy(e._zod,"optout",()=>t.options.some(e=>"optional"===e._zod.optout)?"optional":void 0),d.defineLazy(e._zod,"values",()=>{if(t.options.every(e=>e._zod.values))return new Set(t.options.flatMap(e=>Array.from(e._zod.values)))}),d.defineLazy(e._zod,"pattern",()=>{if(t.options.every(e=>e._zod.pattern)){let e=t.options.map(e=>e._zod.pattern);return RegExp(`^(${e.map(e=>d.cleanRegex(e.source)).join("|")})$`)}}),e._zod.parse=(r,n)=>{let i=!1,a=[];for(let e of t.options){let t=e._zod.run({value:r.value,issues:[]},n);if(t instanceof Promise)a.push(t),i=!0;else{if(0===t.issues.length)return t;a.push(t)}}return i?Promise.all(a).then(t=>v(t,r,e,n)):v(a,r,e,n)}}),r.$ZodDiscriminatedUnion=o.$constructor("$ZodDiscriminatedUnion",(e,t)=>{r.$ZodUnion.init(e,t);let n=e._zod.parse;d.defineLazy(e._zod,"propValues",()=>{let e={};for(let r of t.options){let n=r._zod.propValues;if(!n||0===Object.keys(n).length)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(r)}"`);for(let[t,r]of Object.entries(n))for(let n of(e[t]||(e[t]=new Set),r))e[t].add(n)}return e});let i=d.cached(()=>{let e=t.options,r=new Map;for(let n of e){let e=n._zod.propValues[t.discriminator];if(!e||0===e.size)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(n)}"`);for(let t of e){if(r.has(t))throw Error(`Duplicate discriminator value "${String(t)}"`);r.set(t,n)}}return r});e._zod.parse=(r,a)=>{let s=r.value;if(!d.isObject(s))return r.issues.push({code:"invalid_type",expected:"object",input:s,inst:e}),r;let o=i.value.get(s?.[t.discriminator]);return o?o._zod.run(r,a):t.unionFallback?n(r,a):(r.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:s,path:[t.discriminator],inst:e}),r)}}),r.$ZodIntersection=o.$constructor("$ZodIntersection",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(e,r)=>{let n=e.value,i=t.left._zod.run({value:n,issues:[]},r),a=t.right._zod.run({value:n,issues:[]},r);return i instanceof Promise||a instanceof Promise?Promise.all([i,a]).then(([t,r])=>w(e,t,r)):w(e,i,a)}}),r.$ZodTuple=o.$constructor("$ZodTuple",(e,t)=>{r.$ZodType.init(e,t);let n=t.items,i=n.length-[...n].reverse().findIndex(e=>"optional"!==e._zod.optin);e._zod.parse=(r,a)=>{let s=r.value;if(!Array.isArray(s))return r.issues.push({input:s,inst:e,expected:"tuple",code:"invalid_type"}),r;r.value=[];let o=[];if(!t.rest){let t=s.length>n.length,a=s.length<i-1;if(t||a)return r.issues.push({input:s,inst:e,origin:"array",...t?{code:"too_big",maximum:n.length}:{code:"too_small",minimum:n.length}}),r}let l=-1;for(let e of n){if(++l>=s.length&&l>=i)continue;let t=e._zod.run({value:s[l],issues:[]},a);t instanceof Promise?o.push(t.then(e=>O(e,r,l))):O(t,r,l)}if(t.rest)for(let e of s.slice(n.length)){l++;let n=t.rest._zod.run({value:e,issues:[]},a);n instanceof Promise?o.push(n.then(e=>O(e,r,l))):O(n,r,l)}return o.length?Promise.all(o).then(()=>r):r}}),r.$ZodRecord=o.$constructor("$ZodRecord",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!d.isPlainObject(i))return r.issues.push({expected:"record",code:"invalid_type",input:i,inst:e}),r;let a=[];if(t.keyType._zod.values){let s,o=t.keyType._zod.values;for(let e of(r.value={},o))if("string"==typeof e||"number"==typeof e||"symbol"==typeof e){let s=t.valueType._zod.run({value:i[e],issues:[]},n);s instanceof Promise?a.push(s.then(t=>{t.issues.length&&r.issues.push(...d.prefixIssues(e,t.issues)),r.value[e]=t.value})):(s.issues.length&&r.issues.push(...d.prefixIssues(e,s.issues)),r.value[e]=s.value)}for(let e in i)o.has(e)||(s=s??[]).push(e);s&&s.length>0&&r.issues.push({code:"unrecognized_keys",input:i,inst:e,keys:s})}else for(let s of(r.value={},Reflect.ownKeys(i))){if("__proto__"===s)continue;let l=t.keyType._zod.run({value:s,issues:[]},n);if(l instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(l.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:l.issues.map(e=>d.finalizeIssue(e,n,o.config())),input:s,path:[s],inst:e}),r.value[l.value]=l.value;continue}let u=t.valueType._zod.run({value:i[s],issues:[]},n);u instanceof Promise?a.push(u.then(e=>{e.issues.length&&r.issues.push(...d.prefixIssues(s,e.issues)),r.value[l.value]=e.value})):(u.issues.length&&r.issues.push(...d.prefixIssues(s,u.issues)),r.value[l.value]=u.value)}return a.length?Promise.all(a).then(()=>r):r}}),r.$ZodMap=o.$constructor("$ZodMap",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!(i instanceof Map))return r.issues.push({expected:"map",code:"invalid_type",input:i,inst:e}),r;let a=[];for(let[s,o]of(r.value=new Map,i)){let l=t.keyType._zod.run({value:s,issues:[]},n),u=t.valueType._zod.run({value:o,issues:[]},n);l instanceof Promise||u instanceof Promise?a.push(Promise.all([l,u]).then(([t,a])=>{P(t,a,r,s,i,e,n)})):P(l,u,r,s,i,e,n)}return a.length?Promise.all(a).then(()=>r):r}}),r.$ZodSet=o.$constructor("$ZodSet",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!(i instanceof Set))return r.issues.push({input:i,inst:e,expected:"set",code:"invalid_type"}),r;let a=[];for(let e of(r.value=new Set,i)){let i=t.valueType._zod.run({value:e,issues:[]},n);i instanceof Promise?a.push(i.then(e=>S(e,r))):S(i,r)}return a.length?Promise.all(a).then(()=>r):r}}),r.$ZodEnum=o.$constructor("$ZodEnum",(e,t)=>{r.$ZodType.init(e,t);let n=d.getEnumValues(t.entries);e._zod.values=new Set(n),e._zod.pattern=RegExp(`^(${n.filter(e=>d.propertyKeyTypes.has(typeof e)).map(e=>"string"==typeof e?d.escapeRegex(e):e.toString()).join("|")})$`),e._zod.parse=(t,r)=>{let i=t.value;return e._zod.values.has(i)||t.issues.push({code:"invalid_value",values:n,input:i,inst:e}),t}}),r.$ZodLiteral=o.$constructor("$ZodLiteral",(e,t)=>{r.$ZodType.init(e,t),e._zod.values=new Set(t.values),e._zod.pattern=RegExp(`^(${t.values.map(e=>"string"==typeof e?d.escapeRegex(e):e?e.toString():String(e)).join("|")})$`),e._zod.parse=(r,n)=>{let i=r.value;return e._zod.values.has(i)||r.issues.push({code:"invalid_value",values:t.values,input:i,inst:e}),r}}),r.$ZodFile=o.$constructor("$ZodFile",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return n instanceof File||t.issues.push({expected:"file",code:"invalid_type",input:n,inst:e}),t}}),r.$ZodTransform=o.$constructor("$ZodTransform",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(e,r)=>{let n=t.transform(e.value,e);if(r.async)return(n instanceof Promise?n:Promise.resolve(n)).then(t=>(e.value=t,e));if(n instanceof Promise)throw new o.$ZodAsyncError;return e.value=n,e}}),r.$ZodOptional=o.$constructor("$ZodOptional",(e,t)=>{r.$ZodType.init(e,t),e._zod.optin="optional",e._zod.optout="optional",d.defineLazy(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),d.defineLazy(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${d.cleanRegex(e.source)})?$`):void 0}),e._zod.parse=(e,r)=>"optional"===t.innerType._zod.optin?t.innerType._zod.run(e,r):void 0===e.value?e:t.innerType._zod.run(e,r)}),r.$ZodNullable=o.$constructor("$ZodNullable",(e,t)=>{r.$ZodType.init(e,t),d.defineLazy(e._zod,"optin",()=>t.innerType._zod.optin),d.defineLazy(e._zod,"optout",()=>t.innerType._zod.optout),d.defineLazy(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${d.cleanRegex(e.source)}|null)$`):void 0}),d.defineLazy(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(e,r)=>null===e.value?e:t.innerType._zod.run(e,r)}),r.$ZodDefault=o.$constructor("$ZodDefault",(e,t)=>{r.$ZodType.init(e,t),e._zod.optin="optional",d.defineLazy(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{if(void 0===e.value)return e.value=t.defaultValue,e;let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(e=>E(e,t)):E(n,t)}}),r.$ZodPrefault=o.$constructor("$ZodPrefault",(e,t)=>{r.$ZodType.init(e,t),e._zod.optin="optional",d.defineLazy(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>(void 0===e.value&&(e.value=t.defaultValue),t.innerType._zod.run(e,r))}),r.$ZodNonOptional=o.$constructor("$ZodNonOptional",(e,t)=>{r.$ZodType.init(e,t),d.defineLazy(e._zod,"values",()=>{let e=t.innerType._zod.values;return e?new Set([...e].filter(e=>void 0!==e)):void 0}),e._zod.parse=(r,n)=>{let i=t.innerType._zod.run(r,n);return i instanceof Promise?i.then(t=>k(t,e)):k(i,e)}}),r.$ZodSuccess=o.$constructor("$ZodSuccess",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(e,r)=>{let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(t=>(e.value=0===t.issues.length,e)):(e.value=0===n.issues.length,e)}}),r.$ZodCatch=o.$constructor("$ZodCatch",(e,t)=>{r.$ZodType.init(e,t),e._zod.optin="optional",d.defineLazy(e._zod,"optout",()=>t.innerType._zod.optout),d.defineLazy(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(n=>(e.value=n.value,n.issues.length&&(e.value=t.catchValue({...e,error:{issues:n.issues.map(e=>d.finalizeIssue(e,r,o.config()))},input:e.value}),e.issues=[]),e)):(e.value=n.value,n.issues.length&&(e.value=t.catchValue({...e,error:{issues:n.issues.map(e=>d.finalizeIssue(e,r,o.config()))},input:e.value}),e.issues=[]),e)}}),r.$ZodNaN=o.$constructor("$ZodNaN",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(t,r)=>("number"==typeof t.value&&Number.isNaN(t.value)||t.issues.push({input:t.value,inst:e,expected:"nan",code:"invalid_type"}),t)}),r.$ZodPipe=o.$constructor("$ZodPipe",(e,t)=>{r.$ZodType.init(e,t),d.defineLazy(e._zod,"values",()=>t.in._zod.values),d.defineLazy(e._zod,"optin",()=>t.in._zod.optin),d.defineLazy(e._zod,"optout",()=>t.out._zod.optout),e._zod.parse=(e,r)=>{let n=t.in._zod.run(e,r);return n instanceof Promise?n.then(e=>I(e,t,r)):I(n,t,r)}}),r.$ZodReadonly=o.$constructor("$ZodReadonly",(e,t)=>{r.$ZodType.init(e,t),d.defineLazy(e._zod,"propValues",()=>t.innerType._zod.propValues),d.defineLazy(e._zod,"values",()=>t.innerType._zod.values),d.defineLazy(e._zod,"optin",()=>t.innerType._zod.optin),d.defineLazy(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(e,r)=>{let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(A):A(n)}}),r.$ZodTemplateLiteral=o.$constructor("$ZodTemplateLiteral",(e,t)=>{r.$ZodType.init(e,t);let n=[];for(let e of t.parts)if(e instanceof r.$ZodType){if(!e._zod.pattern)throw Error(`Invalid template literal part, no pattern found: ${[...e._zod.traits].shift()}`);let t=e._zod.pattern instanceof RegExp?e._zod.pattern.source:e._zod.pattern;if(!t)throw Error(`Invalid template literal part: ${e._zod.traits}`);let r=+!!t.startsWith("^"),i=t.endsWith("$")?t.length-1:t.length;n.push(t.slice(r,i))}else if(null===e||d.primitiveTypes.has(typeof e))n.push(d.escapeRegex(`${e}`));else throw Error(`Invalid template literal part: ${e}`);e._zod.pattern=RegExp(`^${n.join("")}$`),e._zod.parse=(t,r)=>("string"!=typeof t.value?t.issues.push({input:t.value,inst:e,expected:"template_literal",code:"invalid_type"}):(e._zod.pattern.lastIndex=0,e._zod.pattern.test(t.value)||t.issues.push({input:t.value,inst:e,code:"invalid_format",format:"template_literal",pattern:e._zod.pattern.source})),t)}),r.$ZodPromise=o.$constructor("$ZodPromise",(e,t)=>{r.$ZodType.init(e,t),e._zod.parse=(e,r)=>Promise.resolve(e.value).then(e=>t.innerType._zod.run({value:e,issues:[]},r))}),r.$ZodLazy=o.$constructor("$ZodLazy",(e,t)=>{r.$ZodType.init(e,t),d.defineLazy(e._zod,"innerType",()=>t.getter()),d.defineLazy(e._zod,"pattern",()=>e._zod.innerType._zod.pattern),d.defineLazy(e._zod,"propValues",()=>e._zod.innerType._zod.propValues),d.defineLazy(e._zod,"optin",()=>e._zod.innerType._zod.optin),d.defineLazy(e._zod,"optout",()=>e._zod.innerType._zod.optout),e._zod.parse=(t,r)=>e._zod.innerType._zod.run(t,r)}),r.$ZodCustom=o.$constructor("$ZodCustom",(e,t)=>{s.$ZodCheck.init(e,t),r.$ZodType.init(e,t),e._zod.parse=(e,t)=>e,e._zod.check=r=>{let n=r.value,i=t.fn(n);if(i instanceof Promise)return i.then(t=>T(t,r,n,e));T(i,r,n,e)}})},22172,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"Ø­Ø±Ù",verb:"Ø£Ù† ÙŠØ­ÙˆÙŠ"},file:{unit:"Ø¨Ø§ÙŠØª",verb:"Ø£Ù† ÙŠØ­ÙˆÙŠ"},array:{unit:"Ø¹Ù†ØµØ±",verb:"Ø£Ù† ÙŠØ­ÙˆÙŠ"},set:{unit:"Ø¹Ù†ØµØ±",verb:"Ø£Ù† ÙŠØ­ÙˆÙŠ"}},t={regex:"Ù…Ø¯Ø®Ù„",email:"Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",url:"Ø±Ø§Ø¨Ø·",emoji:"Ø¥ÙŠÙ…ÙˆØ¬ÙŠ",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø¨Ù…Ø¹ÙŠØ§Ø± ISO",date:"ØªØ§Ø±ÙŠØ® Ø¨Ù…Ø¹ÙŠØ§Ø± ISO",time:"ÙˆÙ‚Øª Ø¨Ù…Ø¹ÙŠØ§Ø± ISO",duration:"Ù…Ø¯Ø© Ø¨Ù…Ø¹ÙŠØ§Ø± ISO",ipv4:"Ø¹Ù†ÙˆØ§Ù† IPv4",ipv6:"Ø¹Ù†ÙˆØ§Ù† IPv6",cidrv4:"Ù…Ø¯Ù‰ Ø¹Ù†Ø§ÙˆÙŠÙ† Ø¨ØµÙŠØºØ© IPv4",cidrv6:"Ù…Ø¯Ù‰ Ø¹Ù†Ø§ÙˆÙŠÙ† Ø¨ØµÙŠØºØ© IPv6",base64:"Ù†ÙŽØµ Ø¨ØªØ±Ù…ÙŠØ² base64-encoded",base64url:"Ù†ÙŽØµ Ø¨ØªØ±Ù…ÙŠØ² base64url-encoded",json_string:"Ù†ÙŽØµ Ø¹Ù„Ù‰ Ù‡ÙŠØ¦Ø© JSON",e164:"Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø¨Ù…Ø¹ÙŠØ§Ø± E.164",jwt:"JWT",template_literal:"Ù…Ø¯Ø®Ù„"};return r=>{switch(r.code){case"invalid_type":return`Ù…Ø¯Ø®Ù„Ø§Øª ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„Ø©: ÙŠÙØªØ±Ø¶ Ø¥Ø¯Ø®Ø§Ù„ ${r.expected}ØŒ ÙˆÙ„ÙƒÙ† ØªÙ… Ø¥Ø¯Ø®Ø§Ù„ ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Ù…Ø¯Ø®Ù„Ø§Øª ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„Ø©: ÙŠÙØªØ±Ø¶ Ø¥Ø¯Ø®Ø§Ù„ ${s.stringifyPrimitive(r.values[0])}`;return`Ø§Ø®ØªÙŠØ§Ø± ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„: ÙŠØªÙˆÙ‚Ø¹ Ø§Ù†ØªÙ‚Ø§Ø¡ Ø£Ø­Ø¯ Ù‡Ø°Ù‡ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª: ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return` Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ù„Ø§Ø²Ù…: ÙŠÙØªØ±Ø¶ Ø£Ù† ØªÙƒÙˆÙ† ${r.origin??"Ø§Ù„Ù‚ÙŠÙ…Ø©"} ${t} ${r.maximum.toString()} ${n.unit??"Ø¹Ù†ØµØ±"}`;return`Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ù„Ø§Ø²Ù…: ÙŠÙØªØ±Ø¶ Ø£Ù† ØªÙƒÙˆÙ† ${r.origin??"Ø§Ù„Ù‚ÙŠÙ…Ø©"} ${t} ${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Ø£ØµØºØ± Ù…Ù† Ø§Ù„Ù„Ø§Ø²Ù…: ÙŠÙØªØ±Ø¶ Ù„Ù€ ${r.origin} Ø£Ù† ÙŠÙƒÙˆÙ† ${t} ${r.minimum.toString()} ${n.unit}`;return`Ø£ØµØºØ± Ù…Ù† Ø§Ù„Ù„Ø§Ø²Ù…: ÙŠÙØªØ±Ø¶ Ù„Ù€ ${r.origin} Ø£Ù† ÙŠÙƒÙˆÙ† ${t} ${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Ù†ÙŽØµ ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„: ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€ "${r.prefix}"`;if("ends_with"===r.format)return`Ù†ÙŽØµ ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„: ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ù€ "${r.suffix}"`;if("includes"===r.format)return`Ù†ÙŽØµ ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„: ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªØ¶Ù…Ù‘ÙŽÙ† "${r.includes}"`;if("regex"===r.format)return`Ù†ÙŽØµ ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„: ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ·Ø§Ø¨Ù‚ Ø§Ù„Ù†Ù…Ø· ${r.pattern}`;return`${t[r.format]??r.format} ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„`;case"not_multiple_of":return`Ø±Ù‚Ù… ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„: ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…Ù† Ù…Ø¶Ø§Ø¹ÙØ§Øª ${r.divisor}`;case"unrecognized_keys":return`Ù…Ø¹Ø±Ù${r.keys.length>1?"Ø§Øª":""} ØºØ±ÙŠØ¨${r.keys.length>1?"Ø©":""}: ${s.joinValues(r.keys,"ØŒ ")}`;case"invalid_key":return`Ù…Ø¹Ø±Ù ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„ ÙÙŠ ${r.origin}`;case"invalid_union":default:return"Ù…Ø¯Ø®Ù„ ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„";case"invalid_element":return`Ù…Ø¯Ø®Ù„ ØºÙŠØ± Ù…Ù‚Ø¨ÙˆÙ„ ÙÙŠ ${r.origin}`}}})()}};let s=a(e.r(25896))},20484,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"simvol",verb:"olmalÄ±dÄ±r"},file:{unit:"bayt",verb:"olmalÄ±dÄ±r"},array:{unit:"element",verb:"olmalÄ±dÄ±r"},set:{unit:"element",verb:"olmalÄ±dÄ±r"}},t={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return r=>{switch(r.code){case"invalid_type":return`YanlÄ±ÅŸ dÉ™yÉ™r: g\xf6zlÉ™nilÉ™n ${r.expected}, daxil olan ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`YanlÄ±ÅŸ dÉ™yÉ™r: g\xf6zlÉ™nilÉ™n ${s.stringifyPrimitive(r.values[0])}`;return`YanlÄ±ÅŸ se\xe7im: aÅŸaÄŸÄ±dakÄ±lardan biri olmalÄ±dÄ±r: ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`\xc7ox b\xf6y\xfck: g\xf6zlÉ™nilÉ™n ${r.origin??"dÉ™yÉ™r"} ${t}${r.maximum.toString()} ${n.unit??"element"}`;return`\xc7ox b\xf6y\xfck: g\xf6zlÉ™nilÉ™n ${r.origin??"dÉ™yÉ™r"} ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`\xc7ox ki\xe7ik: g\xf6zlÉ™nilÉ™n ${r.origin} ${t}${r.minimum.toString()} ${n.unit}`;return`\xc7ox ki\xe7ik: g\xf6zlÉ™nilÉ™n ${r.origin} ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`YanlÄ±ÅŸ mÉ™tn: "${r.prefix}" ilÉ™ baÅŸlamalÄ±dÄ±r`;if("ends_with"===r.format)return`YanlÄ±ÅŸ mÉ™tn: "${r.suffix}" ilÉ™ bitmÉ™lidir`;if("includes"===r.format)return`YanlÄ±ÅŸ mÉ™tn: "${r.includes}" daxil olmalÄ±dÄ±r`;if("regex"===r.format)return`YanlÄ±ÅŸ mÉ™tn: ${r.pattern} ÅŸablonuna uyÄŸun olmalÄ±dÄ±r`;return`YanlÄ±ÅŸ ${t[r.format]??r.format}`;case"not_multiple_of":return`YanlÄ±ÅŸ É™dÉ™d: ${r.divisor} ilÉ™ b\xf6l\xfcnÉ™ bilÉ™n olmalÄ±dÄ±r`;case"unrecognized_keys":return`TanÄ±nmayan a\xe7ar${r.keys.length>1?"lar":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`${r.origin} daxilindÉ™ yanlÄ±ÅŸ a\xe7ar`;case"invalid_union":return"YanlÄ±ÅŸ dÉ™yÉ™r";case"invalid_element":return`${r.origin} daxilindÉ™ yanlÄ±ÅŸ dÉ™yÉ™r`;default:return`YanlÄ±ÅŸ dÉ™yÉ™r`}}})()}};let s=a(e.r(25896))},17397,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:{one:"ÑÑ–Ð¼Ð²Ð°Ð»",few:"ÑÑ–Ð¼Ð²Ð°Ð»Ñ‹",many:"ÑÑ–Ð¼Ð²Ð°Ð»Ð°Ñž"},verb:"Ð¼ÐµÑ†ÑŒ"},array:{unit:{one:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚",few:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹",many:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð°Ñž"},verb:"Ð¼ÐµÑ†ÑŒ"},set:{unit:{one:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚",few:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹",many:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð°Ñž"},verb:"Ð¼ÐµÑ†ÑŒ"},file:{unit:{one:"Ð±Ð°Ð¹Ñ‚",few:"Ð±Ð°Ð¹Ñ‚Ñ‹",many:"Ð±Ð°Ð¹Ñ‚Ð°Ñž"},verb:"Ð¼ÐµÑ†ÑŒ"}},t={regex:"ÑƒÐ²Ð¾Ð´",email:"email Ð°Ð´Ñ€Ð°Ñ",url:"URL",emoji:"ÑÐ¼Ð¾Ð´Ð·Ñ–",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO Ð´Ð°Ñ‚Ð° Ñ– Ñ‡Ð°Ñ",date:"ISO Ð´Ð°Ñ‚Ð°",time:"ISO Ñ‡Ð°Ñ",duration:"ISO Ð¿Ñ€Ð°Ñ†ÑÐ³Ð»Ð°ÑÑ†ÑŒ",ipv4:"IPv4 Ð°Ð´Ñ€Ð°Ñ",ipv6:"IPv6 Ð°Ð´Ñ€Ð°Ñ",cidrv4:"IPv4 Ð´Ñ‹ÑÐ¿Ð°Ð·Ð¾Ð½",cidrv6:"IPv6 Ð´Ñ‹ÑÐ¿Ð°Ð·Ð¾Ð½",base64:"Ñ€Ð°Ð´Ð¾Ðº Ñƒ Ñ„Ð°Ñ€Ð¼Ð°Ñ†Ðµ base64",base64url:"Ñ€Ð°Ð´Ð¾Ðº Ñƒ Ñ„Ð°Ñ€Ð¼Ð°Ñ†Ðµ base64url",json_string:"JSON Ñ€Ð°Ð´Ð¾Ðº",e164:"Ð½ÑƒÐ¼Ð°Ñ€ E.164",jwt:"JWT",template_literal:"ÑƒÐ²Ð¾Ð´"};return r=>{switch(r.code){case"invalid_type":return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ ÑžÐ²Ð¾Ð´: Ñ‡Ð°ÐºÐ°ÑžÑÑ ${r.expected}, Ð°Ñ‚Ñ€Ñ‹Ð¼Ð°Ð½Ð° ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"Ð»Ñ–Ðº";case"object":if(Array.isArray(e))return"Ð¼Ð°ÑÑ–Ñž";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ ÑžÐ²Ð¾Ð´: Ñ‡Ð°ÐºÐ°Ð»Ð°ÑÑ ${s.stringifyPrimitive(r.values[0])}`;return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ Ð²Ð°Ñ€Ñ‹ÑÐ½Ñ‚: Ñ‡Ð°ÐºÐ°ÑžÑÑ Ð°Ð´Ð·Ñ–Ð½ Ð· ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n){let e=o(Number(r.maximum),n.unit.one,n.unit.few,n.unit.many);return`Ð—Ð°Ð½Ð°Ð´Ñ‚Ð° Ð²ÑÐ»Ñ–ÐºÑ–: Ñ‡Ð°ÐºÐ°Ð»Ð°ÑÑ, ÑˆÑ‚Ð¾ ${r.origin??"Ð·Ð½Ð°Ñ‡ÑÐ½Ð½Ðµ"} Ð¿Ð°Ð²Ñ–Ð½Ð½Ð° ${n.verb} ${t}${r.maximum.toString()} ${e}`}return`Ð—Ð°Ð½Ð°Ð´Ñ‚Ð° Ð²ÑÐ»Ñ–ÐºÑ–: Ñ‡Ð°ÐºÐ°Ð»Ð°ÑÑ, ÑˆÑ‚Ð¾ ${r.origin??"Ð·Ð½Ð°Ñ‡ÑÐ½Ð½Ðµ"} Ð¿Ð°Ð²Ñ–Ð½Ð½Ð° Ð±Ñ‹Ñ†ÑŒ ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n){let e=o(Number(r.minimum),n.unit.one,n.unit.few,n.unit.many);return`Ð—Ð°Ð½Ð°Ð´Ñ‚Ð° Ð¼Ð°Ð»Ñ‹: Ñ‡Ð°ÐºÐ°Ð»Ð°ÑÑ, ÑˆÑ‚Ð¾ ${r.origin} Ð¿Ð°Ð²Ñ–Ð½Ð½Ð° ${n.verb} ${t}${r.minimum.toString()} ${e}`}return`Ð—Ð°Ð½Ð°Ð´Ñ‚Ð° Ð¼Ð°Ð»Ñ‹: Ñ‡Ð°ÐºÐ°Ð»Ð°ÑÑ, ÑˆÑ‚Ð¾ ${r.origin} Ð¿Ð°Ð²Ñ–Ð½Ð½Ð° Ð±Ñ‹Ñ†ÑŒ ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ Ñ€Ð°Ð´Ð¾Ðº: Ð¿Ð°Ð²Ñ–Ð½ÐµÐ½ Ð¿Ð°Ñ‡Ñ‹Ð½Ð°Ñ†Ñ†Ð° Ð· "${r.prefix}"`;if("ends_with"===r.format)return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ Ñ€Ð°Ð´Ð¾Ðº: Ð¿Ð°Ð²Ñ–Ð½ÐµÐ½ Ð·Ð°ÐºÐ°Ð½Ñ‡Ð²Ð°Ñ†Ñ†Ð° Ð½Ð° "${r.suffix}"`;if("includes"===r.format)return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ Ñ€Ð°Ð´Ð¾Ðº: Ð¿Ð°Ð²Ñ–Ð½ÐµÐ½ Ð·Ð¼ÑÑˆÑ‡Ð°Ñ†ÑŒ "${r.includes}"`;if("regex"===r.format)return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ Ñ€Ð°Ð´Ð¾Ðº: Ð¿Ð°Ð²Ñ–Ð½ÐµÐ½ Ð°Ð´Ð¿Ð°Ð²ÑÐ´Ð°Ñ†ÑŒ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñƒ ${r.pattern}`;return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ ${t[r.format]??r.format}`;case"not_multiple_of":return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ Ð»Ñ–Ðº: Ð¿Ð°Ð²Ñ–Ð½ÐµÐ½ Ð±Ñ‹Ñ†ÑŒ ÐºÑ€Ð°Ñ‚Ð½Ñ‹Ð¼ ${r.divisor}`;case"unrecognized_keys":return`ÐÐµÑ€Ð°ÑÐ¿Ð°Ð·Ð½Ð°Ð½Ñ‹ ${r.keys.length>1?"ÐºÐ»ÑŽÑ‡Ñ‹":"ÐºÐ»ÑŽÑ‡"}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ ÐºÐ»ÑŽÑ‡ Ñƒ ${r.origin}`;case"invalid_union":return"ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ ÑžÐ²Ð¾Ð´";case"invalid_element":return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ð°Ðµ Ð·Ð½Ð°Ñ‡ÑÐ½Ð½Ðµ Ñž ${r.origin}`;default:return`ÐÑÐ¿Ñ€Ð°Ð²Ñ–Ð»ÑŒÐ½Ñ‹ ÑžÐ²Ð¾Ð´`}}})()}};let s=a(e.r(25896));function o(e,t,r,n){let i=Math.abs(e),a=i%10,s=i%100;return s>=11&&s<=19?n:1===a?t:a>=2&&a<=4?r:n}},15374,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"carÃ cters",verb:"contenir"},file:{unit:"bytes",verb:"contenir"},array:{unit:"elements",verb:"contenir"},set:{unit:"elements",verb:"contenir"}},t={regex:"entrada",email:"adreÃ§a electrÃ²nica",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i hora ISO",date:"data ISO",time:"hora ISO",duration:"durada ISO",ipv4:"adreÃ§a IPv4",ipv6:"adreÃ§a IPv6",cidrv4:"rang IPv4",cidrv6:"rang IPv6",base64:"cadena codificada en base64",base64url:"cadena codificada en base64url",json_string:"cadena JSON",e164:"nÃºmero E.164",jwt:"JWT",template_literal:"entrada"};return r=>{switch(r.code){case"invalid_type":return`Tipus inv\xe0lid: s'esperava ${r.expected}, s'ha rebut ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Valor inv\xe0lid: s'esperava ${s.stringifyPrimitive(r.values[0])}`;return`Opci\xf3 inv\xe0lida: s'esperava una de ${s.joinValues(r.values," o ")}`;case"too_big":{let t=r.inclusive?"com a mÃ xim":"menys de",n=e[r.origin]??null;if(n)return`Massa gran: s'esperava que ${r.origin??"el valor"} contingu\xe9s ${t} ${r.maximum.toString()} ${n.unit??"elements"}`;return`Massa gran: s'esperava que ${r.origin??"el valor"} fos ${t} ${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?"com a mÃ­nim":"mÃ©s de",n=e[r.origin]??null;if(n)return`Massa petit: s'esperava que ${r.origin} contingu\xe9s ${t} ${r.minimum.toString()} ${n.unit}`;return`Massa petit: s'esperava que ${r.origin} fos ${t} ${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Format inv\xe0lid: ha de comen\xe7ar amb "${r.prefix}"`;if("ends_with"===r.format)return`Format inv\xe0lid: ha d'acabar amb "${r.suffix}"`;if("includes"===r.format)return`Format inv\xe0lid: ha d'incloure "${r.includes}"`;if("regex"===r.format)return`Format inv\xe0lid: ha de coincidir amb el patr\xf3 ${r.pattern}`;return`Format inv\xe0lid per a ${t[r.format]??r.format}`;case"not_multiple_of":return`N\xfamero inv\xe0lid: ha de ser m\xfaltiple de ${r.divisor}`;case"unrecognized_keys":return`Clau${r.keys.length>1?"s":""} no reconeguda${r.keys.length>1?"s":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Clau inv\xe0lida a ${r.origin}`;case"invalid_union":return"Entrada invÃ lida";case"invalid_element":return`Element inv\xe0lid a ${r.origin}`;default:return`Entrada inv\xe0lida`}}})()}};let s=a(e.r(25896))},76376,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"znakÅ¯",verb:"mÃ­t"},file:{unit:"bajtÅ¯",verb:"mÃ­t"},array:{unit:"prvkÅ¯",verb:"mÃ­t"},set:{unit:"prvkÅ¯",verb:"mÃ­t"}},t={regex:"regulÃ¡rnÃ­ vÃ½raz",email:"e-mailovÃ¡ adresa",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"datum a Äas ve formÃ¡tu ISO",date:"datum ve formÃ¡tu ISO",time:"Äas ve formÃ¡tu ISO",duration:"doba trvÃ¡nÃ­ ISO",ipv4:"IPv4 adresa",ipv6:"IPv6 adresa",cidrv4:"rozsah IPv4",cidrv6:"rozsah IPv6",base64:"Å™etÄ›zec zakÃ³dovanÃ½ ve formÃ¡tu base64",base64url:"Å™etÄ›zec zakÃ³dovanÃ½ ve formÃ¡tu base64url",json_string:"Å™etÄ›zec ve formÃ¡tu JSON",e164:"ÄÃ­slo E.164",jwt:"JWT",template_literal:"vstup"};return r=>{switch(r.code){case"invalid_type":return`Neplatn\xfd vstup: oÄek\xe1v\xe1no ${r.expected}, obdrÅ¾eno ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"ÄÃ­slo";case"string":return"Å™etÄ›zec";case"boolean":return"boolean";case"bigint":return"bigint";case"function":return"funkce";case"symbol":return"symbol";case"undefined":return"undefined";case"object":if(Array.isArray(e))return"pole";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Neplatn\xfd vstup: oÄek\xe1v\xe1no ${s.stringifyPrimitive(r.values[0])}`;return`Neplatn\xe1 moÅ¾nost: oÄek\xe1v\xe1na jedna z hodnot ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Hodnota je pÅ™\xedliÅ¡ velk\xe1: ${r.origin??"hodnota"} mus\xed m\xedt ${t}${r.maximum.toString()} ${n.unit??"prvkÅ¯"}`;return`Hodnota je pÅ™\xedliÅ¡ velk\xe1: ${r.origin??"hodnota"} mus\xed b\xfdt ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Hodnota je pÅ™\xedliÅ¡ mal\xe1: ${r.origin??"hodnota"} mus\xed m\xedt ${t}${r.minimum.toString()} ${n.unit??"prvkÅ¯"}`;return`Hodnota je pÅ™\xedliÅ¡ mal\xe1: ${r.origin??"hodnota"} mus\xed b\xfdt ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Neplatn\xfd Å™etÄ›zec: mus\xed zaÄ\xednat na "${r.prefix}"`;if("ends_with"===r.format)return`Neplatn\xfd Å™etÄ›zec: mus\xed konÄit na "${r.suffix}"`;if("includes"===r.format)return`Neplatn\xfd Å™etÄ›zec: mus\xed obsahovat "${r.includes}"`;if("regex"===r.format)return`Neplatn\xfd Å™etÄ›zec: mus\xed odpov\xeddat vzoru ${r.pattern}`;return`Neplatn\xfd form\xe1t ${t[r.format]??r.format}`;case"not_multiple_of":return`Neplatn\xe9 Ä\xedslo: mus\xed b\xfdt n\xe1sobkem ${r.divisor}`;case"unrecognized_keys":return`Nezn\xe1m\xe9 kl\xedÄe: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Neplatn\xfd kl\xedÄ v ${r.origin}`;case"invalid_union":return"NeplatnÃ½ vstup";case"invalid_element":return`Neplatn\xe1 hodnota v ${r.origin}`;default:return`Neplatn\xfd vstup`}}})()}};let s=a(e.r(25896))},49888,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"Zeichen",verb:"zu haben"},file:{unit:"Bytes",verb:"zu haben"},array:{unit:"Elemente",verb:"zu haben"},set:{unit:"Elemente",verb:"zu haben"}},t={regex:"Eingabe",email:"E-Mail-Adresse",url:"URL",emoji:"Emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-Datum und -Uhrzeit",date:"ISO-Datum",time:"ISO-Uhrzeit",duration:"ISO-Dauer",ipv4:"IPv4-Adresse",ipv6:"IPv6-Adresse",cidrv4:"IPv4-Bereich",cidrv6:"IPv6-Bereich",base64:"Base64-codierter String",base64url:"Base64-URL-codierter String",json_string:"JSON-String",e164:"E.164-Nummer",jwt:"JWT",template_literal:"Eingabe"};return r=>{switch(r.code){case"invalid_type":return`Ung\xfcltige Eingabe: erwartet ${r.expected}, erhalten ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"Zahl";case"object":if(Array.isArray(e))return"Array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Ung\xfcltige Eingabe: erwartet ${s.stringifyPrimitive(r.values[0])}`;return`Ung\xfcltige Option: erwartet eine von ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Zu gro\xdf: erwartet, dass ${r.origin??"Wert"} ${t}${r.maximum.toString()} ${n.unit??"Elemente"} hat`;return`Zu gro\xdf: erwartet, dass ${r.origin??"Wert"} ${t}${r.maximum.toString()} ist`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Zu klein: erwartet, dass ${r.origin} ${t}${r.minimum.toString()} ${n.unit} hat`;return`Zu klein: erwartet, dass ${r.origin} ${t}${r.minimum.toString()} ist`}case"invalid_format":if("starts_with"===r.format)return`Ung\xfcltiger String: muss mit "${r.prefix}" beginnen`;if("ends_with"===r.format)return`Ung\xfcltiger String: muss mit "${r.suffix}" enden`;if("includes"===r.format)return`Ung\xfcltiger String: muss "${r.includes}" enthalten`;if("regex"===r.format)return`Ung\xfcltiger String: muss dem Muster ${r.pattern} entsprechen`;return`Ung\xfcltig: ${t[r.format]??r.format}`;case"not_multiple_of":return`Ung\xfcltige Zahl: muss ein Vielfaches von ${r.divisor} sein`;case"unrecognized_keys":return`${r.keys.length>1?"Unbekannte SchlÃ¼ssel":"Unbekannter SchlÃ¼ssel"}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Ung\xfcltiger Schl\xfcssel in ${r.origin}`;case"invalid_union":return"UngÃ¼ltige Eingabe";case"invalid_element":return`Ung\xfcltiger Wert in ${r.origin}`;default:return`Ung\xfcltige Eingabe`}}})()}};let s=a(e.r(25896))},84107,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.parsedType=void 0,r.default=function(){return{localeError:(()=>{let e={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}},t={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${(0,r.parsedType)(n.input)}`;case"invalid_value":if(1===n.values.length)return`Invalid input: expected ${s.stringifyPrimitive(n.values[0])}`;return`Invalid option: expected one of ${s.joinValues(n.values,"|")}`;case"too_big":{let t=n.inclusive?"<=":"<",r=e[n.origin]??null;if(r)return`Too big: expected ${n.origin??"value"} to have ${t}${n.maximum.toString()} ${r.unit??"elements"}`;return`Too big: expected ${n.origin??"value"} to be ${t}${n.maximum.toString()}`}case"too_small":{let t=n.inclusive?">=":">",r=e[n.origin]??null;if(r)return`Too small: expected ${n.origin} to have ${t}${n.minimum.toString()} ${r.unit}`;return`Too small: expected ${n.origin} to be ${t}${n.minimum.toString()}`}case"invalid_format":if("starts_with"===n.format)return`Invalid string: must start with "${n.prefix}"`;if("ends_with"===n.format)return`Invalid string: must end with "${n.suffix}"`;if("includes"===n.format)return`Invalid string: must include "${n.includes}"`;if("regex"===n.format)return`Invalid string: must match pattern ${n.pattern}`;return`Invalid ${t[n.format]??n.format}`;case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${s.joinValues(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":default:return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`}}})()}};let s=a(e.r(25896));r.parsedType=e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t}},68939,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.parsedType=void 0,r.default=function(){return{localeError:(()=>{let e={string:{unit:"karaktrojn",verb:"havi"},file:{unit:"bajtojn",verb:"havi"},array:{unit:"elementojn",verb:"havi"},set:{unit:"elementojn",verb:"havi"}},t={regex:"enigo",email:"retadreso",url:"URL",emoji:"emoÄio",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datotempo",date:"ISO-dato",time:"ISO-tempo",duration:"ISO-daÅ­ro",ipv4:"IPv4-adreso",ipv6:"IPv6-adreso",cidrv4:"IPv4-rango",cidrv6:"IPv6-rango",base64:"64-ume kodita karaktraro",base64url:"URL-64-ume kodita karaktraro",json_string:"JSON-karaktraro",e164:"E.164-nombro",jwt:"JWT",template_literal:"enigo"};return n=>{switch(n.code){case"invalid_type":return`Nevalida enigo: atendiÄis ${n.expected}, riceviÄis ${(0,r.parsedType)(n.input)}`;case"invalid_value":if(1===n.values.length)return`Nevalida enigo: atendiÄis ${s.stringifyPrimitive(n.values[0])}`;return`Nevalida opcio: atendiÄis unu el ${s.joinValues(n.values,"|")}`;case"too_big":{let t=n.inclusive?"<=":"<",r=e[n.origin]??null;if(r)return`Tro granda: atendiÄis ke ${n.origin??"valoro"} havu ${t}${n.maximum.toString()} ${r.unit??"elementojn"}`;return`Tro granda: atendiÄis ke ${n.origin??"valoro"} havu ${t}${n.maximum.toString()}`}case"too_small":{let t=n.inclusive?">=":">",r=e[n.origin]??null;if(r)return`Tro malgranda: atendiÄis ke ${n.origin} havu ${t}${n.minimum.toString()} ${r.unit}`;return`Tro malgranda: atendiÄis ke ${n.origin} estu ${t}${n.minimum.toString()}`}case"invalid_format":if("starts_with"===n.format)return`Nevalida karaktraro: devas komenciÄi per "${n.prefix}"`;if("ends_with"===n.format)return`Nevalida karaktraro: devas finiÄi per "${n.suffix}"`;if("includes"===n.format)return`Nevalida karaktraro: devas inkluzivi "${n.includes}"`;if("regex"===n.format)return`Nevalida karaktraro: devas kongrui kun la modelo ${n.pattern}`;return`Nevalida ${t[n.format]??n.format}`;case"not_multiple_of":return`Nevalida nombro: devas esti oblo de ${n.divisor}`;case"unrecognized_keys":return`Nekonata${n.keys.length>1?"j":""} Ålosilo${n.keys.length>1?"j":""}: ${s.joinValues(n.keys,", ")}`;case"invalid_key":return`Nevalida Ålosilo en ${n.origin}`;case"invalid_union":default:return"Nevalida enigo";case"invalid_element":return`Nevalida valoro en ${n.origin}`}}})()}};let s=a(e.r(25896));r.parsedType=e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"nombro";case"object":if(Array.isArray(e))return"tabelo";if(null===e)return"senvalora";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t}},29054,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"caracteres",verb:"tener"},file:{unit:"bytes",verb:"tener"},array:{unit:"elementos",verb:"tener"},set:{unit:"elementos",verb:"tener"}},t={regex:"entrada",email:"direcciÃ³n de correo electrÃ³nico",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"fecha y hora ISO",date:"fecha ISO",time:"hora ISO",duration:"duraciÃ³n ISO",ipv4:"direcciÃ³n IPv4",ipv6:"direcciÃ³n IPv6",cidrv4:"rango IPv4",cidrv6:"rango IPv6",base64:"cadena codificada en base64",base64url:"URL codificada en base64",json_string:"cadena JSON",e164:"nÃºmero E.164",jwt:"JWT",template_literal:"entrada"};return r=>{switch(r.code){case"invalid_type":return`Entrada inv\xe1lida: se esperaba ${r.expected}, recibido ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"nÃºmero";case"object":if(Array.isArray(e))return"arreglo";if(null===e)return"nulo";if(Object.getPrototypeOf(e)!==Object.prototype)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Entrada inv\xe1lida: se esperaba ${s.stringifyPrimitive(r.values[0])}`;return`Opci\xf3n inv\xe1lida: se esperaba una de ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Demasiado grande: se esperaba que ${r.origin??"valor"} tuviera ${t}${r.maximum.toString()} ${n.unit??"elementos"}`;return`Demasiado grande: se esperaba que ${r.origin??"valor"} fuera ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Demasiado peque\xf1o: se esperaba que ${r.origin} tuviera ${t}${r.minimum.toString()} ${n.unit}`;return`Demasiado peque\xf1o: se esperaba que ${r.origin} fuera ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Cadena inv\xe1lida: debe comenzar con "${r.prefix}"`;if("ends_with"===r.format)return`Cadena inv\xe1lida: debe terminar en "${r.suffix}"`;if("includes"===r.format)return`Cadena inv\xe1lida: debe incluir "${r.includes}"`;if("regex"===r.format)return`Cadena inv\xe1lida: debe coincidir con el patr\xf3n ${r.pattern}`;return`Inv\xe1lido ${t[r.format]??r.format}`;case"not_multiple_of":return`N\xfamero inv\xe1lido: debe ser m\xfaltiplo de ${r.divisor}`;case"unrecognized_keys":return`Llave${r.keys.length>1?"s":""} desconocida${r.keys.length>1?"s":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Llave inv\xe1lida en ${r.origin}`;case"invalid_union":return"Entrada invÃ¡lida";case"invalid_element":return`Valor inv\xe1lido en ${r.origin}`;default:return`Entrada inv\xe1lida`}}})()}};let s=a(e.r(25896))},2393,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"Ú©Ø§Ø±Ø§Ú©ØªØ±",verb:"Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯"},file:{unit:"Ø¨Ø§ÛŒØª",verb:"Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯"},array:{unit:"Ø¢ÛŒØªÙ…",verb:"Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯"},set:{unit:"Ø¢ÛŒØªÙ…",verb:"Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯"}},t={regex:"ÙˆØ±ÙˆØ¯ÛŒ",email:"Ø¢Ø¯Ø±Ø³ Ø§ÛŒÙ…ÛŒÙ„",url:"URL",emoji:"Ø§ÛŒÙ…ÙˆØ¬ÛŒ",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù† Ø§ÛŒØ²Ùˆ",date:"ØªØ§Ø±ÛŒØ® Ø§ÛŒØ²Ùˆ",time:"Ø²Ù…Ø§Ù† Ø§ÛŒØ²Ùˆ",duration:"Ù…Ø¯Øª Ø²Ù…Ø§Ù† Ø§ÛŒØ²Ùˆ",ipv4:"IPv4 Ø¢Ø¯Ø±Ø³",ipv6:"IPv6 Ø¢Ø¯Ø±Ø³",cidrv4:"IPv4 Ø¯Ø§Ù…Ù†Ù‡",cidrv6:"IPv6 Ø¯Ø§Ù…Ù†Ù‡",base64:"base64-encoded Ø±Ø´ØªÙ‡",base64url:"base64url-encoded Ø±Ø´ØªÙ‡",json_string:"JSON Ø±Ø´ØªÙ‡",e164:"E.164 Ø¹Ø¯Ø¯",jwt:"JWT",template_literal:"ÙˆØ±ÙˆØ¯ÛŒ"};return r=>{switch(r.code){case"invalid_type":return`ÙˆØ±ÙˆØ¯ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø±: Ù…ÛŒâ€ŒØ¨Ø§ÛŒØ³Øª ${r.expected} Ù…ÛŒâ€ŒØ¨ÙˆØ¯ØŒ ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"Ø¹Ø¯Ø¯";case"object":if(Array.isArray(e))return"Ø¢Ø±Ø§ÛŒÙ‡";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)} Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯`;case"invalid_value":if(1===r.values.length)return`ÙˆØ±ÙˆØ¯ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø±: Ù…ÛŒâ€ŒØ¨Ø§ÛŒØ³Øª ${s.stringifyPrimitive(r.values[0])} Ù…ÛŒâ€ŒØ¨ÙˆØ¯`;return`Ú¯Ø²ÛŒÙ†Ù‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø±: Ù…ÛŒâ€ŒØ¨Ø§ÛŒØ³Øª ÛŒÚ©ÛŒ Ø§Ø² ${s.joinValues(r.values,"|")} Ù…ÛŒâ€ŒØ¨ÙˆØ¯`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Ø®ÛŒÙ„ÛŒ Ø¨Ø²Ø±Ú¯: ${r.origin??"Ù…Ù‚Ø¯Ø§Ø±"} Ø¨Ø§ÛŒØ¯ ${t}${r.maximum.toString()} ${n.unit??"Ø¹Ù†ØµØ±"} Ø¨Ø§Ø´Ø¯`;return`Ø®ÛŒÙ„ÛŒ Ø¨Ø²Ø±Ú¯: ${r.origin??"Ù…Ù‚Ø¯Ø§Ø±"} Ø¨Ø§ÛŒØ¯ ${t}${r.maximum.toString()} Ø¨Ø§Ø´Ø¯`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Ø®ÛŒÙ„ÛŒ Ú©ÙˆÚ†Ú©: ${r.origin} Ø¨Ø§ÛŒØ¯ ${t}${r.minimum.toString()} ${n.unit} Ø¨Ø§Ø´Ø¯`;return`Ø®ÛŒÙ„ÛŒ Ú©ÙˆÚ†Ú©: ${r.origin} Ø¨Ø§ÛŒØ¯ ${t}${r.minimum.toString()} Ø¨Ø§Ø´Ø¯`}case"invalid_format":if("starts_with"===r.format)return`Ø±Ø´ØªÙ‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø±: Ø¨Ø§ÛŒØ¯ Ø¨Ø§ "${r.prefix}" Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯`;if("ends_with"===r.format)return`Ø±Ø´ØªÙ‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø±: Ø¨Ø§ÛŒØ¯ Ø¨Ø§ "${r.suffix}" ØªÙ…Ø§Ù… Ø´ÙˆØ¯`;if("includes"===r.format)return`Ø±Ø´ØªÙ‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø±: Ø¨Ø§ÛŒØ¯ Ø´Ø§Ù…Ù„ "${r.includes}" Ø¨Ø§Ø´Ø¯`;if("regex"===r.format)return`Ø±Ø´ØªÙ‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø±: Ø¨Ø§ÛŒØ¯ Ø¨Ø§ Ø§Ù„Ú¯ÙˆÛŒ ${r.pattern} Ù…Ø·Ø§Ø¨Ù‚Øª Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯`;return`${t[r.format]??r.format} Ù†Ø§Ù…Ø¹ØªØ¨Ø±`;case"not_multiple_of":return`Ø¹Ø¯Ø¯ Ù†Ø§Ù…Ø¹ØªØ¨Ø±: Ø¨Ø§ÛŒØ¯ Ù…Ø¶Ø±Ø¨ ${r.divisor} Ø¨Ø§Ø´Ø¯`;case"unrecognized_keys":return`Ú©Ù„ÛŒØ¯${r.keys.length>1?"Ù‡Ø§ÛŒ":""} Ù†Ø§Ø´Ù†Ø§Ø³: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Ú©Ù„ÛŒØ¯ Ù†Ø§Ø´Ù†Ø§Ø³ Ø¯Ø± ${r.origin}`;case"invalid_union":default:return`ÙˆØ±ÙˆØ¯ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø±`;case"invalid_element":return`Ù…Ù‚Ø¯Ø§Ø± Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø¯Ø± ${r.origin}`}}})()}};let s=a(e.r(25896))},83747,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"merkkiÃ¤",subject:"merkkijonon"},file:{unit:"tavua",subject:"tiedoston"},array:{unit:"alkiota",subject:"listan"},set:{unit:"alkiota",subject:"joukon"},number:{unit:"",subject:"luvun"},bigint:{unit:"",subject:"suuren kokonaisluvun"},int:{unit:"",subject:"kokonaisluvun"},date:{unit:"",subject:"pÃ¤ivÃ¤mÃ¤Ã¤rÃ¤n"}},t={regex:"sÃ¤Ã¤nnÃ¶llinen lauseke",email:"sÃ¤hkÃ¶postiosoite",url:"URL-osoite",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-aikaleima",date:"ISO-pÃ¤ivÃ¤mÃ¤Ã¤rÃ¤",time:"ISO-aika",duration:"ISO-kesto",ipv4:"IPv4-osoite",ipv6:"IPv6-osoite",cidrv4:"IPv4-alue",cidrv6:"IPv6-alue",base64:"base64-koodattu merkkijono",base64url:"base64url-koodattu merkkijono",json_string:"JSON-merkkijono",e164:"E.164-luku",jwt:"JWT",template_literal:"templaattimerkkijono"};return r=>{switch(r.code){case"invalid_type":return`Virheellinen tyyppi: odotettiin ${r.expected}, oli ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Virheellinen sy\xf6te: t\xe4ytyy olla ${s.stringifyPrimitive(r.values[0])}`;return`Virheellinen valinta: t\xe4ytyy olla yksi seuraavista: ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Liian suuri: ${n.subject} t\xe4ytyy olla ${t}${r.maximum.toString()} ${n.unit}`.trim();return`Liian suuri: arvon t\xe4ytyy olla ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Liian pieni: ${n.subject} t\xe4ytyy olla ${t}${r.minimum.toString()} ${n.unit}`.trim();return`Liian pieni: arvon t\xe4ytyy olla ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Virheellinen sy\xf6te: t\xe4ytyy alkaa "${r.prefix}"`;if("ends_with"===r.format)return`Virheellinen sy\xf6te: t\xe4ytyy loppua "${r.suffix}"`;if("includes"===r.format)return`Virheellinen sy\xf6te: t\xe4ytyy sis\xe4lt\xe4\xe4 "${r.includes}"`;if("regex"===r.format)return`Virheellinen sy\xf6te: t\xe4ytyy vastata s\xe4\xe4nn\xf6llist\xe4 lauseketta ${r.pattern}`;return`Virheellinen ${t[r.format]??r.format}`;case"not_multiple_of":return`Virheellinen luku: t\xe4ytyy olla luvun ${r.divisor} monikerta`;case"unrecognized_keys":return`${r.keys.length>1?"Tuntemattomat avaimet":"Tuntematon avain"}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return"Virheellinen avain tietueessa";case"invalid_union":return"Virheellinen unioni";case"invalid_element":return"Virheellinen arvo joukossa";default:return`Virheellinen sy\xf6te`}}})()}};let s=a(e.r(25896))},49677,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"caractÃ¨res",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"Ã©lÃ©ments",verb:"avoir"},set:{unit:"Ã©lÃ©ments",verb:"avoir"}},t={regex:"entrÃ©e",email:"adresse e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date et heure ISO",date:"date ISO",time:"heure ISO",duration:"durÃ©e ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"chaÃ®ne encodÃ©e en base64",base64url:"chaÃ®ne encodÃ©e en base64url",json_string:"chaÃ®ne JSON",e164:"numÃ©ro E.164",jwt:"JWT",template_literal:"entrÃ©e"};return r=>{switch(r.code){case"invalid_type":return`Entr\xe9e invalide : ${r.expected} attendu, ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"nombre";case"object":if(Array.isArray(e))return"tableau";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)} re\xe7u`;case"invalid_value":if(1===r.values.length)return`Entr\xe9e invalide : ${s.stringifyPrimitive(r.values[0])} attendu`;return`Option invalide : une valeur parmi ${s.joinValues(r.values,"|")} attendue`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Trop grand : ${r.origin??"valeur"} doit ${n.verb} ${t}${r.maximum.toString()} ${n.unit??"Ã©lÃ©ment(s)"}`;return`Trop grand : ${r.origin??"valeur"} doit \xeatre ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Trop petit : ${r.origin} doit ${n.verb} ${t}${r.minimum.toString()} ${n.unit}`;return`Trop petit : ${r.origin} doit \xeatre ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Cha\xeene invalide : doit commencer par "${r.prefix}"`;if("ends_with"===r.format)return`Cha\xeene invalide : doit se terminer par "${r.suffix}"`;if("includes"===r.format)return`Cha\xeene invalide : doit inclure "${r.includes}"`;if("regex"===r.format)return`Cha\xeene invalide : doit correspondre au mod\xe8le ${r.pattern}`;return`${t[r.format]??r.format} invalide`;case"not_multiple_of":return`Nombre invalide : doit \xeatre un multiple de ${r.divisor}`;case"unrecognized_keys":return`Cl\xe9${r.keys.length>1?"s":""} non reconnue${r.keys.length>1?"s":""} : ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Cl\xe9 invalide dans ${r.origin}`;case"invalid_union":return"EntrÃ©e invalide";case"invalid_element":return`Valeur invalide dans ${r.origin}`;default:return`Entr\xe9e invalide`}}})()}};let s=a(e.r(25896))},20208,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"caractÃ¨res",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"Ã©lÃ©ments",verb:"avoir"},set:{unit:"Ã©lÃ©ments",verb:"avoir"}},t={regex:"entrÃ©e",email:"adresse courriel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date-heure ISO",date:"date ISO",time:"heure ISO",duration:"durÃ©e ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"chaÃ®ne encodÃ©e en base64",base64url:"chaÃ®ne encodÃ©e en base64url",json_string:"chaÃ®ne JSON",e164:"numÃ©ro E.164",jwt:"JWT",template_literal:"entrÃ©e"};return r=>{switch(r.code){case"invalid_type":return`Entr\xe9e invalide : attendu ${r.expected}, re\xe7u ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Entr\xe9e invalide : attendu ${s.stringifyPrimitive(r.values[0])}`;return`Option invalide : attendu l'une des valeurs suivantes ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"â‰¤":"<",n=e[r.origin]??null;if(n)return`Trop grand : attendu que ${r.origin??"la valeur"} ait ${t}${r.maximum.toString()} ${n.unit}`;return`Trop grand : attendu que ${r.origin??"la valeur"} soit ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?"â‰¥":">",n=e[r.origin]??null;if(n)return`Trop petit : attendu que ${r.origin} ait ${t}${r.minimum.toString()} ${n.unit}`;return`Trop petit : attendu que ${r.origin} soit ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Cha\xeene invalide : doit commencer par "${r.prefix}"`;if("ends_with"===r.format)return`Cha\xeene invalide : doit se terminer par "${r.suffix}"`;if("includes"===r.format)return`Cha\xeene invalide : doit inclure "${r.includes}"`;if("regex"===r.format)return`Cha\xeene invalide : doit correspondre au motif ${r.pattern}`;return`${t[r.format]??r.format} invalide`;case"not_multiple_of":return`Nombre invalide : doit \xeatre un multiple de ${r.divisor}`;case"unrecognized_keys":return`Cl\xe9${r.keys.length>1?"s":""} non reconnue${r.keys.length>1?"s":""} : ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Cl\xe9 invalide dans ${r.origin}`;case"invalid_union":return"EntrÃ©e invalide";case"invalid_element":return`Valeur invalide dans ${r.origin}`;default:return`Entr\xe9e invalide`}}})()}};let s=a(e.r(25896))},94269,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"××•×ª×™×•×ª",verb:"×œ×›×œ×•×œ"},file:{unit:"×‘×™×™×˜×™×",verb:"×œ×›×œ×•×œ"},array:{unit:"×¤×¨×™×˜×™×",verb:"×œ×›×œ×•×œ"},set:{unit:"×¤×¨×™×˜×™×",verb:"×œ×›×œ×•×œ"}},t={regex:"×§×œ×˜",email:"×›×ª×•×‘×ª ××™×ž×™×™×œ",url:"×›×ª×•×‘×ª ×¨×©×ª",emoji:"××™×ž×•×’'×™",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"×ª××¨×™×š ×•×–×ž×Ÿ ISO",date:"×ª××¨×™×š ISO",time:"×–×ž×Ÿ ISO",duration:"×ž×©×š ×–×ž×Ÿ ISO",ipv4:"×›×ª×•×‘×ª IPv4",ipv6:"×›×ª×•×‘×ª IPv6",cidrv4:"×˜×•×•×— IPv4",cidrv6:"×˜×•×•×— IPv6",base64:"×ž×—×¨×•×–×ª ×‘×‘×¡×™×¡ 64",base64url:"×ž×—×¨×•×–×ª ×‘×‘×¡×™×¡ 64 ×œ×›×ª×•×‘×•×ª ×¨×©×ª",json_string:"×ž×—×¨×•×–×ª JSON",e164:"×ž×¡×¤×¨ E.164",jwt:"JWT",template_literal:"×§×œ×˜"};return r=>{switch(r.code){case"invalid_type":return`×§×œ×˜ ×œ× ×ª×§×™×Ÿ: ×¦×¨×™×š ${r.expected}, ×”×ª×§×‘×œ ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`×§×œ×˜ ×œ× ×ª×§×™×Ÿ: ×¦×¨×™×š ${s.stringifyPrimitive(r.values[0])}`;return`×§×œ×˜ ×œ× ×ª×§×™×Ÿ: ×¦×¨×™×š ××—×ª ×ž×”××¤×©×¨×•×™×•×ª  ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`×’×“×•×œ ×ž×“×™: ${r.origin??"value"} ×¦×¨×™×š ×œ×”×™×•×ª ${t}${r.maximum.toString()} ${n.unit??"elements"}`;return`×’×“×•×œ ×ž×“×™: ${r.origin??"value"} ×¦×¨×™×š ×œ×”×™×•×ª ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`×§×˜×Ÿ ×ž×“×™: ${r.origin} ×¦×¨×™×š ×œ×”×™×•×ª ${t}${r.minimum.toString()} ${n.unit}`;return`×§×˜×Ÿ ×ž×“×™: ${r.origin} ×¦×¨×™×š ×œ×”×™×•×ª ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`×ž×—×¨×•×–×ª ×œ× ×ª×§×™× ×”: ×—×™×™×‘×ª ×œ×”×ª×—×™×œ ×‘"${r.prefix}"`;if("ends_with"===r.format)return`×ž×—×¨×•×–×ª ×œ× ×ª×§×™× ×”: ×—×™×™×‘×ª ×œ×”×¡×ª×™×™× ×‘ "${r.suffix}"`;if("includes"===r.format)return`×ž×—×¨×•×–×ª ×œ× ×ª×§×™× ×”: ×—×™×™×‘×ª ×œ×›×œ×•×œ "${r.includes}"`;if("regex"===r.format)return`×ž×—×¨×•×–×ª ×œ× ×ª×§×™× ×”: ×—×™×™×‘×ª ×œ×”×ª××™× ×œ×ª×‘× ×™×ª ${r.pattern}`;return`${t[r.format]??r.format} ×œ× ×ª×§×™×Ÿ`;case"not_multiple_of":return`×ž×¡×¤×¨ ×œ× ×ª×§×™×Ÿ: ×—×™×™×‘ ×œ×”×™×•×ª ×ž×›×¤×œ×” ×©×œ ${r.divisor}`;case"unrecognized_keys":return`×ž×¤×ª×—${r.keys.length>1?"×•×ª":""} ×œ× ×ž×–×•×”${r.keys.length>1?"×™×":"×”"}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`×ž×¤×ª×— ×œ× ×ª×§×™×Ÿ ×‘${r.origin}`;case"invalid_union":return"×§×œ×˜ ×œ× ×ª×§×™×Ÿ";case"invalid_element":return`×¢×¨×š ×œ× ×ª×§×™×Ÿ ×‘${r.origin}`;default:return`×§×œ×˜ ×œ× ×ª×§×™×Ÿ`}}})()}};let s=a(e.r(25896))},49693,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"karakter",verb:"legyen"},file:{unit:"byte",verb:"legyen"},array:{unit:"elem",verb:"legyen"},set:{unit:"elem",verb:"legyen"}},t={regex:"bemenet",email:"email cÃ­m",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO idÅ‘bÃ©lyeg",date:"ISO dÃ¡tum",time:"ISO idÅ‘",duration:"ISO idÅ‘intervallum",ipv4:"IPv4 cÃ­m",ipv6:"IPv6 cÃ­m",cidrv4:"IPv4 tartomÃ¡ny",cidrv6:"IPv6 tartomÃ¡ny",base64:"base64-kÃ³dolt string",base64url:"base64url-kÃ³dolt string",json_string:"JSON string",e164:"E.164 szÃ¡m",jwt:"JWT",template_literal:"bemenet"};return r=>{switch(r.code){case"invalid_type":return`\xc9rv\xe9nytelen bemenet: a v\xe1rt \xe9rt\xe9k ${r.expected}, a kapott \xe9rt\xe9k ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"szÃ¡m";case"object":if(Array.isArray(e))return"tÃ¶mb";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`\xc9rv\xe9nytelen bemenet: a v\xe1rt \xe9rt\xe9k ${s.stringifyPrimitive(r.values[0])}`;return`\xc9rv\xe9nytelen opci\xf3: valamelyik \xe9rt\xe9k v\xe1rt ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`T\xfal nagy: ${r.origin??"Ã©rtÃ©k"} m\xe9rete t\xfal nagy ${t}${r.maximum.toString()} ${n.unit??"elem"}`;return`T\xfal nagy: a bemeneti \xe9rt\xe9k ${r.origin??"Ã©rtÃ©k"} t\xfal nagy: ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`T\xfal kicsi: a bemeneti \xe9rt\xe9k ${r.origin} m\xe9rete t\xfal kicsi ${t}${r.minimum.toString()} ${n.unit}`;return`T\xfal kicsi: a bemeneti \xe9rt\xe9k ${r.origin} t\xfal kicsi ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`\xc9rv\xe9nytelen string: "${r.prefix}" \xe9rt\xe9kkel kell kezdÅ‘dnie`;if("ends_with"===r.format)return`\xc9rv\xe9nytelen string: "${r.suffix}" \xe9rt\xe9kkel kell v\xe9gzÅ‘dnie`;if("includes"===r.format)return`\xc9rv\xe9nytelen string: "${r.includes}" \xe9rt\xe9ket kell tartalmaznia`;if("regex"===r.format)return`\xc9rv\xe9nytelen string: ${r.pattern} mint\xe1nak kell megfelelnie`;return`\xc9rv\xe9nytelen ${t[r.format]??r.format}`;case"not_multiple_of":return`\xc9rv\xe9nytelen sz\xe1m: ${r.divisor} t\xf6bbsz\xf6r\xf6s\xe9nek kell lennie`;case"unrecognized_keys":return`Ismeretlen kulcs${r.keys.length>1?"s":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`\xc9rv\xe9nytelen kulcs ${r.origin}`;case"invalid_union":return"Ã‰rvÃ©nytelen bemenet";case"invalid_element":return`\xc9rv\xe9nytelen \xe9rt\xe9k: ${r.origin}`;default:return`\xc9rv\xe9nytelen bemenet`}}})()}};let s=a(e.r(25896))},30429,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"karakter",verb:"memiliki"},file:{unit:"byte",verb:"memiliki"},array:{unit:"item",verb:"memiliki"},set:{unit:"item",verb:"memiliki"}},t={regex:"input",email:"alamat email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tanggal dan waktu format ISO",date:"tanggal format ISO",time:"jam format ISO",duration:"durasi format ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"rentang alamat IPv4",cidrv6:"rentang alamat IPv6",base64:"string dengan enkode base64",base64url:"string dengan enkode base64url",json_string:"string JSON",e164:"angka E.164",jwt:"JWT",template_literal:"input"};return r=>{switch(r.code){case"invalid_type":return`Input tidak valid: diharapkan ${r.expected}, diterima ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Input tidak valid: diharapkan ${s.stringifyPrimitive(r.values[0])}`;return`Pilihan tidak valid: diharapkan salah satu dari ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Terlalu besar: diharapkan ${r.origin??"value"} memiliki ${t}${r.maximum.toString()} ${n.unit??"elemen"}`;return`Terlalu besar: diharapkan ${r.origin??"value"} menjadi ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Terlalu kecil: diharapkan ${r.origin} memiliki ${t}${r.minimum.toString()} ${n.unit}`;return`Terlalu kecil: diharapkan ${r.origin} menjadi ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`String tidak valid: harus dimulai dengan "${r.prefix}"`;if("ends_with"===r.format)return`String tidak valid: harus berakhir dengan "${r.suffix}"`;if("includes"===r.format)return`String tidak valid: harus menyertakan "${r.includes}"`;if("regex"===r.format)return`String tidak valid: harus sesuai pola ${r.pattern}`;return`${t[r.format]??r.format} tidak valid`;case"not_multiple_of":return`Angka tidak valid: harus kelipatan dari ${r.divisor}`;case"unrecognized_keys":return`Kunci tidak dikenali ${r.keys.length>1?"s":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Kunci tidak valid di ${r.origin}`;case"invalid_union":default:return"Input tidak valid";case"invalid_element":return`Nilai tidak valid di ${r.origin}`}}})()}};let s=a(e.r(25896))},66406,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"caratteri",verb:"avere"},file:{unit:"byte",verb:"avere"},array:{unit:"elementi",verb:"avere"},set:{unit:"elementi",verb:"avere"}},t={regex:"input",email:"indirizzo email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e ora ISO",date:"data ISO",time:"ora ISO",duration:"durata ISO",ipv4:"indirizzo IPv4",ipv6:"indirizzo IPv6",cidrv4:"intervallo IPv4",cidrv6:"intervallo IPv6",base64:"stringa codificata in base64",base64url:"URL codificata in base64",json_string:"stringa JSON",e164:"numero E.164",jwt:"JWT",template_literal:"input"};return r=>{switch(r.code){case"invalid_type":return`Input non valido: atteso ${r.expected}, ricevuto ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"numero";case"object":if(Array.isArray(e))return"vettore";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Input non valido: atteso ${s.stringifyPrimitive(r.values[0])}`;return`Opzione non valida: atteso uno tra ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Troppo grande: ${r.origin??"valore"} deve avere ${t}${r.maximum.toString()} ${n.unit??"elementi"}`;return`Troppo grande: ${r.origin??"valore"} deve essere ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Troppo piccolo: ${r.origin} deve avere ${t}${r.minimum.toString()} ${n.unit}`;return`Troppo piccolo: ${r.origin} deve essere ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Stringa non valida: deve iniziare con "${r.prefix}"`;if("ends_with"===r.format)return`Stringa non valida: deve terminare con "${r.suffix}"`;if("includes"===r.format)return`Stringa non valida: deve includere "${r.includes}"`;if("regex"===r.format)return`Stringa non valida: deve corrispondere al pattern ${r.pattern}`;return`Invalid ${t[r.format]??r.format}`;case"not_multiple_of":return`Numero non valido: deve essere un multiplo di ${r.divisor}`;case"unrecognized_keys":return`Chiav${r.keys.length>1?"i":"e"} non riconosciut${r.keys.length>1?"e":"a"}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Chiave non valida in ${r.origin}`;case"invalid_union":default:return"Input non valido";case"invalid_element":return`Valore non valido in ${r.origin}`}}})()}};let s=a(e.r(25896))},98099,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"æ–‡å­—",verb:"ã§ã‚ã‚‹"},file:{unit:"ãƒã‚¤ãƒˆ",verb:"ã§ã‚ã‚‹"},array:{unit:"è¦ç´ ",verb:"ã§ã‚ã‚‹"},set:{unit:"è¦ç´ ",verb:"ã§ã‚ã‚‹"}},t={regex:"å…¥åŠ›å€¤",email:"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹",url:"URL",emoji:"çµµæ–‡å­—",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISOæ—¥æ™‚",date:"ISOæ—¥ä»˜",time:"ISOæ™‚åˆ»",duration:"ISOæœŸé–“",ipv4:"IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹",ipv6:"IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹",cidrv4:"IPv4ç¯„å›²",cidrv6:"IPv6ç¯„å›²",base64:"base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æ–‡å­—åˆ—",base64url:"base64urlã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æ–‡å­—åˆ—",json_string:"JSONæ–‡å­—åˆ—",e164:"E.164ç•ªå·",jwt:"JWT",template_literal:"å…¥åŠ›å€¤"};return r=>{switch(r.code){case"invalid_type":return`ç„¡åŠ¹ãªå…¥åŠ›: ${r.expected}ãŒæœŸå¾…ã•ã‚Œã¾ã—ãŸãŒã€${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"æ•°å€¤";case"object":if(Array.isArray(e))return"é…åˆ—";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}ãŒå…¥åŠ›ã•ã‚Œã¾ã—ãŸ`;case"invalid_value":if(1===r.values.length)return`ç„¡åŠ¹ãªå…¥åŠ›: ${s.stringifyPrimitive(r.values[0])}ãŒæœŸå¾…ã•ã‚Œã¾ã—ãŸ`;return`ç„¡åŠ¹ãªé¸æŠž: ${s.joinValues(r.values,"ã€")}ã®ã„ãšã‚Œã‹ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™`;case"too_big":{let t=r.inclusive?"ä»¥ä¸‹ã§ã‚ã‚‹":"ã‚ˆã‚Šå°ã•ã„",n=e[r.origin]??null;if(n)return`å¤§ãã™ãŽã‚‹å€¤: ${r.origin??"å€¤"}ã¯${r.maximum.toString()}${n.unit??"è¦ç´ "}${t}å¿…è¦ãŒã‚ã‚Šã¾ã™`;return`å¤§ãã™ãŽã‚‹å€¤: ${r.origin??"å€¤"}ã¯${r.maximum.toString()}${t}å¿…è¦ãŒã‚ã‚Šã¾ã™`}case"too_small":{let t=r.inclusive?"ä»¥ä¸Šã§ã‚ã‚‹":"ã‚ˆã‚Šå¤§ãã„",n=e[r.origin]??null;if(n)return`å°ã•ã™ãŽã‚‹å€¤: ${r.origin}ã¯${r.minimum.toString()}${n.unit}${t}å¿…è¦ãŒã‚ã‚Šã¾ã™`;return`å°ã•ã™ãŽã‚‹å€¤: ${r.origin}ã¯${r.minimum.toString()}${t}å¿…è¦ãŒã‚ã‚Šã¾ã™`}case"invalid_format":if("starts_with"===r.format)return`ç„¡åŠ¹ãªæ–‡å­—åˆ—: "${r.prefix}"ã§å§‹ã¾ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™`;if("ends_with"===r.format)return`ç„¡åŠ¹ãªæ–‡å­—åˆ—: "${r.suffix}"ã§çµ‚ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™`;if("includes"===r.format)return`ç„¡åŠ¹ãªæ–‡å­—åˆ—: "${r.includes}"ã‚’å«ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™`;if("regex"===r.format)return`ç„¡åŠ¹ãªæ–‡å­—åˆ—: ãƒ‘ã‚¿ãƒ¼ãƒ³${r.pattern}ã«ä¸€è‡´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™`;return`ç„¡åŠ¹ãª${t[r.format]??r.format}`;case"not_multiple_of":return`ç„¡åŠ¹ãªæ•°å€¤: ${r.divisor}ã®å€æ•°ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™`;case"unrecognized_keys":return`èªè­˜ã•ã‚Œã¦ã„ãªã„ã‚­ãƒ¼${r.keys.length>1?"ç¾¤":""}: ${s.joinValues(r.keys,"ã€")}`;case"invalid_key":return`${r.origin}å†…ã®ç„¡åŠ¹ãªã‚­ãƒ¼`;case"invalid_union":return"ç„¡åŠ¹ãªå…¥åŠ›";case"invalid_element":return`${r.origin}å†…ã®ç„¡åŠ¹ãªå€¤`;default:return`ç„¡åŠ¹ãªå…¥åŠ›`}}})()}};let s=a(e.r(25896))},78174,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"ážáž½áž¢áž€áŸ’ážŸážš",verb:"áž‚áž½ážšáž˜áž¶áž“"},file:{unit:"áž”áŸƒ",verb:"áž‚áž½ážšáž˜áž¶áž“"},array:{unit:"áž’áž¶ážáž»",verb:"áž‚áž½ážšáž˜áž¶áž“"},set:{unit:"áž’áž¶ážáž»",verb:"áž‚áž½ážšáž˜áž¶áž“"}},t={regex:"áž‘áž·áž“áŸ’áž“áž“áŸáž™áž”áž‰áŸ’áž…áž¼áž›",email:"áž¢áž¶ážŸáž™ážŠáŸ’áž‹áž¶áž“áž¢áŸŠáž¸áž˜áŸ‚áž›",url:"URL",emoji:"ážŸáž‰áŸ’áž‰áž¶áž¢áž¶ážšáž˜áŸ’áž˜ážŽáŸ",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘ áž“áž·áž„áž˜áŸ‰áŸ„áž„ ISO",date:"áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘ ISO",time:"áž˜áŸ‰áŸ„áž„ ISO",duration:"ážšáž™áŸˆáž–áŸáž› ISO",ipv4:"áž¢áž¶ážŸáž™ážŠáŸ’áž‹áž¶áž“ IPv4",ipv6:"áž¢áž¶ážŸáž™ážŠáŸ’áž‹áž¶áž“ IPv6",cidrv4:"ážŠáŸ‚áž“áž¢áž¶ážŸáž™ážŠáŸ’áž‹áž¶áž“ IPv4",cidrv6:"ážŠáŸ‚áž“áž¢áž¶ážŸáž™ážŠáŸ’áž‹áž¶áž“ IPv6",base64:"ážáŸ’ážŸáŸ‚áž¢áž€áŸ’ážŸážšáž¢áŸŠáž·áž€áž¼ážŠ base64",base64url:"ážáŸ’ážŸáŸ‚áž¢áž€áŸ’ážŸážšáž¢áŸŠáž·áž€áž¼ážŠ base64url",json_string:"ážáŸ’ážŸáŸ‚áž¢áž€áŸ’ážŸážš JSON",e164:"áž›áŸáž E.164",jwt:"JWT",template_literal:"áž‘áž·áž“áŸ’áž“áž“áŸáž™áž”áž‰áŸ’áž…áž¼áž›"};return r=>{switch(r.code){case"invalid_type":return`áž‘áž·áž“áŸ’áž“áž“áŸáž™áž”áž‰áŸ’áž…áž¼áž›áž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáŸ– ážáŸ’ážšáž¼ážœáž€áž¶ážš ${r.expected} áž”áŸ‰áž»áž“áŸ’ážáŸ‚áž‘áž‘áž½áž›áž”áž¶áž“ ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"áž˜áž·áž“áž˜áŸ‚áž“áž‡áž¶áž›áŸáž (NaN)":"áž›áŸáž";case"object":if(Array.isArray(e))return"áž¢áž¶ážšáŸ (Array)";if(null===e)return"áž‚áŸ’áž˜áž¶áž“ážáž˜áŸ’áž›áŸƒ (null)";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`áž‘áž·áž“áŸ’áž“áž“áŸáž™áž”áž‰áŸ’áž…áž¼áž›áž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáŸ– ážáŸ’ážšáž¼ážœáž€áž¶ážš ${s.stringifyPrimitive(r.values[0])}`;return`áž‡áž˜áŸ’ážšáž¾ážŸáž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáŸ– ážáŸ’ážšáž¼ážœáž‡áž¶áž˜áž½áž™áž€áŸ’áž“áž»áž„áž…áŸ†ážŽáŸ„áž˜ ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`áž’áŸ†áž–áŸáž€áŸ– ážáŸ’ážšáž¼ážœáž€áž¶ážš ${r.origin??"ážáž˜áŸ’áž›áŸƒ"} ${t} ${r.maximum.toString()} ${n.unit??"áž’áž¶ážáž»"}`;return`áž’áŸ†áž–áŸáž€áŸ– ážáŸ’ážšáž¼ážœáž€áž¶ážš ${r.origin??"ážáž˜áŸ’áž›áŸƒ"} ${t} ${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`ážáž¼áž…áž–áŸáž€áŸ– ážáŸ’ážšáž¼ážœáž€áž¶ážš ${r.origin} ${t} ${r.minimum.toString()} ${n.unit}`;return`ážáž¼áž…áž–áŸáž€áŸ– ážáŸ’ážšáž¼ážœáž€áž¶ážš ${r.origin} ${t} ${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`ážáŸ’ážŸáŸ‚áž¢áž€áŸ’ážŸážšáž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáŸ– ážáŸ’ážšáž¼ážœáž…áž¶áž”áŸ‹áž•áŸ’ážáž¾áž˜ážŠáŸ„áž™ "${r.prefix}"`;if("ends_with"===r.format)return`ážáŸ’ážŸáŸ‚áž¢áž€áŸ’ážŸážšáž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáŸ– ážáŸ’ážšáž¼ážœáž”áž‰áŸ’áž…áž”áŸ‹ážŠáŸ„áž™ "${r.suffix}"`;if("includes"===r.format)return`ážáŸ’ážŸáŸ‚áž¢áž€áŸ’ážŸážšáž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáŸ– ážáŸ’ážšáž¼ážœáž˜áž¶áž“ "${r.includes}"`;if("regex"===r.format)return`ážáŸ’ážŸáŸ‚áž¢áž€áŸ’ážŸážšáž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáŸ– ážáŸ’ážšáž¼ážœážáŸ‚áž•áŸ’áž‚áž¼áž•áŸ’áž‚áž„áž“áž¹áž„áž‘áž˜áŸ’ážšáž„áŸ‹ážŠáŸ‚áž›áž”áž¶áž“áž€áŸ†ážŽážáŸ‹ ${r.pattern}`;return`áž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáŸ– ${t[r.format]??r.format}`;case"not_multiple_of":return`áž›áŸážáž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáŸ– ážáŸ’ážšáž¼ážœážáŸ‚áž‡áž¶áž–áž áž»áž‚áž»ážŽáž“áŸƒ ${r.divisor}`;case"unrecognized_keys":return`ážšáž€ážƒáž¾áž‰ážŸáŸ„áž˜áž·áž“ážŸáŸ’áž‚áž¶áž›áŸ‹áŸ– ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`ážŸáŸ„áž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáž“áŸ…áž€áŸ’áž“áž»áž„ ${r.origin}`;case"invalid_union":default:return`áž‘áž·áž“áŸ’áž“áž“áŸáž™áž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœ`;case"invalid_element":return`áž‘áž·áž“áŸ’áž“áž“áŸáž™áž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœáž“áŸ…áž€áŸ’áž“áž»áž„ ${r.origin}`}}})()}};let s=a(e.r(25896))},51316,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"ë¬¸ìž",verb:"to have"},file:{unit:"ë°”ì´íŠ¸",verb:"to have"},array:{unit:"ê°œ",verb:"to have"},set:{unit:"ê°œ",verb:"to have"}},t={regex:"ìž…ë ¥",email:"ì´ë©”ì¼ ì£¼ì†Œ",url:"URL",emoji:"ì´ëª¨ì§€",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO ë‚ ì§œì‹œê°„",date:"ISO ë‚ ì§œ",time:"ISO ì‹œê°„",duration:"ISO ê¸°ê°„",ipv4:"IPv4 ì£¼ì†Œ",ipv6:"IPv6 ì£¼ì†Œ",cidrv4:"IPv4 ë²”ìœ„",cidrv6:"IPv6 ë²”ìœ„",base64:"base64 ì¸ì½”ë”© ë¬¸ìžì—´",base64url:"base64url ì¸ì½”ë”© ë¬¸ìžì—´",json_string:"JSON ë¬¸ìžì—´",e164:"E.164 ë²ˆí˜¸",jwt:"JWT",template_literal:"ìž…ë ¥"};return r=>{switch(r.code){case"invalid_type":return`ìž˜ëª»ëœ ìž…ë ¥: ì˜ˆìƒ íƒ€ìž…ì€ ${r.expected}, ë°›ì€ íƒ€ìž…ì€ ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}ìž…ë‹ˆë‹¤`;case"invalid_value":if(1===r.values.length)return`ìž˜ëª»ëœ ìž…ë ¥: ê°’ì€ ${s.stringifyPrimitive(r.values[0])} ì´ì–´ì•¼ í•©ë‹ˆë‹¤`;return`ìž˜ëª»ëœ ì˜µì…˜: ${s.joinValues(r.values,"ë˜ëŠ” ")} ì¤‘ í•˜ë‚˜ì—¬ì•¼ í•©ë‹ˆë‹¤`;case"too_big":{let t=r.inclusive?"ì´í•˜":"ë¯¸ë§Œ",n="ë¯¸ë§Œ"===t?"ì´ì–´ì•¼ í•©ë‹ˆë‹¤":"ì—¬ì•¼ í•©ë‹ˆë‹¤",i=e[r.origin]??null,a=i?.unit??"ìš”ì†Œ";if(i)return`${r.origin??"ê°’"}ì´ ë„ˆë¬´ í½ë‹ˆë‹¤: ${r.maximum.toString()}${a} ${t}${n}`;return`${r.origin??"ê°’"}ì´ ë„ˆë¬´ í½ë‹ˆë‹¤: ${r.maximum.toString()} ${t}${n}`}case"too_small":{let t=r.inclusive?"ì´ìƒ":"ì´ˆê³¼",n="ì´ìƒ"===t?"ì´ì–´ì•¼ í•©ë‹ˆë‹¤":"ì—¬ì•¼ í•©ë‹ˆë‹¤",i=e[r.origin]??null,a=i?.unit??"ìš”ì†Œ";if(i)return`${r.origin??"ê°’"}ì´ ë„ˆë¬´ ìž‘ìŠµë‹ˆë‹¤: ${r.minimum.toString()}${a} ${t}${n}`;return`${r.origin??"ê°’"}ì´ ë„ˆë¬´ ìž‘ìŠµë‹ˆë‹¤: ${r.minimum.toString()} ${t}${n}`}case"invalid_format":if("starts_with"===r.format)return`ìž˜ëª»ëœ ë¬¸ìžì—´: "${r.prefix}"(ìœ¼)ë¡œ ì‹œìž‘í•´ì•¼ í•©ë‹ˆë‹¤`;if("ends_with"===r.format)return`ìž˜ëª»ëœ ë¬¸ìžì—´: "${r.suffix}"(ìœ¼)ë¡œ ëë‚˜ì•¼ í•©ë‹ˆë‹¤`;if("includes"===r.format)return`ìž˜ëª»ëœ ë¬¸ìžì—´: "${r.includes}"ì„(ë¥¼) í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤`;if("regex"===r.format)return`ìž˜ëª»ëœ ë¬¸ìžì—´: ì •ê·œì‹ ${r.pattern} íŒ¨í„´ê³¼ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤`;return`ìž˜ëª»ëœ ${t[r.format]??r.format}`;case"not_multiple_of":return`ìž˜ëª»ëœ ìˆ«ìž: ${r.divisor}ì˜ ë°°ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤`;case"unrecognized_keys":return`ì¸ì‹í•  ìˆ˜ ì—†ëŠ” í‚¤: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`ìž˜ëª»ëœ í‚¤: ${r.origin}`;case"invalid_union":default:return`ìž˜ëª»ëœ ìž…ë ¥`;case"invalid_element":return`ìž˜ëª»ëœ ê°’: ${r.origin}`}}})()}};let s=a(e.r(25896))},15367,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"Ð·Ð½Ð°Ñ†Ð¸",verb:"Ð´Ð° Ð¸Ð¼Ð°Ð°Ñ‚"},file:{unit:"Ð±Ð°Ñ˜Ñ‚Ð¸",verb:"Ð´Ð° Ð¸Ð¼Ð°Ð°Ñ‚"},array:{unit:"ÑÑ‚Ð°Ð²ÐºÐ¸",verb:"Ð´Ð° Ð¸Ð¼Ð°Ð°Ñ‚"},set:{unit:"ÑÑ‚Ð°Ð²ÐºÐ¸",verb:"Ð´Ð° Ð¸Ð¼Ð°Ð°Ñ‚"}},t={regex:"Ð²Ð½ÐµÑ",email:"Ð°Ð´Ñ€ÐµÑÐ° Ð½Ð° Ðµ-Ð¿Ð¾ÑˆÑ‚Ð°",url:"URL",emoji:"ÐµÐ¼Ð¾ÑŸÐ¸",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO Ð´Ð°Ñ‚ÑƒÐ¼ Ð¸ Ð²Ñ€ÐµÐ¼Ðµ",date:"ISO Ð´Ð°Ñ‚ÑƒÐ¼",time:"ISO Ð²Ñ€ÐµÐ¼Ðµ",duration:"ISO Ð²Ñ€ÐµÐ¼ÐµÑ‚Ñ€Ð°ÐµÑšÐµ",ipv4:"IPv4 Ð°Ð´Ñ€ÐµÑÐ°",ipv6:"IPv6 Ð°Ð´Ñ€ÐµÑÐ°",cidrv4:"IPv4 Ð¾Ð¿ÑÐµÐ³",cidrv6:"IPv6 Ð¾Ð¿ÑÐµÐ³",base64:"base64-ÐµÐ½ÐºÐ¾Ð´Ð¸Ñ€Ð°Ð½Ð° Ð½Ð¸Ð·Ð°",base64url:"base64url-ÐµÐ½ÐºÐ¾Ð´Ð¸Ñ€Ð°Ð½Ð° Ð½Ð¸Ð·Ð°",json_string:"JSON Ð½Ð¸Ð·Ð°",e164:"E.164 Ð±Ñ€Ð¾Ñ˜",jwt:"JWT",template_literal:"Ð²Ð½ÐµÑ"};return r=>{switch(r.code){case"invalid_type":return`Ð“Ñ€ÐµÑˆÐµÐ½ Ð²Ð½ÐµÑ: ÑÐµ Ð¾Ñ‡ÐµÐºÑƒÐ²Ð° ${r.expected}, Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ð¾ ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"Ð±Ñ€Ð¾Ñ˜";case"object":if(Array.isArray(e))return"Ð½Ð¸Ð·Ð°";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Invalid input: expected ${s.stringifyPrimitive(r.values[0])}`;return`Ð“Ñ€ÐµÑˆÐ°Ð½Ð° Ð¾Ð¿Ñ†Ð¸Ñ˜Ð°: ÑÐµ Ð¾Ñ‡ÐµÐºÑƒÐ²Ð° ÐµÐ´Ð½Ð° ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`ÐŸÑ€ÐµÐ¼Ð½Ð¾Ð³Ñƒ Ð³Ð¾Ð»ÐµÐ¼: ÑÐµ Ð¾Ñ‡ÐµÐºÑƒÐ²Ð° ${r.origin??"Ð²Ñ€ÐµÐ´Ð½Ð¾ÑÑ‚Ð°"} Ð´Ð° Ð¸Ð¼Ð° ${t}${r.maximum.toString()} ${n.unit??"ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¸"}`;return`ÐŸÑ€ÐµÐ¼Ð½Ð¾Ð³Ñƒ Ð³Ð¾Ð»ÐµÐ¼: ÑÐµ Ð¾Ñ‡ÐµÐºÑƒÐ²Ð° ${r.origin??"Ð²Ñ€ÐµÐ´Ð½Ð¾ÑÑ‚Ð°"} Ð´Ð° Ð±Ð¸Ð´Ðµ ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`ÐŸÑ€ÐµÐ¼Ð½Ð¾Ð³Ñƒ Ð¼Ð°Ð»: ÑÐµ Ð¾Ñ‡ÐµÐºÑƒÐ²Ð° ${r.origin} Ð´Ð° Ð¸Ð¼Ð° ${t}${r.minimum.toString()} ${n.unit}`;return`ÐŸÑ€ÐµÐ¼Ð½Ð¾Ð³Ñƒ Ð¼Ð°Ð»: ÑÐµ Ð¾Ñ‡ÐµÐºÑƒÐ²Ð° ${r.origin} Ð´Ð° Ð±Ð¸Ð´Ðµ ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`ÐÐµÐ²Ð°Ð¶ÐµÑ‡ÐºÐ° Ð½Ð¸Ð·Ð°: Ð¼Ð¾Ñ€Ð° Ð´Ð° Ð·Ð°Ð¿Ð¾Ñ‡Ð½ÑƒÐ²Ð° ÑÐ¾ "${r.prefix}"`;if("ends_with"===r.format)return`ÐÐµÐ²Ð°Ð¶ÐµÑ‡ÐºÐ° Ð½Ð¸Ð·Ð°: Ð¼Ð¾Ñ€Ð° Ð´Ð° Ð·Ð°Ð²Ñ€ÑˆÑƒÐ²Ð° ÑÐ¾ "${r.suffix}"`;if("includes"===r.format)return`ÐÐµÐ²Ð°Ð¶ÐµÑ‡ÐºÐ° Ð½Ð¸Ð·Ð°: Ð¼Ð¾Ñ€Ð° Ð´Ð° Ð²ÐºÐ»ÑƒÑ‡ÑƒÐ²Ð° "${r.includes}"`;if("regex"===r.format)return`ÐÐµÐ²Ð°Ð¶ÐµÑ‡ÐºÐ° Ð½Ð¸Ð·Ð°: Ð¼Ð¾Ñ€Ð° Ð´Ð° Ð¾Ð´Ð³Ð¾Ð°Ñ€Ð° Ð½Ð° Ð¿Ð°Ñ‚ÐµÑ€Ð½Ð¾Ñ‚ ${r.pattern}`;return`Invalid ${t[r.format]??r.format}`;case"not_multiple_of":return`Ð“Ñ€ÐµÑˆÐµÐ½ Ð±Ñ€Ð¾Ñ˜: Ð¼Ð¾Ñ€Ð° Ð´Ð° Ð±Ð¸Ð´Ðµ Ð´ÐµÐ»Ð¸Ð² ÑÐ¾ ${r.divisor}`;case"unrecognized_keys":return`${r.keys.length>1?"ÐÐµÐ¿Ñ€ÐµÐ¿Ð¾Ð·Ð½Ð°ÐµÐ½Ð¸ ÐºÐ»ÑƒÑ‡ÐµÐ²Ð¸":"ÐÐµÐ¿Ñ€ÐµÐ¿Ð¾Ð·Ð½Ð°ÐµÐ½ ÐºÐ»ÑƒÑ‡"}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Ð“Ñ€ÐµÑˆÐµÐ½ ÐºÐ»ÑƒÑ‡ Ð²Ð¾ ${r.origin}`;case"invalid_union":return"Ð“Ñ€ÐµÑˆÐµÐ½ Ð²Ð½ÐµÑ";case"invalid_element":return`Ð“Ñ€ÐµÑˆÐ½Ð° Ð²Ñ€ÐµÐ´Ð½Ð¾ÑÑ‚ Ð²Ð¾ ${r.origin}`;default:return`Ð“Ñ€ÐµÑˆÐµÐ½ Ð²Ð½ÐµÑ`}}})()}};let s=a(e.r(25896))},21801,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"aksara",verb:"mempunyai"},file:{unit:"bait",verb:"mempunyai"},array:{unit:"elemen",verb:"mempunyai"},set:{unit:"elemen",verb:"mempunyai"}},t={regex:"input",email:"alamat e-mel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tarikh masa ISO",date:"tarikh ISO",time:"masa ISO",duration:"tempoh ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"julat IPv4",cidrv6:"julat IPv6",base64:"string dikodkan base64",base64url:"string dikodkan base64url",json_string:"string JSON",e164:"nombor E.164",jwt:"JWT",template_literal:"input"};return r=>{switch(r.code){case"invalid_type":return`Input tidak sah: dijangka ${r.expected}, diterima ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"nombor";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Input tidak sah: dijangka ${s.stringifyPrimitive(r.values[0])}`;return`Pilihan tidak sah: dijangka salah satu daripada ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Terlalu besar: dijangka ${r.origin??"nilai"} ${n.verb} ${t}${r.maximum.toString()} ${n.unit??"elemen"}`;return`Terlalu besar: dijangka ${r.origin??"nilai"} adalah ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Terlalu kecil: dijangka ${r.origin} ${n.verb} ${t}${r.minimum.toString()} ${n.unit}`;return`Terlalu kecil: dijangka ${r.origin} adalah ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`String tidak sah: mesti bermula dengan "${r.prefix}"`;if("ends_with"===r.format)return`String tidak sah: mesti berakhir dengan "${r.suffix}"`;if("includes"===r.format)return`String tidak sah: mesti mengandungi "${r.includes}"`;if("regex"===r.format)return`String tidak sah: mesti sepadan dengan corak ${r.pattern}`;return`${t[r.format]??r.format} tidak sah`;case"not_multiple_of":return`Nombor tidak sah: perlu gandaan ${r.divisor}`;case"unrecognized_keys":return`Kunci tidak dikenali: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Kunci tidak sah dalam ${r.origin}`;case"invalid_union":default:return"Input tidak sah";case"invalid_element":return`Nilai tidak sah dalam ${r.origin}`}}})()}};let s=a(e.r(25896))},2447,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"tekens"},file:{unit:"bytes"},array:{unit:"elementen"},set:{unit:"elementen"}},t={regex:"invoer",email:"emailadres",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum en tijd",date:"ISO datum",time:"ISO tijd",duration:"ISO duur",ipv4:"IPv4-adres",ipv6:"IPv6-adres",cidrv4:"IPv4-bereik",cidrv6:"IPv6-bereik",base64:"base64-gecodeerde tekst",base64url:"base64 URL-gecodeerde tekst",json_string:"JSON string",e164:"E.164-nummer",jwt:"JWT",template_literal:"invoer"};return r=>{switch(r.code){case"invalid_type":return`Ongeldige invoer: verwacht ${r.expected}, ontving ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"getal";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Ongeldige invoer: verwacht ${s.stringifyPrimitive(r.values[0])}`;return`Ongeldige optie: verwacht \xe9\xe9n van ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Te lang: verwacht dat ${r.origin??"waarde"} ${t}${r.maximum.toString()} ${n.unit??"elementen"} bevat`;return`Te lang: verwacht dat ${r.origin??"waarde"} ${t}${r.maximum.toString()} is`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Te kort: verwacht dat ${r.origin} ${t}${r.minimum.toString()} ${n.unit} bevat`;return`Te kort: verwacht dat ${r.origin} ${t}${r.minimum.toString()} is`}case"invalid_format":if("starts_with"===r.format)return`Ongeldige tekst: moet met "${r.prefix}" beginnen`;if("ends_with"===r.format)return`Ongeldige tekst: moet op "${r.suffix}" eindigen`;if("includes"===r.format)return`Ongeldige tekst: moet "${r.includes}" bevatten`;if("regex"===r.format)return`Ongeldige tekst: moet overeenkomen met patroon ${r.pattern}`;return`Ongeldig: ${t[r.format]??r.format}`;case"not_multiple_of":return`Ongeldig getal: moet een veelvoud van ${r.divisor} zijn`;case"unrecognized_keys":return`Onbekende key${r.keys.length>1?"s":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Ongeldige key in ${r.origin}`;case"invalid_union":default:return"Ongeldige invoer";case"invalid_element":return`Ongeldige waarde in ${r.origin}`}}})()}};let s=a(e.r(25896))},87440,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"tegn",verb:"Ã¥ ha"},file:{unit:"bytes",verb:"Ã¥ ha"},array:{unit:"elementer",verb:"Ã¥ inneholde"},set:{unit:"elementer",verb:"Ã¥ inneholde"}},t={regex:"input",email:"e-postadresse",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dato- og klokkeslett",date:"ISO-dato",time:"ISO-klokkeslett",duration:"ISO-varighet",ipv4:"IPv4-omrÃ¥de",ipv6:"IPv6-omrÃ¥de",cidrv4:"IPv4-spekter",cidrv6:"IPv6-spekter",base64:"base64-enkodet streng",base64url:"base64url-enkodet streng",json_string:"JSON-streng",e164:"E.164-nummer",jwt:"JWT",template_literal:"input"};return r=>{switch(r.code){case"invalid_type":return`Ugyldig input: forventet ${r.expected}, fikk ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"tall";case"object":if(Array.isArray(e))return"liste";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Ugyldig verdi: forventet ${s.stringifyPrimitive(r.values[0])}`;return`Ugyldig valg: forventet en av ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`For stor(t): forventet ${r.origin??"value"} til \xe5 ha ${t}${r.maximum.toString()} ${n.unit??"elementer"}`;return`For stor(t): forventet ${r.origin??"value"} til \xe5 ha ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`For lite(n): forventet ${r.origin} til \xe5 ha ${t}${r.minimum.toString()} ${n.unit}`;return`For lite(n): forventet ${r.origin} til \xe5 ha ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Ugyldig streng: m\xe5 starte med "${r.prefix}"`;if("ends_with"===r.format)return`Ugyldig streng: m\xe5 ende med "${r.suffix}"`;if("includes"===r.format)return`Ugyldig streng: m\xe5 inneholde "${r.includes}"`;if("regex"===r.format)return`Ugyldig streng: m\xe5 matche m\xf8nsteret ${r.pattern}`;return`Ugyldig ${t[r.format]??r.format}`;case"not_multiple_of":return`Ugyldig tall: m\xe5 v\xe6re et multiplum av ${r.divisor}`;case"unrecognized_keys":return`${r.keys.length>1?"Ukjente nÃ¸kler":"Ukjent nÃ¸kkel"}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Ugyldig n\xf8kkel i ${r.origin}`;case"invalid_union":default:return"Ugyldig input";case"invalid_element":return`Ugyldig verdi i ${r.origin}`}}})()}};let s=a(e.r(25896))},81333,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"harf",verb:"olmalÄ±dÄ±r"},file:{unit:"bayt",verb:"olmalÄ±dÄ±r"},array:{unit:"unsur",verb:"olmalÄ±dÄ±r"},set:{unit:"unsur",verb:"olmalÄ±dÄ±r"}},t={regex:"giren",email:"epostagÃ¢h",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO hengÃ¢mÄ±",date:"ISO tarihi",time:"ISO zamanÄ±",duration:"ISO mÃ¼ddeti",ipv4:"IPv4 niÅŸÃ¢nÄ±",ipv6:"IPv6 niÅŸÃ¢nÄ±",cidrv4:"IPv4 menzili",cidrv6:"IPv6 menzili",base64:"base64-ÅŸifreli metin",base64url:"base64url-ÅŸifreli metin",json_string:"JSON metin",e164:"E.164 sayÄ±sÄ±",jwt:"JWT",template_literal:"giren"};return r=>{switch(r.code){case"invalid_type":return`F\xe2sit giren: umulan ${r.expected}, alÄ±nan ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"numara";case"object":if(Array.isArray(e))return"saf";if(null===e)return"gayb";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`F\xe2sit giren: umulan ${s.stringifyPrimitive(r.values[0])}`;return`F\xe2sit tercih: m\xfbteberler ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Fazla b\xfcy\xfck: ${r.origin??"value"}, ${t}${r.maximum.toString()} ${n.unit??"elements"} sahip olmalÄ±ydÄ±.`;return`Fazla b\xfcy\xfck: ${r.origin??"value"}, ${t}${r.maximum.toString()} olmalÄ±ydÄ±.`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Fazla k\xfc\xe7\xfck: ${r.origin}, ${t}${r.minimum.toString()} ${n.unit} sahip olmalÄ±ydÄ±.`;return`Fazla k\xfc\xe7\xfck: ${r.origin}, ${t}${r.minimum.toString()} olmalÄ±ydÄ±.`}case"invalid_format":if("starts_with"===r.format)return`F\xe2sit metin: "${r.prefix}" ile baÅŸlamalÄ±.`;if("ends_with"===r.format)return`F\xe2sit metin: "${r.suffix}" ile bitmeli.`;if("includes"===r.format)return`F\xe2sit metin: "${r.includes}" ihtiv\xe2 etmeli.`;if("regex"===r.format)return`F\xe2sit metin: ${r.pattern} nakÅŸÄ±na uymalÄ±.`;return`F\xe2sit ${t[r.format]??r.format}`;case"not_multiple_of":return`F\xe2sit sayÄ±: ${r.divisor} katÄ± olmalÄ±ydÄ±.`;case"unrecognized_keys":return`TanÄ±nmayan anahtar ${r.keys.length>1?"s":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`${r.origin} i\xe7in tanÄ±nmayan anahtar var.`;case"invalid_union":return"Giren tanÄ±namadÄ±.";case"invalid_element":return`${r.origin} i\xe7in tanÄ±nmayan kÄ±ymet var.`;default:return`KÄ±ymet tanÄ±namadÄ±.`}}})()}};let s=a(e.r(25896))},45578,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"ØªÙˆÚ©ÙŠ",verb:"ÙˆÙ„Ø±ÙŠ"},file:{unit:"Ø¨Ø§ÛŒÙ¼Ø³",verb:"ÙˆÙ„Ø±ÙŠ"},array:{unit:"ØªÙˆÚ©ÙŠ",verb:"ÙˆÙ„Ø±ÙŠ"},set:{unit:"ØªÙˆÚ©ÙŠ",verb:"ÙˆÙ„Ø±ÙŠ"}},t={regex:"ÙˆØ±ÙˆØ¯ÙŠ",email:"Ø¨Ø±ÛŒÚšÙ†Ø§Ù„ÛŒÚ©",url:"ÛŒÙˆ Ø¢Ø± Ø§Ù„",emoji:"Ø§ÛŒÙ…ÙˆØ¬ÙŠ",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"Ù†ÛŒÙ¼Ù‡ Ø§Ùˆ ÙˆØ®Øª",date:"Ù†ÛÙ¼Ù‡",time:"ÙˆØ®Øª",duration:"Ù…ÙˆØ¯Ù‡",ipv4:"Ø¯ IPv4 Ù¾ØªÙ‡",ipv6:"Ø¯ IPv6 Ù¾ØªÙ‡",cidrv4:"Ø¯ IPv4 Ø³Ø§Ø­Ù‡",cidrv6:"Ø¯ IPv6 Ø³Ø§Ø­Ù‡",base64:"base64-encoded Ù…ØªÙ†",base64url:"base64url-encoded Ù…ØªÙ†",json_string:"JSON Ù…ØªÙ†",e164:"Ø¯ E.164 Ø´Ù…ÛØ±Ù‡",jwt:"JWT",template_literal:"ÙˆØ±ÙˆØ¯ÙŠ"};return r=>{switch(r.code){case"invalid_type":return`Ù†Ø§Ø³Ù… ÙˆØ±ÙˆØ¯ÙŠ: Ø¨Ø§ÛŒØ¯ ${r.expected} ÙˆØ§ÛŒ, Ù…Ú«Ø± ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"Ø¹Ø¯Ø¯";case"object":if(Array.isArray(e))return"Ø§Ø±Û";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)} ØªØ±Ù„Ø§Ø³Ù‡ Ø´Ùˆ`;case"invalid_value":if(1===r.values.length)return`Ù†Ø§Ø³Ù… ÙˆØ±ÙˆØ¯ÙŠ: Ø¨Ø§ÛŒØ¯ ${s.stringifyPrimitive(r.values[0])} ÙˆØ§ÛŒ`;return`Ù†Ø§Ø³Ù… Ø§Ù†ØªØ®Ø§Ø¨: Ø¨Ø§ÛŒØ¯ ÛŒÙˆ Ù„Ù‡ ${s.joinValues(r.values,"|")} Ú…Ø®Ù‡ ÙˆØ§ÛŒ`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Ú‰ÛŒØ± Ù„ÙˆÛŒ: ${r.origin??"Ø§Ø±Ø²ÚšØª"} Ø¨Ø§ÛŒØ¯ ${t}${r.maximum.toString()} ${n.unit??"Ø¹Ù†ØµØ±ÙˆÙ†Ù‡"} ÙˆÙ„Ø±ÙŠ`;return`Ú‰ÛŒØ± Ù„ÙˆÛŒ: ${r.origin??"Ø§Ø±Ø²ÚšØª"} Ø¨Ø§ÛŒØ¯ ${t}${r.maximum.toString()} ÙˆÙŠ`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Ú‰ÛŒØ± Ú©ÙˆÚ†Ù†ÛŒ: ${r.origin} Ø¨Ø§ÛŒØ¯ ${t}${r.minimum.toString()} ${n.unit} ÙˆÙ„Ø±ÙŠ`;return`Ú‰ÛŒØ± Ú©ÙˆÚ†Ù†ÛŒ: ${r.origin} Ø¨Ø§ÛŒØ¯ ${t}${r.minimum.toString()} ÙˆÙŠ`}case"invalid_format":if("starts_with"===r.format)return`Ù†Ø§Ø³Ù… Ù…ØªÙ†: Ø¨Ø§ÛŒØ¯ Ø¯ "${r.prefix}" Ø³Ø±Ù‡ Ù¾ÛŒÙ„ Ø´ÙŠ`;if("ends_with"===r.format)return`Ù†Ø§Ø³Ù… Ù…ØªÙ†: Ø¨Ø§ÛŒØ¯ Ø¯ "${r.suffix}" Ø³Ø±Ù‡ Ù¾Ø§ÛŒ ØªÙ‡ ÙˆØ±Ø³ÙŠÚ–ÙŠ`;if("includes"===r.format)return`Ù†Ø§Ø³Ù… Ù…ØªÙ†: Ø¨Ø§ÛŒØ¯ "${r.includes}" ÙˆÙ„Ø±ÙŠ`;if("regex"===r.format)return`Ù†Ø§Ø³Ù… Ù…ØªÙ†: Ø¨Ø§ÛŒØ¯ Ø¯ ${r.pattern} Ø³Ø±Ù‡ Ù…Ø·Ø§Ø¨Ù‚Øª ÙˆÙ„Ø±ÙŠ`;return`${t[r.format]??r.format} Ù†Ø§Ø³Ù… Ø¯ÛŒ`;case"not_multiple_of":return`Ù†Ø§Ø³Ù… Ø¹Ø¯Ø¯: Ø¨Ø§ÛŒØ¯ Ø¯ ${r.divisor} Ù…Ø¶Ø±Ø¨ ÙˆÙŠ`;case"unrecognized_keys":return`Ù†Ø§Ø³Ù… ${r.keys.length>1?"Ú©Ù„ÛŒÚ‰ÙˆÙ†Ù‡":"Ú©Ù„ÛŒÚ‰"}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Ù†Ø§Ø³Ù… Ú©Ù„ÛŒÚ‰ Ù¾Ù‡ ${r.origin} Ú©Û`;case"invalid_union":default:return`Ù†Ø§Ø³Ù…Ù‡ ÙˆØ±ÙˆØ¯ÙŠ`;case"invalid_element":return`Ù†Ø§Ø³Ù… Ø¹Ù†ØµØ± Ù¾Ù‡ ${r.origin} Ú©Û`}}})()}};let s=a(e.r(25896))},12690,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"znakÃ³w",verb:"mieÄ‡"},file:{unit:"bajtÃ³w",verb:"mieÄ‡"},array:{unit:"elementÃ³w",verb:"mieÄ‡"},set:{unit:"elementÃ³w",verb:"mieÄ‡"}},t={regex:"wyraÅ¼enie",email:"adres email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i godzina w formacie ISO",date:"data w formacie ISO",time:"godzina w formacie ISO",duration:"czas trwania ISO",ipv4:"adres IPv4",ipv6:"adres IPv6",cidrv4:"zakres IPv4",cidrv6:"zakres IPv6",base64:"ciÄ…g znakÃ³w zakodowany w formacie base64",base64url:"ciÄ…g znakÃ³w zakodowany w formacie base64url",json_string:"ciÄ…g znakÃ³w w formacie JSON",e164:"liczba E.164",jwt:"JWT",template_literal:"wejÅ›cie"};return r=>{switch(r.code){case"invalid_type":return`NieprawidÅ‚owe dane wejÅ›ciowe: oczekiwano ${r.expected}, otrzymano ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"liczba";case"object":if(Array.isArray(e))return"tablica";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`NieprawidÅ‚owe dane wejÅ›ciowe: oczekiwano ${s.stringifyPrimitive(r.values[0])}`;return`NieprawidÅ‚owa opcja: oczekiwano jednej z wartoÅ›ci ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Za duÅ¼a wartoÅ›Ä‡: oczekiwano, Å¼e ${r.origin??"wartoÅ›Ä‡"} bÄ™dzie mieÄ‡ ${t}${r.maximum.toString()} ${n.unit??"elementÃ³w"}`;return`Zbyt duÅ¼(y/a/e): oczekiwano, Å¼e ${r.origin??"wartoÅ›Ä‡"} bÄ™dzie wynosiÄ‡ ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Za maÅ‚a wartoÅ›Ä‡: oczekiwano, Å¼e ${r.origin??"wartoÅ›Ä‡"} bÄ™dzie mieÄ‡ ${t}${r.minimum.toString()} ${n.unit??"elementÃ³w"}`;return`Zbyt maÅ‚(y/a/e): oczekiwano, Å¼e ${r.origin??"wartoÅ›Ä‡"} bÄ™dzie wynosiÄ‡ ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`NieprawidÅ‚owy ciÄ…g znak\xf3w: musi zaczynaÄ‡ siÄ™ od "${r.prefix}"`;if("ends_with"===r.format)return`NieprawidÅ‚owy ciÄ…g znak\xf3w: musi koÅ„czyÄ‡ siÄ™ na "${r.suffix}"`;if("includes"===r.format)return`NieprawidÅ‚owy ciÄ…g znak\xf3w: musi zawieraÄ‡ "${r.includes}"`;if("regex"===r.format)return`NieprawidÅ‚owy ciÄ…g znak\xf3w: musi odpowiadaÄ‡ wzorcowi ${r.pattern}`;return`NieprawidÅ‚ow(y/a/e) ${t[r.format]??r.format}`;case"not_multiple_of":return`NieprawidÅ‚owa liczba: musi byÄ‡ wielokrotnoÅ›ciÄ… ${r.divisor}`;case"unrecognized_keys":return`Nierozpoznane klucze${r.keys.length>1?"s":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`NieprawidÅ‚owy klucz w ${r.origin}`;case"invalid_union":return"NieprawidÅ‚owe dane wejÅ›ciowe";case"invalid_element":return`NieprawidÅ‚owa wartoÅ›Ä‡ w ${r.origin}`;default:return`NieprawidÅ‚owe dane wejÅ›ciowe`}}})()}};let s=a(e.r(25896))},15573,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"caracteres",verb:"ter"},file:{unit:"bytes",verb:"ter"},array:{unit:"itens",verb:"ter"},set:{unit:"itens",verb:"ter"}},t={regex:"padrÃ£o",email:"endereÃ§o de e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e hora ISO",date:"data ISO",time:"hora ISO",duration:"duraÃ§Ã£o ISO",ipv4:"endereÃ§o IPv4",ipv6:"endereÃ§o IPv6",cidrv4:"faixa de IPv4",cidrv6:"faixa de IPv6",base64:"texto codificado em base64",base64url:"URL codificada em base64",json_string:"texto JSON",e164:"nÃºmero E.164",jwt:"JWT",template_literal:"entrada"};return r=>{switch(r.code){case"invalid_type":return`Tipo inv\xe1lido: esperado ${r.expected}, recebido ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"nÃºmero";case"object":if(Array.isArray(e))return"array";if(null===e)return"nulo";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Entrada inv\xe1lida: esperado ${s.stringifyPrimitive(r.values[0])}`;return`Op\xe7\xe3o inv\xe1lida: esperada uma das ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Muito grande: esperado que ${r.origin??"valor"} tivesse ${t}${r.maximum.toString()} ${n.unit??"elementos"}`;return`Muito grande: esperado que ${r.origin??"valor"} fosse ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Muito pequeno: esperado que ${r.origin} tivesse ${t}${r.minimum.toString()} ${n.unit}`;return`Muito pequeno: esperado que ${r.origin} fosse ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Texto inv\xe1lido: deve come\xe7ar com "${r.prefix}"`;if("ends_with"===r.format)return`Texto inv\xe1lido: deve terminar com "${r.suffix}"`;if("includes"===r.format)return`Texto inv\xe1lido: deve incluir "${r.includes}"`;if("regex"===r.format)return`Texto inv\xe1lido: deve corresponder ao padr\xe3o ${r.pattern}`;return`${t[r.format]??r.format} inv\xe1lido`;case"not_multiple_of":return`N\xfamero inv\xe1lido: deve ser m\xfaltiplo de ${r.divisor}`;case"unrecognized_keys":return`Chave${r.keys.length>1?"s":""} desconhecida${r.keys.length>1?"s":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Chave inv\xe1lida em ${r.origin}`;case"invalid_union":return"Entrada invÃ¡lida";case"invalid_element":return`Valor inv\xe1lido em ${r.origin}`;default:return`Campo inv\xe1lido`}}})()}};let s=a(e.r(25896))},61460,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:{one:"ÑÐ¸Ð¼Ð²Ð¾Ð»",few:"ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°",many:"ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²"},verb:"Ð¸Ð¼ÐµÑ‚ÑŒ"},file:{unit:{one:"Ð±Ð°Ð¹Ñ‚",few:"Ð±Ð°Ð¹Ñ‚Ð°",many:"Ð±Ð°Ð¹Ñ‚"},verb:"Ð¸Ð¼ÐµÑ‚ÑŒ"},array:{unit:{one:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚",few:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð°",many:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð²"},verb:"Ð¸Ð¼ÐµÑ‚ÑŒ"},set:{unit:{one:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚",few:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð°",many:"ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð²"},verb:"Ð¸Ð¼ÐµÑ‚ÑŒ"}},t={regex:"Ð²Ð²Ð¾Ð´",email:"email Ð°Ð´Ñ€ÐµÑ",url:"URL",emoji:"ÑÐ¼Ð¾Ð´Ð·Ð¸",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO Ð´Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ",date:"ISO Ð´Ð°Ñ‚Ð°",time:"ISO Ð²Ñ€ÐµÐ¼Ñ",duration:"ISO Ð´Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ",ipv4:"IPv4 Ð°Ð´Ñ€ÐµÑ",ipv6:"IPv6 Ð°Ð´Ñ€ÐµÑ",cidrv4:"IPv4 Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½",cidrv6:"IPv6 Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½",base64:"ÑÑ‚Ñ€Ð¾ÐºÐ° Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ base64",base64url:"ÑÑ‚Ñ€Ð¾ÐºÐ° Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ base64url",json_string:"JSON ÑÑ‚Ñ€Ð¾ÐºÐ°",e164:"Ð½Ð¾Ð¼ÐµÑ€ E.164",jwt:"JWT",template_literal:"Ð²Ð²Ð¾Ð´"};return r=>{switch(r.code){case"invalid_type":return`ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ð²Ð²Ð¾Ð´: Ð¾Ð¶Ð¸Ð´Ð°Ð»Ð¾ÑÑŒ ${r.expected}, Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¾ ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"Ñ‡Ð¸ÑÐ»Ð¾";case"object":if(Array.isArray(e))return"Ð¼Ð°ÑÑÐ¸Ð²";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ð²Ð²Ð¾Ð´: Ð¾Ð¶Ð¸Ð´Ð°Ð»Ð¾ÑÑŒ ${s.stringifyPrimitive(r.values[0])}`;return`ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚: Ð¾Ð¶Ð¸Ð´Ð°Ð»Ð¾ÑÑŒ Ð¾Ð´Ð½Ð¾ Ð¸Ð· ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n){let e=o(Number(r.maximum),n.unit.one,n.unit.few,n.unit.many);return`Ð¡Ð»Ð¸ÑˆÐºÐ¾Ð¼ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ: Ð¾Ð¶Ð¸Ð´Ð°Ð»Ð¾ÑÑŒ, Ñ‡Ñ‚Ð¾ ${r.origin??"Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ"} Ð±ÑƒÐ´ÐµÑ‚ Ð¸Ð¼ÐµÑ‚ÑŒ ${t}${r.maximum.toString()} ${e}`}return`Ð¡Ð»Ð¸ÑˆÐºÐ¾Ð¼ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ: Ð¾Ð¶Ð¸Ð´Ð°Ð»Ð¾ÑÑŒ, Ñ‡Ñ‚Ð¾ ${r.origin??"Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ"} Ð±ÑƒÐ´ÐµÑ‚ ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n){let e=o(Number(r.minimum),n.unit.one,n.unit.few,n.unit.many);return`Ð¡Ð»Ð¸ÑˆÐºÐ¾Ð¼ Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ: Ð¾Ð¶Ð¸Ð´Ð°Ð»Ð¾ÑÑŒ, Ñ‡Ñ‚Ð¾ ${r.origin} Ð±ÑƒÐ´ÐµÑ‚ Ð¸Ð¼ÐµÑ‚ÑŒ ${t}${r.minimum.toString()} ${e}`}return`Ð¡Ð»Ð¸ÑˆÐºÐ¾Ð¼ Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ: Ð¾Ð¶Ð¸Ð´Ð°Ð»Ð¾ÑÑŒ, Ñ‡Ñ‚Ð¾ ${r.origin} Ð±ÑƒÐ´ÐµÑ‚ ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`ÐÐµÐ²ÐµÑ€Ð½Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ°: Ð´Ð¾Ð»Ð¶Ð½Ð° Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ‚ÑŒÑÑ Ñ "${r.prefix}"`;if("ends_with"===r.format)return`ÐÐµÐ²ÐµÑ€Ð½Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ°: Ð´Ð¾Ð»Ð¶Ð½Ð° Ð·Ð°ÐºÐ°Ð½Ñ‡Ð¸Ð²Ð°Ñ‚ÑŒÑÑ Ð½Ð° "${r.suffix}"`;if("includes"===r.format)return`ÐÐµÐ²ÐµÑ€Ð½Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ°: Ð´Ð¾Ð»Ð¶Ð½Ð° ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ "${r.includes}"`;if("regex"===r.format)return`ÐÐµÐ²ÐµÑ€Ð½Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ°: Ð´Ð¾Ð»Ð¶Ð½Ð° ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñƒ ${r.pattern}`;return`ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ ${t[r.format]??r.format}`;case"not_multiple_of":return`ÐÐµÐ²ÐµÑ€Ð½Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾: Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ ÐºÑ€Ð°Ñ‚Ð½Ñ‹Ð¼ ${r.divisor}`;case"unrecognized_keys":return`ÐÐµÑ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð½Ð½${r.keys.length>1?"Ñ‹Ðµ":"Ñ‹Ð¹"} ÐºÐ»ÑŽÑ‡${r.keys.length>1?"Ð¸":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡ Ð² ${r.origin}`;case"invalid_union":return"ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ðµ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ";case"invalid_element":return`ÐÐµÐ²ÐµÑ€Ð½Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð² ${r.origin}`;default:return`ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ðµ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ`}}})()}};let s=a(e.r(25896));function o(e,t,r,n){let i=Math.abs(e),a=i%10,s=i%100;return s>=11&&s<=19?n:1===a?t:a>=2&&a<=4?r:n}},58676,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"znakov",verb:"imeti"},file:{unit:"bajtov",verb:"imeti"},array:{unit:"elementov",verb:"imeti"},set:{unit:"elementov",verb:"imeti"}},t={regex:"vnos",email:"e-poÅ¡tni naslov",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum in Äas",date:"ISO datum",time:"ISO Äas",duration:"ISO trajanje",ipv4:"IPv4 naslov",ipv6:"IPv6 naslov",cidrv4:"obseg IPv4",cidrv6:"obseg IPv6",base64:"base64 kodiran niz",base64url:"base64url kodiran niz",json_string:"JSON niz",e164:"E.164 Å¡tevilka",jwt:"JWT",template_literal:"vnos"};return r=>{switch(r.code){case"invalid_type":return`Neveljaven vnos: priÄakovano ${r.expected}, prejeto ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"Å¡tevilo";case"object":if(Array.isArray(e))return"tabela";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Neveljaven vnos: priÄakovano ${s.stringifyPrimitive(r.values[0])}`;return`Neveljavna moÅ¾nost: priÄakovano eno izmed ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Preveliko: priÄakovano, da bo ${r.origin??"vrednost"} imelo ${t}${r.maximum.toString()} ${n.unit??"elementov"}`;return`Preveliko: priÄakovano, da bo ${r.origin??"vrednost"} ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Premajhno: priÄakovano, da bo ${r.origin} imelo ${t}${r.minimum.toString()} ${n.unit}`;return`Premajhno: priÄakovano, da bo ${r.origin} ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Neveljaven niz: mora se zaÄeti z "${r.prefix}"`;if("ends_with"===r.format)return`Neveljaven niz: mora se konÄati z "${r.suffix}"`;if("includes"===r.format)return`Neveljaven niz: mora vsebovati "${r.includes}"`;if("regex"===r.format)return`Neveljaven niz: mora ustrezati vzorcu ${r.pattern}`;return`Neveljaven ${t[r.format]??r.format}`;case"not_multiple_of":return`Neveljavno Å¡tevilo: mora biti veÄkratnik ${r.divisor}`;case"unrecognized_keys":return`Neprepoznan${r.keys.length>1?"i kljuÄi":" kljuÄ"}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Neveljaven kljuÄ v ${r.origin}`;case"invalid_union":default:return"Neveljaven vnos";case"invalid_element":return`Neveljavna vrednost v ${r.origin}`}}})()}};let s=a(e.r(25896))},37994,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"tecken",verb:"att ha"},file:{unit:"bytes",verb:"att ha"},array:{unit:"objekt",verb:"att innehÃ¥lla"},set:{unit:"objekt",verb:"att innehÃ¥lla"}},t={regex:"reguljÃ¤rt uttryck",email:"e-postadress",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datum och tid",date:"ISO-datum",time:"ISO-tid",duration:"ISO-varaktighet",ipv4:"IPv4-intervall",ipv6:"IPv6-intervall",cidrv4:"IPv4-spektrum",cidrv6:"IPv6-spektrum",base64:"base64-kodad strÃ¤ng",base64url:"base64url-kodad strÃ¤ng",json_string:"JSON-strÃ¤ng",e164:"E.164-nummer",jwt:"JWT",template_literal:"mall-literal"};return r=>{switch(r.code){case"invalid_type":return`Ogiltig inmatning: f\xf6rv\xe4ntat ${r.expected}, fick ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"antal";case"object":if(Array.isArray(e))return"lista";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Ogiltig inmatning: f\xf6rv\xe4ntat ${s.stringifyPrimitive(r.values[0])}`;return`Ogiltigt val: f\xf6rv\xe4ntade en av ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`F\xf6r stor(t): f\xf6rv\xe4ntade ${r.origin??"vÃ¤rdet"} att ha ${t}${r.maximum.toString()} ${n.unit??"element"}`;return`F\xf6r stor(t): f\xf6rv\xe4ntat ${r.origin??"vÃ¤rdet"} att ha ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`F\xf6r lite(t): f\xf6rv\xe4ntade ${r.origin??"vÃ¤rdet"} att ha ${t}${r.minimum.toString()} ${n.unit}`;return`F\xf6r lite(t): f\xf6rv\xe4ntade ${r.origin??"vÃ¤rdet"} att ha ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Ogiltig str\xe4ng: m\xe5ste b\xf6rja med "${r.prefix}"`;if("ends_with"===r.format)return`Ogiltig str\xe4ng: m\xe5ste sluta med "${r.suffix}"`;if("includes"===r.format)return`Ogiltig str\xe4ng: m\xe5ste inneh\xe5lla "${r.includes}"`;if("regex"===r.format)return`Ogiltig str\xe4ng: m\xe5ste matcha m\xf6nstret "${r.pattern}"`;return`Ogiltig(t) ${t[r.format]??r.format}`;case"not_multiple_of":return`Ogiltigt tal: m\xe5ste vara en multipel av ${r.divisor}`;case"unrecognized_keys":return`${r.keys.length>1?"OkÃ¤nda nycklar":"OkÃ¤nd nyckel"}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Ogiltig nyckel i ${r.origin??"vÃ¤rdet"}`;case"invalid_union":default:return"Ogiltig input";case"invalid_element":return`Ogiltigt v\xe4rde i ${r.origin??"vÃ¤rdet"}`}}})()}};let s=a(e.r(25896))},84424,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"à®Žà®´à¯à®¤à¯à®¤à¯à®•à¯à®•à®³à¯",verb:"à®•à¯Šà®£à¯à®Ÿà®¿à®°à¯à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯"},file:{unit:"à®ªà¯ˆà®Ÿà¯à®Ÿà¯à®•à®³à¯",verb:"à®•à¯Šà®£à¯à®Ÿà®¿à®°à¯à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯"},array:{unit:"à®‰à®±à¯à®ªà¯à®ªà¯à®•à®³à¯",verb:"à®•à¯Šà®£à¯à®Ÿà®¿à®°à¯à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯"},set:{unit:"à®‰à®±à¯à®ªà¯à®ªà¯à®•à®³à¯",verb:"à®•à¯Šà®£à¯à®Ÿà®¿à®°à¯à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯"}},t={regex:"à®‰à®³à¯à®³à¯€à®Ÿà¯",email:"à®®à®¿à®©à¯à®©à®žà¯à®šà®²à¯ à®®à¯à®•à®µà®°à®¿",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO à®¤à¯‡à®¤à®¿ à®¨à¯‡à®°à®®à¯",date:"ISO à®¤à¯‡à®¤à®¿",time:"ISO à®¨à¯‡à®°à®®à¯",duration:"ISO à®•à®¾à®² à®…à®³à®µà¯",ipv4:"IPv4 à®®à¯à®•à®µà®°à®¿",ipv6:"IPv6 à®®à¯à®•à®µà®°à®¿",cidrv4:"IPv4 à®µà®°à®®à¯à®ªà¯",cidrv6:"IPv6 à®µà®°à®®à¯à®ªà¯",base64:"base64-encoded à®šà®°à®®à¯",base64url:"base64url-encoded à®šà®°à®®à¯",json_string:"JSON à®šà®°à®®à¯",e164:"E.164 à®Žà®£à¯",jwt:"JWT",template_literal:"input"};return r=>{switch(r.code){case"invalid_type":return`à®¤à®µà®±à®¾à®© à®‰à®³à¯à®³à¯€à®Ÿà¯: à®Žà®¤à®¿à®°à¯à®ªà®¾à®°à¯à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯ ${r.expected}, à®ªà¯†à®±à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯ ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"à®Žà®£à¯ à®…à®²à¯à®²à®¾à®¤à®¤à¯":"à®Žà®£à¯";case"object":if(Array.isArray(e))return"à®…à®£à®¿";if(null===e)return"à®µà¯†à®±à¯à®®à¯ˆ";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`à®¤à®µà®±à®¾à®© à®‰à®³à¯à®³à¯€à®Ÿà¯: à®Žà®¤à®¿à®°à¯à®ªà®¾à®°à¯à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯ ${s.stringifyPrimitive(r.values[0])}`;return`à®¤à®µà®±à®¾à®© à®µà®¿à®°à¯à®ªà¯à®ªà®®à¯: à®Žà®¤à®¿à®°à¯à®ªà®¾à®°à¯à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯ ${s.joinValues(r.values,"|")} à®‡à®²à¯ à®’à®©à¯à®±à¯`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`à®®à®¿à®• à®ªà¯†à®°à®¿à®¯à®¤à¯: à®Žà®¤à®¿à®°à¯à®ªà®¾à®°à¯à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯ ${r.origin??"à®®à®¤à®¿à®ªà¯à®ªà¯"} ${t}${r.maximum.toString()} ${n.unit??"à®‰à®±à¯à®ªà¯à®ªà¯à®•à®³à¯"} à®†à®• à®‡à®°à¯à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯`;return`à®®à®¿à®• à®ªà¯†à®°à®¿à®¯à®¤à¯: à®Žà®¤à®¿à®°à¯à®ªà®¾à®°à¯à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯ ${r.origin??"à®®à®¤à®¿à®ªà¯à®ªà¯"} ${t}${r.maximum.toString()} à®†à®• à®‡à®°à¯à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`à®®à®¿à®•à®šà¯ à®šà®¿à®±à®¿à®¯à®¤à¯: à®Žà®¤à®¿à®°à¯à®ªà®¾à®°à¯à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯ ${r.origin} ${t}${r.minimum.toString()} ${n.unit} à®†à®• à®‡à®°à¯à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯`;return`à®®à®¿à®•à®šà¯ à®šà®¿à®±à®¿à®¯à®¤à¯: à®Žà®¤à®¿à®°à¯à®ªà®¾à®°à¯à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯ ${r.origin} ${t}${r.minimum.toString()} à®†à®• à®‡à®°à¯à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯`}case"invalid_format":if("starts_with"===r.format)return`à®¤à®µà®±à®¾à®© à®šà®°à®®à¯: "${r.prefix}" à®‡à®²à¯ à®¤à¯Šà®Ÿà®™à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯`;if("ends_with"===r.format)return`à®¤à®µà®±à®¾à®© à®šà®°à®®à¯: "${r.suffix}" à®‡à®²à¯ à®®à¯à®Ÿà®¿à®µà®Ÿà¯ˆà®¯ à®µà¯‡à®£à¯à®Ÿà¯à®®à¯`;if("includes"===r.format)return`à®¤à®µà®±à®¾à®© à®šà®°à®®à¯: "${r.includes}" à® à®‰à®³à¯à®³à®Ÿà®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯`;if("regex"===r.format)return`à®¤à®µà®±à®¾à®© à®šà®°à®®à¯: ${r.pattern} à®®à¯à®±à¯ˆà®ªà®¾à®Ÿà¯à®Ÿà¯à®Ÿà®©à¯ à®ªà¯Šà®°à¯à®¨à¯à®¤ à®µà¯‡à®£à¯à®Ÿà¯à®®à¯`;return`à®¤à®µà®±à®¾à®© ${t[r.format]??r.format}`;case"not_multiple_of":return`à®¤à®µà®±à®¾à®© à®Žà®£à¯: ${r.divisor} à®‡à®©à¯ à®ªà®²à®®à®¾à®• à®‡à®°à¯à®•à¯à®• à®µà¯‡à®£à¯à®Ÿà¯à®®à¯`;case"unrecognized_keys":return`à®…à®Ÿà¯ˆà®¯à®¾à®³à®®à¯ à®¤à¯†à®°à®¿à®¯à®¾à®¤ à®µà®¿à®šà¯ˆ${r.keys.length>1?"à®•à®³à¯":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`${r.origin} à®‡à®²à¯ à®¤à®µà®±à®¾à®© à®µà®¿à®šà¯ˆ`;case"invalid_union":return"à®¤à®µà®±à®¾à®© à®‰à®³à¯à®³à¯€à®Ÿà¯";case"invalid_element":return`${r.origin} à®‡à®²à¯ à®¤à®µà®±à®¾à®© à®®à®¤à®¿à®ªà¯à®ªà¯`;default:return`à®¤à®µà®±à®¾à®© à®‰à®³à¯à®³à¯€à®Ÿà¯`}}})()}};let s=a(e.r(25896))},60613,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£",verb:"à¸„à¸§à¸£à¸¡à¸µ"},file:{unit:"à¹„à¸šà¸•à¹Œ",verb:"à¸„à¸§à¸£à¸¡à¸µ"},array:{unit:"à¸£à¸²à¸¢à¸à¸²à¸£",verb:"à¸„à¸§à¸£à¸¡à¸µ"},set:{unit:"à¸£à¸²à¸¢à¸à¸²à¸£",verb:"à¸„à¸§à¸£à¸¡à¸µ"}},t={regex:"à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸›à¹‰à¸­à¸™",email:"à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¸­à¸µà¹€à¸¡à¸¥",url:"URL",emoji:"à¸­à¸´à¹‚à¸¡à¸ˆà¸´",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"à¸§à¸±à¸™à¸—à¸µà¹ˆà¹€à¸§à¸¥à¸²à¹à¸šà¸š ISO",date:"à¸§à¸±à¸™à¸—à¸µà¹ˆà¹à¸šà¸š ISO",time:"à¹€à¸§à¸¥à¸²à¹à¸šà¸š ISO",duration:"à¸Šà¹ˆà¸§à¸‡à¹€à¸§à¸¥à¸²à¹à¸šà¸š ISO",ipv4:"à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ IPv4",ipv6:"à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ IPv6",cidrv4:"à¸Šà¹ˆà¸§à¸‡ IP à¹à¸šà¸š IPv4",cidrv6:"à¸Šà¹ˆà¸§à¸‡ IP à¹à¸šà¸š IPv6",base64:"à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹à¸šà¸š Base64",base64url:"à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹à¸šà¸š Base64 à¸ªà¸³à¸«à¸£à¸±à¸š URL",json_string:"à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹à¸šà¸š JSON",e164:"à¹€à¸šà¸­à¸£à¹Œà¹‚à¸—à¸£à¸¨à¸±à¸žà¸—à¹Œà¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸›à¸£à¸°à¹€à¸—à¸¨ (E.164)",jwt:"à¹‚à¸—à¹€à¸„à¸™ JWT",template_literal:"à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸›à¹‰à¸­à¸™"};return r=>{switch(r.code){case"invalid_type":return`à¸›à¸£à¸°à¹€à¸ à¸—à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: à¸„à¸§à¸£à¹€à¸›à¹‡à¸™ ${r.expected} à¹à¸•à¹ˆà¹„à¸”à¹‰à¸£à¸±à¸š ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆà¸•à¸±à¸§à¹€à¸¥à¸‚ (NaN)":"à¸•à¸±à¸§à¹€à¸¥à¸‚";case"object":if(Array.isArray(e))return"à¸­à¸²à¸£à¹Œà¹€à¸£à¸¢à¹Œ (Array)";if(null===e)return"à¹„à¸¡à¹ˆà¸¡à¸µà¸„à¹ˆà¸² (null)";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`à¸„à¹ˆà¸²à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: à¸„à¸§à¸£à¹€à¸›à¹‡à¸™ ${s.stringifyPrimitive(r.values[0])}`;return`à¸•à¸±à¸§à¹€à¸¥à¸·à¸­à¸à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: à¸„à¸§à¸£à¹€à¸›à¹‡à¸™à¸«à¸™à¸¶à¹ˆà¸‡à¹ƒà¸™ ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"à¹„à¸¡à¹ˆà¹€à¸à¸´à¸™":"à¸™à¹‰à¸­à¸¢à¸à¸§à¹ˆà¸²",n=e[r.origin]??null;if(n)return`à¹€à¸à¸´à¸™à¸à¸³à¸«à¸™à¸”: ${r.origin??"à¸„à¹ˆà¸²"} à¸„à¸§à¸£à¸¡à¸µ${t} ${r.maximum.toString()} ${n.unit??"à¸£à¸²à¸¢à¸à¸²à¸£"}`;return`à¹€à¸à¸´à¸™à¸à¸³à¸«à¸™à¸”: ${r.origin??"à¸„à¹ˆà¸²"} à¸„à¸§à¸£à¸¡à¸µ${t} ${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?"à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢":"à¸¡à¸²à¸à¸à¸§à¹ˆà¸²",n=e[r.origin]??null;if(n)return`à¸™à¹‰à¸­à¸¢à¸à¸§à¹ˆà¸²à¸à¸³à¸«à¸™à¸”: ${r.origin} à¸„à¸§à¸£à¸¡à¸µ${t} ${r.minimum.toString()} ${n.unit}`;return`à¸™à¹‰à¸­à¸¢à¸à¸§à¹ˆà¸²à¸à¸³à¸«à¸™à¸”: ${r.origin} à¸„à¸§à¸£à¸¡à¸µ${t} ${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`à¸£à¸¹à¸›à¹à¸šà¸šà¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸•à¹‰à¸­à¸‡à¸‚à¸¶à¹‰à¸™à¸•à¹‰à¸™à¸”à¹‰à¸§à¸¢ "${r.prefix}"`;if("ends_with"===r.format)return`à¸£à¸¹à¸›à¹à¸šà¸šà¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸•à¹‰à¸­à¸‡à¸¥à¸‡à¸—à¹‰à¸²à¸¢à¸”à¹‰à¸§à¸¢ "${r.suffix}"`;if("includes"===r.format)return`à¸£à¸¹à¸›à¹à¸šà¸šà¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸•à¹‰à¸­à¸‡à¸¡à¸µ "${r.includes}" à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡`;if("regex"===r.format)return`à¸£à¸¹à¸›à¹à¸šà¸šà¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: à¸•à¹‰à¸­à¸‡à¸•à¸£à¸‡à¸à¸±à¸šà¸£à¸¹à¸›à¹à¸šà¸šà¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸” ${r.pattern}`;return`à¸£à¸¹à¸›à¹à¸šà¸šà¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: ${t[r.format]??r.format}`;case"not_multiple_of":return`à¸•à¸±à¸§à¹€à¸¥à¸‚à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: à¸•à¹‰à¸­à¸‡à¹€à¸›à¹‡à¸™à¸ˆà¸³à¸™à¸§à¸™à¸—à¸µà¹ˆà¸«à¸²à¸£à¸”à¹‰à¸§à¸¢ ${r.divisor} à¹„à¸”à¹‰à¸¥à¸‡à¸•à¸±à¸§`;case"unrecognized_keys":return`à¸žà¸šà¸„à¸µà¸¢à¹Œà¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸ˆà¸±à¸: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`à¸„à¸µà¸¢à¹Œà¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡à¹ƒà¸™ ${r.origin}`;case"invalid_union":return"à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: à¹„à¸¡à¹ˆà¸•à¸£à¸‡à¸à¸±à¸šà¸£à¸¹à¸›à¹à¸šà¸šà¸¢à¸¹à¹€à¸™à¸µà¸¢à¸™à¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”à¹„à¸§à¹‰";case"invalid_element":return`à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡à¹ƒà¸™ ${r.origin}`;default:return`à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡`}}})()}};let s=a(e.r(25896))},89392,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.parsedType=void 0,r.default=function(){return{localeError:(()=>{let e={string:{unit:"karakter",verb:"olmalÄ±"},file:{unit:"bayt",verb:"olmalÄ±"},array:{unit:"Ã¶ÄŸe",verb:"olmalÄ±"},set:{unit:"Ã¶ÄŸe",verb:"olmalÄ±"}},t={regex:"girdi",email:"e-posta adresi",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO tarih ve saat",date:"ISO tarih",time:"ISO saat",duration:"ISO sÃ¼re",ipv4:"IPv4 adresi",ipv6:"IPv6 adresi",cidrv4:"IPv4 aralÄ±ÄŸÄ±",cidrv6:"IPv6 aralÄ±ÄŸÄ±",base64:"base64 ile ÅŸifrelenmiÅŸ metin",base64url:"base64url ile ÅŸifrelenmiÅŸ metin",json_string:"JSON dizesi",e164:"E.164 sayÄ±sÄ±",jwt:"JWT",template_literal:"Åžablon dizesi"};return n=>{switch(n.code){case"invalid_type":return`Ge\xe7ersiz deÄŸer: beklenen ${n.expected}, alÄ±nan ${(0,r.parsedType)(n.input)}`;case"invalid_value":if(1===n.values.length)return`Ge\xe7ersiz deÄŸer: beklenen ${s.stringifyPrimitive(n.values[0])}`;return`Ge\xe7ersiz se\xe7enek: aÅŸaÄŸÄ±dakilerden biri olmalÄ±: ${s.joinValues(n.values,"|")}`;case"too_big":{let t=n.inclusive?"<=":"<",r=e[n.origin]??null;if(r)return`\xc7ok b\xfcy\xfck: beklenen ${n.origin??"deÄŸer"} ${t}${n.maximum.toString()} ${r.unit??"Ã¶ÄŸe"}`;return`\xc7ok b\xfcy\xfck: beklenen ${n.origin??"deÄŸer"} ${t}${n.maximum.toString()}`}case"too_small":{let t=n.inclusive?">=":">",r=e[n.origin]??null;if(r)return`\xc7ok k\xfc\xe7\xfck: beklenen ${n.origin} ${t}${n.minimum.toString()} ${r.unit}`;return`\xc7ok k\xfc\xe7\xfck: beklenen ${n.origin} ${t}${n.minimum.toString()}`}case"invalid_format":if("starts_with"===n.format)return`Ge\xe7ersiz metin: "${n.prefix}" ile baÅŸlamalÄ±`;if("ends_with"===n.format)return`Ge\xe7ersiz metin: "${n.suffix}" ile bitmeli`;if("includes"===n.format)return`Ge\xe7ersiz metin: "${n.includes}" i\xe7ermeli`;if("regex"===n.format)return`Ge\xe7ersiz metin: ${n.pattern} desenine uymalÄ±`;return`Ge\xe7ersiz ${t[n.format]??n.format}`;case"not_multiple_of":return`Ge\xe7ersiz sayÄ±: ${n.divisor} ile tam b\xf6l\xfcnebilmeli`;case"unrecognized_keys":return`TanÄ±nmayan anahtar${n.keys.length>1?"lar":""}: ${s.joinValues(n.keys,", ")}`;case"invalid_key":return`${n.origin} i\xe7inde ge\xe7ersiz anahtar`;case"invalid_union":return"GeÃ§ersiz deÄŸer";case"invalid_element":return`${n.origin} i\xe7inde ge\xe7ersiz deÄŸer`;default:return`Ge\xe7ersiz deÄŸer`}}})()}};let s=a(e.r(25896));r.parsedType=e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t}},66808,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"ÑÐ¸Ð¼Ð²Ð¾Ð»Ñ–Ð²",verb:"Ð¼Ð°Ñ‚Ð¸Ð¼Ðµ"},file:{unit:"Ð±Ð°Ð¹Ñ‚Ñ–Ð²",verb:"Ð¼Ð°Ñ‚Ð¸Ð¼Ðµ"},array:{unit:"ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ–Ð²",verb:"Ð¼Ð°Ñ‚Ð¸Ð¼Ðµ"},set:{unit:"ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ–Ð²",verb:"Ð¼Ð°Ñ‚Ð¸Ð¼Ðµ"}},t={regex:"Ð²Ñ…Ñ–Ð´Ð½Ñ– Ð´Ð°Ð½Ñ–",email:"Ð°Ð´Ñ€ÐµÑÐ° ÐµÐ»ÐµÐºÑ‚Ñ€Ð¾Ð½Ð½Ð¾Ñ— Ð¿Ð¾ÑˆÑ‚Ð¸",url:"URL",emoji:"ÐµÐ¼Ð¾Ð´Ð·Ñ–",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"Ð´Ð°Ñ‚Ð° Ñ‚Ð° Ñ‡Ð°Ñ ISO",date:"Ð´Ð°Ñ‚Ð° ISO",time:"Ñ‡Ð°Ñ ISO",duration:"Ñ‚Ñ€Ð¸Ð²Ð°Ð»Ñ–ÑÑ‚ÑŒ ISO",ipv4:"Ð°Ð´Ñ€ÐµÑÐ° IPv4",ipv6:"Ð°Ð´Ñ€ÐµÑÐ° IPv6",cidrv4:"Ð´Ñ–Ð°Ð¿Ð°Ð·Ð¾Ð½ IPv4",cidrv6:"Ð´Ñ–Ð°Ð¿Ð°Ð·Ð¾Ð½ IPv6",base64:"Ñ€ÑÐ´Ð¾Ðº Ñƒ ÐºÐ¾Ð´ÑƒÐ²Ð°Ð½Ð½Ñ– base64",base64url:"Ñ€ÑÐ´Ð¾Ðº Ñƒ ÐºÐ¾Ð´ÑƒÐ²Ð°Ð½Ð½Ñ– base64url",json_string:"Ñ€ÑÐ´Ð¾Ðº JSON",e164:"Ð½Ð¾Ð¼ÐµÑ€ E.164",jwt:"JWT",template_literal:"Ð²Ñ…Ñ–Ð´Ð½Ñ– Ð´Ð°Ð½Ñ–"};return r=>{switch(r.code){case"invalid_type":return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ– Ð²Ñ…Ñ–Ð´Ð½Ñ– Ð´Ð°Ð½Ñ–: Ð¾Ñ‡Ñ–ÐºÑƒÑ”Ñ‚ÑŒÑÑ ${r.expected}, Ð¾Ñ‚Ñ€Ð¸Ð¼Ð°Ð½Ð¾ ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"Ñ‡Ð¸ÑÐ»Ð¾";case"object":if(Array.isArray(e))return"Ð¼Ð°ÑÐ¸Ð²";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ– Ð²Ñ…Ñ–Ð´Ð½Ñ– Ð´Ð°Ð½Ñ–: Ð¾Ñ‡Ñ–ÐºÑƒÑ”Ñ‚ÑŒÑÑ ${s.stringifyPrimitive(r.values[0])}`;return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð° Ð¾Ð¿Ñ†Ñ–Ñ: Ð¾Ñ‡Ñ–ÐºÑƒÑ”Ñ‚ÑŒÑÑ Ð¾Ð´Ð½Ðµ Ð· ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Ð—Ð°Ð½Ð°Ð´Ñ‚Ð¾ Ð²ÐµÐ»Ð¸ÐºÐµ: Ð¾Ñ‡Ñ–ÐºÑƒÑ”Ñ‚ÑŒÑÑ, Ñ‰Ð¾ ${r.origin??"Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ"} ${n.verb} ${t}${r.maximum.toString()} ${n.unit??"ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ–Ð²"}`;return`Ð—Ð°Ð½Ð°Ð´Ñ‚Ð¾ Ð²ÐµÐ»Ð¸ÐºÐµ: Ð¾Ñ‡Ñ–ÐºÑƒÑ”Ñ‚ÑŒÑÑ, Ñ‰Ð¾ ${r.origin??"Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ"} Ð±ÑƒÐ´Ðµ ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Ð—Ð°Ð½Ð°Ð´Ñ‚Ð¾ Ð¼Ð°Ð»Ðµ: Ð¾Ñ‡Ñ–ÐºÑƒÑ”Ñ‚ÑŒÑÑ, Ñ‰Ð¾ ${r.origin} ${n.verb} ${t}${r.minimum.toString()} ${n.unit}`;return`Ð—Ð°Ð½Ð°Ð´Ñ‚Ð¾ Ð¼Ð°Ð»Ðµ: Ð¾Ñ‡Ñ–ÐºÑƒÑ”Ñ‚ÑŒÑÑ, Ñ‰Ð¾ ${r.origin} Ð±ÑƒÐ´Ðµ ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¸Ð¹ Ñ€ÑÐ´Ð¾Ðº: Ð¿Ð¾Ð²Ð¸Ð½ÐµÐ½ Ð¿Ð¾Ñ‡Ð¸Ð½Ð°Ñ‚Ð¸ÑÑ Ð· "${r.prefix}"`;if("ends_with"===r.format)return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¸Ð¹ Ñ€ÑÐ´Ð¾Ðº: Ð¿Ð¾Ð²Ð¸Ð½ÐµÐ½ Ð·Ð°ÐºÑ–Ð½Ñ‡ÑƒÐ²Ð°Ñ‚Ð¸ÑÑ Ð½Ð° "${r.suffix}"`;if("includes"===r.format)return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¸Ð¹ Ñ€ÑÐ´Ð¾Ðº: Ð¿Ð¾Ð²Ð¸Ð½ÐµÐ½ Ð¼Ñ–ÑÑ‚Ð¸Ñ‚Ð¸ "${r.includes}"`;if("regex"===r.format)return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¸Ð¹ Ñ€ÑÐ´Ð¾Ðº: Ð¿Ð¾Ð²Ð¸Ð½ÐµÐ½ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ð°Ñ‚Ð¸ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñƒ ${r.pattern}`;return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¸Ð¹ ${t[r.format]??r.format}`;case"not_multiple_of":return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ðµ Ñ‡Ð¸ÑÐ»Ð¾: Ð¿Ð¾Ð²Ð¸Ð½Ð½Ð¾ Ð±ÑƒÑ‚Ð¸ ÐºÑ€Ð°Ñ‚Ð½Ð¸Ð¼ ${r.divisor}`;case"unrecognized_keys":return`ÐÐµÑ€Ð¾Ð·Ð¿Ñ–Ð·Ð½Ð°Ð½Ð¸Ð¹ ÐºÐ»ÑŽÑ‡${r.keys.length>1?"Ñ–":""}: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¸Ð¹ ÐºÐ»ÑŽÑ‡ Ñƒ ${r.origin}`;case"invalid_union":return"ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ– Ð²Ñ…Ñ–Ð´Ð½Ñ– Ð´Ð°Ð½Ñ–";case"invalid_element":return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ Ñƒ ${r.origin}`;default:return`ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ– Ð²Ñ…Ñ–Ð´Ð½Ñ– Ð´Ð°Ð½Ñ–`}}})()}};let s=a(e.r(25896))},32014,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"Ø­Ø±ÙˆÙ",verb:"ÛÙˆÙ†Ø§"},file:{unit:"Ø¨Ø§Ø¦Ù¹Ø³",verb:"ÛÙˆÙ†Ø§"},array:{unit:"Ø¢Ø¦Ù¹Ù…Ø²",verb:"ÛÙˆÙ†Ø§"},set:{unit:"Ø¢Ø¦Ù¹Ù…Ø²",verb:"ÛÙˆÙ†Ø§"}},t={regex:"Ø§Ù† Ù¾Ù¹",email:"Ø§ÛŒ Ù…ÛŒÙ„ Ø§ÛŒÚˆØ±ÛŒØ³",url:"ÛŒÙˆ Ø¢Ø± Ø§ÛŒÙ„",emoji:"Ø§ÛŒÙ…ÙˆØ¬ÛŒ",uuid:"ÛŒÙˆ ÛŒÙˆ Ø¢Ø¦ÛŒ ÚˆÛŒ",uuidv4:"ÛŒÙˆ ÛŒÙˆ Ø¢Ø¦ÛŒ ÚˆÛŒ ÙˆÛŒ 4",uuidv6:"ÛŒÙˆ ÛŒÙˆ Ø¢Ø¦ÛŒ ÚˆÛŒ ÙˆÛŒ 6",nanoid:"Ù†ÛŒÙ†Ùˆ Ø¢Ø¦ÛŒ ÚˆÛŒ",guid:"Ø¬ÛŒ ÛŒÙˆ Ø¢Ø¦ÛŒ ÚˆÛŒ",cuid:"Ø³ÛŒ ÛŒÙˆ Ø¢Ø¦ÛŒ ÚˆÛŒ",cuid2:"Ø³ÛŒ ÛŒÙˆ Ø¢Ø¦ÛŒ ÚˆÛŒ 2",ulid:"ÛŒÙˆ Ø§ÛŒÙ„ Ø¢Ø¦ÛŒ ÚˆÛŒ",xid:"Ø§ÛŒÚ©Ø³ Ø¢Ø¦ÛŒ ÚˆÛŒ",ksuid:"Ú©Û’ Ø§ÛŒØ³ ÛŒÙˆ Ø¢Ø¦ÛŒ ÚˆÛŒ",datetime:"Ø¢Ø¦ÛŒ Ø§ÛŒØ³ Ø§Ùˆ ÚˆÛŒÙ¹ Ù¹Ø§Ø¦Ù…",date:"Ø¢Ø¦ÛŒ Ø§ÛŒØ³ Ø§Ùˆ ØªØ§Ø±ÛŒØ®",time:"Ø¢Ø¦ÛŒ Ø§ÛŒØ³ Ø§Ùˆ ÙˆÙ‚Øª",duration:"Ø¢Ø¦ÛŒ Ø§ÛŒØ³ Ø§Ùˆ Ù…Ø¯Øª",ipv4:"Ø¢Ø¦ÛŒ Ù¾ÛŒ ÙˆÛŒ 4 Ø§ÛŒÚˆØ±ÛŒØ³",ipv6:"Ø¢Ø¦ÛŒ Ù¾ÛŒ ÙˆÛŒ 6 Ø§ÛŒÚˆØ±ÛŒØ³",cidrv4:"Ø¢Ø¦ÛŒ Ù¾ÛŒ ÙˆÛŒ 4 Ø±ÛŒÙ†Ø¬",cidrv6:"Ø¢Ø¦ÛŒ Ù¾ÛŒ ÙˆÛŒ 6 Ø±ÛŒÙ†Ø¬",base64:"Ø¨ÛŒØ³ 64 Ø§Ù† Ú©ÙˆÚˆÚˆ Ø³Ù¹Ø±Ù†Ú¯",base64url:"Ø¨ÛŒØ³ 64 ÛŒÙˆ Ø¢Ø± Ø§ÛŒÙ„ Ø§Ù† Ú©ÙˆÚˆÚˆ Ø³Ù¹Ø±Ù†Ú¯",json_string:"Ø¬Û’ Ø§ÛŒØ³ Ø§Ùˆ Ø§ÛŒÙ† Ø³Ù¹Ø±Ù†Ú¯",e164:"Ø§ÛŒ 164 Ù†Ù…Ø¨Ø±",jwt:"Ø¬Û’ ÚˆØ¨Ù„ÛŒÙˆ Ù¹ÛŒ",template_literal:"Ø§Ù† Ù¾Ù¹"};return r=>{switch(r.code){case"invalid_type":return`ØºÙ„Ø· Ø§Ù† Ù¾Ù¹: ${r.expected} Ù…ØªÙˆÙ‚Ø¹ ØªÚ¾Ø§ØŒ ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"Ù†Ù…Ø¨Ø±";case"object":if(Array.isArray(e))return"Ø¢Ø±Û’";if(null===e)return"Ù†Ù„";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)} Ù…ÙˆØµÙˆÙ„ ÛÙˆØ§`;case"invalid_value":if(1===r.values.length)return`ØºÙ„Ø· Ø§Ù† Ù¾Ù¹: ${s.stringifyPrimitive(r.values[0])} Ù…ØªÙˆÙ‚Ø¹ ØªÚ¾Ø§`;return`ØºÙ„Ø· Ø¢Ù¾Ø´Ù†: ${s.joinValues(r.values,"|")} Ù…ÛŒÚº Ø³Û’ Ø§ÛŒÚ© Ù…ØªÙˆÙ‚Ø¹ ØªÚ¾Ø§`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Ø¨ÛØª Ø¨Ú‘Ø§: ${r.origin??"ÙˆÛŒÙ„ÛŒÙˆ"} Ú©Û’ ${t}${r.maximum.toString()} ${n.unit??"Ø¹Ù†Ø§ØµØ±"} ÛÙˆÙ†Û’ Ù…ØªÙˆÙ‚Ø¹ ØªÚ¾Û’`;return`Ø¨ÛØª Ø¨Ú‘Ø§: ${r.origin??"ÙˆÛŒÙ„ÛŒÙˆ"} Ú©Ø§ ${t}${r.maximum.toString()} ÛÙˆÙ†Ø§ Ù…ØªÙˆÙ‚Ø¹ ØªÚ¾Ø§`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Ø¨ÛØª Ú†Ú¾ÙˆÙ¹Ø§: ${r.origin} Ú©Û’ ${t}${r.minimum.toString()} ${n.unit} ÛÙˆÙ†Û’ Ù…ØªÙˆÙ‚Ø¹ ØªÚ¾Û’`;return`Ø¨ÛØª Ú†Ú¾ÙˆÙ¹Ø§: ${r.origin} Ú©Ø§ ${t}${r.minimum.toString()} ÛÙˆÙ†Ø§ Ù…ØªÙˆÙ‚Ø¹ ØªÚ¾Ø§`}case"invalid_format":if("starts_with"===r.format)return`ØºÙ„Ø· Ø³Ù¹Ø±Ù†Ú¯: "${r.prefix}" Ø³Û’ Ø´Ø±ÙˆØ¹ ÛÙˆÙ†Ø§ Ú†Ø§ÛÛŒÛ’`;if("ends_with"===r.format)return`ØºÙ„Ø· Ø³Ù¹Ø±Ù†Ú¯: "${r.suffix}" Ù¾Ø± Ø®ØªÙ… ÛÙˆÙ†Ø§ Ú†Ø§ÛÛŒÛ’`;if("includes"===r.format)return`ØºÙ„Ø· Ø³Ù¹Ø±Ù†Ú¯: "${r.includes}" Ø´Ø§Ù…Ù„ ÛÙˆÙ†Ø§ Ú†Ø§ÛÛŒÛ’`;if("regex"===r.format)return`ØºÙ„Ø· Ø³Ù¹Ø±Ù†Ú¯: Ù¾ÛŒÙ¹Ø±Ù† ${r.pattern} Ø³Û’ Ù…ÛŒÚ† ÛÙˆÙ†Ø§ Ú†Ø§ÛÛŒÛ’`;return`ØºÙ„Ø· ${t[r.format]??r.format}`;case"not_multiple_of":return`ØºÙ„Ø· Ù†Ù…Ø¨Ø±: ${r.divisor} Ú©Ø§ Ù…Ø¶Ø§Ø¹Ù ÛÙˆÙ†Ø§ Ú†Ø§ÛÛŒÛ’`;case"unrecognized_keys":return`ØºÛŒØ± ØªØ³Ù„ÛŒÙ… Ø´Ø¯Û Ú©ÛŒ${r.keys.length>1?"Ø²":""}: ${s.joinValues(r.keys,"ØŒ ")}`;case"invalid_key":return`${r.origin} Ù…ÛŒÚº ØºÙ„Ø· Ú©ÛŒ`;case"invalid_union":return"ØºÙ„Ø· Ø§Ù† Ù¾Ù¹";case"invalid_element":return`${r.origin} Ù…ÛŒÚº ØºÙ„Ø· ÙˆÛŒÙ„ÛŒÙˆ`;default:return`ØºÙ„Ø· Ø§Ù† Ù¾Ù¹`}}})()}};let s=a(e.r(25896))},74332,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"kÃ½ tá»±",verb:"cÃ³"},file:{unit:"byte",verb:"cÃ³"},array:{unit:"pháº§n tá»­",verb:"cÃ³"},set:{unit:"pháº§n tá»­",verb:"cÃ³"}},t={regex:"Ä‘áº§u vÃ o",email:"Ä‘á»‹a chá»‰ email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ngÃ y giá» ISO",date:"ngÃ y ISO",time:"giá» ISO",duration:"khoáº£ng thá»i gian ISO",ipv4:"Ä‘á»‹a chá»‰ IPv4",ipv6:"Ä‘á»‹a chá»‰ IPv6",cidrv4:"dáº£i IPv4",cidrv6:"dáº£i IPv6",base64:"chuá»—i mÃ£ hÃ³a base64",base64url:"chuá»—i mÃ£ hÃ³a base64url",json_string:"chuá»—i JSON",e164:"sá»‘ E.164",jwt:"JWT",template_literal:"Ä‘áº§u vÃ o"};return r=>{switch(r.code){case"invalid_type":return`Äáº§u v\xe0o kh\xf4ng há»£p lá»‡: mong Ä‘á»£i ${r.expected}, nháº­n Ä‘Æ°á»£c ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"sá»‘";case"object":if(Array.isArray(e))return"máº£ng";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`Äáº§u v\xe0o kh\xf4ng há»£p lá»‡: mong Ä‘á»£i ${s.stringifyPrimitive(r.values[0])}`;return`T\xf9y chá»n kh\xf4ng há»£p lá»‡: mong Ä‘á»£i má»™t trong c\xe1c gi\xe1 trá»‹ ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`Qu\xe1 lá»›n: mong Ä‘á»£i ${r.origin??"giÃ¡ trá»‹"} ${n.verb} ${t}${r.maximum.toString()} ${n.unit??"pháº§n tá»­"}`;return`Qu\xe1 lá»›n: mong Ä‘á»£i ${r.origin??"giÃ¡ trá»‹"} ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`Qu\xe1 nhá»: mong Ä‘á»£i ${r.origin} ${n.verb} ${t}${r.minimum.toString()} ${n.unit}`;return`Qu\xe1 nhá»: mong Ä‘á»£i ${r.origin} ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`Chuá»—i kh\xf4ng há»£p lá»‡: pháº£i báº¯t Ä‘áº§u báº±ng "${r.prefix}"`;if("ends_with"===r.format)return`Chuá»—i kh\xf4ng há»£p lá»‡: pháº£i káº¿t th\xfac báº±ng "${r.suffix}"`;if("includes"===r.format)return`Chuá»—i kh\xf4ng há»£p lá»‡: pháº£i bao gá»“m "${r.includes}"`;if("regex"===r.format)return`Chuá»—i kh\xf4ng há»£p lá»‡: pháº£i khá»›p vá»›i máº«u ${r.pattern}`;return`${t[r.format]??r.format} kh\xf4ng há»£p lá»‡`;case"not_multiple_of":return`Sá»‘ kh\xf4ng há»£p lá»‡: pháº£i l\xe0 bá»™i sá»‘ cá»§a ${r.divisor}`;case"unrecognized_keys":return`Kh\xf3a kh\xf4ng Ä‘Æ°á»£c nháº­n dáº¡ng: ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`Kh\xf3a kh\xf4ng há»£p lá»‡ trong ${r.origin}`;case"invalid_union":return"Äáº§u vÃ o khÃ´ng há»£p lá»‡";case"invalid_element":return`Gi\xe1 trá»‹ kh\xf4ng há»£p lá»‡ trong ${r.origin}`;default:return`Äáº§u v\xe0o kh\xf4ng há»£p lá»‡`}}})()}};let s=a(e.r(25896))},16352,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"å­—ç¬¦",verb:"åŒ…å«"},file:{unit:"å­—èŠ‚",verb:"åŒ…å«"},array:{unit:"é¡¹",verb:"åŒ…å«"},set:{unit:"é¡¹",verb:"åŒ…å«"}},t={regex:"è¾“å…¥",email:"ç”µå­é‚®ä»¶",url:"URL",emoji:"è¡¨æƒ…ç¬¦å·",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISOæ—¥æœŸæ—¶é—´",date:"ISOæ—¥æœŸ",time:"ISOæ—¶é—´",duration:"ISOæ—¶é•¿",ipv4:"IPv4åœ°å€",ipv6:"IPv6åœ°å€",cidrv4:"IPv4ç½‘æ®µ",cidrv6:"IPv6ç½‘æ®µ",base64:"base64ç¼–ç å­—ç¬¦ä¸²",base64url:"base64urlç¼–ç å­—ç¬¦ä¸²",json_string:"JSONå­—ç¬¦ä¸²",e164:"E.164å·ç ",jwt:"JWT",template_literal:"è¾“å…¥"};return r=>{switch(r.code){case"invalid_type":return`æ— æ•ˆè¾“å…¥ï¼šæœŸæœ› ${r.expected}ï¼Œå®žé™…æŽ¥æ”¶ ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"éžæ•°å­—(NaN)":"æ•°å­—";case"object":if(Array.isArray(e))return"æ•°ç»„";if(null===e)return"ç©ºå€¼(null)";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`æ— æ•ˆè¾“å…¥ï¼šæœŸæœ› ${s.stringifyPrimitive(r.values[0])}`;return`æ— æ•ˆé€‰é¡¹ï¼šæœŸæœ›ä»¥ä¸‹ä¹‹ä¸€ ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`æ•°å€¼è¿‡å¤§ï¼šæœŸæœ› ${r.origin??"å€¼"} ${t}${r.maximum.toString()} ${n.unit??"ä¸ªå…ƒç´ "}`;return`æ•°å€¼è¿‡å¤§ï¼šæœŸæœ› ${r.origin??"å€¼"} ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`æ•°å€¼è¿‡å°ï¼šæœŸæœ› ${r.origin} ${t}${r.minimum.toString()} ${n.unit}`;return`æ•°å€¼è¿‡å°ï¼šæœŸæœ› ${r.origin} ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`æ— æ•ˆå­—ç¬¦ä¸²ï¼šå¿…é¡»ä»¥ "${r.prefix}" å¼€å¤´`;if("ends_with"===r.format)return`æ— æ•ˆå­—ç¬¦ä¸²ï¼šå¿…é¡»ä»¥ "${r.suffix}" ç»“å°¾`;if("includes"===r.format)return`æ— æ•ˆå­—ç¬¦ä¸²ï¼šå¿…é¡»åŒ…å« "${r.includes}"`;if("regex"===r.format)return`æ— æ•ˆå­—ç¬¦ä¸²ï¼šå¿…é¡»æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼ ${r.pattern}`;return`æ— æ•ˆ${t[r.format]??r.format}`;case"not_multiple_of":return`æ— æ•ˆæ•°å­—ï¼šå¿…é¡»æ˜¯ ${r.divisor} çš„å€æ•°`;case"unrecognized_keys":return`å‡ºçŽ°æœªçŸ¥çš„é”®(key): ${s.joinValues(r.keys,", ")}`;case"invalid_key":return`${r.origin} ä¸­çš„é”®(key)æ— æ•ˆ`;case"invalid_union":return"æ— æ•ˆè¾“å…¥";case"invalid_element":return`${r.origin} ä¸­åŒ…å«æ— æ•ˆå€¼(value)`;default:return`æ— æ•ˆè¾“å…¥`}}})()}};let s=a(e.r(25896))},7660,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return{localeError:(()=>{let e={string:{unit:"å­—å…ƒ",verb:"æ“æœ‰"},file:{unit:"ä½å…ƒçµ„",verb:"æ“æœ‰"},array:{unit:"é …ç›®",verb:"æ“æœ‰"},set:{unit:"é …ç›®",verb:"æ“æœ‰"}},t={regex:"è¼¸å…¥",email:"éƒµä»¶åœ°å€",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO æ—¥æœŸæ™‚é–“",date:"ISO æ—¥æœŸ",time:"ISO æ™‚é–“",duration:"ISO æœŸé–“",ipv4:"IPv4 ä½å€",ipv6:"IPv6 ä½å€",cidrv4:"IPv4 ç¯„åœ",cidrv6:"IPv6 ç¯„åœ",base64:"base64 ç·¨ç¢¼å­—ä¸²",base64url:"base64url ç·¨ç¢¼å­—ä¸²",json_string:"JSON å­—ä¸²",e164:"E.164 æ•¸å€¼",jwt:"JWT",template_literal:"è¼¸å…¥"};return r=>{switch(r.code){case"invalid_type":return`ç„¡æ•ˆçš„è¼¸å…¥å€¼ï¼šé æœŸç‚º ${r.expected}ï¼Œä½†æ”¶åˆ° ${(e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}return t})(r.input)}`;case"invalid_value":if(1===r.values.length)return`ç„¡æ•ˆçš„è¼¸å…¥å€¼ï¼šé æœŸç‚º ${s.stringifyPrimitive(r.values[0])}`;return`ç„¡æ•ˆçš„é¸é …ï¼šé æœŸç‚ºä»¥ä¸‹å…¶ä¸­ä¹‹ä¸€ ${s.joinValues(r.values,"|")}`;case"too_big":{let t=r.inclusive?"<=":"<",n=e[r.origin]??null;if(n)return`æ•¸å€¼éŽå¤§ï¼šé æœŸ ${r.origin??"å€¼"} æ‡‰ç‚º ${t}${r.maximum.toString()} ${n.unit??"å€‹å…ƒç´ "}`;return`æ•¸å€¼éŽå¤§ï¼šé æœŸ ${r.origin??"å€¼"} æ‡‰ç‚º ${t}${r.maximum.toString()}`}case"too_small":{let t=r.inclusive?">=":">",n=e[r.origin]??null;if(n)return`æ•¸å€¼éŽå°ï¼šé æœŸ ${r.origin} æ‡‰ç‚º ${t}${r.minimum.toString()} ${n.unit}`;return`æ•¸å€¼éŽå°ï¼šé æœŸ ${r.origin} æ‡‰ç‚º ${t}${r.minimum.toString()}`}case"invalid_format":if("starts_with"===r.format)return`ç„¡æ•ˆçš„å­—ä¸²ï¼šå¿…é ˆä»¥ "${r.prefix}" é–‹é ­`;if("ends_with"===r.format)return`ç„¡æ•ˆçš„å­—ä¸²ï¼šå¿…é ˆä»¥ "${r.suffix}" çµå°¾`;if("includes"===r.format)return`ç„¡æ•ˆçš„å­—ä¸²ï¼šå¿…é ˆåŒ…å« "${r.includes}"`;if("regex"===r.format)return`ç„¡æ•ˆçš„å­—ä¸²ï¼šå¿…é ˆç¬¦åˆæ ¼å¼ ${r.pattern}`;return`ç„¡æ•ˆçš„ ${t[r.format]??r.format}`;case"not_multiple_of":return`ç„¡æ•ˆçš„æ•¸å­—ï¼šå¿…é ˆç‚º ${r.divisor} çš„å€æ•¸`;case"unrecognized_keys":return`ç„¡æ³•è­˜åˆ¥çš„éµå€¼${r.keys.length>1?"å€‘":""}ï¼š${s.joinValues(r.keys,"ã€")}`;case"invalid_key":return`${r.origin} ä¸­æœ‰ç„¡æ•ˆçš„éµå€¼`;case"invalid_union":return"ç„¡æ•ˆçš„è¼¸å…¥å€¼";case"invalid_element":return`${r.origin} ä¸­æœ‰ç„¡æ•ˆçš„å€¼`;default:return`ç„¡æ•ˆçš„è¼¸å…¥å€¼`}}})()}};let s=a(e.r(25896))},49514,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.zhTW=r.zhCN=r.vi=r.ur=r.ua=r.tr=r.th=r.ta=r.sv=r.sl=r.ru=r.pt=r.pl=r.ps=r.ota=r.no=r.nl=r.ms=r.mk=r.ko=r.kh=r.ja=r.it=r.id=r.hu=r.he=r.frCA=r.fr=r.fi=r.fa=r.es=r.eo=r.en=r.de=r.cs=r.ca=r.be=r.az=r.ar=void 0;var i=e.r(22172);Object.defineProperty(r,"ar",{enumerable:!0,get:function(){return n(i).default}});var a=e.r(20484);Object.defineProperty(r,"az",{enumerable:!0,get:function(){return n(a).default}});var s=e.r(17397);Object.defineProperty(r,"be",{enumerable:!0,get:function(){return n(s).default}});var o=e.r(15374);Object.defineProperty(r,"ca",{enumerable:!0,get:function(){return n(o).default}});var l=e.r(76376);Object.defineProperty(r,"cs",{enumerable:!0,get:function(){return n(l).default}});var u=e.r(49888);Object.defineProperty(r,"de",{enumerable:!0,get:function(){return n(u).default}});var c=e.r(84107);Object.defineProperty(r,"en",{enumerable:!0,get:function(){return n(c).default}});var d=e.r(68939);Object.defineProperty(r,"eo",{enumerable:!0,get:function(){return n(d).default}});var p=e.r(29054);Object.defineProperty(r,"es",{enumerable:!0,get:function(){return n(p).default}});var h=e.r(2393);Object.defineProperty(r,"fa",{enumerable:!0,get:function(){return n(h).default}});var f=e.r(83747);Object.defineProperty(r,"fi",{enumerable:!0,get:function(){return n(f).default}});var m=e.r(49677);Object.defineProperty(r,"fr",{enumerable:!0,get:function(){return n(m).default}});var g=e.r(20208);Object.defineProperty(r,"frCA",{enumerable:!0,get:function(){return n(g).default}});var y=e.r(94269);Object.defineProperty(r,"he",{enumerable:!0,get:function(){return n(y).default}});var b=e.r(49693);Object.defineProperty(r,"hu",{enumerable:!0,get:function(){return n(b).default}});var _=e.r(30429);Object.defineProperty(r,"id",{enumerable:!0,get:function(){return n(_).default}});var v=e.r(66406);Object.defineProperty(r,"it",{enumerable:!0,get:function(){return n(v).default}});var w=e.r(98099);Object.defineProperty(r,"ja",{enumerable:!0,get:function(){return n(w).default}});var O=e.r(78174);Object.defineProperty(r,"kh",{enumerable:!0,get:function(){return n(O).default}});var P=e.r(51316);Object.defineProperty(r,"ko",{enumerable:!0,get:function(){return n(P).default}});var S=e.r(15367);Object.defineProperty(r,"mk",{enumerable:!0,get:function(){return n(S).default}});var E=e.r(21801);Object.defineProperty(r,"ms",{enumerable:!0,get:function(){return n(E).default}});var k=e.r(2447);Object.defineProperty(r,"nl",{enumerable:!0,get:function(){return n(k).default}});var I=e.r(87440);Object.defineProperty(r,"no",{enumerable:!0,get:function(){return n(I).default}});var A=e.r(81333);Object.defineProperty(r,"ota",{enumerable:!0,get:function(){return n(A).default}});var T=e.r(45578);Object.defineProperty(r,"ps",{enumerable:!0,get:function(){return n(T).default}});var C=e.r(12690);Object.defineProperty(r,"pl",{enumerable:!0,get:function(){return n(C).default}});var j=e.r(15573);Object.defineProperty(r,"pt",{enumerable:!0,get:function(){return n(j).default}});var x=e.r(61460);Object.defineProperty(r,"ru",{enumerable:!0,get:function(){return n(x).default}});var $=e.r(58676);Object.defineProperty(r,"sl",{enumerable:!0,get:function(){return n($).default}});var N=e.r(37994);Object.defineProperty(r,"sv",{enumerable:!0,get:function(){return n(N).default}});var R=e.r(84424);Object.defineProperty(r,"ta",{enumerable:!0,get:function(){return n(R).default}});var M=e.r(60613);Object.defineProperty(r,"th",{enumerable:!0,get:function(){return n(M).default}});var D=e.r(89392);Object.defineProperty(r,"tr",{enumerable:!0,get:function(){return n(D).default}});var L=e.r(66808);Object.defineProperty(r,"ua",{enumerable:!0,get:function(){return n(L).default}});var U=e.r(32014);Object.defineProperty(r,"ur",{enumerable:!0,get:function(){return n(U).default}});var F=e.r(74332);Object.defineProperty(r,"vi",{enumerable:!0,get:function(){return n(F).default}});var z=e.r(16352);Object.defineProperty(r,"zhCN",{enumerable:!0,get:function(){return n(z).default}});var B=e.r(7660);Object.defineProperty(r,"zhTW",{enumerable:!0,get:function(){return n(B).default}})},29531,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.globalRegistry=r.$ZodRegistry=r.$input=r.$output=void 0,r.registry=i,r.$output=Symbol("ZodOutput"),r.$input=Symbol("ZodInput");class n{constructor(){this._map=new Map,this._idmap=new Map}add(e,...t){let r=t[0];if(this._map.set(e,r),r&&"object"==typeof r&&"id"in r){if(this._idmap.has(r.id))throw Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let t=this._map.get(e);return t&&"object"==typeof t&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){let t=e._zod.parent;if(t){let r={...this.get(t)??{}};return delete r.id,{...r,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function i(){return new n}r.$ZodRegistry=n,r.globalRegistry=i()},20105,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.TimePrecision=void 0,r._string=function(e,t){return new e({type:"string",...l.normalizeParams(t)})},r._coercedString=function(e,t){return new e({type:"string",coerce:!0,...l.normalizeParams(t)})},r._email=function(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._guid=function(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._uuid=function(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._uuidv4=function(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...l.normalizeParams(t)})},r._uuidv6=function(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...l.normalizeParams(t)})},r._uuidv7=function(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...l.normalizeParams(t)})},r._url=function(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._emoji=function(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._nanoid=function(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._cuid=function(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._cuid2=function(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._ulid=function(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._xid=function(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._ksuid=function(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._ipv4=function(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._ipv6=function(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._cidrv4=function(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._cidrv6=function(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._base64=function(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._base64url=function(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._e164=function(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._jwt=function(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...l.normalizeParams(t)})},r._isoDateTime=function(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...l.normalizeParams(t)})},r._isoDate=function(e,t){return new e({type:"string",format:"date",check:"string_format",...l.normalizeParams(t)})},r._isoTime=function(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...l.normalizeParams(t)})},r._isoDuration=function(e,t){return new e({type:"string",format:"duration",check:"string_format",...l.normalizeParams(t)})},r._number=function(e,t){return new e({type:"number",checks:[],...l.normalizeParams(t)})},r._coercedNumber=function(e,t){return new e({type:"number",coerce:!0,checks:[],...l.normalizeParams(t)})},r._int=function(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...l.normalizeParams(t)})},r._float32=function(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"float32",...l.normalizeParams(t)})},r._float64=function(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"float64",...l.normalizeParams(t)})},r._int32=function(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"int32",...l.normalizeParams(t)})},r._uint32=function(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"uint32",...l.normalizeParams(t)})},r._boolean=function(e,t){return new e({type:"boolean",...l.normalizeParams(t)})},r._coercedBoolean=function(e,t){return new e({type:"boolean",coerce:!0,...l.normalizeParams(t)})},r._bigint=function(e,t){return new e({type:"bigint",...l.normalizeParams(t)})},r._coercedBigint=function(e,t){return new e({type:"bigint",coerce:!0,...l.normalizeParams(t)})},r._int64=function(e,t){return new e({type:"bigint",check:"bigint_format",abort:!1,format:"int64",...l.normalizeParams(t)})},r._uint64=function(e,t){return new e({type:"bigint",check:"bigint_format",abort:!1,format:"uint64",...l.normalizeParams(t)})},r._symbol=function(e,t){return new e({type:"symbol",...l.normalizeParams(t)})},r._undefined=function(e,t){return new e({type:"undefined",...l.normalizeParams(t)})},r._null=function(e,t){return new e({type:"null",...l.normalizeParams(t)})},r._any=function(e){return new e({type:"any"})},r._unknown=function(e){return new e({type:"unknown"})},r._never=function(e,t){return new e({type:"never",...l.normalizeParams(t)})},r._void=function(e,t){return new e({type:"void",...l.normalizeParams(t)})},r._date=function(e,t){return new e({type:"date",...l.normalizeParams(t)})},r._coercedDate=function(e,t){return new e({type:"date",coerce:!0,...l.normalizeParams(t)})},r._nan=function(e,t){return new e({type:"nan",...l.normalizeParams(t)})},r._lt=u,r._lte=c,r._max=c,r._lte=c,r._max=c,r._gt=d,r._gte=p,r._min=p,r._gte=p,r._min=p,r._positive=function(e){return d(0,e)},r._negative=function(e){return u(0,e)},r._nonpositive=function(e){return c(0,e)},r._nonnegative=function(e){return p(0,e)},r._multipleOf=function(e,t){return new s.$ZodCheckMultipleOf({check:"multiple_of",...l.normalizeParams(t),value:e})},r._maxSize=function(e,t){return new s.$ZodCheckMaxSize({check:"max_size",...l.normalizeParams(t),maximum:e})},r._minSize=function(e,t){return new s.$ZodCheckMinSize({check:"min_size",...l.normalizeParams(t),minimum:e})},r._size=function(e,t){return new s.$ZodCheckSizeEquals({check:"size_equals",...l.normalizeParams(t),size:e})},r._maxLength=function(e,t){return new s.$ZodCheckMaxLength({check:"max_length",...l.normalizeParams(t),maximum:e})},r._minLength=function(e,t){return new s.$ZodCheckMinLength({check:"min_length",...l.normalizeParams(t),minimum:e})},r._length=function(e,t){return new s.$ZodCheckLengthEquals({check:"length_equals",...l.normalizeParams(t),length:e})},r._regex=function(e,t){return new s.$ZodCheckRegex({check:"string_format",format:"regex",...l.normalizeParams(t),pattern:e})},r._lowercase=function(e){return new s.$ZodCheckLowerCase({check:"string_format",format:"lowercase",...l.normalizeParams(e)})},r._uppercase=function(e){return new s.$ZodCheckUpperCase({check:"string_format",format:"uppercase",...l.normalizeParams(e)})},r._includes=function(e,t){return new s.$ZodCheckIncludes({check:"string_format",format:"includes",...l.normalizeParams(t),includes:e})},r._startsWith=function(e,t){return new s.$ZodCheckStartsWith({check:"string_format",format:"starts_with",...l.normalizeParams(t),prefix:e})},r._endsWith=function(e,t){return new s.$ZodCheckEndsWith({check:"string_format",format:"ends_with",...l.normalizeParams(t),suffix:e})},r._property=function(e,t,r){return new s.$ZodCheckProperty({check:"property",property:e,schema:t,...l.normalizeParams(r)})},r._mime=function(e,t){return new s.$ZodCheckMimeType({check:"mime_type",mime:e,...l.normalizeParams(t)})},r._overwrite=h,r._normalize=function(e){return h(t=>t.normalize(e))},r._trim=function(){return h(e=>e.trim())},r._toLowerCase=function(){return h(e=>e.toLowerCase())},r._toUpperCase=function(){return h(e=>e.toUpperCase())},r._array=function(e,t,r){return new e({type:"array",element:t,...l.normalizeParams(r)})},r._union=function(e,t,r){return new e({type:"union",options:t,...l.normalizeParams(r)})},r._discriminatedUnion=function(e,t,r,n){return new e({type:"union",options:r,discriminator:t,...l.normalizeParams(n)})},r._intersection=function(e,t,r){return new e({type:"intersection",left:t,right:r})},r._tuple=function(e,t,r,n){let i=r instanceof o.$ZodType,a=i?n:r;return new e({type:"tuple",items:t,rest:i?r:null,...l.normalizeParams(a)})},r._record=function(e,t,r,n){return new e({type:"record",keyType:t,valueType:r,...l.normalizeParams(n)})},r._map=function(e,t,r,n){return new e({type:"map",keyType:t,valueType:r,...l.normalizeParams(n)})},r._set=function(e,t,r){return new e({type:"set",valueType:t,...l.normalizeParams(r)})},r._enum=function(e,t,r){return new e({type:"enum",entries:Array.isArray(t)?Object.fromEntries(t.map(e=>[e,e])):t,...l.normalizeParams(r)})},r._nativeEnum=function(e,t,r){return new e({type:"enum",entries:t,...l.normalizeParams(r)})},r._literal=function(e,t,r){return new e({type:"literal",values:Array.isArray(t)?t:[t],...l.normalizeParams(r)})},r._file=function(e,t){return new e({type:"file",...l.normalizeParams(t)})},r._transform=function(e,t){return new e({type:"transform",transform:t})},r._optional=function(e,t){return new e({type:"optional",innerType:t})},r._nullable=function(e,t){return new e({type:"nullable",innerType:t})},r._default=function(e,t,r){return new e({type:"default",innerType:t,get defaultValue(){return"function"==typeof r?r():r}})},r._nonoptional=function(e,t,r){return new e({type:"nonoptional",innerType:t,...l.normalizeParams(r)})},r._success=function(e,t){return new e({type:"success",innerType:t})},r._catch=function(e,t,r){return new e({type:"catch",innerType:t,catchValue:"function"==typeof r?r:()=>r})},r._pipe=function(e,t,r){return new e({type:"pipe",in:t,out:r})},r._readonly=function(e,t){return new e({type:"readonly",innerType:t})},r._templateLiteral=function(e,t,r){return new e({type:"template_literal",parts:t,...l.normalizeParams(r)})},r._lazy=function(e,t){return new e({type:"lazy",getter:t})},r._promise=function(e,t){return new e({type:"promise",innerType:t})},r._custom=function(e,t,r){let n=l.normalizeParams(r);return n.abort??(n.abort=!0),new e({type:"custom",check:"custom",fn:t,...n})},r._refine=function(e,t,r){return new e({type:"custom",check:"custom",fn:t,...l.normalizeParams(r)})},r._stringbool=function(e,t){let r=l.normalizeParams(t),n=r.truthy??["true","1","yes","on","y","enabled"],i=r.falsy??["false","0","no","off","n","disabled"];"sensitive"!==r.case&&(n=n.map(e=>"string"==typeof e?e.toLowerCase():e),i=i.map(e=>"string"==typeof e?e.toLowerCase():e));let a=new Set(n),s=new Set(i),u=e.Pipe??o.$ZodPipe,c=e.Boolean??o.$ZodBoolean,d=e.String??o.$ZodString,p=new(e.Transform??o.$ZodTransform)({type:"transform",transform:(e,t)=>{let n=e;return"sensitive"!==r.case&&(n=n.toLowerCase()),!!a.has(n)||!s.has(n)&&(t.issues.push({code:"invalid_value",expected:"stringbool",values:[...a,...s],input:t.value,inst:p}),{})},error:r.error}),h=new u({type:"pipe",in:new d({type:"string",error:r.error}),out:p,error:r.error});return new u({type:"pipe",in:h,out:new c({type:"boolean",error:r.error}),error:r.error})},r._stringFormat=function(e,t,r,n={}){let i=l.normalizeParams(n),a={...l.normalizeParams(n),check:"string_format",type:"string",format:t,fn:"function"==typeof r?r:e=>r.test(e),...i};return r instanceof RegExp&&(a.pattern=r),new e(a)};let s=a(e.r(86512)),o=a(e.r(23513)),l=a(e.r(25896));function u(e,t){return new s.$ZodCheckLessThan({check:"less_than",...l.normalizeParams(t),value:e,inclusive:!1})}function c(e,t){return new s.$ZodCheckLessThan({check:"less_than",...l.normalizeParams(t),value:e,inclusive:!0})}function d(e,t){return new s.$ZodCheckGreaterThan({check:"greater_than",...l.normalizeParams(t),value:e,inclusive:!1})}function p(e,t){return new s.$ZodCheckGreaterThan({check:"greater_than",...l.normalizeParams(t),value:e,inclusive:!0})}function h(e){return new s.$ZodCheckOverwrite({check:"overwrite",tx:e})}r.TimePrecision={Any:null,Minute:-1,Second:0,Millisecond:3,Microsecond:6}},93813,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.$ZodFunction=void 0,r.function=function(e){return new c({type:"function",input:Array.isArray(e?.input)?(0,s._tuple)(l.$ZodTuple,e?.input):e?.input??(0,s._array)(l.$ZodArray,(0,s._unknown)(l.$ZodUnknown)),output:e?.output??(0,s._unknown)(l.$ZodUnknown)})};let s=e.r(20105),o=e.r(23881),l=a(e.r(23513)),u=e.r(23513);class c{constructor(e){this._def=e,this.def=e}implement(e){if("function"!=typeof e)throw Error("implement() must be called with a function");let t=(...r)=>{let n=this._def.input?(0,o.parse)(this._def.input,r,void 0,{callee:t}):r;if(!Array.isArray(n))throw Error("Invalid arguments schema: not an array or tuple schema.");let i=e(...n);return this._def.output?(0,o.parse)(this._def.output,i,void 0,{callee:t}):i};return t}implementAsync(e){if("function"!=typeof e)throw Error("implement() must be called with a function");let t=async(...r)=>{let n=this._def.input?await (0,o.parseAsync)(this._def.input,r,void 0,{callee:t}):r;if(!Array.isArray(n))throw Error("Invalid arguments schema: not an array or tuple schema.");let i=await e(...n);return this._def.output?(0,o.parseAsync)(this._def.output,i,void 0,{callee:t}):i};return t}input(...e){let t=this.constructor;return new t(Array.isArray(e[0])?{type:"function",input:new u.$ZodTuple({type:"tuple",items:e[0],rest:e[1]}),output:this._def.output}:{type:"function",input:e[0],output:this._def.output})}output(e){return new this.constructor({type:"function",input:this._def.input,output:e})}}r.$ZodFunction=c},71413,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.JSONSchemaGenerator=void 0,r.toJSONSchema=function(e,t){if(e instanceof n.$ZodRegistry){let r=new a(t),n={};for(let t of e._idmap.entries()){let[e,n]=t;r.process(n)}let i={},s={registry:e,uri:t?.uri,defs:n};for(let n of e._idmap.entries()){let[e,a]=n;i[e]=r.emit(a,{...t,external:s})}return Object.keys(n).length>0&&(i.__shared={["draft-2020-12"===r.target?"$defs":"definitions"]:n}),{schemas:i}}let r=new a(t);return r.process(e),r.emit(e,t)};let n=e.r(29531),i=e.r(25896);class a{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??n.globalRegistry,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,t={path:[],schemaPath:[]}){var r;let n=e._zod.def,a=this.seen.get(e);if(a)return a.count++,t.schemaPath.includes(e)&&(a.cycle=t.path),a.schema;let s={schema:{},count:1,cycle:void 0,path:t.path};this.seen.set(e,s);let o=e._zod.toJSONSchema?.();if(o)s.schema=o;else{let r={...t,schemaPath:[...t.schemaPath,e],path:t.path},a=e._zod.parent;if(a)s.ref=a,this.process(a,r),this.seen.get(a).isParent=!0;else{let t=s.schema;switch(n.type){case"string":{t.type="string";let{minimum:r,maximum:n,format:i,patterns:a,contentEncoding:o}=e._zod.bag;if("number"==typeof r&&(t.minLength=r),"number"==typeof n&&(t.maxLength=n),i&&(t.format=({guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""})[i]??i,""===t.format&&delete t.format),o&&(t.contentEncoding=o),a&&a.size>0){let e=[...a];1===e.length?t.pattern=e[0].source:e.length>1&&(s.schema.allOf=[...e.map(e=>({..."draft-7"===this.target?{type:"string"}:{},pattern:e.source}))])}break}case"number":{let{minimum:r,maximum:n,format:i,multipleOf:a,exclusiveMaximum:s,exclusiveMinimum:o}=e._zod.bag;"string"==typeof i&&i.includes("int")?t.type="integer":t.type="number","number"==typeof o&&(t.exclusiveMinimum=o),"number"==typeof r&&(t.minimum=r,"number"==typeof o&&(o>=r?delete t.minimum:delete t.exclusiveMinimum)),"number"==typeof s&&(t.exclusiveMaximum=s),"number"==typeof n&&(t.maximum=n,"number"==typeof s&&(s<=n?delete t.maximum:delete t.exclusiveMaximum)),"number"==typeof a&&(t.multipleOf=a);break}case"boolean":case"success":t.type="boolean";break;case"bigint":if("throw"===this.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema");break;case"symbol":if("throw"===this.unrepresentable)throw Error("Symbols cannot be represented in JSON Schema");break;case"null":t.type="null";break;case"any":case"unknown":break;case"undefined":if("throw"===this.unrepresentable)throw Error("Undefined cannot be represented in JSON Schema");break;case"void":if("throw"===this.unrepresentable)throw Error("Void cannot be represented in JSON Schema");break;case"never":t.not={};break;case"date":if("throw"===this.unrepresentable)throw Error("Date cannot be represented in JSON Schema");break;case"array":{let{minimum:i,maximum:a}=e._zod.bag;"number"==typeof i&&(t.minItems=i),"number"==typeof a&&(t.maxItems=a),t.type="array",t.items=this.process(n.element,{...r,path:[...r.path,"items"]});break}case"object":{t.type="object",t.properties={};let e=n.shape;for(let n in e)t.properties[n]=this.process(e[n],{...r,path:[...r.path,"properties",n]});let i=new Set([...new Set(Object.keys(e))].filter(e=>{let t=n.shape[e]._zod;return"input"===this.io?void 0===t.optin:void 0===t.optout}));i.size>0&&(t.required=Array.from(i)),n.catchall?._zod.def.type==="never"?t.additionalProperties=!1:n.catchall?n.catchall&&(t.additionalProperties=this.process(n.catchall,{...r,path:[...r.path,"additionalProperties"]})):"output"===this.io&&(t.additionalProperties=!1);break}case"union":t.anyOf=n.options.map((e,t)=>this.process(e,{...r,path:[...r.path,"anyOf",t]}));break;case"intersection":{let e=this.process(n.left,{...r,path:[...r.path,"allOf",0]}),i=this.process(n.right,{...r,path:[...r.path,"allOf",1]}),a=e=>"allOf"in e&&1===Object.keys(e).length;t.allOf=[...a(e)?e.allOf:[e],...a(i)?i.allOf:[i]];break}case"tuple":{t.type="array";let i=n.items.map((e,t)=>this.process(e,{...r,path:[...r.path,"prefixItems",t]}));if("draft-2020-12"===this.target?t.prefixItems=i:t.items=i,n.rest){let e=this.process(n.rest,{...r,path:[...r.path,"items"]});"draft-2020-12"===this.target?t.items=e:t.additionalItems=e}n.rest&&(t.items=this.process(n.rest,{...r,path:[...r.path,"items"]}));let{minimum:a,maximum:s}=e._zod.bag;"number"==typeof a&&(t.minItems=a),"number"==typeof s&&(t.maxItems=s);break}case"record":t.type="object",t.propertyNames=this.process(n.keyType,{...r,path:[...r.path,"propertyNames"]}),t.additionalProperties=this.process(n.valueType,{...r,path:[...r.path,"additionalProperties"]});break;case"map":if("throw"===this.unrepresentable)throw Error("Map cannot be represented in JSON Schema");break;case"set":if("throw"===this.unrepresentable)throw Error("Set cannot be represented in JSON Schema");break;case"enum":{let e=(0,i.getEnumValues)(n.entries);e.every(e=>"number"==typeof e)&&(t.type="number"),e.every(e=>"string"==typeof e)&&(t.type="string"),t.enum=e;break}case"literal":{let e=[];for(let t of n.values)if(void 0===t){if("throw"===this.unrepresentable)throw Error("Literal `undefined` cannot be represented in JSON Schema")}else if("bigint"==typeof t)if("throw"===this.unrepresentable)throw Error("BigInt literals cannot be represented in JSON Schema");else e.push(Number(t));else e.push(t);if(0===e.length);else if(1===e.length){let r=e[0];t.type=null===r?"null":typeof r,t.const=r}else e.every(e=>"number"==typeof e)&&(t.type="number"),e.every(e=>"string"==typeof e)&&(t.type="string"),e.every(e=>"boolean"==typeof e)&&(t.type="string"),e.every(e=>null===e)&&(t.type="null"),t.enum=e;break}case"file":{let r={type:"string",format:"binary",contentEncoding:"binary"},{minimum:n,maximum:i,mime:a}=e._zod.bag;void 0!==n&&(r.minLength=n),void 0!==i&&(r.maxLength=i),a?1===a.length?(r.contentMediaType=a[0],Object.assign(t,r)):t.anyOf=a.map(e=>({...r,contentMediaType:e})):Object.assign(t,r);break}case"transform":if("throw"===this.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema");break;case"nullable":t.anyOf=[this.process(n.innerType,r),{type:"null"}];break;case"nonoptional":case"promise":case"optional":this.process(n.innerType,r),s.ref=n.innerType;break;case"default":this.process(n.innerType,r),s.ref=n.innerType,t.default=JSON.parse(JSON.stringify(n.defaultValue));break;case"prefault":this.process(n.innerType,r),s.ref=n.innerType,"input"===this.io&&(t._prefault=JSON.parse(JSON.stringify(n.defaultValue)));break;case"catch":{let e;this.process(n.innerType,r),s.ref=n.innerType;try{e=n.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}t.default=e;break}case"nan":if("throw"===this.unrepresentable)throw Error("NaN cannot be represented in JSON Schema");break;case"template_literal":{let r=e._zod.pattern;if(!r)throw Error("Pattern not found in template literal");t.type="string",t.pattern=r.source;break}case"pipe":{let e="input"===this.io?"transform"===n.in._zod.def.type?n.out:n.in:n.out;this.process(e,r),s.ref=e;break}case"readonly":this.process(n.innerType,r),s.ref=n.innerType,t.readOnly=!0;break;case"lazy":{let t=e._zod.innerType;this.process(t,r),s.ref=t;break}case"custom":if("throw"===this.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")}}}let l=this.metadataRegistry.get(e);return l&&Object.assign(s.schema,l),"input"===this.io&&function e(t,r){let n=r??{seen:new Set};if(n.seen.has(t))return!1;n.seen.add(t);let i=t._zod.def;switch(i.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":case"custom":case"success":case"catch":return!1;case"array":return e(i.element,n);case"object":for(let t in i.shape)if(e(i.shape[t],n))return!0;return!1;case"union":for(let t of i.options)if(e(t,n))return!0;return!1;case"intersection":return e(i.left,n)||e(i.right,n);case"tuple":for(let t of i.items)if(e(t,n))return!0;if(i.rest&&e(i.rest,n))return!0;return!1;case"record":case"map":return e(i.keyType,n)||e(i.valueType,n);case"set":return e(i.valueType,n);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":case"default":case"prefault":return e(i.innerType,n);case"lazy":return e(i.getter(),n);case"transform":return!0;case"pipe":return e(i.in,n)||e(i.out,n)}throw Error(`Unknown schema type: ${i.type}`)}(e)&&(delete s.schema.examples,delete s.schema.default),"input"===this.io&&s.schema._prefault&&((r=s.schema).default??(r.default=s.schema._prefault)),delete s.schema._prefault,this.seen.get(e).schema}emit(e,t){let r={cycles:t?.cycles??"ref",reused:t?.reused??"inline",external:t?.external??void 0},n=this.seen.get(e);if(!n)throw Error("Unprocessed schema. This is a bug in Zod.");let i=e=>{let t="draft-2020-12"===this.target?"$defs":"definitions";if(r.external){let n=r.external.registry.get(e[0])?.id,i=r.external.uri??(e=>e);if(n)return{ref:i(n)};let a=e[1].defId??e[1].schema.id??`schema${this.counter++}`;return e[1].defId=a,{defId:a,ref:`${i("__shared")}#/${t}/${a}`}}if(e[1]===n)return{ref:"#"};let i=`#/${t}/`,a=e[1].schema.id??`__schema${this.counter++}`;return{defId:a,ref:i+a}},a=e=>{if(e[1].schema.$ref)return;let t=e[1],{ref:r,defId:n}=i(e);t.def={...t.schema},n&&(t.defId=n);let a=t.schema;for(let e in a)delete a[e];a.$ref=r};if("throw"===r.cycles)for(let e of this.seen.entries()){let t=e[1];if(t.cycle)throw Error(`Cycle detected: #/${t.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let t of this.seen.entries()){let n=t[1];if(e===t[0]){a(t);continue}if(r.external){let n=r.external.registry.get(t[0])?.id;if(e!==t[0]&&n){a(t);continue}}if(this.metadataRegistry.get(t[0])?.id||n.cycle||n.count>1&&"ref"===r.reused){a(t);continue}}let s=(e,t)=>{let r=this.seen.get(e),n=r.def??r.schema,i={...n};if(null===r.ref)return;let a=r.ref;if(r.ref=null,a){s(a,t);let e=this.seen.get(a).schema;e.$ref&&"draft-7"===t.target?(n.allOf=n.allOf??[],n.allOf.push(e)):(Object.assign(n,e),Object.assign(n,i))}r.isParent||this.override({zodSchema:e,jsonSchema:n,path:r.path??[]})};for(let e of[...this.seen.entries()].reverse())s(e[0],{target:this.target});let o={};if("draft-2020-12"===this.target?o.$schema="https://json-schema.org/draft/2020-12/schema":"draft-7"===this.target?o.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),r.external?.uri){let t=r.external.registry.get(e)?.id;if(!t)throw Error("Schema is missing an `id` property");o.$id=r.external.uri(t)}Object.assign(o,n.def);let l=r.external?.defs??{};for(let e of this.seen.entries()){let t=e[1];t.def&&t.defId&&(l[t.defId]=t.def)}r.external||Object.keys(l).length>0&&("draft-2020-12"===this.target?o.$defs=l:o.definitions=l);try{return JSON.parse(JSON.stringify(o))}catch(e){throw Error("Error converting schema to JSON.")}}}r.JSONSchemaGenerator=a},31009,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},92491,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},s=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.JSONSchema=r.locales=r.regexes=r.util=void 0,a(e.r(65320),r),a(e.r(23881),r),a(e.r(18161),r),a(e.r(23513),r),a(e.r(86512),r),a(e.r(9431),r),r.util=s(e.r(25896)),r.regexes=s(e.r(44987)),r.locales=s(e.r(49514)),a(e.r(29531),r),a(e.r(71449),r),a(e.r(93813),r),a(e.r(20105),r),a(e.r(71413),r),r.JSONSchema=s(e.r(31009))},86331,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaultOptions=r.defaultOptions=r.jsonDescription=r.ignoreOverride=void 0,r.ignoreOverride=Symbol("Let zodToJsonSchema decide on which parser to use"),r.jsonDescription=(e,t)=>{if(t.description)try{return{...e,...JSON.parse(t.description)}}catch{}return e},r.defaultOptions={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},r.getDefaultOptions=e=>"string"==typeof e?{...r.defaultOptions,name:e}:{...r.defaultOptions,...e}},22166,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getRefs=void 0;let n=e.r(86331);r.getRefs=e=>{let t=(0,n.getDefaultOptions)(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}}},38707,(e,t,r)=>{"use strict";function n(e,t,r,n){n?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}Object.defineProperty(r,"__esModule",{value:!0}),r.setResponseValueAndErrors=r.addErrorMessage=void 0,r.addErrorMessage=n,r.setResponseValueAndErrors=function(e,t,r,i,a){e[t]=r,n(e,t,i,a)}},81228,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getRelativePath=void 0,r.getRelativePath=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")}},99243,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.z=void 0;let o=a(e.r(29302));r.z=o,s(e.r(29302),r),r.default=o},51830,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseAnyDef=void 0;let n=e.r(81228);r.parseAnyDef=function(e){if("openAi"!==e.target)return{};let t=[...e.basePath,e.definitionPath,e.openAiAnyTypeName];return e.flags.hasReferencedOpenAiAnyType=!0,{$ref:"relative"===e.$refStrategy?(0,n.getRelativePath)(t,e.currentPath):t.join("/")}}},10731,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseArrayDef=void 0;let n=e.r(99243),i=e.r(38707),a=e.r(62876);r.parseArrayDef=function(e,t){let r={type:"array"};return e.type?._def&&e.type?._def?.typeName!==n.ZodFirstPartyTypeKind.ZodAny&&(r.items=(0,a.parseDef)(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&(0,i.setResponseValueAndErrors)(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&(0,i.setResponseValueAndErrors)(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&((0,i.setResponseValueAndErrors)(r,"minItems",e.exactLength.value,e.exactLength.message,t),(0,i.setResponseValueAndErrors)(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r}},75052,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseBigintDef=void 0;let n=e.r(38707);r.parseBigintDef=function(e,t){let r={type:"integer",format:"int64"};if(!e.checks)return r;for(let i of e.checks)switch(i.kind){case"min":"jsonSchema7"===t.target?i.inclusive?(0,n.setResponseValueAndErrors)(r,"minimum",i.value,i.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMinimum",i.value,i.message,t):(i.inclusive||(r.exclusiveMinimum=!0),(0,n.setResponseValueAndErrors)(r,"minimum",i.value,i.message,t));break;case"max":"jsonSchema7"===t.target?i.inclusive?(0,n.setResponseValueAndErrors)(r,"maximum",i.value,i.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMaximum",i.value,i.message,t):(i.inclusive||(r.exclusiveMaximum=!0),(0,n.setResponseValueAndErrors)(r,"maximum",i.value,i.message,t));break;case"multipleOf":(0,n.setResponseValueAndErrors)(r,"multipleOf",i.value,i.message,t)}return r}},55158,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseBooleanDef=void 0,r.parseBooleanDef=function(){return{type:"boolean"}}},5971,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseBrandedDef=void 0;let n=e.r(62876);r.parseBrandedDef=function(e,t){return(0,n.parseDef)(e.type._def,t)}},68897,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseCatchDef=void 0;let n=e.r(62876);r.parseCatchDef=(e,t)=>(0,n.parseDef)(e.innerType._def,t)},81734,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseDateDef=void 0;let n=e.r(38707);r.parseDateDef=function e(t,r,n){let a=n??r.dateStrategy;if(Array.isArray(a))return{anyOf:a.map((n,i)=>e(t,r,n))};switch(a){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return i(t,r)}};let i=(e,t)=>{let r={type:"integer",format:"unix-time"};if("openApi3"===t.target)return r;for(let i of e.checks)switch(i.kind){case"min":(0,n.setResponseValueAndErrors)(r,"minimum",i.value,i.message,t);break;case"max":(0,n.setResponseValueAndErrors)(r,"maximum",i.value,i.message,t)}return r}},52857,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseDefaultDef=void 0;let n=e.r(62876);r.parseDefaultDef=function(e,t){return{...(0,n.parseDef)(e.innerType._def,t),default:e.defaultValue()}}},86265,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseEffectsDef=void 0;let n=e.r(62876),i=e.r(51830);r.parseEffectsDef=function(e,t){return"input"===t.effectStrategy?(0,n.parseDef)(e.schema._def,t):(0,i.parseAnyDef)(t)}},59537,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseEnumDef=void 0,r.parseEnumDef=function(e){return{type:"string",enum:Array.from(e.values)}}},74566,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseIntersectionDef=void 0;let n=e.r(62876);r.parseIntersectionDef=function(e,t){let r=[(0,n.parseDef)(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),(0,n.parseDef)(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),i="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0,a=[];return r.forEach(e=>{if((!("type"in e)||"string"!==e.type)&&"allOf"in e)a.push(...e.allOf),void 0===e.unevaluatedProperties&&(i=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...n}=e;t=n}else i=void 0;a.push(t)}}),a.length?{allOf:a,...i}:void 0}},52421,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseLiteralDef=void 0,r.parseLiteralDef=function(e,t){let r=typeof e.value;return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===r?"integer":r,enum:[e.value]}:{type:"bigint"===r?"integer":r,const:e.value}}},44905,(e,t,r)=>{"use strict";let n;Object.defineProperty(r,"__esModule",{value:!0}),r.parseStringDef=r.zodPatterns=void 0;let i=e.r(38707);function a(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)s.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}r.zodPatterns={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===n&&(n=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),n),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/},r.parseStringDef=function(e,t){let n={type:"string"};if(e.checks)for(let s of e.checks)switch(s.kind){case"min":(0,i.setResponseValueAndErrors)(n,"minLength","number"==typeof n.minLength?Math.max(n.minLength,s.value):s.value,s.message,t);break;case"max":(0,i.setResponseValueAndErrors)(n,"maxLength","number"==typeof n.maxLength?Math.min(n.maxLength,s.value):s.value,s.message,t);break;case"email":switch(t.emailStrategy){case"format:email":o(n,"email",s.message,t);break;case"format:idn-email":o(n,"idn-email",s.message,t);break;case"pattern:zod":l(n,r.zodPatterns.email,s.message,t)}break;case"url":o(n,"uri",s.message,t);break;case"uuid":o(n,"uuid",s.message,t);break;case"regex":l(n,s.regex,s.message,t);break;case"cuid":l(n,r.zodPatterns.cuid,s.message,t);break;case"cuid2":l(n,r.zodPatterns.cuid2,s.message,t);break;case"startsWith":l(n,RegExp(`^${a(s.value,t)}`),s.message,t);break;case"endsWith":l(n,RegExp(`${a(s.value,t)}$`),s.message,t);break;case"datetime":o(n,"date-time",s.message,t);break;case"date":o(n,"date",s.message,t);break;case"time":o(n,"time",s.message,t);break;case"duration":o(n,"duration",s.message,t);break;case"length":(0,i.setResponseValueAndErrors)(n,"minLength","number"==typeof n.minLength?Math.max(n.minLength,s.value):s.value,s.message,t),(0,i.setResponseValueAndErrors)(n,"maxLength","number"==typeof n.maxLength?Math.min(n.maxLength,s.value):s.value,s.message,t);break;case"includes":l(n,RegExp(a(s.value,t)),s.message,t);break;case"ip":"v6"!==s.version&&o(n,"ipv4",s.message,t),"v4"!==s.version&&o(n,"ipv6",s.message,t);break;case"base64url":l(n,r.zodPatterns.base64url,s.message,t);break;case"jwt":l(n,r.zodPatterns.jwt,s.message,t);break;case"cidr":"v6"!==s.version&&l(n,r.zodPatterns.ipv4Cidr,s.message,t),"v4"!==s.version&&l(n,r.zodPatterns.ipv6Cidr,s.message,t);break;case"emoji":l(n,r.zodPatterns.emoji(),s.message,t);break;case"ulid":l(n,r.zodPatterns.ulid,s.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":o(n,"binary",s.message,t);break;case"contentEncoding:base64":(0,i.setResponseValueAndErrors)(n,"contentEncoding","base64",s.message,t);break;case"pattern:zod":l(n,r.zodPatterns.base64,s.message,t)}break;case"nanoid":l(n,r.zodPatterns.nanoid,s.message,t)}return n};let s=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function o(e,t,r,n){e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&n.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&n.errorMessages&&{errorMessage:{format:r}}})):(0,i.setResponseValueAndErrors)(e,"format",t,r,n)}function l(e,t,r,n){e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&n.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:u(t,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):(0,i.setResponseValueAndErrors)(e,"pattern",u(t,n),r,n)}function u(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;let r={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},n=r.i?e.source.toLowerCase():e.source,i="",a=!1,s=!1,o=!1;for(let e=0;e<n.length;e++){if(a){i+=n[e],a=!1;continue}if(r.i){if(s){if(n[e].match(/[a-z]/)){o?(i+=n[e],i+=`${n[e-2]}-${n[e]}`.toUpperCase(),o=!1):"-"===n[e+1]&&n[e+2]?.match(/[a-z]/)?(i+=n[e],o=!0):i+=`${n[e]}${n[e].toUpperCase()}`;continue}}else if(n[e].match(/[a-z]/)){i+=`[${n[e]}${n[e].toUpperCase()}]`;continue}}if(r.m){if("^"===n[e]){i+=`(^|(?<=[\r
]))`;continue}else if("$"===n[e]){i+=`($|(?=[\r
]))`;continue}}if(r.s&&"."===n[e]){i+=s?`${n[e]}\r
`:`[${n[e]}\r
]`;continue}i+=n[e],"\\"===n[e]?a=!0:s&&"]"===n[e]?s=!1:s||"["!==n[e]||(s=!0)}try{new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return i}},63404,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseRecordDef=void 0;let n=e.r(99243),i=e.r(62876),a=e.r(44905),s=e.r(5971),o=e.r(51830);r.parseRecordDef=function(e,t){if("openAi"===t.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===t.target&&e.keyType?._def.typeName===n.ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,n)=>({...r,[n]:(0,i.parseDef)(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",n]})??(0,o.parseAnyDef)(t)}),{}),additionalProperties:t.rejectedAdditionalProperties};let r={type:"object",additionalProperties:(0,i.parseDef)(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if("openApi3"===t.target)return r;if(e.keyType?._def.typeName===n.ZodFirstPartyTypeKind.ZodString&&e.keyType._def.checks?.length){let{type:n,...i}=(0,a.parseStringDef)(e.keyType._def,t);return{...r,propertyNames:i}}if(e.keyType?._def.typeName===n.ZodFirstPartyTypeKind.ZodEnum)return{...r,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===n.ZodFirstPartyTypeKind.ZodBranded&&e.keyType._def.type._def.typeName===n.ZodFirstPartyTypeKind.ZodString&&e.keyType._def.type._def.checks?.length){let{type:n,...i}=(0,s.parseBrandedDef)(e.keyType._def,t);return{...r,propertyNames:i}}return r}},86526,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseMapDef=void 0;let n=e.r(62876),i=e.r(63404),a=e.r(51830);r.parseMapDef=function(e,t){return"record"===t.mapStrategy?(0,i.parseRecordDef)(e,t):{type:"array",maxItems:125,items:{type:"array",items:[(0,n.parseDef)(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||(0,a.parseAnyDef)(t),(0,n.parseDef)(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||(0,a.parseAnyDef)(t)],minItems:2,maxItems:2}}}},7248,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseNativeEnumDef=void 0,r.parseNativeEnumDef=function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),n=Array.from(new Set(r.map(e=>typeof e)));return{type:1===n.length?"string"===n[0]?"string":"number":["string","number"],enum:r}}},92660,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseNeverDef=void 0;let n=e.r(51830);r.parseNeverDef=function(e){return"openAi"===e.target?void 0:{not:(0,n.parseAnyDef)({...e,currentPath:[...e.currentPath,"not"]})}}},78589,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseNullDef=void 0,r.parseNullDef=function(e){return"openApi3"===e.target?{enum:["null"],nullable:!0}:{type:"null"}}},34477,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseUnionDef=r.primitiveMappings=void 0;let n=e.r(62876);r.primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},r.parseUnionDef=function(e,t){if("openApi3"===t.target)return i(e,t);let n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(e=>e._def.typeName in r.primitiveMappings&&(!e._def.checks||!e._def.checks.length))){let e=n.reduce((e,t)=>{let n=r.primitiveMappings[t._def.typeName];return n&&!e.includes(n)?[...e,n]:e},[]);return{type:e.length>1?e:e[0]}}if(n.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=n.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===n.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:n.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(n.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:n.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return i(e,t)};let i=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>(0,n.parseDef)(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0}},23786,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseNullableDef=void 0;let n=e.r(62876),i=e.r(34477);r.parseNullableDef=function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:i.primitiveMappings[e.innerType._def.typeName],nullable:!0}:{type:[i.primitiveMappings[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){let r=(0,n.parseDef)(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}let r=(0,n.parseDef)(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}},30717,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseNumberDef=void 0;let n=e.r(38707);r.parseNumberDef=function(e,t){let r={type:"number"};if(!e.checks)return r;for(let i of e.checks)switch(i.kind){case"int":r.type="integer",(0,n.addErrorMessage)(r,"type",i.message,t);break;case"min":"jsonSchema7"===t.target?i.inclusive?(0,n.setResponseValueAndErrors)(r,"minimum",i.value,i.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMinimum",i.value,i.message,t):(i.inclusive||(r.exclusiveMinimum=!0),(0,n.setResponseValueAndErrors)(r,"minimum",i.value,i.message,t));break;case"max":"jsonSchema7"===t.target?i.inclusive?(0,n.setResponseValueAndErrors)(r,"maximum",i.value,i.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMaximum",i.value,i.message,t):(i.inclusive||(r.exclusiveMaximum=!0),(0,n.setResponseValueAndErrors)(r,"maximum",i.value,i.message,t));break;case"multipleOf":(0,n.setResponseValueAndErrors)(r,"multipleOf",i.value,i.message,t)}return r}},25507,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseObjectDef=void 0;let n=e.r(62876);r.parseObjectDef=function(e,t){let r="openAi"===t.target,i={type:"object",properties:{}},a=[],s=e.shape();for(let e in s){let o=s[e];if(void 0===o||void 0===o._def)continue;let l=function(e){try{return e.isOptional()}catch{return!0}}(o);l&&r&&("ZodOptional"===o._def.typeName&&(o=o._def.innerType),o.isNullable()||(o=o.nullable()),l=!1);let u=(0,n.parseDef)(o._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==u&&(i.properties[e]=u,l||a.push(e))}a.length&&(i.required=a);let o=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return(0,n.parseDef)(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==o&&(i.additionalProperties=o),i}},95721,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseOptionalDef=void 0;let n=e.r(62876),i=e.r(51830);r.parseOptionalDef=(e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return(0,n.parseDef)(e.innerType._def,t);let r=(0,n.parseDef)(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return r?{anyOf:[{not:(0,i.parseAnyDef)(t)},r]}:(0,i.parseAnyDef)(t)}},24755,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parsePipelineDef=void 0;let n=e.r(62876);r.parsePipelineDef=(e,t)=>{if("input"===t.pipeStrategy)return(0,n.parseDef)(e.in._def,t);if("output"===t.pipeStrategy)return(0,n.parseDef)(e.out._def,t);let r=(0,n.parseDef)(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),i=(0,n.parseDef)(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,i].filter(e=>void 0!==e)}}},95881,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parsePromiseDef=void 0;let n=e.r(62876);r.parsePromiseDef=function(e,t){return(0,n.parseDef)(e.type._def,t)}},58400,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseSetDef=void 0;let n=e.r(38707),i=e.r(62876);r.parseSetDef=function(e,t){let r={type:"array",uniqueItems:!0,items:(0,i.parseDef)(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&(0,n.setResponseValueAndErrors)(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&(0,n.setResponseValueAndErrors)(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}},94471,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseTupleDef=void 0;let n=e.r(62876);r.parseTupleDef=function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>(0,n.parseDef)(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:(0,n.parseDef)(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>(0,n.parseDef)(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}},35543,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseUndefinedDef=void 0;let n=e.r(51830);r.parseUndefinedDef=function(e){return{not:(0,n.parseAnyDef)(e)}}},33362,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseUnknownDef=void 0;let n=e.r(51830);r.parseUnknownDef=function(e){return(0,n.parseAnyDef)(e)}},53223,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseReadonlyDef=void 0;let n=e.r(62876);r.parseReadonlyDef=(e,t)=>(0,n.parseDef)(e.innerType._def,t)},24619,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.selectParser=void 0;let n=e.r(99243),i=e.r(51830),a=e.r(10731),s=e.r(75052),o=e.r(55158),l=e.r(5971),u=e.r(68897),c=e.r(81734),d=e.r(52857),p=e.r(86265),h=e.r(59537),f=e.r(74566),m=e.r(52421),g=e.r(86526),y=e.r(7248),b=e.r(92660),_=e.r(78589),v=e.r(23786),w=e.r(30717),O=e.r(25507),P=e.r(95721),S=e.r(24755),E=e.r(95881),k=e.r(63404),I=e.r(58400),A=e.r(44905),T=e.r(94471),C=e.r(35543),j=e.r(34477),x=e.r(33362),$=e.r(53223);r.selectParser=(e,t,r)=>{switch(t){case n.ZodFirstPartyTypeKind.ZodString:return(0,A.parseStringDef)(e,r);case n.ZodFirstPartyTypeKind.ZodNumber:return(0,w.parseNumberDef)(e,r);case n.ZodFirstPartyTypeKind.ZodObject:return(0,O.parseObjectDef)(e,r);case n.ZodFirstPartyTypeKind.ZodBigInt:return(0,s.parseBigintDef)(e,r);case n.ZodFirstPartyTypeKind.ZodBoolean:return(0,o.parseBooleanDef)();case n.ZodFirstPartyTypeKind.ZodDate:return(0,c.parseDateDef)(e,r);case n.ZodFirstPartyTypeKind.ZodUndefined:return(0,C.parseUndefinedDef)(r);case n.ZodFirstPartyTypeKind.ZodNull:return(0,_.parseNullDef)(r);case n.ZodFirstPartyTypeKind.ZodArray:return(0,a.parseArrayDef)(e,r);case n.ZodFirstPartyTypeKind.ZodUnion:case n.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return(0,j.parseUnionDef)(e,r);case n.ZodFirstPartyTypeKind.ZodIntersection:return(0,f.parseIntersectionDef)(e,r);case n.ZodFirstPartyTypeKind.ZodTuple:return(0,T.parseTupleDef)(e,r);case n.ZodFirstPartyTypeKind.ZodRecord:return(0,k.parseRecordDef)(e,r);case n.ZodFirstPartyTypeKind.ZodLiteral:return(0,m.parseLiteralDef)(e,r);case n.ZodFirstPartyTypeKind.ZodEnum:return(0,h.parseEnumDef)(e);case n.ZodFirstPartyTypeKind.ZodNativeEnum:return(0,y.parseNativeEnumDef)(e);case n.ZodFirstPartyTypeKind.ZodNullable:return(0,v.parseNullableDef)(e,r);case n.ZodFirstPartyTypeKind.ZodOptional:return(0,P.parseOptionalDef)(e,r);case n.ZodFirstPartyTypeKind.ZodMap:return(0,g.parseMapDef)(e,r);case n.ZodFirstPartyTypeKind.ZodSet:return(0,I.parseSetDef)(e,r);case n.ZodFirstPartyTypeKind.ZodLazy:return()=>e.getter()._def;case n.ZodFirstPartyTypeKind.ZodPromise:return(0,E.parsePromiseDef)(e,r);case n.ZodFirstPartyTypeKind.ZodNaN:case n.ZodFirstPartyTypeKind.ZodNever:return(0,b.parseNeverDef)(r);case n.ZodFirstPartyTypeKind.ZodEffects:return(0,p.parseEffectsDef)(e,r);case n.ZodFirstPartyTypeKind.ZodAny:return(0,i.parseAnyDef)(r);case n.ZodFirstPartyTypeKind.ZodUnknown:return(0,x.parseUnknownDef)(r);case n.ZodFirstPartyTypeKind.ZodDefault:return(0,d.parseDefaultDef)(e,r);case n.ZodFirstPartyTypeKind.ZodBranded:return(0,l.parseBrandedDef)(e,r);case n.ZodFirstPartyTypeKind.ZodReadonly:return(0,$.parseReadonlyDef)(e,r);case n.ZodFirstPartyTypeKind.ZodCatch:return(0,u.parseCatchDef)(e,r);case n.ZodFirstPartyTypeKind.ZodPipeline:return(0,S.parsePipelineDef)(e,r);case n.ZodFirstPartyTypeKind.ZodFunction:case n.ZodFirstPartyTypeKind.ZodVoid:case n.ZodFirstPartyTypeKind.ZodSymbol:default:return}}},62876,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseDef=void 0;let n=e.r(86331),i=e.r(24619),a=e.r(81228),s=e.r(51830);r.parseDef=function e(t,r,a=!1){let s=r.seen.get(t);if(r.override){let e=r.override?.(t,r,s,a);if(e!==n.ignoreOverride)return e}if(s&&!a){let e=o(s,r);if(void 0!==e)return e}let u={def:t,path:r.currentPath,jsonSchema:void 0};r.seen.set(t,u);let c=(0,i.selectParser)(t,t.typeName,r),d="function"==typeof c?e(c(),r):c;if(d&&l(t,r,d),r.postProcess){let e=r.postProcess(d,t,r);return u.jsonSchema=d,e}return u.jsonSchema=d,d};let o=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:(0,a.getRelativePath)(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),(0,s.parseAnyDef)(t);return"seen"===t.$refStrategy?(0,s.parseAnyDef)(t):void 0}},l=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r)},83116,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},83550,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.zodToJsonSchema=void 0;let n=e.r(62876),i=e.r(22166),a=e.r(51830);r.zodToJsonSchema=(e,t)=>{let r=(0,i.getRefs)(t),s="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,i])=>({...e,[t]:(0,n.parseDef)(i._def,{...r,currentPath:[...r.basePath,r.definitionPath,t]},!0)??(0,a.parseAnyDef)(r)}),{}):void 0,o="string"==typeof t?t:t?.nameStrategy==="title"?void 0:t?.name,l=(0,n.parseDef)(e._def,void 0===o?r:{...r,currentPath:[...r.basePath,r.definitionPath,o]},!1)??(0,a.parseAnyDef)(r),u="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==u&&(l.title=u),r.flags.hasReferencedOpenAiAnyType&&(s||(s={}),s[r.openAiAnyTypeName]||(s[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:"relative"===r.$refStrategy?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));let c=void 0===o?s?{...l,[r.definitionPath]:s}:l:{$ref:[..."relative"===r.$refStrategy?[]:r.basePath,r.definitionPath,o].join("/"),[r.definitionPath]:{...s,[o]:l}};return"jsonSchema7"===r.target?c.$schema="http://json-schema.org/draft-07/schema#":("jsonSchema2019-09"===r.target||"openAi"===r.target)&&(c.$schema="https://json-schema.org/draft/2019-09/schema#"),"openAi"===r.target&&("anyOf"in c||"oneOf"in c||"allOf"in c||"type"in c&&Array.isArray(c.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),c}},78017,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(86331),r),i(e.r(22166),r),i(e.r(38707),r),i(e.r(81228),r),i(e.r(62876),r),i(e.r(83116),r),i(e.r(51830),r),i(e.r(10731),r),i(e.r(75052),r),i(e.r(55158),r),i(e.r(5971),r),i(e.r(68897),r),i(e.r(81734),r),i(e.r(52857),r),i(e.r(86265),r),i(e.r(59537),r),i(e.r(74566),r),i(e.r(52421),r),i(e.r(86526),r),i(e.r(7248),r),i(e.r(92660),r),i(e.r(78589),r),i(e.r(23786),r),i(e.r(30717),r),i(e.r(25507),r),i(e.r(95721),r),i(e.r(24755),r),i(e.r(95881),r),i(e.r(53223),r),i(e.r(63404),r),i(e.r(58400),r),i(e.r(44905),r),i(e.r(94471),r),i(e.r(35543),r),i(e.r(34477),r),i(e.r(33362),r),i(e.r(24619),r),i(e.r(83550),r),r.default=e.r(83550).zodToJsonSchema},18995,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deepCompareStrict=function e(t,r){let n=typeof t;if(n!==typeof r)return!1;if(Array.isArray(t)){if(!Array.isArray(r))return!1;let n=t.length;if(n!==r.length)return!1;for(let i=0;i<n;i++)if(!e(t[i],r[i]))return!1;return!0}if("object"===n){if(!t||!r)return t===r;let n=Object.keys(t),i=Object.keys(r);if(n.length!==i.length)return!1;for(let i of n)if(!e(t[i],r[i]))return!1;return!0}return t===r}},76250,(e,t,r)=>{"use strict";function n(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(r,"__esModule",{value:!0}),r.encodePointer=function(e){return encodeURI(n(e))},r.escapePointer=n},38119,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.initialBaseURI=r.ignoredKeyword=r.schemaMapKeyword=r.schemaArrayKeyword=r.schemaKeyword=void 0,r.dereference=function e(t,i=Object.create(null),a=r.initialBaseURI,s=""){if(t&&"object"==typeof t&&!Array.isArray(t)){let r=t.$id||t.id;if(r){let n=new URL(r,a.href);n.hash.length>1?i[n.href]=t:(n.hash="",""===s?a=n:e(t,i,a))}}else if(!0!==t&&!1!==t)return i;let o=a.href+(s?"#"+s:"");if(void 0!==i[o])throw Error(`Duplicate schema URI "${o}".`);if(i[o]=t,!0===t||!1===t)return i;if(void 0===t.__absolute_uri__&&Object.defineProperty(t,"__absolute_uri__",{enumerable:!1,value:o}),t.$ref&&void 0===t.__absolute_ref__){let e=new URL(t.$ref,a.href);e.hash=e.hash,Object.defineProperty(t,"__absolute_ref__",{enumerable:!1,value:e.href})}if(t.$recursiveRef&&void 0===t.__absolute_recursive_ref__){let e=new URL(t.$recursiveRef,a.href);e.hash=e.hash,Object.defineProperty(t,"__absolute_recursive_ref__",{enumerable:!1,value:e.href})}for(let o in t.$anchor&&(i[new URL("#"+t.$anchor,a.href).href]=t),t){if(r.ignoredKeyword[o])continue;let l=`${s}/${(0,n.encodePointer)(o)}`,u=t[o];if(Array.isArray(u)){if(r.schemaArrayKeyword[o]){let t=u.length;for(let r=0;r<t;r++)e(u[r],i,a,`${l}/${r}`)}}else if(r.schemaMapKeyword[o])for(let t in u)e(u[t],i,a,`${l}/${(0,n.encodePointer)(t)}`);else e(u,i,a,l)}return i};let n=e.r(76250);r.schemaKeyword={additionalItems:!0,unevaluatedItems:!0,items:!0,contains:!0,additionalProperties:!0,unevaluatedProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},r.schemaArrayKeyword={prefixItems:!0,items:!0,allOf:!0,anyOf:!0,oneOf:!0},r.schemaMapKeyword={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependentSchemas:!0},r.ignoredKeyword={id:!0,$id:!0,$ref:!0,$schema:!0,$anchor:!0,$vocabulary:!0,$comment:!0,default:!0,enum:!0,const:!0,required:!0,type:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0},r.initialBaseURI="undefined"!=typeof self&&self.location&&"null"!==self.location.origin?new URL(self.location.origin+self.location.pathname+location.search):new URL("https://github.com/cfworker")},27178,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.format=void 0;let n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,i=[0,31,28,31,30,31,30,31,31,30,31,30,31],a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function s(e){return e.test.bind(e)}function o(e){var t;let r=e.match(n);if(!r)return!1;let a=+r[1],s=+r[2],o=+r[3];return s>=1&&s<=12&&o>=1&&o<=(2==s&&(t=a)%4==0&&(t%100!=0||t%400==0)?29:i[s])}function l(e,t){let r=t.match(a);if(!r)return!1;let n=+r[1],i=+r[2],s=+r[3],o=!!r[5];return(n<=23&&i<=59&&s<=59||23==n&&59==i&&60==s)&&(!e||o)}r.format={date:o,time:l.bind(void 0,!1),"date-time":function(e){let t=e.split(u);return 2==t.length&&o(t[0])&&l(!0,t[1])},duration:e=>e.length>1&&e.length<80&&(/^P\d+([.,]\d+)?W$/.test(e)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(e)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(e)),uri:function(e){return c.test(e)&&d.test(e)},"uri-reference":s(/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i),"uri-template":s(/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i),url:s(/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)(?:\.(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu),email:e=>{if('"'===e[0])return!1;let[t,r,...n]=e.split("@");return!(!t||!r||0!==n.length||t.length>64||r.length>253||"."===t[0]||t.endsWith(".")||t.includes(".."))&&!!/^[a-z0-9.-]+$/i.test(r)&&!!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(t)&&r.split(".").every(e=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(e))},hostname:s(/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i),ipv4:s(/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/),ipv6:s(/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i),regex:function(e){if(p.test(e))return!1;try{return RegExp(e,"u"),!0}catch(e){return!1}},uuid:s(/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i),"json-pointer":s(/^(?:\/(?:[^~/]|~0|~1)*)*$/),"json-pointer-uri-fragment":s(/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i),"relative-json-pointer":s(/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/)};let u=/t|\s/i,c=/\/|:/,d=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,p=/[^\\]\\Z/},29968,(e,t,r)=>{"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.OutputFormat=void 0,function(e){e[e.Flag=1]="Flag",e[e.Basic=2]="Basic",e[e.Detailed=4]="Detailed"}(n||(r.OutputFormat=n={}))},45097,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ucs2length=function(e){let t,r=0,n=e.length,i=0;for(;i<n;)r++,(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<n&&(64512&(t=e.charCodeAt(i)))==56320&&i++;return r}},20975,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.validate=function e(t,r,l="2019-09",u=(0,i.dereference)(r),c=!0,d=null,p="#",h="#",f=Object.create(null)){let m;if(!0===r)return{valid:!0,errors:[]};if(!1===r)return{valid:!1,errors:[{instanceLocation:p,keyword:"false",keywordLocation:p,error:"False boolean schema."}]};let g=typeof t;switch(g){case"boolean":case"number":case"string":m=g;break;case"object":m=null===t?"null":Array.isArray(t)?"array":"object";break;default:throw Error(`Instances of "${g}" type are not supported.`)}let{$ref:y,$recursiveRef:b,$recursiveAnchor:_,type:v,const:w,enum:O,required:P,not:S,anyOf:E,allOf:k,oneOf:I,if:A,then:T,else:C,format:j,properties:x,patternProperties:$,additionalProperties:N,unevaluatedProperties:R,minProperties:M,maxProperties:D,propertyNames:L,dependentRequired:U,dependentSchemas:F,dependencies:z,prefixItems:B,items:G,additionalItems:Z,unevaluatedItems:K,contains:V,minContains:H,maxContains:W,minItems:q,maxItems:J,uniqueItems:Y,minimum:Q,maximum:X,exclusiveMinimum:ee,exclusiveMaximum:et,multipleOf:er,minLength:en,maxLength:ei,pattern:ea,__absolute_ref__:es,__absolute_recursive_ref__:eo}=r,el=[];if(!0===_&&null===d&&(d=r),"#"===b){let n=null===d?u[eo]:d,i=`${h}/$recursiveRef`,a=e(t,null===d?r:d,l,u,c,n,p,i,f);a.valid||el.push({instanceLocation:p,keyword:"$recursiveRef",keywordLocation:i,error:"A subschema had errors."},...a.errors)}if(void 0!==y){let r=u[es||y];if(void 0===r){let e=`Unresolved $ref "${y}".`;throw es&&es!==y&&(e+=`  Absolute URI "${es}".`),Error(e+=`
Known schemas:
- ${Object.keys(u).join("\n- ")}`)}let n=`${h}/$ref`,i=e(t,r,l,u,c,d,p,n,f);if(i.valid||el.push({instanceLocation:p,keyword:"$ref",keywordLocation:n,error:"A subschema had errors."},...i.errors),"4"===l||"7"===l)return{valid:0===el.length,errors:el}}if(Array.isArray(v)){let e=v.length,r=!1;for(let n=0;n<e;n++)if(m===v[n]||"integer"===v[n]&&"number"===m&&t%1==0&&t==t){r=!0;break}r||el.push({instanceLocation:p,keyword:"type",keywordLocation:`${h}/type`,error:`Instance type "${m}" is invalid. Expected "${v.join('", "')}".`})}else"integer"===v?("number"!==m||t%1||t!=t)&&el.push({instanceLocation:p,keyword:"type",keywordLocation:`${h}/type`,error:`Instance type "${m}" is invalid. Expected "${v}".`}):void 0!==v&&m!==v&&el.push({instanceLocation:p,keyword:"type",keywordLocation:`${h}/type`,error:`Instance type "${m}" is invalid. Expected "${v}".`});if(void 0!==w&&("object"===m||"array"===m?(0,n.deepCompareStrict)(t,w)||el.push({instanceLocation:p,keyword:"const",keywordLocation:`${h}/const`,error:`Instance does not match ${JSON.stringify(w)}.`}):t!==w&&el.push({instanceLocation:p,keyword:"const",keywordLocation:`${h}/const`,error:`Instance does not match ${JSON.stringify(w)}.`})),void 0!==O&&("object"===m||"array"===m?O.some(e=>(0,n.deepCompareStrict)(t,e))||el.push({instanceLocation:p,keyword:"enum",keywordLocation:`${h}/enum`,error:`Instance does not match any of ${JSON.stringify(O)}.`}):O.some(e=>t===e)||el.push({instanceLocation:p,keyword:"enum",keywordLocation:`${h}/enum`,error:`Instance does not match any of ${JSON.stringify(O)}.`})),void 0!==S){let r=`${h}/not`;e(t,S,l,u,c,d,p,r).valid&&el.push({instanceLocation:p,keyword:"not",keywordLocation:r,error:'Instance matched "not" schema.'})}let eu=[];if(void 0!==E){let r=`${h}/anyOf`,n=el.length,i=!1;for(let n=0;n<E.length;n++){let a=E[n],s=Object.create(f),o=e(t,a,l,u,c,!0===_?d:null,p,`${r}/${n}`,s);el.push(...o.errors),i=i||o.valid,o.valid&&eu.push(s)}i?el.length=n:el.splice(n,0,{instanceLocation:p,keyword:"anyOf",keywordLocation:r,error:"Instance does not match any subschemas."})}if(void 0!==k){let r=`${h}/allOf`,n=el.length,i=!0;for(let n=0;n<k.length;n++){let a=k[n],s=Object.create(f),o=e(t,a,l,u,c,!0===_?d:null,p,`${r}/${n}`,s);el.push(...o.errors),i=i&&o.valid,o.valid&&eu.push(s)}i?el.length=n:el.splice(n,0,{instanceLocation:p,keyword:"allOf",keywordLocation:r,error:"Instance does not match every subschema."})}if(void 0!==I){let r=`${h}/oneOf`,n=el.length,i=I.filter((n,i)=>{let a=Object.create(f),s=e(t,n,l,u,c,!0===_?d:null,p,`${r}/${i}`,a);return el.push(...s.errors),s.valid&&eu.push(a),s.valid}).length;1===i?el.length=n:el.splice(n,0,{instanceLocation:p,keyword:"oneOf",keywordLocation:r,error:`Instance does not match exactly one subschema (${i} matches).`})}if(("object"===m||"array"===m)&&Object.assign(f,...eu),void 0!==A){let r=`${h}/if`;if(e(t,A,l,u,c,d,p,r,f).valid){if(void 0!==T){let n=e(t,T,l,u,c,d,p,`${h}/then`,f);n.valid||el.push({instanceLocation:p,keyword:"if",keywordLocation:r,error:'Instance does not match "then" schema.'},...n.errors)}}else if(void 0!==C){let n=e(t,C,l,u,c,d,p,`${h}/else`,f);n.valid||el.push({instanceLocation:p,keyword:"if",keywordLocation:r,error:'Instance does not match "else" schema.'},...n.errors)}}if("object"===m){if(void 0!==P)for(let e of P)e in t||el.push({instanceLocation:p,keyword:"required",keywordLocation:`${h}/required`,error:`Instance does not have required property "${e}".`});let r=Object.keys(t);if(void 0!==M&&r.length<M&&el.push({instanceLocation:p,keyword:"minProperties",keywordLocation:`${h}/minProperties`,error:`Instance does not have at least ${M} properties.`}),void 0!==D&&r.length>D&&el.push({instanceLocation:p,keyword:"maxProperties",keywordLocation:`${h}/maxProperties`,error:`Instance does not have at least ${D} properties.`}),void 0!==L){let r=`${h}/propertyNames`;for(let n in t){let t=`${p}/${(0,s.encodePointer)(n)}`,i=e(n,L,l,u,c,d,t,r);i.valid||el.push({instanceLocation:p,keyword:"propertyNames",keywordLocation:r,error:`Property name "${n}" does not match schema.`},...i.errors)}}if(void 0!==U){let e=`${h}/dependantRequired`;for(let r in U)if(r in t)for(let n of U[r])n in t||el.push({instanceLocation:p,keyword:"dependentRequired",keywordLocation:e,error:`Instance has "${r}" but does not have "${n}".`})}if(void 0!==F)for(let r in F){let n=`${h}/dependentSchemas`;if(r in t){let i=e(t,F[r],l,u,c,d,p,`${n}/${(0,s.encodePointer)(r)}`,f);i.valid||el.push({instanceLocation:p,keyword:"dependentSchemas",keywordLocation:n,error:`Instance has "${r}" but does not match dependant schema.`},...i.errors)}}if(void 0!==z){let r=`${h}/dependencies`;for(let n in z)if(n in t){let i=z[n];if(Array.isArray(i))for(let e of i)e in t||el.push({instanceLocation:p,keyword:"dependencies",keywordLocation:r,error:`Instance has "${n}" but does not have "${e}".`});else{let a=e(t,i,l,u,c,d,p,`${r}/${(0,s.encodePointer)(n)}`);a.valid||el.push({instanceLocation:p,keyword:"dependencies",keywordLocation:r,error:`Instance has "${n}" but does not match dependant schema.`},...a.errors)}}}let n=Object.create(null),i=!1;if(void 0!==x){let r=`${h}/properties`;for(let a in x){if(!(a in t))continue;let o=`${p}/${(0,s.encodePointer)(a)}`,h=e(t[a],x[a],l,u,c,d,o,`${r}/${(0,s.encodePointer)(a)}`);if(h.valid)f[a]=n[a]=!0;else if(i=c,el.push({instanceLocation:p,keyword:"properties",keywordLocation:r,error:`Property "${a}" does not match schema.`},...h.errors),i)break}}if(!i&&void 0!==$){let r=`${h}/patternProperties`;for(let a in $){let o=RegExp(a,"u"),h=$[a];for(let m in t){if(!o.test(m))continue;let g=`${p}/${(0,s.encodePointer)(m)}`,y=e(t[m],h,l,u,c,d,g,`${r}/${(0,s.encodePointer)(a)}`);y.valid?f[m]=n[m]=!0:(i=c,el.push({instanceLocation:p,keyword:"patternProperties",keywordLocation:r,error:`Property "${m}" matches pattern "${a}" but does not match associated schema.`},...y.errors))}}}if(i||void 0===N){if(!i&&void 0!==R){let r=`${h}/unevaluatedProperties`;for(let n in t)if(!f[n]){let i=`${p}/${(0,s.encodePointer)(n)}`,a=e(t[n],R,l,u,c,d,i,r);a.valid?f[n]=!0:el.push({instanceLocation:p,keyword:"unevaluatedProperties",keywordLocation:r,error:`Property "${n}" does not match unevaluated properties schema.`},...a.errors)}}}else{let r=`${h}/additionalProperties`;for(let a in t){if(n[a])continue;let o=`${p}/${(0,s.encodePointer)(a)}`,h=e(t[a],N,l,u,c,d,o,r);h.valid?f[a]=!0:(i=c,el.push({instanceLocation:p,keyword:"additionalProperties",keywordLocation:r,error:`Property "${a}" does not match additional properties schema.`},...h.errors))}}}else if("array"===m){void 0!==J&&t.length>J&&el.push({instanceLocation:p,keyword:"maxItems",keywordLocation:`${h}/maxItems`,error:`Array has too many items (${t.length} > ${J}).`}),void 0!==q&&t.length<q&&el.push({instanceLocation:p,keyword:"minItems",keywordLocation:`${h}/minItems`,error:`Array has too few items (${t.length} < ${q}).`});let r=t.length,i=0,a=!1;if(void 0!==B){let n=`${h}/prefixItems`,s=Math.min(B.length,r);for(;i<s;i++){let r=e(t[i],B[i],l,u,c,d,`${p}/${i}`,`${n}/${i}`);if(f[i]=!0,!r.valid&&(a=c,el.push({instanceLocation:p,keyword:"prefixItems",keywordLocation:n,error:"Items did not match schema."},...r.errors),a))break}}if(void 0!==G){let n=`${h}/items`;if(Array.isArray(G)){let s=Math.min(G.length,r);for(;i<s;i++){let r=e(t[i],G[i],l,u,c,d,`${p}/${i}`,`${n}/${i}`);if(f[i]=!0,!r.valid&&(a=c,el.push({instanceLocation:p,keyword:"items",keywordLocation:n,error:"Items did not match schema."},...r.errors),a))break}}else for(;i<r;i++){let r=e(t[i],G,l,u,c,d,`${p}/${i}`,n);if(f[i]=!0,!r.valid&&(a=c,el.push({instanceLocation:p,keyword:"items",keywordLocation:n,error:"Items did not match schema."},...r.errors),a))break}if(!a&&void 0!==Z){let n=`${h}/additionalItems`;for(;i<r;i++){let r=e(t[i],Z,l,u,c,d,`${p}/${i}`,n);f[i]=!0,r.valid||(a=c,el.push({instanceLocation:p,keyword:"additionalItems",keywordLocation:n,error:"Items did not match additional items schema."},...r.errors))}}}if(void 0!==V)if(0===r&&void 0===H)el.push({instanceLocation:p,keyword:"contains",keywordLocation:`${h}/contains`,error:"Array is empty. It must contain at least one item matching the schema."});else if(void 0!==H&&r<H)el.push({instanceLocation:p,keyword:"minContains",keywordLocation:`${h}/minContains`,error:`Array has less items (${r}) than minContains (${H}).`});else{let n=`${h}/contains`,i=el.length,a=0;for(let i=0;i<r;i++){let r=e(t[i],V,l,u,c,d,`${p}/${i}`,n);r.valid?(f[i]=!0,a++):el.push(...r.errors)}a>=(H||0)&&(el.length=i),void 0===H&&void 0===W&&0===a?el.splice(i,0,{instanceLocation:p,keyword:"contains",keywordLocation:n,error:"Array does not contain item matching schema."}):void 0!==H&&a<H?el.push({instanceLocation:p,keyword:"minContains",keywordLocation:`${h}/minContains`,error:`Array must contain at least ${H} items matching schema. Only ${a} items were found.`}):void 0!==W&&a>W&&el.push({instanceLocation:p,keyword:"maxContains",keywordLocation:`${h}/maxContains`,error:`Array may contain at most ${W} items matching schema. ${a} items were found.`})}if(!a&&void 0!==K){let n=`${h}/unevaluatedItems`;for(;i<r;i++){if(f[i])continue;let r=e(t[i],K,l,u,c,d,`${p}/${i}`,n);f[i]=!0,r.valid||el.push({instanceLocation:p,keyword:"unevaluatedItems",keywordLocation:n,error:"Items did not match unevaluated items schema."},...r.errors)}}if(Y)for(let e=0;e<r;e++){let i=t[e],a="object"==typeof i&&null!==i;for(let s=0;s<r;s++){if(e===s)continue;let r=t[s],o="object"==typeof r&&null!==r;(i===r||a&&o&&(0,n.deepCompareStrict)(i,r))&&(el.push({instanceLocation:p,keyword:"uniqueItems",keywordLocation:`${h}/uniqueItems`,error:`Duplicate items at indexes ${e} and ${s}.`}),e=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER)}}}else if("number"===m){if("4"===l?(void 0!==Q&&(!0===ee&&t<=Q||t<Q)&&el.push({instanceLocation:p,keyword:"minimum",keywordLocation:`${h}/minimum`,error:`${t} is less than ${ee?"or equal to ":""} ${Q}.`}),void 0!==X&&(!0===et&&t>=X||t>X)&&el.push({instanceLocation:p,keyword:"maximum",keywordLocation:`${h}/maximum`,error:`${t} is greater than ${et?"or equal to ":""} ${X}.`})):(void 0!==Q&&t<Q&&el.push({instanceLocation:p,keyword:"minimum",keywordLocation:`${h}/minimum`,error:`${t} is less than ${Q}.`}),void 0!==X&&t>X&&el.push({instanceLocation:p,keyword:"maximum",keywordLocation:`${h}/maximum`,error:`${t} is greater than ${X}.`}),void 0!==ee&&t<=ee&&el.push({instanceLocation:p,keyword:"exclusiveMinimum",keywordLocation:`${h}/exclusiveMinimum`,error:`${t} is less than ${ee}.`}),void 0!==et&&t>=et&&el.push({instanceLocation:p,keyword:"exclusiveMaximum",keywordLocation:`${h}/exclusiveMaximum`,error:`${t} is greater than or equal to ${et}.`})),void 0!==er){let e=t%er;Math.abs(0-e)>=11920929e-14&&Math.abs(er-e)>=11920929e-14&&el.push({instanceLocation:p,keyword:"multipleOf",keywordLocation:`${h}/multipleOf`,error:`${t} is not a multiple of ${er}.`})}}else if("string"===m){let e=void 0===en&&void 0===ei?0:(0,o.ucs2length)(t);void 0!==en&&e<en&&el.push({instanceLocation:p,keyword:"minLength",keywordLocation:`${h}/minLength`,error:`String is too short (${e} < ${en}).`}),void 0!==ei&&e>ei&&el.push({instanceLocation:p,keyword:"maxLength",keywordLocation:`${h}/maxLength`,error:`String is too long (${e} > ${ei}).`}),void 0===ea||RegExp(ea,"u").test(t)||el.push({instanceLocation:p,keyword:"pattern",keywordLocation:`${h}/pattern`,error:"String does not match pattern."}),void 0!==j&&a.format[j]&&!a.format[j](t)&&el.push({instanceLocation:p,keyword:"format",keywordLocation:`${h}/format`,error:`String does not match format "${j}".`})}return{valid:0===el.length,errors:el}};let n=e.r(18995),i=e.r(38119),a=e.r(27178),s=e.r(76250),o=e.r(45097)},67748,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Validator=void 0;let n=e.r(38119),i=e.r(20975);r.Validator=class{schema;draft;shortCircuit;lookup;constructor(e,t="2019-09",r=!0){this.schema=e,this.draft=t,this.shortCircuit=r,this.lookup=(0,n.dereference)(e)}validate(e){return(0,i.validate)(e,this.schema,this.draft,this.lookup,this.shortCircuit)}addSchema(e,t){t&&(e={...e,$id:t}),(0,n.dereference)(e,this.lookup)}}},10479,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(18995),r),i(e.r(38119),r),i(e.r(27178),r),i(e.r(76250),r),i(e.r(29968),r),i(e.r(45097),r),i(e.r(20975),r),i(e.r(67748),r)},29164,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isZodSchemaV4=i,r.isZodSchemaV3=a,r.isZodSchema=function(e){return i(e)&&console.warn("[WARNING] Attempting to use Zod 4 schema in a context where Zod 3 schema is expected. This may cause unexpected behavior."),a(e)},r.isInteropZodSchema=s,r.interopSafeParseAsync=o,r.interopParseAsync=l,r.interopSafeParse=function(e,t){if(i(e))try{let r=(0,n.parse)(e,t);return{success:!0,data:r}}catch(e){return{success:!1,error:e}}if(a(e))return e.safeParse(t);throw Error("Schema must be an instance of z3.ZodType or z4.$ZodType")},r.interopParse=function(e,t){if(i(e))return(0,n.parse)(e,t);if(a(e))return e.parse(t);throw Error("Schema must be an instance of z3.ZodType or z4.$ZodType")},r.getSchemaDescription=function(e){return i(e)?n.globalRegistry.get(e)?.description:a(e)||"description"in e&&"string"==typeof e.description?e.description:void 0},r.isShapelessZodSchema=function(e){if(!s(e))return!1;if(a(e)){let t=e._def;if("ZodObject"===t.typeName)return!e.shape||0===Object.keys(e.shape).length;if("ZodRecord"===t.typeName)return!0}if(i(e)){let t=e._zod.def;if("object"===t.type)return!e.shape||0===Object.keys(e.shape).length;if("record"===t.type)return!0}return"object"==typeof e&&null!==e&&!("shape"in e)},r.isSimpleStringZodSchema=function(e){return!!s(e)&&(a(e)?"ZodString"===e._def.typeName:!!i(e)&&"string"===e._zod.def.type)},r.isZodObjectV3=u,r.isZodObjectV4=c,r.isZodArrayV4=d,r.isInteropZodObject=function(e){return!!(u(e)||c(e))},r.getInteropZodObjectShape=function(e){if(a(e))return e.shape;if(i(e))return e._zod.def.shape;throw Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")},r.extendInteropZodObject=function(e,t){if(a(e))return e.extend(t);if(i(e))return n.util.extend(e,t);throw Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")},r.interopZodObjectPartial=function(e){if(a(e))return e.partial();if(i(e))return n.util.partial(n.$ZodOptional,e,void 0);throw Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")},r.interopZodObjectStrict=function e(t,r=!1){if(a(t))return t.strict();if(c(t)){let i=t._zod.def.shape;if(r)for(let[a,s]of Object.entries(t._zod.def.shape)){if(c(s)){let t=e(s,r);i[a]=t}else if(d(s)){let t=s._zod.def.element;c(t)&&(t=e(t,r)),i[a]=(0,n.clone)(s,{...s._zod.def,element:t})}else i[a]=s;let t=n.globalRegistry.get(s);t&&n.globalRegistry.add(i[a],t)}let a=(0,n.clone)(t,{...t._zod.def,shape:i,catchall:(0,n._never)(n.$ZodNever)}),s=n.globalRegistry.get(t);return s&&n.globalRegistry.add(a,s),a}throw Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")},r.interopZodObjectPassthrough=function e(t,r=!1){if(u(t))return t.passthrough();if(c(t)){let i=t._zod.def.shape;if(r)for(let[a,s]of Object.entries(t._zod.def.shape)){if(c(s)){let t=e(s,r);i[a]=t}else if(d(s)){let t=s._zod.def.element;c(t)&&(t=e(t,r)),i[a]=(0,n.clone)(s,{...s._zod.def,element:t})}else i[a]=s;let t=n.globalRegistry.get(s);t&&n.globalRegistry.add(i[a],t)}let a=(0,n.clone)(t,{...t._zod.def,shape:i,catchall:(0,n._unknown)(n.$ZodUnknown)}),s=n.globalRegistry.get(t);return s&&n.globalRegistry.add(a,s),a}throw Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")},r.getInteropZodDefaultGetter=function(e){if(a(e))try{let t=e.parse(void 0);return()=>t}catch{return}if(i(e))try{let t=(0,n.parse)(e,void 0);return()=>t}catch{}},r.interopZodTransformInputSchema=function e(t,r=!1){if(a(t))return a(t)&&"typeName"in t._def&&"ZodEffects"===t._def.typeName?e(t._def.schema,r):t;if(i(t)){let a=t;if(i(t)&&"pipe"===t._zod.def.type&&(a=e(t._zod.def.in,r)),r){if(c(a)){let t=a._zod.def.shape;for(let[n,i]of Object.entries(a._zod.def.shape))t[n]=e(i,r);a=(0,n.clone)(a,{...a._zod.def,shape:t})}else if(d(a)){let t=e(a._zod.def.element,r);a=(0,n.clone)(a,{...a._zod.def,element:t})}}let s=n.globalRegistry.get(t);return s&&n.globalRegistry.add(a,s),a}throw Error("Schema must be an instance of z3.ZodType or z4.$ZodType")};let n=e.r(92491);function i(e){if("object"!=typeof e||null===e||!("_zod"in e))return!1;let t=e._zod;return"object"==typeof t&&null!==t&&"def"in t}function a(e){if("object"!=typeof e||null===e||!("_def"in e)||"_zod"in e)return!1;let t=e._def;return"object"==typeof t&&null!=t&&"typeName"in t}function s(e){return!(!e||"object"!=typeof e||Array.isArray(e))&&!!(i(e)||a(e))}async function o(e,t){if(i(e))try{let r=await (0,n.parseAsync)(e,t);return{success:!0,data:r}}catch(e){return{success:!1,error:e}}if(a(e))return e.safeParse(t);throw Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}async function l(e,t){if(i(e))return(0,n.parse)(e,t);if(a(e))return e.parse(t);throw Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function u(e){return"object"==typeof e&&null!==e&&"_def"in e&&"object"==typeof e._def&&null!==e._def&&"typeName"in e._def&&"ZodObject"===e._def.typeName||!1}function c(e){return!!i(e)&&("object"==typeof e&&null!==e&&"_zod"in e&&"object"==typeof e._zod&&null!==e._zod&&"def"in e._zod&&"object"==typeof e._zod.def&&null!==e._zod.def&&"type"in e._zod.def&&"object"===e._zod.def.type||!1)}function d(e){return!!i(e)&&("object"==typeof e&&null!==e&&"_zod"in e&&"object"==typeof e._zod&&null!==e._zod&&"def"in e._zod&&"object"==typeof e._zod.def&&null!==e._zod.def&&"type"in e._zod.def&&"array"===e._zod.def.type||!1)}},30952,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Validator=r.deepCompareStrict=void 0,r.toJsonSchema=function(e){if((0,s.isZodSchemaV4)(e)){let t=(0,s.interopZodTransformInputSchema)(e,!0);if(!(0,s.isZodObjectV4)(t))return(0,n.toJSONSchema)(e);{let e=(0,s.interopZodObjectStrict)(t,!0);return(0,n.toJSONSchema)(e)}}return(0,s.isZodSchemaV3)(e)?(0,i.zodToJsonSchema)(e):e},r.validatesOnlyStrings=function e(t){if(!t||"object"!=typeof t||0===Object.keys(t).length||Array.isArray(t))return!1;if("type"in t)return"string"==typeof t.type?"string"===t.type:!!Array.isArray(t.type)&&t.type.every(e=>"string"===e);if("enum"in t)return Array.isArray(t.enum)&&t.enum.length>0&&t.enum.every(e=>"string"==typeof e);if("const"in t)return"string"==typeof t.const;if("allOf"in t&&Array.isArray(t.allOf))return t.allOf.some(t=>e(t));if("anyOf"in t&&Array.isArray(t.anyOf)||"oneOf"in t&&Array.isArray(t.oneOf)){let r="anyOf"in t?t.anyOf:t.oneOf;return r.length>0&&r.every(t=>e(t))}if("not"in t)return!1;if("$ref"in t&&"string"==typeof t.$ref){let r=t.$ref,n=(0,a.dereference)(t);if(n[r])return e(n[r])}return!1};let n=e.r(92491),i=e.r(78017),a=e.r(10479),s=e.r(29164);var o=e.r(10479);Object.defineProperty(r,"deepCompareStrict",{enumerable:!0,get:function(){return o.deepCompareStrict}}),Object.defineProperty(r,"Validator",{enumerable:!0,get:function(){return o.Validator}})},56044,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Graph=void 0;let n=e.r(79403),i=e.r(92933),a=e.r(75713),s=e.r(30952);class o{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=e?.nodes??this.nodes,this.edges=e?.edges??this.edges}toJSON(){let e={};return Object.values(this.nodes).forEach((t,r)=>{e[t.id]=(0,n.validate)(t.id)?r:t.id}),{nodes:Object.values(this.nodes).map(t=>({id:e[t.id],...(0,i.isRunnableInterface)(t.data)?{type:"runnable",data:{id:t.data.lc_id,name:t.data.getName()}}:{type:"schema",data:{...(0,s.toJsonSchema)(t.data.schema),title:t.data.name}}})),edges:this.edges.map(t=>{let r={source:e[t.source],target:e[t.target]};return void 0!==t.data&&(r.data=t.data),void 0!==t.conditional&&(r.conditional=t.conditional),r})}}addNode(e,t,r){if(void 0!==t&&void 0!==this.nodes[t])throw Error(`Node with id ${t} already exists`);let a=t??(0,n.v4)(),s={id:a,data:e,name:function(e,t){if(void 0!==e&&!(0,n.validate)(e))return e;if(!(0,i.isRunnableInterface)(t))return t.name??"UnknownSchema";try{let e=t.getName();return e=e.startsWith("Runnable")?e.slice(8):e}catch(e){return t.getName()}}(t,e),metadata:r};return this.nodes[a]=s,s}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(t=>t.source!==e.id&&t.target!==e.id)}addEdge(e,t,r,n){if(void 0===this.nodes[e.id])throw Error(`Source node ${e.id} not in graph`);if(void 0===this.nodes[t.id])throw Error(`Target node ${t.id} not in graph`);let i={source:e.id,target:t.id,data:r,conditional:n};return this.edges.push(i),i}firstNode(){return l(this)}lastNode(){return u(this)}extend(e,t=""){let r=t;Object.values(e.nodes).map(e=>e.id).every(n.validate)&&(r="");let i=e=>r?`${r}:${e}`:e;Object.entries(e.nodes).forEach(([e,t])=>{this.nodes[i(e)]={...t,id:i(e)}});let a=e.edges.map(e=>({...e,source:i(e.source),target:i(e.target)}));this.edges=[...this.edges,...a];let s=e.firstNode(),o=e.lastNode();return[s?{id:i(s.id),data:s.data}:void 0,o?{id:i(o.id),data:o.data}:void 0]}trimFirstNode(){let e=this.firstNode();e&&l(this,[e.id])&&this.removeNode(e)}trimLastNode(){let e=this.lastNode();e&&u(this,[e.id])&&this.removeNode(e)}reid(){let e=Object.fromEntries(Object.values(this.nodes).map(e=>[e.id,e.name])),t=new Map;Object.values(e).forEach(e=>{t.set(e,(t.get(e)||0)+1)});let r=r=>{let i=e[r];return(0,n.validate)(r)&&1===t.get(i)?i:r};return new o({nodes:Object.fromEntries(Object.entries(this.nodes).map(([e,t])=>[r(e),{...t,id:r(e)}])),edges:this.edges.map(e=>({...e,source:r(e.source),target:r(e.target)}))})}drawMermaid(e){let{withStyles:t,curveStyle:r,nodeColors:n={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:i}=e??{},s=this.reid(),o=s.firstNode(),l=s.lastNode();return(0,a.drawMermaid)(s.nodes,s.edges,{firstNode:o?.id,lastNode:l?.id,withStyles:t,curveStyle:r,nodeColors:n,wrapLabelNWords:i})}async drawMermaidPng(e){let t=this.drawMermaid(e);return(0,a.drawMermaidPng)(t,{backgroundColor:e?.backgroundColor})}}function l(e,t=[]){let r=new Set(e.edges.filter(e=>!t.includes(e.source)).map(e=>e.target)),n=[];for(let i of Object.values(e.nodes))t.includes(i.id)||r.has(i.id)||n.push(i);return 1===n.length?n[0]:void 0}function u(e,t=[]){let r=new Set(e.edges.filter(e=>!t.includes(e.target)).map(e=>e.source)),n=[];for(let i of Object.values(e.nodes))t.includes(i.id)||r.has(i.id)||n.push(i);return 1===n.length?n[0]:void 0}r.Graph=o},74214,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.convertToHttpEventStream=function(e){let t=new TextEncoder,r=new ReadableStream({async start(r){for await(let n of e)r.enqueue(t.encode(`event: data
data: ${JSON.stringify(n)}

`));r.enqueue(t.encode("event: end\n\n")),r.close()}});return n.IterableReadableStream.fromReadableStream(r)};let n=e.r(62350)},73374,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isIterator=void 0,r.isIterableIterator=function(e){return"object"==typeof e&&null!==e&&"function"==typeof e[Symbol.iterator]&&"function"==typeof e.next},r.isAsyncIterable=function(e){return"object"==typeof e&&null!==e&&"function"==typeof e[Symbol.asyncIterator]},r.consumeIteratorInContext=function*(e,t){for(;;){let{value:r,done:a}=n.AsyncLocalStorageProviderSingleton.runWithConfig((0,i.pickRunnableConfigKeys)(e),t.next.bind(t),!0);if(a)break;yield r}},r.consumeAsyncIterableInContext=a;let n=e.r(18807),i=e.r(81425);async function*a(e,t){let r=t[Symbol.asyncIterator]();for(;;){let{value:a,done:s}=await n.AsyncLocalStorageProviderSingleton.runWithConfig((0,i.pickRunnableConfigKeys)(e),r.next.bind(t),!0);if(s)break;yield a}}r.isIterator=e=>null!=e&&"object"==typeof e&&"next"in e&&"function"==typeof e.next},68974,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.RunnableToolLike=r.RunnablePick=r.RunnableAssign=r.RunnableWithFallbacks=r.RunnableParallel=r.RunnableLambda=r.RunnableTraceable=r.RunnableMap=r.RunnableSequence=r.RunnableRetry=r.RunnableEach=r.RunnableBinding=r.Runnable=void 0,r._coerceToDict=P,r._coerceToRunnable=$,r.convertRunnableToTool=D;let i=e.r(32770),a=n(e.r(36850)),s=e.r(79403),o=e.r(65740),l=e.r(1529),u=e.r(37556),c=e.r(46893),d=e.r(62350),p=e.r(87510),h=e.r(81425),f=e.r(1344),m=e.r(7978),g=e.r(92933),y=e.r(18807),b=e.r(56044),_=e.r(74214),v=e.r(73374),w=e.r(25951),O=e.r(29164);function P(e,t){return!e||Array.isArray(e)||e instanceof Date||"object"!=typeof e?{[t]:e}:e}class S extends c.Serializable{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){let t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new E({bound:this,kwargs:e,config:{}})}map(){return new k({bound:this})}withRetry(e){return new I({bound:this,kwargs:{},config:{},maxAttemptNumber:e?.stopAfterAttempt,...e})}withConfig(e){return new E({bound:this,config:e,kwargs:{}})}withFallbacks(e){return new x({runnable:this,fallbacks:Array.isArray(e)?e:e.fallbacks})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(h.ensureConfig);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");let r=Object.fromEntries(Object.entries(e).filter(([e])=>"runId"!==e));return Array.from({length:t},(t,n)=>(0,h.ensureConfig)(0===n?e:r))}return Array.from({length:t},()=>(0,h.ensureConfig)(e))}async batch(e,t,r){let n=this._getOptionsList(t??{},e.length),i=n[0]?.maxConcurrency??r?.maxConcurrency,a=new f.AsyncCaller({maxConcurrency:i,onFailedAttempt:e=>{throw e}});return Promise.all(e.map((e,t)=>a.call(async()=>{try{return await this.invoke(e,n[t])}catch(e){if(r?.returnExceptions)return e;throw e}})))}async *_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){let r=(0,h.ensureConfig)(t),n=new d.AsyncGeneratorWithSetup({generator:this._streamIterator(e,r),config:r});return await n.setup,d.IterableReadableStream.fromAsyncGenerator(n)}_separateRunnableConfigFromCallOptions(e){let t;t=void 0===e?(0,h.ensureConfig)(e):(0,h.ensureConfig)({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});let r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,delete r.timeout,delete r.signal,[t,r]}async _callWithConfig(e,t,r){let n,i=(0,h.ensureConfig)(r),a=await (0,h.getCallbackManagerForConfig)(i),s=await a?.handleChainStart(this.toJSON(),P(t,"input"),i.runId,i?.runType,void 0,void 0,i?.runName??this.getName());delete i.runId;try{let a=e.call(this,t,i,s);n=await (0,p.raceWithSignal)(a,r?.signal)}catch(e){throw await s?.handleChainError(e),e}return await s?.handleChainEnd(P(n,"output")),n}async _batchWithConfig(e,t,r,n){let i,a=this._getOptionsList(r??{},t.length),s=await Promise.all(a.map(h.getCallbackManagerForConfig)),o=await Promise.all(s.map(async(e,r)=>{let n=await e?.handleChainStart(this.toJSON(),P(t[r],"input"),a[r].runId,a[r].runType,void 0,void 0,a[r].runName??this.getName());return delete a[r].runId,n}));try{let r=e.call(this,t,a,o,n);i=await (0,p.raceWithSignal)(r,a?.[0]?.signal)}catch(e){throw await Promise.all(o.map(t=>t?.handleChainError(e))),e}return await Promise.all(o.map(e=>e?.handleChainEnd(P(i,"output")))),i}_concatOutputChunks(e,t){return(0,d.concat)(e,t)}async *_transformStreamWithConfig(e,t,r){let n,i,a,s=!0,o=!0,c=(0,h.ensureConfig)(r),p=await (0,h.getCallbackManagerForConfig)(c),f=this;async function*m(){for await(let t of e){if(s)if(void 0===n)n=t;else try{n=f._concatOutputChunks(n,t)}catch{n=void 0,s=!1}yield t}}try{let e=await (0,d.pipeGeneratorWithSetup)(t.bind(this),m(),async()=>p?.handleChainStart(this.toJSON(),{input:""},c.runId,c.runType,void 0,void 0,c.runName??this.getName()),r?.signal,c);delete c.runId,a=e.setup;let n=a?.handlers.find(u.isStreamEventsHandler),s=e.output;void 0!==n&&void 0!==a&&(s=n.tapOutputIterable(a.runId,s));let h=a?.handlers.find(l.isLogStreamHandler);for await(let e of(void 0!==h&&void 0!==a&&(s=h.tapOutputIterable(a.runId,s)),s))if(yield e,o)if(void 0===i)i=e;else try{i=this._concatOutputChunks(i,e)}catch{i=void 0,o=!1}}catch(e){throw await a?.handleChainError(e,void 0,void 0,void 0,{inputs:P(n,"input")}),e}await a?.handleChainEnd(i??{},void 0,void 0,void 0,{inputs:P(n,"input")})}getGraph(e){let t=new b.Graph,r=t.addNode({name:`${this.getName()}Input`,schema:i.z.any()}),n=t.addNode(this),a=t.addNode({name:`${this.getName()}Output`,schema:i.z.any()});return t.addEdge(r,n),t.addEdge(n,a),t}pipe(e){return new A({first:this,last:$(e)})}pick(e){return this.pipe(new R(e))}assign(e){return this.pipe(new N(new T({steps:e})))}async *transform(e,t){let r;for await(let t of e)r=void 0===r?t:this._concatOutputChunks(r,t);yield*this._streamIterator(r,(0,h.ensureConfig)(t))}async *streamLog(e,t,r){let n=new l.LogStreamCallbackHandler({...r,autoClose:!1,_schemaFormat:"original"}),i=(0,h.ensureConfig)(t);yield*this._streamLog(e,n,i)}async *_streamLog(e,t,r){let{callbacks:n}=r;if(void 0===n)r.callbacks=[t];else if(Array.isArray(n))r.callbacks=n.concat([t]);else{let e=n.copy();e.addHandler(t,!0),r.callbacks=e}let i=this.stream(e,r),a=async function(){try{for await(let e of(await i)){let r=new l.RunLogPatch({ops:[{op:"add",path:"/streamed_output/-",value:e}]});await t.writer.write(r)}}finally{await t.writer.close()}}();try{for await(let e of t)yield e}finally{await a}}streamEvents(e,t,r){let n;if("v1"===t.version)n=this._streamEventsV1(e,t,r);else if("v2"===t.version)n=this._streamEventsV2(e,t,r);else throw Error('Only versions "v1" and "v2" of the schema are currently supported.');return"text/event-stream"===t.encoding?(0,_.convertToHttpEventStream)(n):d.IterableReadableStream.fromAsyncGenerator(n)}async *_streamEventsV2(e,t,r){let n,i=new u.EventStreamCallbackHandler({...r,autoClose:!1}),a=(0,h.ensureConfig)(t),o=a.runId??(0,s.v4)();a.runId=o;let l=a.callbacks;if(void 0===l)a.callbacks=[i];else if(Array.isArray(l))a.callbacks=l.concat(i);else{let e=l.copy();e.addHandler(i,!0),a.callbacks=e}let c=new AbortController,d=this,p=async function(){let r,n=null;try{t?.signal?"any"in AbortSignal?r=AbortSignal.any([c.signal,t.signal]):(r=t.signal,n=()=>{c.abort()},t.signal.addEventListener("abort",n,{once:!0})):r=c.signal;let s=await d.stream(e,{...a,signal:r});for await(let e of i.tapOutputIterable(o,s))if(c.signal.aborted)break}finally{await i.finish(),r&&n&&r.removeEventListener("abort",n)}}(),f=!1;try{for await(let t of i){if(!f){t.data.input=e,f=!0,n=t.run_id,yield t;continue}t.run_id===n&&t.event.endsWith("_end")&&t.data?.input&&delete t.data.input,yield t}}finally{c.abort(),await p}}async *_streamEventsV1(e,t,r){let n,i=!1,a=(0,h.ensureConfig)(t),s=a.tags??[],o=a.metadata??{},u=a.runName??this.getName(),c=new l.LogStreamCallbackHandler({...r,autoClose:!1,_schemaFormat:"streaming_events"}),d=new g._RootEventFilter({...r});for await(let t of this._streamLog(e,c,a)){if(void 0===(n=n?n.concat(t):l.RunLog.fromRunLogPatch(t)).state)throw Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!i){i=!0;let t={...n.state},r={run_id:t.id,event:`on_${t.type}_start`,name:u,tags:s,metadata:o,data:{input:e}};d.includeEvent(r,t.type)&&(yield r)}for(let e of[...new Set(t.ops.filter(e=>e.path.startsWith("/logs/")).map(e=>e.path.split("/")[2]))]){let t,r={},i=n.state.logs[e];if("start"==(t=void 0===i.end_time?i.streamed_output.length>0?"stream":"start":"end"))void 0!==i.inputs&&(r.input=i.inputs);else if("end"===t)void 0!==i.inputs&&(r.input=i.inputs),r.output=i.final_output;else if("stream"===t){let e=i.streamed_output.length;if(1!==e)throw Error(`Expected exactly one chunk of streamed output, got ${e} instead. Encountered in: "${i.name}"`);r={chunk:i.streamed_output[0]},i.streamed_output=[]}yield{event:`on_${i.type}_${t}`,name:i.name,run_id:i.id,tags:i.tags,metadata:i.metadata,data:r}}let{state:r}=n;if(r.streamed_output.length>0){let e=r.streamed_output.length;if(1!==e)throw Error(`Expected exactly one chunk of streamed output, got ${e} instead. Encountered in: "${r.name}"`);let t={chunk:r.streamed_output[0]};r.streamed_output=[];let n={event:`on_${r.type}_stream`,run_id:r.id,tags:s,metadata:o,name:u,data:t};d.includeEvent(n,r.type)&&(yield n)}}let p=n?.state;if(void 0!==p){let e={event:`on_${p.type}_end`,name:u,run_id:p.id,tags:s,metadata:o,data:{output:p.final_output}};d.includeEvent(e,p.type)&&(yield e)}}static isRunnable(e){return(0,g.isRunnableInterface)(e)}withListeners({onStart:e,onEnd:t,onError:r}){return new E({bound:this,config:{},configFactories:[n=>({callbacks:[new m.RootListenersTracer({config:n,onStart:e,onEnd:t,onError:r})]})]})}asTool(e){return D(this,e)}}r.Runnable=S;class E extends S{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){let t=(0,h.mergeConfigs)(this.config,...e);return(0,h.mergeConfigs)(t,...this.configFactories?await Promise.all(this.configFactories.map(async e=>await e(t))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new I({bound:this.bound,kwargs:this.kwargs,config:this.config,maxAttemptNumber:e?.stopAfterAttempt,...e})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig((0,h.ensureConfig)(t),this.kwargs))}async batch(e,t,r){let n=Array.isArray(t)?await Promise.all(t.map(async e=>this._mergeConfig((0,h.ensureConfig)(e),this.kwargs))):await this._mergeConfig((0,h.ensureConfig)(t),this.kwargs);return this.bound.batch(e,n,r)}_concatOutputChunks(e,t){return this.bound._concatOutputChunks(e,t)}async *_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig((0,h.ensureConfig)(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig((0,h.ensureConfig)(t),this.kwargs))}async *transform(e,t){yield*this.bound.transform(e,await this._mergeConfig((0,h.ensureConfig)(t),this.kwargs))}streamEvents(e,t,r){let n=this,i=async function*(){yield*n.bound.streamEvents(e,{...await n._mergeConfig((0,h.ensureConfig)(t),n.kwargs),version:t.version},r)};return d.IterableReadableStream.fromAsyncGenerator(i())}static isRunnableBinding(e){return e.bound&&S.isRunnable(e.bound)}withListeners({onStart:e,onEnd:t,onError:r}){return new E({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[n=>({callbacks:[new m.RootListenersTracer({config:n,onStart:e,onEnd:t,onError:r})]})]})}}r.RunnableBinding=E;class k extends S{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new k({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _invoke(e,t,r){return this.bound.batch(e,(0,h.patchConfig)(t,{callbacks:r?.getChild()}))}withListeners({onStart:e,onEnd:t,onError:r}){return new k({bound:this.bound.withListeners({onStart:e,onEnd:t,onError:r})})}}r.RunnableEach=k;class I extends E{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,r){let n=e>1?`retry:attempt:${e}`:void 0;return(0,h.patchConfig)(t,{callbacks:r?.getChild(n)})}async _invoke(e,t,r){return(0,a.default)(n=>super.invoke(e,this._patchConfigForRetry(n,t,r)),{onFailedAttempt:t=>this.onFailedAttempt(t,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _batch(e,t,r,n){let i={};try{await (0,a.default)(async a=>{let s,o=e.map((e,t)=>t).filter(e=>void 0===i[e.toString()]||i[e.toString()]instanceof Error),l=o.map(t=>e[t]),u=o.map(e=>this._patchConfigForRetry(a,t?.[e],r?.[e])),c=await super.batch(l,u,{...n,returnExceptions:!0});for(let e=0;e<c.length;e+=1){let t=c[e],r=o[e];t instanceof Error&&void 0===s&&((s=t).input=l[e]),i[r.toString()]=t}if(s)throw s;return c},{onFailedAttempt:e=>this.onFailedAttempt(e,e.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(e){if(n?.returnExceptions!==!0)throw e}return Object.keys(i).sort((e,t)=>parseInt(e,10)-parseInt(t,10)).map(e=>i[parseInt(e,10)])}async batch(e,t,r){return this._batchWithConfig(this._batch.bind(this),e,t,r)}}r.RunnableRetry=I;class A extends S{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){let r,n=(0,h.ensureConfig)(t),i=await (0,h.getCallbackManagerForConfig)(n),a=await i?.handleChainStart(this.toJSON(),P(e,"input"),n.runId,void 0,void 0,void 0,n?.runName);delete n.runId;let s=e;try{let e=[this.first,...this.middle];for(let r=0;r<e.length;r+=1){let i=e[r].invoke(s,(0,h.patchConfig)(n,{callbacks:a?.getChild(this.omitSequenceTags?void 0:`seq:step:${r+1}`)}));s=await (0,p.raceWithSignal)(i,t?.signal)}if(t?.signal?.aborted)throw Error("Aborted");r=await this.last.invoke(s,(0,h.patchConfig)(n,{callbacks:a?.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(e){throw await a?.handleChainError(e),e}return await a?.handleChainEnd(P(r,"output")),r}async batch(e,t,r){let n=this._getOptionsList(t??{},e.length),i=await Promise.all(n.map(h.getCallbackManagerForConfig)),a=await Promise.all(i.map(async(t,r)=>{let i=await t?.handleChainStart(this.toJSON(),P(e[r],"input"),n[r].runId,void 0,void 0,void 0,n[r].runName);return delete n[r].runId,i})),s=e;try{for(let e=0;e<this.steps.length;e+=1){let t=this.steps[e].batch(s,a.map((t,r)=>{let i=t?.getChild(this.omitSequenceTags?void 0:`seq:step:${e+1}`);return(0,h.patchConfig)(n[r],{callbacks:i})}),r);s=await (0,p.raceWithSignal)(t,n[0]?.signal)}}catch(e){throw await Promise.all(a.map(t=>t?.handleChainError(e))),e}return await Promise.all(a.map(e=>e?.handleChainEnd(P(s,"output")))),s}_concatOutputChunks(e,t){return this.last._concatOutputChunks(e,t)}async *_streamIterator(e,t){let r,n=await (0,h.getCallbackManagerForConfig)(t),{runId:i,...a}=t??{},s=await n?.handleChainStart(this.toJSON(),P(e,"input"),i,void 0,void 0,void 0,a?.runName),o=[this.first,...this.middle,this.last],l=!0;async function*u(){yield e}try{let e=o[0].transform(u(),(0,h.patchConfig)(a,{callbacks:s?.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let t=1;t<o.length;t+=1){let r=o[t];e=await r.transform(e,(0,h.patchConfig)(a,{callbacks:s?.getChild(this.omitSequenceTags?void 0:`seq:step:${t+1}`)}))}for await(let n of e)if(t?.signal?.throwIfAborted(),yield n,l)if(void 0===r)r=n;else try{r=this._concatOutputChunks(r,n)}catch(e){r=void 0,l=!1}}catch(e){throw await s?.handleChainError(e),e}await s?.handleChainEnd(P(r,"output"))}getGraph(e){let t=new b.Graph,r=null;return this.steps.forEach((n,i)=>{let a=n.getGraph(e);0!==i&&a.trimFirstNode(),i!==this.steps.length-1&&a.trimLastNode(),t.extend(a);let s=a.firstNode();if(!s)throw Error(`Runnable ${n} has no first node`);r&&t.addEdge(r,s),r=a.lastNode()}),t}pipe(e){return new A(A.isRunnableSequence(e)?{first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}:{first:this.first,middle:[...this.middle,this.last],last:$(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&S.isRunnable(e)}static from([e,...t],r){let n={};return"string"==typeof r?n.name=r:void 0!==r&&(n=r),new A({...n,first:$(e),middle:t.slice(0,-1).map($),last:$(t[t.length-1])})}}r.RunnableSequence=A;class T extends S{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){for(let[t,r]of(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={},Object.entries(e.steps)))this.steps[t]=$(r)}static from(e){return new T({steps:e})}async invoke(e,t){let r=(0,h.ensureConfig)(t),n=await (0,h.getCallbackManagerForConfig)(r),i=await n?.handleChainStart(this.toJSON(),{input:e},r.runId,void 0,void 0,void 0,r?.runName);delete r.runId;let a={};try{let n=Object.entries(this.steps).map(async([t,n])=>{a[t]=await n.invoke(e,(0,h.patchConfig)(r,{callbacks:i?.getChild(`map:key:${t}`)}))});await (0,p.raceWithSignal)(Promise.all(n),t?.signal)}catch(e){throw await i?.handleChainError(e),e}return await i?.handleChainEnd(a),a}async *_transform(e,t,r){let n={...this.steps},i=(0,d.atee)(e,Object.keys(n).length),a=new Map(Object.entries(n).map(([e,n],a)=>{let s=n.transform(i[a],(0,h.patchConfig)(r,{callbacks:t?.getChild(`map:key:${e}`)}));return[e,s.next().then(t=>({key:e,gen:s,result:t}))]}));for(;a.size;){let e=Promise.race(a.values()),{key:t,result:n,gen:i}=await (0,p.raceWithSignal)(e,r?.signal);a.delete(t),n.done||(yield{[t]:n.value},a.set(t,i.next().then(e=>({key:t,gen:i,result:e}))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}let n=(0,h.ensureConfig)(t),i=new d.AsyncGeneratorWithSetup({generator:this.transform(r(),n),config:n});return await i.setup,d.IterableReadableStream.fromAsyncGenerator(i)}}r.RunnableMap=T;class C extends S{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!(0,o.isTraceableFunction)(e.func))throw Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,t){let[r]=this._getOptionsList(t??{},1),n=await (0,h.getCallbackManagerForConfig)(r),i=this.func((0,h.patchConfig)(r,{callbacks:n}),e);return(0,p.raceWithSignal)(i,r?.signal)}async *_streamIterator(e,t){let[r]=this._getOptionsList(t??{},1),n=await this.invoke(e,t);if((0,v.isAsyncIterable)(n)){for await(let e of n)r?.signal?.throwIfAborted(),yield e;return}if((0,v.isIterator)(n)){for(;;){r?.signal?.throwIfAborted();let e=n.next();if(e.done)break;yield e.value}return}yield n}static from(e){return new C({func:e})}}r.RunnableTraceable=C;class j extends S{static lc_name(){return"RunnableLambda"}constructor(e){if((0,o.isTraceableFunction)(e.func))return C.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0});var t=e.func;if((0,o.isTraceableFunction)(t))throw Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.");this.func=e.func}static from(e){return new j({func:e})}async _invoke(e,t,r){return new Promise((n,i)=>{let a=(0,h.patchConfig)(t,{callbacks:r?.getChild(),recursionLimit:(t?.recursionLimit??h.DEFAULT_RECURSION_LIMIT)-1});y.AsyncLocalStorageProviderSingleton.runWithConfig((0,h.pickRunnableConfigKeys)(a),async()=>{try{let r=await this.func(e,{...a});if(r&&S.isRunnable(r)){if(t?.recursionLimit===0)throw Error("Recursion limit reached.");r=await r.invoke(e,{...a,recursionLimit:(a.recursionLimit??h.DEFAULT_RECURSION_LIMIT)-1})}else if((0,v.isAsyncIterable)(r)){let e;for await(let n of(0,v.consumeAsyncIterableInContext)(a,r))if(t?.signal?.throwIfAborted(),void 0===e)e=n;else try{e=this._concatOutputChunks(e,n)}catch(t){e=n}r=e}else if((0,v.isIterableIterator)(r)){let e;for(let n of(0,v.consumeIteratorInContext)(a,r))if(t?.signal?.throwIfAborted(),void 0===e)e=n;else try{e=this._concatOutputChunks(e,n)}catch(t){e=n}r=e}n(r)}catch(e){i(e)}})})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async *_transform(e,t,r){let n;for await(let t of e)if(void 0===n)n=t;else try{n=this._concatOutputChunks(n,t)}catch(e){n=t}let i=(0,h.patchConfig)(r,{callbacks:t?.getChild(),recursionLimit:(r?.recursionLimit??h.DEFAULT_RECURSION_LIMIT)-1}),a=await new Promise((e,t)=>{y.AsyncLocalStorageProviderSingleton.runWithConfig((0,h.pickRunnableConfigKeys)(i),async()=>{try{let t=await this.func(n,{...i,config:i});e(t)}catch(e){t(e)}})});if(a&&S.isRunnable(a)){if(r?.recursionLimit===0)throw Error("Recursion limit reached.");for await(let e of(await a.stream(n,i)))yield e}else if((0,v.isAsyncIterable)(a))for await(let e of(0,v.consumeAsyncIterableInContext)(i,a))r?.signal?.throwIfAborted(),yield e;else if((0,v.isIterableIterator)(a))for(let e of(0,v.consumeIteratorInContext)(i,a))r?.signal?.throwIfAborted(),yield e;else yield a}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}let n=(0,h.ensureConfig)(t),i=new d.AsyncGeneratorWithSetup({generator:this.transform(r(),n),config:n});return await i.setup,d.IterableReadableStream.fromAsyncGenerator(i)}}r.RunnableLambda=j,r.RunnableParallel=class extends T{};class x extends S{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){for(let e of(yield this.runnable,this.fallbacks))yield e}async invoke(e,t){let r=(0,h.ensureConfig)(t),n=await (0,h.getCallbackManagerForConfig)(r),{runId:i,...a}=r,s=await n?.handleChainStart(this.toJSON(),P(e,"input"),i,void 0,void 0,void 0,a?.runName),o=(0,h.patchConfig)(a,{callbacks:s?.getChild()});return await y.AsyncLocalStorageProviderSingleton.runWithConfig(o,async()=>{let t;for(let n of this.runnables()){r?.signal?.throwIfAborted();try{let t=await n.invoke(e,o);return await s?.handleChainEnd(P(t,"output")),t}catch(e){void 0===t&&(t=e)}}if(void 0===t)throw Error("No error stored at end of fallback.");throw await s?.handleChainError(t),t})}async *_streamIterator(e,t){let r,n,i,a=(0,h.ensureConfig)(t),s=await (0,h.getCallbackManagerForConfig)(a),{runId:o,...l}=a,u=await s?.handleChainStart(this.toJSON(),P(e,"input"),o,void 0,void 0,void 0,l?.runName);for(let t of this.runnables()){a?.signal?.throwIfAborted();let i=(0,h.patchConfig)(l,{callbacks:u?.getChild()});try{let r=await t.stream(e,i);n=(0,v.consumeAsyncIterableInContext)(i,r);break}catch(e){void 0===r&&(r=e)}}if(void 0===n){let e=r??Error("No error stored at end of fallback.");throw await u?.handleChainError(e),e}try{for await(let e of n){yield e;try{i=void 0===i?i:this._concatOutputChunks(i,e)}catch(e){i=void 0}}}catch(e){throw await u?.handleChainError(e),e}await u?.handleChainEnd(P(i,"output"))}async batch(e,t,r){let n;if(r?.returnExceptions)throw Error("Not implemented.");let i=this._getOptionsList(t??{},e.length),a=await Promise.all(i.map(e=>(0,h.getCallbackManagerForConfig)(e))),s=await Promise.all(a.map(async(t,r)=>{let n=await t?.handleChainStart(this.toJSON(),P(e[r],"input"),i[r].runId,void 0,void 0,void 0,i[r].runName);return delete i[r].runId,n}));for(let t of this.runnables()){i[0].signal?.throwIfAborted();try{let n=await t.batch(e,s.map((e,t)=>(0,h.patchConfig)(i[t],{callbacks:e?.getChild()})),r);return await Promise.all(s.map((e,t)=>e?.handleChainEnd(P(n[t],"output")))),n}catch(e){void 0===n&&(n=e)}}if(!n)throw Error("No error stored at end of fallbacks.");throw await Promise.all(s.map(e=>e?.handleChainError(n))),n}}function $(e){if("function"==typeof e)return new j({func:e});if(S.isRunnable(e))return e;if(Array.isArray(e)||"object"!=typeof e)throw Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`);{let t={};for(let[r,n]of Object.entries(e))t[r]=$(n);return new T({steps:t})}}r.RunnableWithFallbacks=x;class N extends S{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof T&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){let r=await this.mapper.invoke(e,t);return{...e,...r}}async *_transform(e,t,r){let n=this.mapper.getStepsKeys(),[i,a]=(0,d.atee)(e),s=this.mapper.transform(a,(0,h.patchConfig)(r,{callbacks:t?.getChild()})),o=s.next();for await(let e of i){if("object"!=typeof e||Array.isArray(e))throw Error(`RunnableAssign can only be used with objects as input, got ${typeof e}`);let t=Object.fromEntries(Object.entries(e).filter(([e])=>!n.includes(e)));Object.keys(t).length>0&&(yield t)}for await(let e of(yield(await o).value,s))yield e}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}let n=(0,h.ensureConfig)(t),i=new d.AsyncGeneratorWithSetup({generator:this.transform(r(),n),config:n});return await i.setup,d.IterableReadableStream.fromAsyncGenerator(i)}}r.RunnableAssign=N;class R extends S{static lc_name(){return"RunnablePick"}constructor(e){("string"==typeof e||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if("string"==typeof this.keys)return e[this.keys];{let t=this.keys.map(t=>[t,e[t]]).filter(e=>void 0!==e[1]);return 0===t.length?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async *_transform(e){for await(let t of e){let e=await this._pick(t);void 0!==e&&(yield e)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}let n=(0,h.ensureConfig)(t),i=new d.AsyncGeneratorWithSetup({generator:this.transform(r(),n),config:n});return await i.setup,d.IterableReadableStream.fromAsyncGenerator(i)}}r.RunnablePick=R;class M extends E{constructor(e){super({bound:A.from([j.from(async e=>{let t;if((0,w._isToolCall)(e))try{t=await (0,O.interopParseAsync)(this.schema,e.args)}catch(t){throw new w.ToolInputParsingException("Received tool input did not match expected schema",JSON.stringify(e.args))}else t=e;return t}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name}),config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function D(e,t){let r=t.name??e.getName(),n=t.description??(0,O.getSchemaDescription)(t.schema);return new M((0,O.isSimpleStringZodSchema)(t.schema)?{name:r,description:n,schema:i.z.object({input:i.z.string()}).transform(e=>e.input),bound:e}:{name:r,description:n,schema:t.schema,bound:e})}r.RunnableToolLike=M},27548,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filterMessages=function(e,t){return Array.isArray(e)?f(e,t):n.RunnableLambda.from(t=>f(t,e))},r.mergeMessageRuns=function(e){return Array.isArray(e)?m(e):n.RunnableLambda.from(m)},r.trimMessages=function(e,t){if(!Array.isArray(e))return n.RunnableLambda.from(t=>g(t,e)).withConfig({runName:"trim_messages"});if(!t)throw Error("Options parameter is required when providing messages.");return g(e,t)},r.defaultTextSplitter=w;let n=e.r(68974),i=e.r(46404),a=e.r(98508),s=e.r(57845),o=e.r(96040),l=e.r(61785),u=e.r(2758),c=e.r(11839),d=e.r(85257),p=e.r(12556),h=(e,t)=>{let r=[...new Set(t?.map(e=>{if("string"==typeof e)return e;let t=new e({});if(!("getType"in t)||"function"!=typeof t.getType)throw Error("Invalid type provided.");return t.getType()}))],n=e.getType();return r.some(e=>e===n)};function f(e,t={}){let{includeNames:r,excludeNames:n,includeTypes:i,excludeTypes:a,includeIds:s,excludeIds:o}=t,l=[];for(let t of e)if(!(n&&t.name&&n.includes(t.name))){if(a&&h(t,a))continue;if(o&&t.id&&o.includes(t.id))continue;i||s||r?r&&t.name&&r.some(e=>e===t.name)||i&&h(t,i)?l.push(t):s&&t.id&&s.some(e=>e===t.id)&&l.push(t):l.push(t)}return l}function m(e){if(!e.length)return[];let t=[];for(let r of e){let e=t.pop();if(e)if("tool"===r.getType()||r.getType()!==e.getType())t.push(e,r);else{let n=(0,p.convertToChunk)(e),i=(0,p.convertToChunk)(r),a=n.concat(i);"string"==typeof n.content&&"string"==typeof i.content&&(a.content=`${n.content}
${i.content}`),t.push(function(e){let t,r=e.getType(),n=Object.fromEntries(Object.entries(e).filter(([e])=>!["type","tool_call_chunks"].includes(e)&&!e.startsWith("lc_")));if(r in _&&(t=v(r,n)),!t)throw Error(`Unrecognized message chunk class ${r}. Supported classes are ${Object.keys(_)}`);return t}(a))}else t.push(r)}return t}async function g(e,t){let r,{maxTokens:n,tokenCounter:i,strategy:a="last",allowPartial:s=!1,endOn:o,startOn:l,includeSystem:u=!1,textSplitter:c}=t;if(l&&"first"===a)throw Error("`startOn` should only be specified if `strategy` is 'last'.");if(u&&"first"===a)throw Error("`includeSystem` should only be specified if `strategy` is 'last'.");r="getNumTokens"in i?async e=>(await Promise.all(e.map(e=>i.getNumTokens(e.content)))).reduce((e,t)=>e+t,0):async e=>i(e);let d=w;if(c&&(d="splitText"in c?c.splitText:async e=>c(e)),"first"===a)return y(e,{maxTokens:n,tokenCounter:r,textSplitter:d,partialStrategy:s?"first":void 0,endOn:o});if("last"===a)return b(e,{maxTokens:n,tokenCounter:r,textSplitter:d,allowPartial:s,includeSystem:u,startOn:l,endOn:o});throw Error(`Unrecognized strategy: '${a}'. Must be one of 'first' or 'last'.`)}async function y(e,t){let{maxTokens:r,tokenCounter:n,textSplitter:i,partialStrategy:a,endOn:s}=t,o=[...e],l=0;for(let e=0;e<o.length;e+=1){let t=e>0?o.slice(0,-e):o;if(await n(t)<=r){l=o.length-e;break}}if(l<o.length&&a){let e=!1;if(Array.isArray(o[l].content)){let t=o[l];if("string"==typeof t.content)throw Error("Expected content to be an array.");let i=t.content.length,s="last"===a?[...t.content].reverse():t.content;for(let u=1;u<=i;u+=1){let i="first"===a?s.slice(0,u):s.slice(-u),c=Object.fromEntries(Object.entries(t).filter(([e])=>"type"!==e&&!e.startsWith("lc_"))),d=v(t.getType(),{...c,content:i}),p=[...o.slice(0,l),d];if(await n(p)<=r)o=p,l+=1,e=!0;else break}e&&"last"===a&&(t.content=[...s].reverse())}if(!e){let e,t=o[l];if(Array.isArray(t.content)&&t.content.some(e=>"string"==typeof e||"text"===e.type)){let r=t.content.find(e=>"text"===e.type&&e.text);e=r?.text}else"string"==typeof t.content&&(e=t.content);if(e){let s=await i(e),u=s.length;"last"===a&&s.reverse();for(let e=0;e<u-1;e+=1)if(s.pop(),t.content=s.join(""),await n([...o.slice(0,l),t])<=r){"last"===a&&(t.content=[...s].reverse().join("")),o=[...o.slice(0,l),t],l+=1;break}}}}if(s){let e=Array.isArray(s)?s:[s];for(;l>0&&!h(o[l-1],e);)l-=1}return o.slice(0,l)}async function b(e,t){let{allowPartial:r=!1,includeSystem:n=!1,endOn:i,startOn:s,...o}=t,l=e.map(e=>{let t=Object.fromEntries(Object.entries(e).filter(([e])=>"type"!==e&&!e.startsWith("lc_")));return v(e.getType(),t,(0,a.isBaseMessageChunk)(e))});if(i){let e=Array.isArray(i)?i:[i];for(;l.length>0&&!h(l[l.length-1],e);)l=l.slice(0,-1)}let u=n&&l[0]?.getType()==="system",c=u?l.slice(0,1).concat(l.slice(1).reverse()):l.reverse();return(c=await y(c,{...o,partialStrategy:r?"last":void 0,endOn:s}),u)?[c[0],...c.slice(1).reverse()]:c.reverse()}let _={human:{message:l.HumanMessage,messageChunk:l.HumanMessageChunk},ai:{message:i.AIMessage,messageChunk:i.AIMessageChunk},system:{message:c.SystemMessage,messageChunk:c.SystemMessageChunk},developer:{message:c.SystemMessage,messageChunk:c.SystemMessageChunk},tool:{message:d.ToolMessage,messageChunk:d.ToolMessageChunk},function:{message:o.FunctionMessage,messageChunk:o.FunctionMessageChunk},generic:{message:s.ChatMessage,messageChunk:s.ChatMessageChunk},remove:{message:u.RemoveMessage,messageChunk:u.RemoveMessage}};function v(e,t,r){let n,a;switch(e){case"human":r?n=new l.HumanMessageChunk(t):a=new l.HumanMessage(t);break;case"ai":if(r){let e={...t};"tool_calls"in e&&(e={...e,tool_call_chunks:e.tool_calls?.map(e=>({...e,type:"tool_call_chunk",index:void 0,args:JSON.stringify(e.args)}))}),n=new i.AIMessageChunk(e)}else a=new i.AIMessage(t);break;case"system":r?n=new c.SystemMessageChunk(t):a=new c.SystemMessage(t);break;case"developer":r?n=new c.SystemMessageChunk({...t,additional_kwargs:{...t.additional_kwargs,__openai_role__:"developer"}}):a=new c.SystemMessage({...t,additional_kwargs:{...t.additional_kwargs,__openai_role__:"developer"}});break;case"tool":if("tool_call_id"in t)r?n=new d.ToolMessageChunk(t):a=new d.ToolMessage(t);else throw Error("Can not convert ToolMessage to ToolMessageChunk if 'tool_call_id' field is not defined.");break;case"function":if(r)n=new o.FunctionMessageChunk(t);else{if(!t.name)throw Error("FunctionMessage must have a 'name' field");a=new o.FunctionMessage(t)}break;case"generic":if("role"in t)r?n=new s.ChatMessageChunk(t):a=new s.ChatMessage(t);else throw Error("Can not convert ChatMessage to ChatMessageChunk if 'role' field is not defined.");break;default:throw Error(`Unrecognized message type ${e}`)}if(r&&n)return n;if(a)return a;throw Error(`Unrecognized message type ${e}`)}function w(e){let t=e.split("\n");return Promise.resolve([...t.slice(0,-1).map(e=>`${e}
`),t[t.length-1]])}},39512,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.isToolMessageChunk=r.isToolMessage=r.ToolMessageChunk=r.ToolMessage=void 0,i(e.r(46404),r),i(e.r(98508),r),i(e.r(57845),r),i(e.r(96040),r),i(e.r(61785),r),i(e.r(11839),r),i(e.r(12556),r),i(e.r(27548),r),i(e.r(2758),r),i(e.r(26065),r);var a=e.r(85257);Object.defineProperty(r,"ToolMessage",{enumerable:!0,get:function(){return a.ToolMessage}}),Object.defineProperty(r,"ToolMessageChunk",{enumerable:!0,get:function(){return a.ToolMessageChunk}}),Object.defineProperty(r,"isToolMessage",{enumerable:!0,get:function(){return a.isToolMessage}}),Object.defineProperty(r,"isToolMessageChunk",{enumerable:!0,get:function(){return a.isToolMessageChunk}})},22991,(e,t,r)=>{t.exports=e.r(39512)},82581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.insecureHash=void 0;var n={},i="0123456789abcdef".split(""),a=[-0x80000000,8388608,32768,128],s=[24,16,8,0],o=[];function l(e){e?(o[0]=o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0,this.blocks=o):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=0x67452301,this.h1=0xefcdab89,this.h2=0x98badcfe,this.h3=0x10325476,this.h4=0xc3d2e1f0,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}l.prototype.update=function(e){if(!this.finalized){var t="string"!=typeof e;t&&e.constructor===n.ArrayBuffer&&(e=new Uint8Array(e));for(var r,i,a=0,o=e.length||0,l=this.blocks;a<o;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),t)for(i=this.start;a<o&&i<64;++a)l[i>>2]|=e[a]<<s[3&i++];else for(i=this.start;a<o&&i<64;++a)(r=e.charCodeAt(a))<128?l[i>>2]|=r<<s[3&i++]:(r<2048?l[i>>2]|=(192|r>>6)<<s[3&i++]:(r<55296||r>=57344?l[i>>2]|=(224|r>>12)<<s[3&i++]:(r=65536+((1023&r)<<10|1023&e.charCodeAt(++a)),l[i>>2]|=(240|r>>18)<<s[3&i++],l[i>>2]|=(128|r>>12&63)<<s[3&i++]),l[i>>2]|=(128|r>>6&63)<<s[3&i++]),l[i>>2]|=(128|63&r)<<s[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=l[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>0xffffffff&&(this.hBytes+=this.bytes/0x100000000|0,this.bytes=this.bytes%0x100000000),this}},l.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=a[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},l.prototype.hash=function(){var e,t,r,n=this.h0,i=this.h1,a=this.h2,s=this.h3,o=this.h4,l=this.blocks;for(t=16;t<80;++t)r=l[t-3]^l[t-8]^l[t-14]^l[t-16],l[t]=r<<1|r>>>31;for(t=0;t<20;t+=5)e=i&a|~i&s,o=(r=n<<5|n>>>27)+e+o+0x5a827999+l[t]|0,e=n&(i=i<<30|i>>>2)|~n&a,s=(r=o<<5|o>>>27)+e+s+0x5a827999+l[t+1]|0,e=o&(n=n<<30|n>>>2)|~o&i,a=(r=s<<5|s>>>27)+e+a+0x5a827999+l[t+2]|0,e=s&(o=o<<30|o>>>2)|~s&n,i=(r=a<<5|a>>>27)+e+i+0x5a827999+l[t+3]|0,e=a&(s=s<<30|s>>>2)|~a&o,n=(r=i<<5|i>>>27)+e+n+0x5a827999+l[t+4]|0,a=a<<30|a>>>2;for(;t<40;t+=5)e=i^a^s,o=(r=n<<5|n>>>27)+e+o+0x6ed9eba1+l[t]|0,e=n^(i=i<<30|i>>>2)^a,s=(r=o<<5|o>>>27)+e+s+0x6ed9eba1+l[t+1]|0,e=o^(n=n<<30|n>>>2)^i,a=(r=s<<5|s>>>27)+e+a+0x6ed9eba1+l[t+2]|0,e=s^(o=o<<30|o>>>2)^n,i=(r=a<<5|a>>>27)+e+i+0x6ed9eba1+l[t+3]|0,e=a^(s=s<<30|s>>>2)^o,n=(r=i<<5|i>>>27)+e+n+0x6ed9eba1+l[t+4]|0,a=a<<30|a>>>2;for(;t<60;t+=5)e=i&a|i&s|a&s,o=(r=n<<5|n>>>27)+e+o-0x70e44324+l[t]|0,e=n&(i=i<<30|i>>>2)|n&a|i&a,s=(r=o<<5|o>>>27)+e+s-0x70e44324+l[t+1]|0,e=o&(n=n<<30|n>>>2)|o&i|n&i,a=(r=s<<5|s>>>27)+e+a-0x70e44324+l[t+2]|0,e=s&(o=o<<30|o>>>2)|s&n|o&n,i=(r=a<<5|a>>>27)+e+i-0x70e44324+l[t+3]|0,e=a&(s=s<<30|s>>>2)|a&o|s&o,n=(r=i<<5|i>>>27)+e+n-0x70e44324+l[t+4]|0,a=a<<30|a>>>2;for(;t<80;t+=5)e=i^a^s,o=(r=n<<5|n>>>27)+e+o-0x359d3e2a+l[t]|0,e=n^(i=i<<30|i>>>2)^a,s=(r=o<<5|o>>>27)+e+s-0x359d3e2a+l[t+1]|0,e=o^(n=n<<30|n>>>2)^i,a=(r=s<<5|s>>>27)+e+a-0x359d3e2a+l[t+2]|0,e=s^(o=o<<30|o>>>2)^n,i=(r=a<<5|a>>>27)+e+i-0x359d3e2a+l[t+3]|0,e=a^(s=s<<30|s>>>2)^o,n=(r=i<<5|i>>>27)+e+n-0x359d3e2a+l[t+4]|0,a=a<<30|a>>>2;this.h0=this.h0+n|0,this.h1=this.h1+i|0,this.h2=this.h2+a|0,this.h3=this.h3+s|0,this.h4=this.h4+o|0},l.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,a=this.h4;return i[e>>28&15]+i[e>>24&15]+i[e>>20&15]+i[e>>16&15]+i[e>>12&15]+i[e>>8&15]+i[e>>4&15]+i[15&e]+i[t>>28&15]+i[t>>24&15]+i[t>>20&15]+i[t>>16&15]+i[t>>12&15]+i[t>>8&15]+i[t>>4&15]+i[15&t]+i[r>>28&15]+i[r>>24&15]+i[r>>20&15]+i[r>>16&15]+i[r>>12&15]+i[r>>8&15]+i[r>>4&15]+i[15&r]+i[n>>28&15]+i[n>>24&15]+i[n>>20&15]+i[n>>16&15]+i[n>>12&15]+i[n>>8&15]+i[n>>4&15]+i[15&n]+i[a>>28&15]+i[a>>24&15]+i[a>>20&15]+i[a>>16&15]+i[a>>12&15]+i[a>>8&15]+i[a>>4&15]+i[15&a]},l.prototype.toString=l.prototype.hex,l.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4;return[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24&255,r>>16&255,r>>8&255,255&r,n>>24&255,n>>16&255,n>>8&255,255&n,i>>24&255,i>>16&255,i>>8&255,255&i]},l.prototype.array=l.prototype.digest,l.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};let u=!1;r.insecureHash=e=>(u||(console.warn(`The default method for hashing keys is insecure and will be replaced in a future version,
but hasn't been replaced yet as to not break existing caches. It's recommended that you use
a more secure hashing algorithm to avoid cache poisoning.

See this page for more information:
|
â””> https://js.langchain.com/docs/troubleshooting/warnings/insecure-cache-algorithm`),u=!0),new l(!0).update(e).hex())},55912,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sha256=void 0;var n="0123456789abcdef".split(""),i=[-0x80000000,8388608,32768,128],a=[24,16,8,0],s=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2],o=[];function l(e,t){t?(o[0]=o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0,this.blocks=o):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=0xc1059ed8,this.h1=0x367cd507,this.h2=0x3070dd17,this.h3=0xf70e5939,this.h4=0xffc00b31,this.h5=0x68581511,this.h6=0x64f98fa7,this.h7=0xbefa4fa4):(this.h0=0x6a09e667,this.h1=0xbb67ae85,this.h2=0x3c6ef372,this.h3=0xa54ff53a,this.h4=0x510e527f,this.h5=0x9b05688c,this.h6=0x1f83d9ab,this.h7=0x5be0cd19),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}l.prototype.update=function(e){if(!this.finalized){var t,r=typeof e;if("string"!==r){if("object"===r){if(null===e)throw Error(ERROR);else if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!Array.isArray(e)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(e)))throw Error(ERROR)}else throw Error(ERROR);t=!0}for(var n,i,s=0,o=e.length,l=this.blocks;s<o;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,this.block=l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),t)for(i=this.start;s<o&&i<64;++s)l[i>>>2]|=e[s]<<a[3&i++];else for(i=this.start;s<o&&i<64;++s)(n=e.charCodeAt(s))<128?l[i>>>2]|=n<<a[3&i++]:(n<2048?l[i>>>2]|=(192|n>>>6)<<a[3&i++]:(n<55296||n>=57344?l[i>>>2]|=(224|n>>>12)<<a[3&i++]:(n=65536+((1023&n)<<10|1023&e.charCodeAt(++s)),l[i>>>2]|=(240|n>>>18)<<a[3&i++],l[i>>>2]|=(128|n>>>12&63)<<a[3&i++]),l[i>>>2]|=(128|n>>>6&63)<<a[3&i++]),l[i>>>2]|=(128|63&n)<<a[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=l[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>0xffffffff&&(this.hBytes+=this.bytes/0x100000000|0,this.bytes=this.bytes%0x100000000),this}},l.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>>2]|=i[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},l.prototype.hash=function(){var e,t,r,n,i,a,o,l,u,c,d=this.h0,p=this.h1,h=this.h2,f=this.h3,m=this.h4,g=this.h5,y=this.h6,b=this.h7,_=this.blocks;for(e=16;e<64;++e)t=((i=_[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,r=((i=_[e-2])>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,_[e]=_[e-16]+t+_[e-7]+r|0;for(e=0,c=p&h;e<64;e+=4)this.first?(this.is224?(o=300032,b=(i=_[0]-0x543c9a5b)-0x8f1a6c7|0,f=i+0x170e9b5|0):(o=0x2a01a605,b=(i=_[0]-0xc881298)-0x5ab00ac6|0,f=i+0x8909ae5|0),this.first=!1):(t=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),r=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7),n=(o=d&p)^d&h^c,i=b+r+(m&g^~m&y)+s[e]+_[e],a=t+n,b=f+i|0,f=i+a|0),t=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),r=(b>>>6|b<<26)^(b>>>11|b<<21)^(b>>>25|b<<7),n=(l=f&d)^f&p^o,i=g+r+(y&b^~y&m)+s[e+1]+_[e+1],a=t+n,y=h+i|0,t=((h=i+a|0)>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),r=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),n=(u=h&f)^h&d^l,i=m+r+(g&y^~g&b)+s[e+2]+_[e+2],a=t+n,g=p+i|0,t=((p=i+a|0)>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10),r=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),n=(c=p&h)^p&f^u,i=m+r+(g&y^~g&b)+s[e+3]+_[e+3],a=t+n,m=d+i|0,d=i+a|0,this.chromeBugWorkAround=!0;this.h0=this.h0+d|0,this.h1=this.h1+p|0,this.h2=this.h2+h|0,this.h3=this.h3+f|0,this.h4=this.h4+m|0,this.h5=this.h5+g|0,this.h6=this.h6+y|0,this.h7=this.h7+b|0},l.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,i=this.h3,a=this.h4,s=this.h5,o=this.h6,l=this.h7,u=n[e>>>28&15]+n[e>>>24&15]+n[e>>>20&15]+n[e>>>16&15]+n[e>>>12&15]+n[e>>>8&15]+n[e>>>4&15]+n[15&e]+n[t>>>28&15]+n[t>>>24&15]+n[t>>>20&15]+n[t>>>16&15]+n[t>>>12&15]+n[t>>>8&15]+n[t>>>4&15]+n[15&t]+n[r>>>28&15]+n[r>>>24&15]+n[r>>>20&15]+n[r>>>16&15]+n[r>>>12&15]+n[r>>>8&15]+n[r>>>4&15]+n[15&r]+n[i>>>28&15]+n[i>>>24&15]+n[i>>>20&15]+n[i>>>16&15]+n[i>>>12&15]+n[i>>>8&15]+n[i>>>4&15]+n[15&i]+n[a>>>28&15]+n[a>>>24&15]+n[a>>>20&15]+n[a>>>16&15]+n[a>>>12&15]+n[a>>>8&15]+n[a>>>4&15]+n[15&a]+n[s>>>28&15]+n[s>>>24&15]+n[s>>>20&15]+n[s>>>16&15]+n[s>>>12&15]+n[s>>>8&15]+n[s>>>4&15]+n[15&s]+n[o>>>28&15]+n[o>>>24&15]+n[o>>>20&15]+n[o>>>16&15]+n[o>>>12&15]+n[o>>>8&15]+n[o>>>4&15]+n[15&o];return this.is224||(u+=n[l>>>28&15]+n[l>>>24&15]+n[l>>>20&15]+n[l>>>16&15]+n[l>>>12&15]+n[l>>>8&15]+n[l>>>4&15]+n[15&l]),u},l.prototype.toString=l.prototype.hex,l.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,a=this.h5,s=this.h6,o=this.h7,l=[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i>>>24&255,i>>>16&255,i>>>8&255,255&i,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s];return this.is224||l.push(o>>>24&255,o>>>16&255,o>>>8&255,255&o),l},l.prototype.array=l.prototype.digest,l.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},r.sha256=(...e)=>new l(!1,!0).update(e.join("")).hex()},47882,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sha256=r.insecureHash=void 0;var n=e.r(82581);Object.defineProperty(r,"insecureHash",{enumerable:!0,get:function(){return n.insecureHash}});var i=e.r(55912);Object.defineProperty(r,"sha256",{enumerable:!0,get:function(){return i.sha256}})},88041,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InMemoryCache=r.BaseCache=r.getCacheKey=void 0,r.deserializeStoredGeneration=function(e){return void 0!==e.message?{text:e.text,message:(0,i.mapStoredMessageToChatMessage)(e.message)}:{text:e.text}},r.serializeGeneration=function(e){let t={text:e.text};return void 0!==e.message&&(t.message=e.message.toDict()),t};let n=e.r(47882),i=e.r(12556);r.getCacheKey=(...e)=>(0,n.insecureHash)(e.join("_"));class a{constructor(){Object.defineProperty(this,"keyEncoder",{enumerable:!0,configurable:!0,writable:!0,value:r.getCacheKey})}makeDefaultKeyEncoder(e){this.keyEncoder=e}}r.BaseCache=a;let s=new Map;class o extends a{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(this.keyEncoder(e,t))??null)}async update(e,t,r){this.cache.set(this.keyEncoder(e,t),r)}static global(){return new o(s)}}r.InMemoryCache=o},63983,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ImagePromptValue=r.ChatPromptValue=r.StringPromptValue=r.BasePromptValue=void 0;let n=e.r(46893),i=e.r(61785),a=e.r(12556);class s extends n.Serializable{}r.BasePromptValue=s,r.StringPromptValue=class extends s{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new i.HumanMessage(this.value)]}},r.ChatPromptValue=class extends s{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return(0,a.getBufferString)(this.messages)}toChatMessages(){return this.messages}},r.ImagePromptValue=class extends s{static lc_name(){return"ImagePromptValue"}constructor(e){"imageUrl"in e||(e={imageUrl:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"imageUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.imageUrl=e.imageUrl}toString(){return this.imageUrl.url}toChatMessages(){return[new i.HumanMessage({content:[{type:"image_url",image_url:{detail:this.imageUrl.detail,url:this.imageUrl.url}}]})]}}},6920,(e,t,r)=>{"use strict";r.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return(r+n)*3/4-n},r.toByteArray=function(e){var t,r,n=u(e),s=n[0],o=n[1],l=new a((s+o)*3/4-o),c=0,d=o>0?s-4:s;for(r=0;r<d;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;return 2===o&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,l[c++]=255&t),1===o&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t),l},r.fromByteArray=function(e){for(var t,r=e.length,i=r%3,a=[],s=0,o=r-i;s<o;s+=16383)a.push(function(e,t,r){for(var i,a=[],s=t;s<r;s+=3)i=(e[s]<<16&0xff0000)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[i>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return a.join("")}(e,s,s+16383>o?o:s+16383));return 1===i?a.push(n[(t=e[r-1])>>2]+n[t<<4&63]+"=="):2===i&&a.push(n[(t=(e[r-2]<<8)+e[r-1])>>10]+n[t>>4&63]+n[t<<2&63]+"="),a.join("")};for(var n=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=s.length;o<l;++o)n[o]=s[o],i[s.charCodeAt(o)]=o;function u(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}i[45]=62,i[95]=63},19018,(e,t,r)=>{"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(e.r(6920)),i=Object.defineProperty,a=class{specialTokens;inverseSpecialTokens;patStr;textEncoder=new TextEncoder;textDecoder=new TextDecoder("utf-8");rankMap=new Map;textMap=new Map;constructor(e,t){for(let[t,r]of(this.patStr=e.pat_str,Object.entries(e.bpe_ranks.split("\n").filter(Boolean).reduce((e,t)=>{let[r,n,...i]=t.split(" "),a=Number.parseInt(n,10);return i.forEach((t,r)=>e[t]=a+r),e},{})))){let e=n.default.toByteArray(t);this.rankMap.set(e.join(","),r),this.textMap.set(r,e)}this.specialTokens={...e.special_tokens,...t},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((e,[t,r])=>(e[r]=this.textEncoder.encode(t),e),{})}encode(e,t=[],r="all"){let n=RegExp(this.patStr,"ug"),i=a.specialTokenRegex(Object.keys(this.specialTokens)),s=[],o=new Set("all"===t?Object.keys(this.specialTokens):t),l=new Set("all"===r?Object.keys(this.specialTokens).filter(e=>!o.has(e)):r);if(l.size>0){let t=a.specialTokenRegex([...l]),r=e.match(t);if(null!=r)throw Error(`The text contains a special token that is not allowed: ${r[0]}`)}let u=0;for(;;){let t=null,r=u;for(;i.lastIndex=r,!(null==(t=i.exec(e))||o.has(t[0]));)r=t.index+1;let a=t?.index??e.length;for(let t of e.substring(u,a).matchAll(n)){let e=this.textEncoder.encode(t[0]),r=this.rankMap.get(e.join(","));if(null!=r){s.push(r);continue}s.push(...function(e,t){return 1===e.length?[t.get(e.join(","))]:(function(e,t){let r=Array.from({length:e.length},(e,t)=>({start:t,end:t+1}));for(;r.length>1;){let n=null;for(let i=0;i<r.length-1;i++){let a=e.slice(r[i].start,r[i+1].end),s=t.get(a.join(","));null!=s&&(null==n||s<n[0])&&(n=[s,i])}if(null!=n){let e=n[1];r[e]={start:r[e].start,end:r[e+1].end},r.splice(e+1,1)}else break}return r})(e,t).map(r=>t.get(e.slice(r.start,r.end).join(","))).filter(e=>null!=e)}(e,this.rankMap))}if(null==t)break;let l=this.specialTokens[t[0]];s.push(l),u=t.index+t[0].length}return s}decode(e){let t=[],r=0;for(let n=0;n<e.length;++n){let i=e[n],a=this.textMap.get(i)??this.inverseSpecialTokens[i];null!=a&&(t.push(a),r+=a.length)}let n=new Uint8Array(r),i=0;for(let e of t)n.set(e,i),i+=e.length;return this.textDecoder.decode(n)}};((e,t,r)=>((e,t,r)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r))(a,"specialTokenRegex",e=>RegExp(e.map(e=>e.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")).join("|"),"g")),r.Tiktoken=a,r.getEncodingNameForModel=function(e){switch(e){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"gpt-4o-search-preview":case"gpt-4o-search-preview-2025-03-11":case"gpt-4o-mini-search-preview":case"gpt-4o-mini-search-preview-2025-03-11":case"gpt-4o-audio-preview":case"gpt-4o-audio-preview-2024-12-17":case"gpt-4o-audio-preview-2024-10-01":case"gpt-4o-mini-audio-preview":case"gpt-4o-mini-audio-preview-2024-12-17":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-mini-2024-09-12":case"o1-preview":case"o1-preview-2024-09-12":case"o1-pro":case"o1-pro-2025-03-19":case"o3":case"o3-2025-04-16":case"o3-mini":case"o3-mini-2025-01-31":case"o4-mini":case"o4-mini-2025-04-16":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":case"gpt-4o-realtime-preview-2024-12-17":case"gpt-4o-mini-realtime-preview":case"gpt-4o-mini-realtime-preview-2024-12-17":case"gpt-4.1":case"gpt-4.1-2025-04-14":case"gpt-4.1-mini":case"gpt-4.1-mini-2025-04-14":case"gpt-4.1-nano":case"gpt-4.1-nano-2025-04-14":case"gpt-4.5-preview":case"gpt-4.5-preview-2025-02-27":case"gpt-5":case"gpt-5-2025-08-07":case"gpt-5-nano":case"gpt-5-nano-2025-08-07":case"gpt-5-mini":case"gpt-5-mini-2025-08-07":case"gpt-5-chat-latest":return"o200k_base";default:throw Error("Unknown model")}}},22905,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getEncoding=o,r.encodingForModel=l;let n=e.r(19018),i=e.r(1344),a={},s=new i.AsyncCaller({});async function o(e){return e in a||(a[e]=s.fetch(`https://tiktoken.pages.dev/js/${e}.json`).then(e=>e.json()).then(e=>new n.Tiktoken(e)).catch(t=>{throw delete a[e],t})),await a[e]}async function l(e){return o((0,n.getEncodingNameForModel)(e))}},85864,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseLanguageModel=r.BaseLangChain=r.calculateMaxTokens=r.getModelContextSize=r.getEmbeddingContextSize=r.getModelNameForTiktoken=void 0,r.isOpenAITool=function(e){return"object"==typeof e&&!!e&&("type"in e&&"function"===e.type&&"function"in e&&"object"==typeof e.function&&!!e.function&&"name"in e.function&&"parameters"in e.function||!1)};let n=e.r(88041),i=e.r(63983),a=e.r(12556),s=e.r(1344),o=e.r(22905),l=e.r(68974);r.getModelNameForTiktoken=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e,r.getEmbeddingContextSize=e=>"text-embedding-ada-002"===e?8191:2046,r.getModelContextSize=e=>{switch((0,r.getModelNameForTiktoken)(e)){case"gpt-3.5-turbo-16k":return 16384;case"gpt-3.5-turbo":return 4096;case"gpt-4-32k":return 32768;case"gpt-4":return 8192;case"text-davinci-003":default:return 4097;case"text-curie-001":case"text-babbage-001":case"text-ada-001":case"code-cushman-001":return 2048;case"code-davinci-002":return 8e3}};let u=async({prompt:e,modelName:t})=>{let n;try{n=(await (0,o.encodingForModel)((0,r.getModelNameForTiktoken)(t))).encode(e).length}catch(t){console.warn("Failed to calculate number of tokens, falling back to approximate count"),n=Math.ceil(e.length/4)}return(0,r.getModelContextSize)(t)-n};r.calculateMaxTokens=u;class c extends l.Runnable{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??!1,this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}r.BaseLangChain=c,r.BaseLanguageModel=class extends c{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...r}){let{cache:i,...a}=r;super({callbacks:e??t,...a}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),"object"==typeof i?this.cache=i:i?this.cache=n.InMemoryCache.global():this.cache=void 0,this.caller=new s.AsyncCaller(r??{})}async getNumTokens(e){let t,n=Math.ceil((t="string"==typeof e?e:e.map(e=>"string"==typeof e?e:"text"===e.type&&"text"in e?e.text:"").join("")).length/4);if(!this._encoding)try{this._encoding=await (0,o.encodingForModel)("modelName"in this?(0,r.getModelNameForTiktoken)(this.modelName):"gpt2")}catch(e){console.warn("Failed to calculate number of tokens, falling back to approximate count",e)}if(this._encoding)try{n=this._encoding.encode(t).length}catch(e){console.warn("Failed to calculate number of tokens, falling back to approximate count",e)}return n}static _convertInputToPromptValue(e){return"string"==typeof e?new i.StringPromptValue(e):Array.isArray(e)?new i.ChatPromptValue(e.map(a.coerceMessageLikeToMessage)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...t}){return Object.entries({...this._identifyingParams(),...t,_type:this._llmType(),_model:this._modelType()}).filter(([e,t])=>void 0!==t).map(([e,t])=>`${e}:${JSON.stringify(t)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw Error("Use .toJSON() instead")}}},45440,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RunnablePassthrough=void 0;let n=e.r(62350),i=e.r(68974),a=e.r(81425);class s extends i.Runnable{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,t){let r=(0,a.ensureConfig)(t);return this.func&&await this.func(e,r),this._callWithConfig(e=>Promise.resolve(e),e,r)}async *transform(e,t){let r,i=(0,a.ensureConfig)(t),s=!0;for await(let t of this._transformStreamWithConfig(e,e=>e,i))if(yield t,s)if(void 0===r)r=t;else try{r=(0,n.concat)(r,t)}catch{r=void 0,s=!1}this.func&&void 0!==r&&await this.func(r,i)}static assign(e){return new i.RunnableAssign(new i.RunnableMap({steps:e}))}}r.RunnablePassthrough=s},79425,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SimpleChatModel=r.BaseChatModel=void 0,r.createChatMessageChunkEncoderStream=function(){let e=new TextEncoder;return new TransformStream({transform(t,r){r.enqueue(e.encode("string"==typeof t.content?t.content:JSON.stringify(t.content)))}})};let n=e.r(39512),i=e.r(13583),a=e.r(85864),s=e.r(75622),o=e.r(68974),l=e.r(62350),u=e.r(45440),c=e.r(29164),d=e.r(9255),p=e.r(30952);function h(e){let t=[];for(let r of e){let e=r;if(Array.isArray(r.content))for(let t=0;t<r.content.length;t++){let i=r.content[t];((0,n.isURLContentBlock)(i)||(0,n.isBase64ContentBlock)(i))&&e===r&&(e=new r.constructor({...e,content:[...r.content.slice(0,t),(0,n.convertToOpenAIImageBlock)(i),...r.content.slice(t+1)]}))}t.push(e)}return t}class f extends a.BaseLanguageModel{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){let[t,r]=super._separateRunnableConfigFromCallOptions(e);return r.signal=t.signal,[t,r]}async invoke(e,t){let r=f._convertInputToPromptValue(e);return(await this.generatePrompt([r],t,t?.callbacks)).generations[0][0].message}async *_streamResponseChunks(e,t,r){throw Error("Not implemented.")}async *_streamIterator(e,t){if(this._streamResponseChunks===f.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,t);else{let r,i,a=f._convertInputToPromptValue(e).toChatMessages(),[o,l]=this._separateRunnableConfigFromCallOptionsCompat(t),u={...o.metadata,...this.getLsParams(l)},c=await s.CallbackManager.configure(o.callbacks,this.callbacks,o.tags,this.tags,u,this.metadata,{verbose:this.verbose}),d={options:l,invocation_params:this?.invocationParams(l),batch_size:1},p=await c?.handleChatModelStart(this.toJSON(),[h(a)],o.runId,void 0,d,void 0,void 0,o.runName);try{for await(let e of this._streamResponseChunks(a,l,p?.[0])){if(null==e.message.id){let t=p?.at(0)?.runId;null!=t&&e.message._updateId(`run-${t}`)}e.message.response_metadata={...e.generationInfo,...e.message.response_metadata},yield e.message,r=r?r.concat(e):e,(0,n.isAIMessageChunk)(e.message)&&void 0!==e.message.usage_metadata&&(i={tokenUsage:{promptTokens:e.message.usage_metadata.input_tokens,completionTokens:e.message.usage_metadata.output_tokens,totalTokens:e.message.usage_metadata.total_tokens}})}}catch(e){throw await Promise.all((p??[]).map(t=>t?.handleLLMError(e))),e}await Promise.all((p??[]).map(e=>e?.handleLLMEnd({generations:[[r]],llmOutput:i})))}}getLsParams(e){let t=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:t}}async _generateUncached(e,t,r,a){let o,u=e.map(e=>e.map(n.coerceMessageLikeToMessage));if(void 0!==a&&a.length===u.length)o=a;else{let e={...r.metadata,...this.getLsParams(t)},n=await s.CallbackManager.configure(r.callbacks,this.callbacks,r.tags,this.tags,e,this.metadata,{verbose:this.verbose}),i={options:t,invocation_params:this?.invocationParams(t),batch_size:1};o=await n?.handleChatModelStart(this.toJSON(),u.map(h),r.runId,void 0,i,void 0,void 0,r.runName)}let c=[],p=[];if(o?.[0].handlers.find(d.callbackHandlerPrefersStreaming)&&!this.disableStreaming&&1===u.length&&this._streamResponseChunks!==f.prototype._streamResponseChunks)try{let e,r;for await(let i of(await this._streamResponseChunks(u[0],t,o?.[0]))){if(null==i.message.id){let e=o?.at(0)?.runId;null!=e&&i.message._updateId(`run-${e}`)}e=void 0===e?i:(0,l.concat)(e,i),(0,n.isAIMessageChunk)(i.message)&&void 0!==i.message.usage_metadata&&(r={tokenUsage:{promptTokens:i.message.usage_metadata.input_tokens,completionTokens:i.message.usage_metadata.output_tokens,totalTokens:i.message.usage_metadata.total_tokens}})}if(void 0===e)throw Error("Received empty response from chat model call.");c.push([e]),await o?.[0].handleLLMEnd({generations:c,llmOutput:r})}catch(e){throw await o?.[0].handleLLMError(e),e}else{let e=await Promise.allSettled(u.map((e,r)=>this._generate(e,{...t,promptIndex:r},o?.[r])));await Promise.all(e.map(async(e,t)=>{if("fulfilled"!==e.status)return await o?.[t]?.handleLLMError(e.reason),Promise.reject(e.reason);{let r=e.value;for(let e of r.generations){if(null==e.message.id){let t=o?.at(0)?.runId;null!=t&&e.message._updateId(`run-${t}`)}e.message.response_metadata={...e.generationInfo,...e.message.response_metadata}}return 1===r.generations.length&&(r.generations[0].message.response_metadata={...r.llmOutput,...r.generations[0].message.response_metadata}),c[t]=r.generations,p[t]=r.llmOutput,o?.[t]?.handleLLMEnd({generations:[r.generations],llmOutput:r.llmOutput})}}))}let m={generations:c,llmOutput:p.length?this._combineLLMOutput?.(...p):void 0};return Object.defineProperty(m,i.RUN_KEY,{value:o?{runIds:o?.map(e=>e.runId)}:void 0,configurable:!0}),m}async _generateCached({messages:e,cache:t,llmStringKey:r,parsedOptions:a,handledOptions:o}){let l=e.map(e=>e.map(n.coerceMessageLikeToMessage)),u={...o.metadata,...this.getLsParams(a)},c=await s.CallbackManager.configure(o.callbacks,this.callbacks,o.tags,this.tags,u,this.metadata,{verbose:this.verbose}),d={options:a,invocation_params:this?.invocationParams(a),batch_size:1},p=await c?.handleChatModelStart(this.toJSON(),l.map(h),o.runId,void 0,d,void 0,void 0,o.runName),m=[],g=(await Promise.allSettled(l.map(async(e,n)=>{let i=f._convertInputToPromptValue(e).toString(),a=await t.lookup(i,r);return null==a&&m.push(n),a}))).map((e,t)=>({result:e,runManager:p?.[t]})).filter(({result:e})=>"fulfilled"===e.status&&null!=e.value||"rejected"===e.status),y=[];await Promise.all(g.map(async({result:e,runManager:t},r)=>{if("fulfilled"!==e.status)return await t?.handleLLMError(e.reason,void 0,void 0,void 0,{cached:!0}),Promise.reject(e.reason);{let i=e.value;return y[r]=i.map(e=>("message"in e&&(0,n.isBaseMessage)(e.message)&&(0,n.isAIMessage)(e.message)&&(e.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),e.generationInfo={...e.generationInfo,tokenUsage:{}},e)),i.length&&await t?.handleLLMNewToken(i[0].text),t?.handleLLMEnd({generations:[i]},void 0,void 0,void 0,{cached:!0})}}));let b={generations:y,missingPromptIndices:m,startedRunManagers:p};return Object.defineProperty(b,i.RUN_KEY,{value:p?{runIds:p?.map(e=>e.runId)}:void 0,configurable:!0}),b}async generate(e,t,r){let i;i=Array.isArray(t)?{stop:t}:t;let a=e.map(e=>e.map(n.coerceMessageLikeToMessage)),[s,o]=this._separateRunnableConfigFromCallOptionsCompat(i);if(s.callbacks=s.callbacks??r,!this.cache)return this._generateUncached(a,o,s);let{cache:l}=this,u=this._getSerializedCacheKeyParametersForCall(o),{generations:c,missingPromptIndices:d,startedRunManagers:p}=await this._generateCached({messages:a,cache:l,llmStringKey:u,parsedOptions:o,handledOptions:s}),h={};if(d.length>0){let e=await this._generateUncached(d.map(e=>a[e]),o,s,void 0!==p?d.map(e=>p?.[e]):void 0);await Promise.all(e.generations.map(async(e,t)=>{let r=d[t];c[r]=e;let n=f._convertInputToPromptValue(a[r]).toString();return l.update(n,u,e)})),h=e.llmOutput??{}}return{generations:c,llmOutput:h}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,t,r){let n=e.map(e=>e.toChatMessages());return this.generate(n,t,r)}async call(e,t,r){return(await this.generate([e.map(n.coerceMessageLikeToMessage)],t,r)).generations[0][0].message}async callPrompt(e,t,r){let n=e.toChatMessages();return this.call(n,t,r)}async predictMessages(e,t,r){return this.call(e,t,r)}async predict(e,t,r){let i=new n.HumanMessage(e),a=await this.call([i],t,r);if("string"!=typeof a.content)throw Error("Cannot use predict when output is not a string.");return a.content}withStructuredOutput(e,t){let r;if("function"!=typeof this.bindTools)throw Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(t?.strict)throw Error('"strict" mode is not supported for this model by default.');let n=t?.name,i=(0,c.getSchemaDescription)(e)??"A function available to call.",a=t?.method,s=t?.includeRaw;if("jsonMode"===a)throw Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let l=n??"extract";(0,c.isInteropZodSchema)(e)?r=[{type:"function",function:{name:l,description:i,parameters:(0,p.toJsonSchema)(e)}}]:("name"in e&&(l=e.name),r=[{type:"function",function:{name:l,description:i,parameters:e}}]);let d=this.bindTools(r),h=o.RunnableLambda.from(e=>{if(!e.tool_calls||0===e.tool_calls.length)throw Error("No tool calls found in the response.");let t=e.tool_calls.find(e=>e.name===l);if(!t)throw Error(`No tool call found with name ${l}.`);return t.args});if(!s)return d.pipe(h).withConfig({runName:"StructuredOutput"});let f=u.RunnablePassthrough.assign({parsed:(e,t)=>h.invoke(e.raw,t)}),m=u.RunnablePassthrough.assign({parsed:()=>null}),g=f.withFallbacks({fallbacks:[m]});return o.RunnableSequence.from([{raw:d},g]).withConfig({runName:"StructuredOutputRunnable"})}}r.BaseChatModel=f,r.SimpleChatModel=class extends f{async _generate(e,t,r){let i=await this._call(e,t,r),a=new n.AIMessage(i);if("string"!=typeof a.content)throw Error("Cannot generate with a simple chat model when output is not a string.");return{generations:[{text:a.content,message:a}]}}}},11144,(e,t,r)=>{t.exports=e.r(79425)},63782,e=>{"use strict";e.s(["DOMException",()=>_,"Headers",()=>l,"Request",()=>m,"Response",()=>y,"fetch",()=>v]);var t="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||e.g||{},r={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(r.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function s(e){return"string"!=typeof e&&(e=String(e)),e}function o(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r.iterable&&(t[Symbol.iterator]=function(){return t}),t}function l(e){this.map={},e instanceof l?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function u(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(TypeError("Already read"));e.bodyUsed=!0}}function c(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function d(e){var t=new FileReader,r=c(t);return t.readAsArrayBuffer(e),r}function p(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(e){if(this.bodyUsed=this.bodyUsed,this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(r.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(r.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else{var t;r.arrayBuffer&&r.blob&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=p(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||i(e))?this._bodyArrayBuffer=p(e):this._bodyText=e=Object.prototype.toString.call(e)}else this._noBody=!0,this._bodyText="";!this.headers.get("content-type")&&("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var e=u(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(!this._bodyFormData)return Promise.resolve(new Blob([this._bodyText]));throw Error("could not read FormData body as blob")}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=u(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(r.blob)return this.blob().then(d);throw Error("could not read as ArrayBuffer")},this.text=function(){var e,t,r,n,i,a=u(this);if(a)return a;if(this._bodyBlob)return e=this._bodyBlob,r=c(t=new FileReader),i=(n=/charset=([A-Za-z0-9_-]+)/.exec(e.type))?n[1]:"utf-8",t.readAsText(e,i),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(!this._bodyFormData)return Promise.resolve(this._bodyText);throw Error("could not read FormData body as text")},r.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}l.prototype.append=function(e,t){e=a(e),t=s(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},l.prototype.delete=function(e){delete this.map[a(e)]},l.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},l.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},l.prototype.set=function(e,t){this.map[a(e)]=s(t)},l.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},l.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),o(e)},l.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),o(e)},l.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),o(e)},r.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var f=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function m(e,r){if(!(this instanceof m))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,i,a=(r=r||{}).body;if(e instanceof m){if(e.bodyUsed)throw TypeError("Already read");this.url=e.url,this.credentials=e.credentials,r.headers||(this.headers=new l(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,a||null==e._bodyInit||(a=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=r.credentials||this.credentials||"same-origin",(r.headers||!this.headers)&&(this.headers=new l(r.headers)),this.method=(i=(n=r.method||this.method||"GET").toUpperCase(),f.indexOf(i)>-1?i:n),this.mode=r.mode||this.mode||null,this.signal=r.signal||this.signal||function(){if("AbortController"in t)return new AbortController().signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&a)throw TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(a),("GET"===this.method||"HEAD"===this.method)&&("no-store"===r.cache||"no-cache"===r.cache)){var s=/([?&])_=[^&]*/;s.test(this.url)?this.url=this.url.replace(s,"$1_="+new Date().getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+new Date().getTime()}}function g(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function y(e,t){if(!(this instanceof y))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new l(t.headers),this.url=t.url||"",this._initBody(e)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},h.call(m.prototype),h.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var b=[301,302,303,307,308];y.redirect=function(e,t){if(-1===b.indexOf(t))throw RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})};var _=t.DOMException;try{new _}catch(e){(_=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack}).prototype=Object.create(Error.prototype),_.prototype.constructor=_}function v(e,n){return new Promise(function(i,o){var u=new m(e,n);if(u.signal&&u.signal.aborted)return o(new _("Aborted","AbortError"));var c=new XMLHttpRequest;function d(){c.abort()}if(c.onload=function(){var e,t,r={statusText:c.statusText,headers:(e=c.getAllResponseHeaders()||"",t=new l,e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();try{t.append(n,i)}catch(e){console.warn("Response "+e.message)}}}),t)};0===u.url.indexOf("file://")&&(c.status<200||c.status>599)?r.status=200:r.status=c.status,r.url="responseURL"in c?c.responseURL:r.headers.get("X-Request-URL");var n="response"in c?c.response:c.responseText;setTimeout(function(){i(new y(n,r))},0)},c.onerror=function(){setTimeout(function(){o(TypeError("Network request failed"))},0)},c.ontimeout=function(){setTimeout(function(){o(TypeError("Network request timed out"))},0)},c.onabort=function(){setTimeout(function(){o(new _("Aborted","AbortError"))},0)},c.open(u.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(t){return e}}(u.url),!0),"include"===u.credentials?c.withCredentials=!0:"omit"===u.credentials&&(c.withCredentials=!1),"responseType"in c&&(r.blob?c.responseType="blob":r.arrayBuffer&&(c.responseType="arraybuffer")),n&&"object"==typeof n.headers&&!(n.headers instanceof l||t.Headers&&n.headers instanceof t.Headers)){var p=[];Object.getOwnPropertyNames(n.headers).forEach(function(e){p.push(a(e)),c.setRequestHeader(e,s(n.headers[e]))}),u.headers.forEach(function(e,t){-1===p.indexOf(t)&&c.setRequestHeader(t,e)})}else u.headers.forEach(function(e,t){c.setRequestHeader(t,e)});u.signal&&(u.signal.addEventListener("abort",d),c.onreadystatechange=function(){4===c.readyState&&u.signal.removeEventListener("abort",d)}),c.send(void 0===u._bodyInit?null:u._bodyInit)})}v.polyfill=!0,t.fetch||(t.fetch=v,t.Headers=l,t.Request=m,t.Response=y)},76370,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),e.r(63782);let n="11434",i=`http://127.0.0.1:${n}`;var a=Object.defineProperty,s=(e,t,r)=>(((e,t,r)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r),r);class o extends Error{constructor(e,t){super(e),this.error=e,this.status_code=t,this.name="ResponseError",Error.captureStackTrace&&Error.captureStackTrace(this,o)}}class l{constructor(e,t,r){s(this,"abortController"),s(this,"itr"),s(this,"doneCallback"),this.abortController=e,this.itr=t,this.doneCallback=r}abort(){this.abortController.abort()}async *[Symbol.asyncIterator](){for await(let e of this.itr){if("error"in e)throw Error(e.error);if(yield e,e.done||"success"===e.status)return void this.doneCallback()}throw Error("Did not receive done or success response in stream.")}}let u=async e=>{if(e.ok)return;let t=`Error ${e.status}: ${e.statusText}`;if(e.headers.get("content-type")?.includes("application/json"))try{t=(await e.json()).error||t}catch(e){console.log("Failed to parse error response as JSON")}else try{console.log("Getting text from response"),t=await e.text()||t}catch(e){console.log("Failed to get text from error response")}throw new o(t,e.status)},c=async(e,t,r={})=>{let n={"Content-Type":"application/json",Accept:"application/json","User-Agent":`ollama-js/0.5.18 (${"undefined"!=typeof process?`${process.arch} ${process.platform} Node.js/${process.version}`:""})`};r.headers=function(e){if(e instanceof Headers){let t={};return e.forEach((e,r)=>{t[r]=e}),t}return Array.isArray(e)?Object.fromEntries(e):e||{}}(r.headers);let i=Object.fromEntries(Object.entries(r.headers).filter(([e])=>!Object.keys(n).some(t=>t.toLowerCase()===e.toLowerCase())));return r.headers={...n,...i},e(t,r)},d=async(e,t,r)=>{let n=await c(e,t,{headers:r?.headers});return await u(n),n},p=async(e,t,r,n)=>{let i=(e=>null!==e&&"object"==typeof e&&!Array.isArray(e))(r)?JSON.stringify(r):r,a=await c(e,t,{method:"POST",body:i,signal:n?.signal,headers:n?.headers});return await u(a),a},h=async(e,t,r,n)=>{let i=await c(e,t,{method:"DELETE",body:JSON.stringify(r),headers:n?.headers});return await u(i),i},f=async function*(e){let t=new TextDecoder("utf-8"),r="",n=e.getReader();for(;;){let{done:e,value:i}=await n.read();if(e)break;let a=(r+=t.decode(i)).split("\n");for(let e of(r=a.pop()??"",a))try{yield JSON.parse(e)}catch(t){console.warn("invalid json: ",e)}}for(let e of r.split("\n").filter(e=>""!==e))try{yield JSON.parse(e)}catch(t){console.warn("invalid json: ",e)}};var m=Object.defineProperty,g=(e,t,r)=>(((e,t,r)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r),r);let y=class{constructor(e){g(this,"config"),g(this,"fetch"),g(this,"ongoingStreamedRequests",[]),this.config={host:"",headers:e?.headers},e?.proxy||(this.config.host=(e=>{if(!e)return i;let t=e.includes("://");e.startsWith(":")&&(e=`http://127.0.0.1${e}`,t=!0),t||(e=`http://${e}`);let r=new URL(e),a=r.port;a||(a=t?"https:"===r.protocol?"443":"80":n);let s="";r.username&&(s=r.username,r.password&&(s+=`:${r.password}`),s+="@");let o=`${r.protocol}//${s}${r.hostname}:${a}${r.pathname}`;return o.endsWith("/")&&(o=o.slice(0,-1)),o})(e?.host??i)),this.fetch=e?.fetch??fetch}abort(){for(let e of this.ongoingStreamedRequests)e.abort();this.ongoingStreamedRequests.length=0}async processStreamableRequest(e,t){t.stream=t.stream??!1;let r=`${this.config.host}/api/${e}`;if(t.stream){let e=new AbortController,n=await p(this.fetch,r,t,{signal:e.signal,headers:this.config.headers});if(!n.body)throw Error("Missing body");let i=new l(e,f(n.body),()=>{let e=this.ongoingStreamedRequests.indexOf(i);e>-1&&this.ongoingStreamedRequests.splice(e,1)});return this.ongoingStreamedRequests.push(i),i}let n=await p(this.fetch,r,t,{headers:this.config.headers});return await n.json()}async encodeImage(e){if("string"!=typeof e){let t=new Uint8Array(e),r="",n=t.byteLength;for(let e=0;e<n;e++)r+=String.fromCharCode(t[e]);return btoa(r)}return e}async generate(e){return e.images&&(e.images=await Promise.all(e.images.map(this.encodeImage.bind(this)))),this.processStreamableRequest("generate",e)}async chat(e){if(e.messages)for(let t of e.messages)t.images&&(t.images=await Promise.all(t.images.map(this.encodeImage.bind(this))));return this.processStreamableRequest("chat",e)}async create(e){return this.processStreamableRequest("create",{...e})}async pull(e){return this.processStreamableRequest("pull",{name:e.model,stream:e.stream,insecure:e.insecure})}async push(e){return this.processStreamableRequest("push",{name:e.model,stream:e.stream,insecure:e.insecure})}async delete(e){return await h(this.fetch,`${this.config.host}/api/delete`,{name:e.model},{headers:this.config.headers}),{status:"success"}}async copy(e){return await p(this.fetch,`${this.config.host}/api/copy`,{...e},{headers:this.config.headers}),{status:"success"}}async list(){let e=await d(this.fetch,`${this.config.host}/api/tags`,{headers:this.config.headers});return await e.json()}async show(e){let t=await p(this.fetch,`${this.config.host}/api/show`,{...e},{headers:this.config.headers});return await t.json()}async embed(e){let t=await p(this.fetch,`${this.config.host}/api/embed`,{...e},{headers:this.config.headers});return await t.json()}async embeddings(e){let t=await p(this.fetch,`${this.config.host}/api/embeddings`,{...e},{headers:this.config.headers});return await t.json()}async ps(){let e=await d(this.fetch,`${this.config.host}/api/ps`,{headers:this.config.headers});return await e.json()}},b=new y;r.Ollama=y,r.default=b},24976,(e,t,r)=>{t.exports=e.r(13583)},55105,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RouterRunnable=void 0;let n=e.r(68974),i=e.r(81425);class a extends n.Runnable{static lc_name(){return"RouterRunnable"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnables=e.runnables}async invoke(e,t){let{key:r,input:n}=e,a=this.runnables[r];if(void 0===a)throw Error(`No runnable associated with key "${r}".`);return a.invoke(n,(0,i.ensureConfig)(t))}async batch(e,t,r){let n=e.map(e=>e.key),i=e.map(e=>e.input);if(void 0!==n.find(e=>void 0===this.runnables[e]))throw Error("One or more keys do not have a corresponding runnable.");let a=n.map(e=>this.runnables[e]),s=this._getOptionsList(t??{},e.length),o=s[0]?.maxConcurrency??r?.maxConcurrency,l=o&&o>0?o:e.length,u=[];for(let e=0;e<i.length;e+=l){let t=i.slice(e,e+l).map((e,t)=>a[t].invoke(e,s[t])),r=await Promise.all(t);u.push(r)}return u.flat()}async stream(e,t){let{key:r,input:n}=e,i=this.runnables[r];if(void 0===i)throw Error(`No runnable associated with key "${r}".`);return i.stream(n,t)}}r.RouterRunnable=a},93743,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RunnableBranch=void 0;let n=e.r(68974),i=e.r(81425),a=e.r(62350);class s extends n.Runnable{static lc_name(){return"RunnableBranch"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"default",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"branches",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.branches=e.branches,this.default=e.default}static from(e){if(e.length<1)throw Error("RunnableBranch requires at least one branch");return new this({branches:e.slice(0,-1).map(([e,t])=>[(0,n._coerceToRunnable)(e),(0,n._coerceToRunnable)(t)]),default:(0,n._coerceToRunnable)(e[e.length-1])})}async _invoke(e,t,r){let n;for(let a=0;a<this.branches.length;a+=1){let[s,o]=this.branches[a];if(await s.invoke(e,(0,i.patchConfig)(t,{callbacks:r?.getChild(`condition:${a+1}`)}))){n=await o.invoke(e,(0,i.patchConfig)(t,{callbacks:r?.getChild(`branch:${a+1}`)}));break}}return n||(n=await this.default.invoke(e,(0,i.patchConfig)(t,{callbacks:r?.getChild("branch:default")}))),n}async invoke(e,t={}){return this._callWithConfig(this._invoke,e,t)}async *_streamIterator(e,t){let r,s,o=await (0,i.getCallbackManagerForConfig)(t),l=await o?.handleChainStart(this.toJSON(),(0,n._coerceToDict)(e,"input"),t?.runId,void 0,void 0,void 0,t?.runName),u=!0;try{for(let n=0;n<this.branches.length;n+=1){let[o,c]=this.branches[n];if(await o.invoke(e,(0,i.patchConfig)(t,{callbacks:l?.getChild(`condition:${n+1}`)}))){for await(let o of s=await c.stream(e,(0,i.patchConfig)(t,{callbacks:l?.getChild(`branch:${n+1}`)})))if(yield o,u)if(void 0===r)r=o;else try{r=(0,a.concat)(r,o)}catch(e){r=void 0,u=!1}break}}if(void 0===s){for await(let n of s=await this.default.stream(e,(0,i.patchConfig)(t,{callbacks:l?.getChild("branch:default")})))if(yield n,u)if(void 0===r)r=n;else try{r=(0,a.concat)(r,n)}catch(e){r=void 0,u=!1}}}catch(e){throw await l?.handleChainError(e),e}await l?.handleChainEnd(r??{})}}r.RunnableBranch=s},62106,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RunnableWithMessageHistory=void 0;let n=e.r(39512),i=e.r(68974),a=e.r(45440);class s extends i.RunnableBinding{constructor(e){let t=i.RunnableLambda.from((e,t)=>this._enterHistory(e,t??{})).withConfig({runName:"loadHistory"}),r=e.historyMessagesKey??e.inputMessagesKey;r&&(t=a.RunnablePassthrough.assign({[r]:t}).withConfig({runName:"insertHistory"})),super({...e,config:e.config??{},bound:t.pipe(e.runnable.withListeners({onEnd:(e,t)=>this._exitHistory(e,t??{})})).withConfig({runName:"RunnableWithMessageHistory"})}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputMessagesKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputMessagesKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"historyMessagesKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"getMessageHistory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.getMessageHistory=e.getMessageHistory,this.inputMessagesKey=e.inputMessagesKey,this.outputMessagesKey=e.outputMessagesKey,this.historyMessagesKey=e.historyMessagesKey}_getInputMessages(e){let t;if("object"!=typeof e||Array.isArray(e)||(0,n.isBaseMessage)(e))t=e;else{let r;r=this.inputMessagesKey?this.inputMessagesKey:1===Object.keys(e).length?Object.keys(e)[0]:"input",t=Array.isArray(e[r])&&Array.isArray(e[r][0])?e[r][0]:e[r]}if("string"==typeof t)return[new n.HumanMessage(t)];if(Array.isArray(t))return t;if((0,n.isBaseMessage)(t))return[t];throw Error(`Expected a string, BaseMessage, or array of BaseMessages.
Got ${JSON.stringify(t,null,2)}`)}_getOutputMessages(e){let t;if(Array.isArray(e)||(0,n.isBaseMessage)(e)||"string"==typeof e)t=e;else{let r;r=void 0!==this.outputMessagesKey?this.outputMessagesKey:1===Object.keys(e).length?Object.keys(e)[0]:"output",t=void 0!==e.generations?e.generations[0][0].message:e[r]}if("string"==typeof t)return[new n.AIMessage(t)];if(Array.isArray(t))return t;if((0,n.isBaseMessage)(t))return[t];throw Error(`Expected a string, BaseMessage, or array of BaseMessages. Received: ${JSON.stringify(t,null,2)}`)}async _enterHistory(e,t){let r=t?.configurable?.messageHistory,n=await r.getMessages();return void 0===this.historyMessagesKey?n.concat(this._getInputMessages(e)):n}async _exitHistory(e,t){let r,n=t.configurable?.messageHistory;r=Array.isArray(e.inputs)&&Array.isArray(e.inputs[0])?e.inputs[0]:e.inputs;let i=this._getInputMessages(r);if(void 0===this.historyMessagesKey){let e=await n.getMessages();i=i.slice(e.length)}let a=e.outputs;if(!a)throw Error(`Output values from 'Run' undefined. Run: ${JSON.stringify(e,null,2)}`);let s=this._getOutputMessages(a);await n.addMessages([...i,...s])}async _mergeConfig(...e){let t=await super._mergeConfig(...e);if(!t.configurable||!t.configurable.sessionId){let e={[this.inputMessagesKey??"input"]:"foo"};throw Error(`sessionId is required. Pass it in as part of the config argument to .invoke() or .stream()
eg. chain.invoke(${JSON.stringify(e)}, ${JSON.stringify({configurable:{sessionId:"123"}})})`)}let{sessionId:r}=t.configurable;return t.configurable.messageHistory=await this.getMessageHistory(r),t}}r.RunnableWithMessageHistory=s},29495,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RunnableWithMessageHistory=r.RunnableBranch=r.RouterRunnable=r.RunnablePassthrough=r.pickRunnableConfigKeys=r.mergeConfigs=r.ensureConfig=r.patchConfig=r.getCallbackManagerForConfig=r.RunnableToolLike=r._coerceToRunnable=r.RunnablePick=r.RunnableAssign=r.RunnableWithFallbacks=r.RunnableLambda=r.RunnableParallel=r.RunnableMap=r.RunnableSequence=r.RunnableRetry=r.RunnableEach=r.RunnableBinding=r.Runnable=void 0;var n=e.r(68974);Object.defineProperty(r,"Runnable",{enumerable:!0,get:function(){return n.Runnable}}),Object.defineProperty(r,"RunnableBinding",{enumerable:!0,get:function(){return n.RunnableBinding}}),Object.defineProperty(r,"RunnableEach",{enumerable:!0,get:function(){return n.RunnableEach}}),Object.defineProperty(r,"RunnableRetry",{enumerable:!0,get:function(){return n.RunnableRetry}}),Object.defineProperty(r,"RunnableSequence",{enumerable:!0,get:function(){return n.RunnableSequence}}),Object.defineProperty(r,"RunnableMap",{enumerable:!0,get:function(){return n.RunnableMap}}),Object.defineProperty(r,"RunnableParallel",{enumerable:!0,get:function(){return n.RunnableParallel}}),Object.defineProperty(r,"RunnableLambda",{enumerable:!0,get:function(){return n.RunnableLambda}}),Object.defineProperty(r,"RunnableWithFallbacks",{enumerable:!0,get:function(){return n.RunnableWithFallbacks}}),Object.defineProperty(r,"RunnableAssign",{enumerable:!0,get:function(){return n.RunnableAssign}}),Object.defineProperty(r,"RunnablePick",{enumerable:!0,get:function(){return n.RunnablePick}}),Object.defineProperty(r,"_coerceToRunnable",{enumerable:!0,get:function(){return n._coerceToRunnable}}),Object.defineProperty(r,"RunnableToolLike",{enumerable:!0,get:function(){return n.RunnableToolLike}});var i=e.r(81425);Object.defineProperty(r,"getCallbackManagerForConfig",{enumerable:!0,get:function(){return i.getCallbackManagerForConfig}}),Object.defineProperty(r,"patchConfig",{enumerable:!0,get:function(){return i.patchConfig}}),Object.defineProperty(r,"ensureConfig",{enumerable:!0,get:function(){return i.ensureConfig}}),Object.defineProperty(r,"mergeConfigs",{enumerable:!0,get:function(){return i.mergeConfigs}}),Object.defineProperty(r,"pickRunnableConfigKeys",{enumerable:!0,get:function(){return i.pickRunnableConfigKeys}});var a=e.r(45440);Object.defineProperty(r,"RunnablePassthrough",{enumerable:!0,get:function(){return a.RunnablePassthrough}});var s=e.r(55105);Object.defineProperty(r,"RouterRunnable",{enumerable:!0,get:function(){return s.RouterRunnable}});var o=e.r(93743);Object.defineProperty(r,"RunnableBranch",{enumerable:!0,get:function(){return o.RunnableBranch}});var l=e.r(62106);Object.defineProperty(r,"RunnableWithMessageHistory",{enumerable:!0,get:function(){return l.RunnableWithMessageHistory}})},78541,(e,t,r)=>{t.exports=e.r(29495)},1388,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isStructuredTool=a,r.isRunnableToolLike=s,r.isStructuredToolParams=o,r.isLangChainTool=function(e){return o(e)||s(e)||a(e)};let n=e.r(68974),i=e.r(29164);function a(e){return void 0!==e&&Array.isArray(e.lc_namespace)}function s(e){return void 0!==e&&n.Runnable.isRunnable(e)&&"lc_name"in e.constructor&&"function"==typeof e.constructor.lc_name&&"RunnableToolLike"===e.constructor.lc_name()}function o(e){return!!e&&"object"==typeof e&&"name"in e&&"schema"in e&&((0,i.isInteropZodSchema)(e.schema)||null!=e.schema&&"object"==typeof e.schema&&"type"in e.schema&&"string"==typeof e.schema.type&&["null","boolean","object","array","number","string"].includes(e.schema.type))}},61789,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isLangChainTool=r.isRunnableToolLike=r.isStructuredToolParams=r.isStructuredTool=void 0,r.convertToOpenAIFunction=s,r.convertToOpenAITool=function(e,t){let r,i="number"==typeof t?void 0:t;return r=(0,n.isLangChainTool)(e)?{type:"function",function:s(e)}:e,i?.strict!==void 0&&(r.function.strict=i.strict),r};let n=e.r(1388),i=e.r(30952);var a=e.r(1388);function s(e,t){let r="number"==typeof t?void 0:t;return{name:e.name,description:e.description,parameters:(0,i.toJsonSchema)(e.schema),...r?.strict!==void 0?{strict:r.strict}:{}}}Object.defineProperty(r,"isStructuredTool",{enumerable:!0,get:function(){return a.isStructuredTool}}),Object.defineProperty(r,"isStructuredToolParams",{enumerable:!0,get:function(){return a.isStructuredToolParams}}),Object.defineProperty(r,"isRunnableToolLike",{enumerable:!0,get:function(){return a.isRunnableToolLike}}),Object.defineProperty(r,"isLangChainTool",{enumerable:!0,get:function(){return a.isLangChainTool}})},42200,(e,t,r)=>{t.exports=e.r(61789)},99078,(e,t,r)=>{t.exports=e.r(62350)},6245,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.OutputParserException=r.BaseOutputParser=r.BaseLLMOutputParser=void 0;let n=e.r(29495),i=e.r(97898);class a extends n.Runnable{parseResultWithPrompt(e,t,r){return this.parseResult(e,r)}_baseMessageToString(e){return"string"==typeof e.content?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return"string"==typeof e?this._callWithConfig(async(e,t)=>this.parseResult([{text:e}],t?.callbacks),e,{...t,runType:"parser"}):this._callWithConfig(async(e,t)=>this.parseResult([{message:e,text:this._baseMessageToString(e)}],t?.callbacks),e,{...t,runType:"parser"})}}r.BaseLLMOutputParser=a,r.BaseOutputParser=class extends a{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,r){return this.parse(e,r)}_type(){throw Error("_type not implemented")}},r.OutputParserException=class extends Error{constructor(e,t,r,n=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=t,this.observation=r,this.sendToLLM=n,n&&(void 0===r||void 0===t))throw Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");(0,i.addLangChainErrorFields)(this,"OUTPUT_PARSING_FAILURE")}}},84928,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseCumulativeTransformOutputParser=r.BaseTransformOutputParser=void 0;let n=e.r(10479),i=e.r(6245),a=e.r(98508),s=e.r(12556),o=e.r(13583);class l extends i.BaseOutputParser{async *_transform(e){for await(let t of e)"string"==typeof t?yield this.parseResult([{text:t}]):yield this.parseResult([{message:t,text:this._baseMessageToString(t)}])}async *transform(e,t){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...t,runType:"parser"})}}r.BaseTransformOutputParser=l,r.BaseCumulativeTransformOutputParser=class extends l{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=e?.diff??this.diff}async *_transform(e){let t,r;for await(let i of e){let e;if("string"!=typeof i&&"string"!=typeof i.content)throw Error("Cannot handle non-string output.");if((0,a.isBaseMessageChunk)(i)){if("string"!=typeof i.content)throw Error("Cannot handle non-string message output.");e=new o.ChatGenerationChunk({message:i,text:i.content})}else if((0,a.isBaseMessage)(i)){if("string"!=typeof i.content)throw Error("Cannot handle non-string message output.");e=new o.ChatGenerationChunk({message:(0,s.convertToChunk)(i),text:i.content})}else e=new o.GenerationChunk({text:i});r=void 0===r?e:r.concat(e);let l=await this.parsePartialResult([r]);null==l||(0,n.deepCompareStrict)(l,t)||(this.diff?yield this._diff(t,l):yield l,t=l)}}getFormatInstructions(){return""}}},99932,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BytesOutputParser=void 0;let n=e.r(84928);class i extends n.BaseTransformOutputParser{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","bytes"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"textEncoder",{enumerable:!0,configurable:!0,writable:!0,value:new TextEncoder})}static lc_name(){return"BytesOutputParser"}parse(e){return Promise.resolve(this.textEncoder.encode(e))}getFormatInstructions(){return""}}r.BytesOutputParser=i},61698,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MarkdownListOutputParser=r.NumberedListOutputParser=r.CustomListOutputParser=r.CommaSeparatedListOutputParser=r.ListOutputParser=void 0;let n=e.r(6245),i=e.r(84928);class a extends i.BaseTransformOutputParser{constructor(){super(...arguments),Object.defineProperty(this,"re",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async *_transform(e){let t="";for await(let r of e)if("string"==typeof r?t+=r:t+=r.content,this.re){let e=[...t.matchAll(this.re)];if(e.length>1){let r=0;for(let t of e.slice(0,-1))yield[t[1]],r+=(t.index??0)+t[0].length;t=t.slice(r)}}else{let e=await this.parse(t);if(e.length>1){for(let t of e.slice(0,-1))yield[t];t=e[e.length-1]}}for(let e of(await this.parse(t)))yield[e]}}r.ListOutputParser=a,r.CommaSeparatedListOutputParser=class extends a{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","list"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"CommaSeparatedListOutputParser"}async parse(e){try{return e.trim().split(",").map(e=>e.trim())}catch(t){throw new n.OutputParserException(`Could not parse output: ${e}`,e)}}getFormatInstructions(){return"Your response should be a list of comma separated values, eg: `foo, bar, baz`"}},r.CustomListOutputParser=class extends a{constructor({length:e,separator:t}){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","list"]}),Object.defineProperty(this,"length",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"separator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.length=e,this.separator=t||","}async parse(e){try{let t=e.trim().split(this.separator).map(e=>e.trim());if(void 0!==this.length&&t.length!==this.length)throw new n.OutputParserException(`Incorrect number of items. Expected ${this.length}, got ${t.length}.`);return t}catch(t){if(Object.getPrototypeOf(t)===n.OutputParserException.prototype)throw t;throw new n.OutputParserException(`Could not parse output: ${e}`)}}getFormatInstructions(){return`Your response should be a list of ${void 0===this.length?"":`${this.length} `}items separated by "${this.separator}" (eg: \`foo${this.separator} bar${this.separator} baz\`)`}},r.NumberedListOutputParser=class extends a{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","list"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"re",{enumerable:!0,configurable:!0,writable:!0,value:/\d+\.\s([^\n]+)/g})}static lc_name(){return"NumberedListOutputParser"}getFormatInstructions(){return`Your response should be a numbered list with each item on a new line. For example: 

1. foo

2. bar

3. baz`}async parse(e){return[...e.matchAll(this.re)??[]].map(e=>e[1])}},r.MarkdownListOutputParser=class extends a{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","list"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"re",{enumerable:!0,configurable:!0,writable:!0,value:/^\s*[-*]\s([^\n]+)$/gm})}static lc_name(){return"NumberedListOutputParser"}getFormatInstructions(){return`Your response should be a numbered list with each item on a new line. For example: 

1. foo

2. bar

3. baz`}async parse(e){return[...e.matchAll(this.re)??[]].map(e=>e[1])}}},72867,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.StringOutputParser=void 0;let n=e.r(84928);class i extends n.BaseTransformOutputParser{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","string"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"StrOutputParser"}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}_textContentToString(e){return e.text}_imageUrlContentToString(e){throw Error('Cannot coerce a multimodal "image_url" message part into a string.')}_messageContentComplexToString(e){switch(e.type){case"text":case"text_delta":if("text"in e)return this._textContentToString(e);break;case"image_url":if("image_url"in e)return this._imageUrlContentToString(e);break;default:throw Error(`Cannot coerce "${e.type}" message part into a string.`)}throw Error(`Invalid content type: ${e.type}`)}_baseMessageContentToString(e){return e.reduce((e,t)=>e+this._messageContentComplexToString(t),"")}}r.StringOutputParser=i},55187,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AsymmetricStructuredOutputParser=r.JsonMarkdownStructuredOutputParser=r.StructuredOutputParser=void 0;let n=e.r(32770),i=e.r(6245),a=e.r(29164),s=e.r(30952);class o extends i.BaseOutputParser{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){return new this(n.z.object(Object.fromEntries(Object.entries(e).map(([e,t])=>[e,n.z.string().describe(t)]))))}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify((0,s.toJsonSchema)(this.schema))}
\`\`\`
`}async parse(e){try{let t=e.trim(),r=(t.match(/^```(?:json)?\s*([\s\S]*?)```/)?.[1]||t.match(/```json\s*([\s\S]*?)```/)?.[1]||t).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(e,t)=>{let r=t.replace(/\n/g,"\\n");return`"${r}"`}).replace(/\n/g,"");return await (0,a.interopParseAsync)(this.schema,JSON.parse(r))}catch(t){throw new i.OutputParserException(`Failed to parse. Text: "${e}". Error: ${t}`,e)}}}r.StructuredOutputParser=o;class l extends o{static lc_name(){return"JsonMarkdownStructuredOutputParser"}getFormatInstructions(e){let t=e?.interpolationDepth??1;if(t<1)throw Error("f string interpolation depth must be at least 1");return`Return a markdown code snippet with a JSON object formatted to look like:
\`\`\`json
${this._schemaToInstruction((0,s.toJsonSchema)(this.schema)).replaceAll("{","{".repeat(t)).replaceAll("}","}".repeat(t))}
\`\`\``}_schemaToInstruction(e,t=2){if("type"in e){let r,n=!1;if(Array.isArray(e.type)){let t=e.type.findIndex(e=>"null"===e);-1!==t&&(n=!0,e.type.splice(t,1)),r=e.type.join(" | ")}else r=e.type;if("object"===e.type&&e.properties){let r=e.description?` // ${e.description}`:"",n=Object.entries(e.properties).map(([r,n])=>{let i=e.required?.includes(r)?"":" (optional)";return`${" ".repeat(t)}"${r}": ${this._schemaToInstruction(n,t+2)}${i}`}).join("\n");return`{
${n}
${" ".repeat(t-2)}}${r}`}if("array"===e.type&&e.items){let r=e.description?` // ${e.description}`:"";return`array[
${" ".repeat(t)}${this._schemaToInstruction(e.items,t+2)}
${" ".repeat(t-2)}] ${r}`}let i=n?" (nullable)":"",a=e.description?` // ${e.description}`:"";return`${r}${a}${i}`}if("anyOf"in e)return e.anyOf.map(e=>this._schemaToInstruction(e,t)).join(`
${" ".repeat(t-2)}`);throw Error("unsupported schema type")}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){return new this(n.z.object(Object.fromEntries(Object.entries(e).map(([e,t])=>[e,n.z.string().describe(t)]))))}}r.JsonMarkdownStructuredOutputParser=l;class u extends i.BaseOutputParser{constructor({inputSchema:e}){super(...arguments),Object.defineProperty(this,"structuredInputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.structuredInputParser=new l(e)}async parse(e){let t;try{t=await this.structuredInputParser.parse(e)}catch(t){throw new i.OutputParserException(`Failed to parse. Text: "${e}". Error: ${t}`,e)}return this.outputProcessor(t)}getFormatInstructions(){return this.structuredInputParser.getFormatInstructions()}}r.AsymmetricStructuredOutputParser=u},30943,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.applyPatch=r.compare=void 0;var n=e.r(10539);Object.defineProperty(r,"compare",{enumerable:!0,get:function(){return n.compare}}),Object.defineProperty(r,"applyPatch",{enumerable:!0,get:function(){return n.applyPatch}})},20087,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseJsonMarkdown=r.parsePartialJson=r.JsonOutputParser=void 0;let n=e.r(84928),i=e.r(30943),a=e.r(80088);Object.defineProperty(r,"parseJsonMarkdown",{enumerable:!0,get:function(){return a.parseJsonMarkdown}}),Object.defineProperty(r,"parsePartialJson",{enumerable:!0,get:function(){return a.parsePartialJson}});class s extends n.BaseCumulativeTransformOutputParser{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_concatOutputChunks(e,t){return this.diff?super._concatOutputChunks(e,t):t}_diff(e,t){if(t)return e?(0,i.compare)(e,t):[{op:"replace",path:"",value:t}]}async parsePartialResult(e){return(0,a.parseJsonMarkdown)(e[0].text)}async parse(e){return(0,a.parseJsonMarkdown)(e,JSON.parse)}getFormatInstructions(){return""}}r.JsonOutputParser=s},33359,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sax=void 0,r.sax=function(){let e={};e.parser=function(e,t){return new r(e,t)},e.SAXParser=r,e.SAXStream=l,e.createStream=function(e,t){return new l(e,t)},e.MAX_BUFFER_LENGTH=65536;let t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function r(n,i){if(!(this instanceof r))return new r(n,i);(function(e){for(var r=0,n=t.length;r<n;r++)e[t[r]]=""})(this),this.q=this.c="",this.bufferCheckPosition=e.MAX_BUFFER_LENGTH,this.opt=i||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!n,this.noscript=!!(n||this.opt.noscript),this.state=_.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(d)),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),w(this,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),r.prototype={end:function(){k(this)},write:function(r){if(this.error)throw this.error;if(this.closed)return E(this,"Cannot write after close. Assign an onready handler.");if(null===r)return k(this);"object"==typeof r&&(r=r.toString());for(var n=0,i="";i=N(r,n++),this.c=i,i;)switch(this.trackPosition&&(this.position++,"\n"===i?(this.line++,this.column=0):this.column++),this.state){case _.BEGIN:if(this.state=_.BEGIN_WHITESPACE,"\uFEFF"===i)continue;$(this,i);continue;case _.BEGIN_WHITESPACE:$(this,i);continue;case _.TEXT:if(this.sawRoot&&!this.closedRoot){for(var a=n-1;i&&"<"!==i&&"&"!==i;)(i=N(r,n++))&&this.trackPosition&&(this.position++,"\n"===i?(this.line++,this.column=0):this.column++);this.textNode+=r.substring(a,n-1)}"<"!==i||this.sawRoot&&this.closedRoot&&!this.strict?(g(i)||this.sawRoot&&!this.closedRoot||I(this,"Text data outside of root node."),"&"===i?this.state=_.TEXT_ENTITY:this.textNode+=i):(this.state=_.OPEN_WAKA,this.startTagPosition=this.position);continue;case _.SCRIPT:"<"===i?this.state=_.SCRIPT_ENDING:this.script+=i;continue;case _.SCRIPT_ENDING:"/"===i?this.state=_.CLOSE_TAG:(this.script+="<"+i,this.state=_.SCRIPT);continue;case _.OPEN_WAKA:"!"===i?(this.state=_.SGML_DECL,this.sgmlDecl=""):g(i)||(b(p,i)?(this.state=_.OPEN_TAG,this.tagName=i):"/"===i?(this.state=_.CLOSE_TAG,this.tagName=""):"?"===i?(this.state=_.PROC_INST,this.procInstName=this.procInstBody=""):(I(this,"Unencoded <"),this.startTagPosition+1<this.position&&(i=Array(this.position-this.startTagPosition).join(" ")+i),this.textNode+="<"+i,this.state=_.TEXT));continue;case _.SGML_DECL:"[CDATA["===(this.sgmlDecl+i).toUpperCase()?(O(this,"onopencdata"),this.state=_.CDATA,this.sgmlDecl="",this.cdata=""):this.sgmlDecl+i==="--"?(this.state=_.COMMENT,this.comment="",this.sgmlDecl=""):"DOCTYPE"===(this.sgmlDecl+i).toUpperCase()?(this.state=_.DOCTYPE,(this.doctype||this.sawRoot)&&I(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===i?(O(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=_.TEXT):(y(i)&&(this.state=_.SGML_DECL_QUOTED),this.sgmlDecl+=i);continue;case _.SGML_DECL_QUOTED:i===this.q&&(this.state=_.SGML_DECL,this.q=""),this.sgmlDecl+=i;continue;case _.DOCTYPE:">"===i?(this.state=_.TEXT,O(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=i,"["===i?this.state=_.DOCTYPE_DTD:y(i)&&(this.state=_.DOCTYPE_QUOTED,this.q=i));continue;case _.DOCTYPE_QUOTED:this.doctype+=i,i===this.q&&(this.q="",this.state=_.DOCTYPE);continue;case _.DOCTYPE_DTD:this.doctype+=i,"]"===i?this.state=_.DOCTYPE:y(i)&&(this.state=_.DOCTYPE_DTD_QUOTED,this.q=i);continue;case _.DOCTYPE_DTD_QUOTED:this.doctype+=i,i===this.q&&(this.state=_.DOCTYPE_DTD,this.q="");continue;case _.COMMENT:"-"===i?this.state=_.COMMENT_ENDING:this.comment+=i;continue;case _.COMMENT_ENDING:"-"===i?(this.state=_.COMMENT_ENDED,this.comment=S(this.opt,this.comment),this.comment&&O(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+i,this.state=_.COMMENT);continue;case _.COMMENT_ENDED:">"!==i?(I(this,"Malformed comment"),this.comment+="--"+i,this.state=_.COMMENT):this.state=_.TEXT;continue;case _.CDATA:"]"===i?this.state=_.CDATA_ENDING:this.cdata+=i;continue;case _.CDATA_ENDING:"]"===i?this.state=_.CDATA_ENDING_2:(this.cdata+="]"+i,this.state=_.CDATA);continue;case _.CDATA_ENDING_2:">"===i?(this.cdata&&O(this,"oncdata",this.cdata),O(this,"onclosecdata"),this.cdata="",this.state=_.TEXT):"]"===i?this.cdata+="]":(this.cdata+="]]"+i,this.state=_.CDATA);continue;case _.PROC_INST:"?"===i?this.state=_.PROC_INST_ENDING:g(i)?this.state=_.PROC_INST_BODY:this.procInstName+=i;continue;case _.PROC_INST_BODY:!this.procInstBody&&g(i)||("?"===i?this.state=_.PROC_INST_ENDING:this.procInstBody+=i);continue;case _.PROC_INST_ENDING:">"===i?(O(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=_.TEXT):(this.procInstBody+="?"+i,this.state=_.PROC_INST_BODY);continue;case _.OPEN_TAG:b(h,i)?this.tagName+=i:(!function(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,r=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(r.ns=t.ns),e.attribList.length=0,O(e,"onopentagstart",r)}(this),">"===i?C(this):"/"===i?this.state=_.OPEN_TAG_SLASH:(g(i)||I(this,"Invalid character in tag name"),this.state=_.ATTRIB));continue;case _.OPEN_TAG_SLASH:">"===i?(C(this,!0),j(this)):(I(this,"Forward-slash in opening tag not followed by >"),this.state=_.ATTRIB);continue;case _.ATTRIB:g(i)||(">"===i?C(this):"/"===i?this.state=_.OPEN_TAG_SLASH:b(p,i)?(this.attribName=i,this.attribValue="",this.state=_.ATTRIB_NAME):I(this,"Invalid attribute name"));continue;case _.ATTRIB_NAME:"="===i?this.state=_.ATTRIB_VALUE:">"===i?(I(this,"Attribute without value"),this.attribValue=this.attribName,T(this),C(this)):g(i)?this.state=_.ATTRIB_NAME_SAW_WHITE:b(h,i)?this.attribName+=i:I(this,"Invalid attribute name");continue;case _.ATTRIB_NAME_SAW_WHITE:if("="===i)this.state=_.ATTRIB_VALUE;else{if(g(i))continue;I(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",O(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===i?C(this):b(p,i)?(this.attribName=i,this.state=_.ATTRIB_NAME):(I(this,"Invalid attribute name"),this.state=_.ATTRIB)}continue;case _.ATTRIB_VALUE:g(i)||(y(i)?(this.q=i,this.state=_.ATTRIB_VALUE_QUOTED):(I(this,"Unquoted attribute value"),this.state=_.ATTRIB_VALUE_UNQUOTED,this.attribValue=i));continue;case _.ATTRIB_VALUE_QUOTED:if(i!==this.q){"&"===i?this.state=_.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=i;continue}T(this),this.q="",this.state=_.ATTRIB_VALUE_CLOSED;continue;case _.ATTRIB_VALUE_CLOSED:g(i)?this.state=_.ATTRIB:">"===i?C(this):"/"===i?this.state=_.OPEN_TAG_SLASH:b(p,i)?(I(this,"No whitespace between attributes"),this.attribName=i,this.attribValue="",this.state=_.ATTRIB_NAME):I(this,"Invalid attribute name");continue;case _.ATTRIB_VALUE_UNQUOTED:if(!(">"===(s=i)||g(s))){"&"===i?this.state=_.ATTRIB_VALUE_ENTITY_U:this.attribValue+=i;continue}T(this),">"===i?C(this):this.state=_.ATTRIB;continue;case _.CLOSE_TAG:this.tagName?">"===i?j(this):b(h,i)?this.tagName+=i:this.script?(this.script+="</"+this.tagName,this.tagName="",this.state=_.SCRIPT):(g(i)||I(this,"Invalid tagname in closing tag"),this.state=_.CLOSE_TAG_SAW_WHITE):g(i)||(b(p,i)?this.tagName=i:this.script?(this.script+="</"+i,this.state=_.SCRIPT):I(this,"Invalid tagname in closing tag."));continue;case _.CLOSE_TAG_SAW_WHITE:if(g(i))continue;">"===i?j(this):I(this,"Invalid characters in closing tag");continue;case _.TEXT_ENTITY:case _.ATTRIB_VALUE_ENTITY_Q:case _.ATTRIB_VALUE_ENTITY_U:switch(this.state){case _.TEXT_ENTITY:o=_.TEXT,l="textNode";break;case _.ATTRIB_VALUE_ENTITY_Q:o=_.ATTRIB_VALUE_QUOTED,l="attribValue";break;case _.ATTRIB_VALUE_ENTITY_U:o=_.ATTRIB_VALUE_UNQUOTED,l="attribValue"}if(";"===i)if(this.opt.unparsedEntities){var s,o,l,u=x(this);this.entity="",this.state=o,this.write(u)}else this[l]+=x(this),this.entity="",this.state=o;else b(this.entity.length?m:f,i)?this.entity+=i:(I(this,"Invalid character in entity name"),this[l]+="&"+this.entity+i,this.entity="",this.state=o);continue;default:throw Error(this,"Unknown state: "+this.state)}return this.position>=this.bufferCheckPosition&&function(r){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,a=0,s=t.length;a<s;a++){var o=r[t[a]].length;if(o>n)switch(t[a]){case"textNode":P(r);break;case"cdata":O(r,"oncdata",r.cdata),r.cdata="";break;case"script":O(r,"onscript",r.script),r.script="";break;default:E(r,"Max buffer length exceeded: "+t[a])}i=Math.max(i,o)}r.bufferCheckPosition=e.MAX_BUFFER_LENGTH-i+r.position}(this),this},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){P(this),""!==this.cdata&&(O(this,"oncdata",this.cdata),this.cdata=""),""!==this.script&&(O(this,"onscript",this.script),this.script="")}};var n,i,a,s=ReadableStream;s||(s=function(){});var o=e.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});function l(e,t){if(!(this instanceof l))return new l(e,t);s.apply(this),this._parser=new r(e,t),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null},this._decoder=null,o.forEach(function(e){Object.defineProperty(n,"on"+e,{get:function(){return n._parser["on"+e]},set:function(t){if(!t)return n.removeAllListeners(e),n._parser["on"+e]=t,t;n.on(e,t)},enumerable:!0,configurable:!1})})}l.prototype=Object.create(s.prototype,{constructor:{value:l}}),l.prototype.write=function(e){return this._parser.write(e.toString()),this.emit("data",e),!0},l.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},l.prototype.on=function(e,t){var r=this;return r._parser["on"+e]||-1===o.indexOf(e)||(r._parser["on"+e]=function(){var t=1==arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),s.prototype.on.call(r,e,t)};var u="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/2000/xmlns/",d={xml:u,xmlns:c},p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(e){return" "===e||"\n"===e||"\r"===e||"	"===e}function y(e){return'"'===e||"'"===e}function b(e,t){return e.test(t)}var _=0;for(var v in e.STATE={BEGIN:_++,BEGIN_WHITESPACE:_++,TEXT:_++,TEXT_ENTITY:_++,OPEN_WAKA:_++,SGML_DECL:_++,SGML_DECL_QUOTED:_++,DOCTYPE:_++,DOCTYPE_QUOTED:_++,DOCTYPE_DTD:_++,DOCTYPE_DTD_QUOTED:_++,COMMENT_STARTING:_++,COMMENT:_++,COMMENT_ENDING:_++,COMMENT_ENDED:_++,CDATA:_++,CDATA_ENDING:_++,CDATA_ENDING_2:_++,PROC_INST:_++,PROC_INST_BODY:_++,PROC_INST_ENDING:_++,OPEN_TAG:_++,OPEN_TAG_SLASH:_++,ATTRIB:_++,ATTRIB_NAME:_++,ATTRIB_NAME_SAW_WHITE:_++,ATTRIB_VALUE:_++,ATTRIB_VALUE_QUOTED:_++,ATTRIB_VALUE_CLOSED:_++,ATTRIB_VALUE_UNQUOTED:_++,ATTRIB_VALUE_ENTITY_Q:_++,ATTRIB_VALUE_ENTITY_U:_++,CLOSE_TAG:_++,CLOSE_TAG_SAW_WHITE:_++,SCRIPT:_++,SCRIPT_ENDING:_++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(t){var r=e.ENTITIES[t],n="number"==typeof r?String.fromCharCode(r):r;e.ENTITIES[t]=n}),e.STATE)e.STATE[e.STATE[v]]=v;function w(e,t,r){e[t]&&e[t](r)}function O(e,t,r){e.textNode&&P(e),w(e,t,r)}function P(e){e.textNode=S(e.opt,e.textNode),e.textNode&&w(e,"ontext",e.textNode),e.textNode=""}function S(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function E(e,t){return P(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),e.error=t=Error(t),w(e,"onerror",t),e}function k(e){return e.sawRoot&&!e.closedRoot&&I(e,"Unclosed root tag"),e.state!==_.BEGIN&&e.state!==_.BEGIN_WHITESPACE&&e.state!==_.TEXT&&E(e,"Unexpected end"),P(e),e.c="",e.closed=!0,w(e,"onend"),r.call(e,e.strict,e.opt),e}function I(e,t){if("object"!=typeof e||!(e instanceof r))throw Error("bad call to strictFail");e.strict&&E(e,t)}function A(e,t){var r=0>e.indexOf(":")?["",e]:e.split(":"),n=r[0],i=r[1];return t&&"xmlns"===e&&(n="xmlns",i=""),{prefix:n,local:i}}function T(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName)){e.attribName=e.attribValue="";return}if(e.opt.xmlns){var t=A(e.attribName,!0),r=t.prefix,n=t.local;if("xmlns"===r)if("xml"===n&&e.attribValue!==u)I(e,"xml: prefix must be bound to "+u+"\nActual: "+e.attribValue);else if("xmlns"===n&&e.attribValue!==c)I(e,"xmlns: prefix must be bound to "+c+"\nActual: "+e.attribValue);else{var i=e.tag,a=e.tags[e.tags.length-1]||e;i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[n]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,O(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}function C(e,t){if(e.opt.xmlns){var r=e.tag,n=A(e.tagName);r.prefix=n.prefix,r.local=n.local,r.uri=r.ns[n.prefix]||"",r.prefix&&!r.uri&&(I(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),r.uri=n.prefix);var i=e.tags[e.tags.length-1]||e;r.ns&&i.ns!==r.ns&&Object.keys(r.ns).forEach(function(t){O(e,"onopennamespace",{prefix:t,uri:r.ns[t]})});for(var a=0,s=e.attribList.length;a<s;a++){var o=e.attribList[a],l=o[0],u=o[1],c=A(l,!0),d=c.prefix,p=c.local,h=""===d?"":r.ns[d]||"",f={name:l,value:u,prefix:d,local:p,uri:h};d&&"xmlns"!==d&&!h&&(I(e,"Unbound namespace prefix: "+JSON.stringify(d)),f.uri=d),e.tag.attributes[l]=f,O(e,"onattribute",f)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),O(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=_.TEXT:e.state=_.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function j(e){if(!e.tagName){I(e,"Weird empty close tag."),e.textNode+="</>",e.state=_.TEXT;return}if(e.script){if("script"!==e.tagName){e.script+="</"+e.tagName+">",e.tagName="",e.state=_.SCRIPT;return}O(e,"onscript",e.script),e.script=""}var t=e.tags.length,r=e.tagName;e.strict||(r=r[e.looseCase]());for(var n=r;t--;)if(e.tags[t].name!==n)I(e,"Unexpected close tag");else break;if(t<0){I(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",e.state=_.TEXT;return}e.tagName=r;for(var i=e.tags.length;i-- >t;){var a=e.tag=e.tags.pop();e.tagName=e.tag.name,O(e,"onclosetag",e.tagName);var s={};for(var o in a.ns)s[o]=a.ns[o];var l=e.tags[e.tags.length-1]||e;e.opt.xmlns&&a.ns!==l.ns&&Object.keys(a.ns).forEach(function(t){var r=a.ns[t];O(e,"onclosenamespace",{prefix:t,uri:r})})}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=_.TEXT}function x(e){var t,r=e.entity,n=r.toLowerCase(),i="";return e.ENTITIES[r]?e.ENTITIES[r]:e.ENTITIES[n]?e.ENTITIES[n]:("#"===(r=n).charAt(0)&&(i="x"===r.charAt(1)?(t=parseInt(r=r.slice(2),16)).toString(16):(t=parseInt(r=r.slice(1),10)).toString(10)),r=r.replace(/^0+/,""),isNaN(t)||i.toLowerCase()!==r)?(I(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t)}function $(e,t){"<"===t?(e.state=_.OPEN_WAKA,e.startTagPosition=e.position):g(t)||(I(e,"Non-whitespace before first tag."),e.textNode=t,e.state=_.TEXT)}function N(e,t){var r="";return t<e.length&&(r=e.charAt(t)),r}return _=e.STATE,String.fromCodePoint||(n=String.fromCharCode,i=Math.floor,a=function(){var e,t,r=[],a=-1,s=arguments.length;if(!s)return"";for(var o="";++a<s;){var l=Number(arguments[a]);if(!isFinite(l)||l<0||l>1114111||i(l)!==l)throw RangeError("Invalid code point: "+l);l<=65535?r.push(l):(l-=65536,e=(l>>10)+55296,t=l%1024+56320,r.push(e,t)),(a+1===s||r.length>16384)&&(o+=n.apply(null,r),r.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:a,configurable:!0,writable:!0}):String.fromCodePoint=a),e}()},22293,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.XMLOutputParser=r.XML_FORMAT_INSTRUCTIONS=void 0,r.parseXMLMarkdown=l;let n=e.r(84928),i=e.r(30943),a=e.r(33359);r.XML_FORMAT_INSTRUCTIONS=`The output should be formatted as a XML file.
1. Output should conform to the tags below. 
2. If tags are not given, make them on your own.
3. Remember to always open and close all the tags.

As an example, for the tags ["foo", "bar", "baz"]:
1. String "<foo>
   <bar>
      <baz></baz>
   </bar>
</foo>" is a well-formatted instance of the schema. 
2. String "<foo>
   <bar>
   </foo>" is a badly-formatted instance.
3. String "<foo>
   <tag>
   </tag>
</foo>" is a badly-formatted instance.

Here are the output tags:
\`\`\`
{tags}
\`\`\``;class s extends n.BaseCumulativeTransformOutputParser{constructor(e){super(e),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.tags=e?.tags}static lc_name(){return"XMLOutputParser"}_diff(e,t){if(t)return e?(0,i.compare)(e,t):[{op:"replace",path:"",value:t}]}async parsePartialResult(e){return l(e[0].text)}async parse(e){return l(e)}getFormatInstructions(){return this.tags&&this.tags.length>0?r.XML_FORMAT_INSTRUCTIONS.replace("{tags}",this.tags?.join(", ")??""):r.XML_FORMAT_INSTRUCTIONS}}r.XMLOutputParser=s;let o=e=>{if(0===Object.keys(e).length)return{};let t={};return e.children.length>0?t[e.name]=e.children.map(o):t[e.name]=e.text??void 0,t};function l(e){let t=e.split("\n").map(e=>e.replace(/^\s+/,"")).join("\n").trim(),r=a.sax.parser(!0),n={},i=[];r.onopentag=e=>{let t={name:e.name,attributes:e.attributes,children:[],text:"",isSelfClosing:e.isSelfClosing};i.length>0?i[i.length-1].children.push(t):n=t,e.isSelfClosing||i.push(t)},r.onclosetag=()=>{if(i.length>0){let e=i.pop();0===i.length&&e&&(n=e)}},r.ontext=e=>{if(i.length>0){let t=i[i.length-1];t.text+=e}},r.onattribute=e=>{i.length>0&&(i[i.length-1].attributes[e.name]=e.value)};let s=/```(xml)?(.*)```/s.exec(t),l=s?s[2]:t;return r.write(l).close(),n&&"?xml"===n.name&&(n=n.children[0]),o(n)}},60105,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(6245),r),i(e.r(99932),r),i(e.r(61698),r),i(e.r(72867),r),i(e.r(55187),r),i(e.r(84928),r),i(e.r(20087),r),i(e.r(22293),r)},62421,(e,t,r)=>{t.exports=e.r(60105)},42235,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(29164),r)},15225,(e,t,r)=>{t.exports=e.r(42235)},63656,(e,t,r)=>{t.exports=e.r(30952)},95988,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.convertOllamaMessagesToLangChain=function(e,t){return new n.AIMessageChunk({content:e.thinking??e.content??"",tool_call_chunks:e.tool_calls?.map(e=>({name:e.function.name,args:JSON.stringify(e.function.arguments),type:"tool_call_chunk",index:0,id:(0,i.v4)()})),response_metadata:t?.responseMetadata,usage_metadata:t?.usageMetadata})},r.convertToOllamaMessages=function(e){return e.flatMap(e=>{if(["human","generic"].includes(e._getType()))return"string"==typeof e.content?[{role:"user",content:e.content}]:e.content.map(e=>{if("text"===e.type)return{role:"user",content:e.text};if("image_url"===e.type){if("string"==typeof e.image_url)return{role:"user",content:"",images:[a(e.image_url)]};else if(e.image_url.url&&"string"==typeof e.image_url.url)return{role:"user",content:"",images:[a(e.image_url.url)]}}throw Error(`Unsupported content type: ${e.type}`)});if("ai"===e._getType()){let t;if("string"==typeof e.content)return[{role:"assistant",content:e.content}];let r=e.content.filter(e=>"text"===e.type&&"string"==typeof e.text).map(e=>({role:"assistant",content:e.text}));if(e.content.find(e=>"tool_use"===e.type)&&e.tool_calls?.length){let r=e.tool_calls?.map(e=>({id:e.id,type:"function",function:{name:e.name,arguments:e.args}}));r&&(t={role:"assistant",tool_calls:r,content:""})}else if(e.content.find(e=>"tool_use"===e.type)&&!e.tool_calls?.length)throw Error("'tool_use' content type is not supported without tool calls.");return[...r,...t?[t]:[]]}if("system"===e._getType()){if("string"==typeof e.content)return[{role:"system",content:e.content}];if(e.content.every(e=>"text"===e.type&&"string"==typeof e.text))return e.content.map(e=>({role:"system",content:e.text}));throw Error(`Unsupported content type(s): ${e.content.map(e=>e.type).join(", ")}`)}if("tool"===e._getType()){if("string"!=typeof e.content)throw Error("Non string tool message content is not supported");return[{role:"tool",content:e.content}]}throw Error(`Unsupported message type: ${e._getType()}`)})};let n=e.r(22991),i=e.r(79403);function a(e){let t=e.match(/^data:.*?;base64,(.*)$/);return t?t[1]:""}},58240,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChatOllama=void 0;let n=e.r(22991),i=e.r(11144),a=e.r(76370),s=e.r(24976),o=e.r(22991),l=e.r(78541),u=e.r(42200),c=e.r(99078),d=e.r(62421),p=e.r(15225),h=e.r(63656),f=e.r(95988);class m extends i.BaseChatModel{static lc_name(){return"ChatOllama"}constructor(e){super(e??{}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"llama3"}),Object.defineProperty(this,"numa",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numCtx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numBatch",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numGpu",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mainGpu",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lowVram",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"f16Kv",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitsAll",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vocabOnly",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useMmap",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useMlock",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"embeddingOnly",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numThread",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numKeep",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"seed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numPredict",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tfsZ",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"typicalP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repeatLastN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repeatPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostatTau",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostatEta",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"penalizeNewline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"format",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keepAlive",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkOrPullModel",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"baseUrl",{enumerable:!0,configurable:!0,writable:!0,value:"http://127.0.0.1:11434"}),Object.defineProperty(this,"think",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.client=new a.Ollama({fetch:e?.fetch,host:e?.baseUrl,headers:e?.headers}),this.baseUrl=e?.baseUrl??this.baseUrl,this.model=e?.model??this.model,this.numa=e?.numa,this.numCtx=e?.numCtx,this.numBatch=e?.numBatch,this.numGpu=e?.numGpu,this.mainGpu=e?.mainGpu,this.lowVram=e?.lowVram,this.f16Kv=e?.f16Kv,this.logitsAll=e?.logitsAll,this.vocabOnly=e?.vocabOnly,this.useMmap=e?.useMmap,this.useMlock=e?.useMlock,this.embeddingOnly=e?.embeddingOnly,this.numThread=e?.numThread,this.numKeep=e?.numKeep,this.seed=e?.seed,this.numPredict=e?.numPredict,this.topK=e?.topK,this.topP=e?.topP,this.tfsZ=e?.tfsZ,this.typicalP=e?.typicalP,this.repeatLastN=e?.repeatLastN,this.temperature=e?.temperature,this.repeatPenalty=e?.repeatPenalty,this.presencePenalty=e?.presencePenalty,this.frequencyPenalty=e?.frequencyPenalty,this.mirostat=e?.mirostat,this.mirostatTau=e?.mirostatTau,this.mirostatEta=e?.mirostatEta,this.penalizeNewline=e?.penalizeNewline,this.streaming=e?.streaming,this.format=e?.format,this.keepAlive=e?.keepAlive,this.think=e?.think,this.checkOrPullModel=e?.checkOrPullModel??this.checkOrPullModel}_llmType(){return"ollama"}async pull(e,t){let{stream:r,insecure:n,logProgress:i}={stream:!0,...t};if(r)for await(let t of(await this.client.pull({model:e,insecure:n,stream:r})))i&&console.log(t);else{let t=await this.client.pull({model:e,insecure:n});i&&console.log(t)}}bindTools(e,t){return this.withConfig({tools:e.map(e=>(0,u.convertToOpenAITool)(e)),...t})}getLsParams(e){let t=this.invocationParams(e);return{ls_provider:"ollama",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.options?.temperature??void 0,ls_max_tokens:t.options?.num_predict??void 0,ls_stop:e.stop}}invocationParams(e){if(e?.tool_choice)throw Error("Tool choice is not supported for ChatOllama.");return{model:this.model,format:e?.format??this.format,keep_alive:this.keepAlive,think:this.think,options:{numa:this.numa,num_ctx:this.numCtx,num_batch:this.numBatch,num_gpu:this.numGpu,main_gpu:this.mainGpu,low_vram:this.lowVram,f16_kv:this.f16Kv,logits_all:this.logitsAll,vocab_only:this.vocabOnly,use_mmap:this.useMmap,use_mlock:this.useMlock,embedding_only:this.embeddingOnly,num_thread:this.numThread,num_keep:this.numKeep,seed:this.seed,num_predict:this.numPredict,top_k:this.topK,top_p:this.topP,tfs_z:this.tfsZ,typical_p:this.typicalP,repeat_last_n:this.repeatLastN,temperature:this.temperature,repeat_penalty:this.repeatPenalty,presence_penalty:this.presencePenalty,frequency_penalty:this.frequencyPenalty,mirostat:this.mirostat,mirostat_tau:this.mirostatTau,mirostat_eta:this.mirostatEta,penalize_newline:this.penalizeNewline,stop:e?.stop},tools:e?.tools?.length?e.tools.map(e=>(0,u.convertToOpenAITool)(e)):void 0}}async checkModelExistsOnMachine(e){let{models:t}=await this.client.list();return!!t.find(t=>t.name===e||t.name===`${e}:latest`)}async _generate(e,t,r){let i;for await(let n of(this.checkOrPullModel&&!await this.checkModelExistsOnMachine(this.model)&&await this.pull(this.model,{logProgress:!0}),this._streamResponseChunks(e,t,r)))i=i?(0,c.concat)(i,n.message):n.message;let a=new n.AIMessage({id:i?.id,content:i?.content??"",tool_calls:i?.tool_calls,response_metadata:i?.response_metadata,usage_metadata:i?.usage_metadata});return{generations:[{text:"string"==typeof a.content?a.content:"",message:a}]}}async *_streamResponseChunks(e,t,r){let n;this.checkOrPullModel&&!await this.checkModelExistsOnMachine(this.model)&&await this.pull(this.model,{logProgress:!0});let i=this.invocationParams(t),a=(0,f.convertToOllamaMessages)(e),l={input_tokens:0,output_tokens:0,total_tokens:0};for await(let e of(await this.client.chat({...i,messages:a,stream:!0}))){t.signal?.aborted&&this.client.abort();let{message:i,...a}=e;l.input_tokens+=a.prompt_eval_count??0,l.output_tokens+=a.eval_count??0,l.total_tokens=l.input_tokens+l.output_tokens,n=a;let o=this.think?i.thinking??i.content??"":i.content??"";yield new s.ChatGenerationChunk({text:o,message:(0,f.convertOllamaMessagesToLangChain)(i)}),await r?.handleLLMNewToken(o)}yield new s.ChatGenerationChunk({text:"",message:new o.AIMessageChunk({content:"",response_metadata:n,usage_metadata:l})})}withStructuredOutput(e,t){if(t?.method!==void 0&&t?.method!=="jsonSchema")return super.withStructuredOutput(e,t);{let r=(0,p.isInteropZodSchema)(e),n=r?(0,h.toJsonSchema)(e):e,i=this.bindTools([{type:"function",function:{name:"extract",description:n.description,parameters:n}}]).withConfig({format:"json",ls_structured_output_format:{kwargs:{method:"jsonSchema"},schema:(0,h.toJsonSchema)(e)}}),a=r?d.StructuredOutputParser.fromZodSchema(e):new d.JsonOutputParser;if(!t?.includeRaw)return i.pipe(a);let s=l.RunnablePassthrough.assign({parsed:(e,t)=>a.invoke(e.raw,t)}),o=l.RunnablePassthrough.assign({parsed:()=>null}),u=s.withFallbacks({fallbacks:[o]});return l.RunnableSequence.from([{raw:i},u])}}}r.ChatOllama=m},70736,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Embeddings=void 0;let n=e.r(1344);r.Embeddings=class{constructor(e){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new n.AsyncCaller(e??{})}}},98175,(e,t,r)=>{t.exports=e.r(70736)},45153,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.OllamaEmbeddings=void 0;let n=e.r(98175),i=e.r(76370);class a extends n.Embeddings{constructor(e){super({maxConcurrency:1,...e}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"mxbai-embed-large"}),Object.defineProperty(this,"baseUrl",{enumerable:!0,configurable:!0,writable:!0,value:"http://localhost:11434"}),Object.defineProperty(this,"keepAlive",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"requestOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"truncate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.client=new i.Ollama({fetch:e?.fetch,host:e?.baseUrl,headers:e?.headers?new Headers(e.headers):void 0}),this.baseUrl=e?.baseUrl??this.baseUrl,this.model=e?.model??this.model,this.keepAlive=e?.keepAlive,this.truncate=e?.truncate??this.truncate,this.requestOptions=e?.requestOptions?this._convertOptions(e?.requestOptions):void 0}_convertOptions(e){let t={},r={embeddingOnly:"embedding_only",frequencyPenalty:"frequency_penalty",keepAlive:"keep_alive",logitsAll:"logits_all",lowVram:"low_vram",mainGpu:"main_gpu",mirostat:"mirostat",mirostatEta:"mirostat_eta",mirostatTau:"mirostat_tau",numBatch:"num_batch",numCtx:"num_ctx",numGpu:"num_gpu",numKeep:"num_keep",numPredict:"num_predict",numThread:"num_thread",penalizeNewline:"penalize_newline",presencePenalty:"presence_penalty",repeatLastN:"repeat_last_n",repeatPenalty:"repeat_penalty",temperature:"temperature",stop:"stop",tfsZ:"tfs_z",topK:"top_k",topP:"top_p",typicalP:"typical_p",useMlock:"use_mlock",useMmap:"use_mmap",vocabOnly:"vocab_only",f16Kv:"f16_kv",numa:"numa",seed:"seed"};for(let[n,i]of Object.entries(e)){let e=r[n];e?t[e]=i:t[n]=i}return t}async embedDocuments(e){return this.embeddingWithRetry(e)}async embedQuery(e){return(await this.embeddingWithRetry([e]))[0]}async embeddingWithRetry(e){return(await this.caller.call(()=>this.client.embed({model:this.model,input:e,keep_alive:this.keepAlive,options:this.requestOptions,truncate:this.truncate}))).embeddings}}r.OllamaEmbeddings=a},99860,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},14921,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LLM=r.BaseLLM=void 0;let n=e.r(39512),i=e.r(13583),a=e.r(75622),s=e.r(85864),o=e.r(62350),l=e.r(9255);class u extends s.BaseLanguageModel{constructor({concurrency:e,...t}){super(e?{maxConcurrency:e,...t}:t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms",this._llmType()]})}async invoke(e,t){let r=u._convertInputToPromptValue(e);return(await this.generatePrompt([r],t,t?.callbacks)).generations[0][0].text}async *_streamResponseChunks(e,t,r){throw Error("Not implemented.")}_separateRunnableConfigFromCallOptionsCompat(e){let[t,r]=super._separateRunnableConfigFromCallOptions(e);return r.signal=t.signal,[t,r]}async *_streamIterator(e,t){if(this._streamResponseChunks===u.prototype._streamResponseChunks)yield this.invoke(e,t);else{let r=u._convertInputToPromptValue(e),[n,s]=this._separateRunnableConfigFromCallOptionsCompat(t),o=await a.CallbackManager.configure(n.callbacks,this.callbacks,n.tags,this.tags,n.metadata,this.metadata,{verbose:this.verbose}),l={options:s,invocation_params:this?.invocationParams(s),batch_size:1},c=await o?.handleLLMStart(this.toJSON(),[r.toString()],n.runId,void 0,l,void 0,void 0,n.runName),d=new i.GenerationChunk({text:""});try{for await(let e of this._streamResponseChunks(r.toString(),s,c?.[0]))d=d?d.concat(e):e,"string"==typeof e.text&&(yield e.text)}catch(e){throw await Promise.all((c??[]).map(t=>t?.handleLLMError(e))),e}await Promise.all((c??[]).map(e=>e?.handleLLMEnd({generations:[[d]]})))}}async generatePrompt(e,t,r){let n=e.map(e=>e.toString());return this.generate(n,t,r)}invocationParams(e){return{}}_flattenLLMResult(e){let t=[];for(let r=0;r<e.generations.length;r+=1){let n=e.generations[r];if(0===r)t.push({generations:[n],llmOutput:e.llmOutput});else{let r=e.llmOutput?{...e.llmOutput,tokenUsage:{}}:void 0;t.push({generations:[n],llmOutput:r})}}return t}async _generateUncached(e,t,r,n){let s,c;if(void 0!==n&&n.length===e.length)s=n;else{let n=await a.CallbackManager.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),i={options:t,invocation_params:this?.invocationParams(t),batch_size:e.length};s=await n?.handleLLMStart(this.toJSON(),e,r.runId,void 0,i,void 0,void 0,r?.runName)}if(s?.[0].handlers.find(l.callbackHandlerPrefersStreaming)&&1===e.length&&this._streamResponseChunks!==u.prototype._streamResponseChunks)try{let r;for await(let n of(await this._streamResponseChunks(e[0],t,s?.[0])))r=void 0===r?n:(0,o.concat)(r,n);if(void 0===r)throw Error("Received empty response from chat model call.");c={generations:[[r]],llmOutput:{}},await s?.[0].handleLLMEnd(c)}catch(e){throw await s?.[0].handleLLMError(e),e}else{try{c=await this._generate(e,t,s?.[0])}catch(e){throw await Promise.all((s??[]).map(t=>t?.handleLLMError(e))),e}let r=this._flattenLLMResult(c);await Promise.all((s??[]).map((e,t)=>e?.handleLLMEnd(r[t])))}let d=s?.map(e=>e.runId)||void 0;return Object.defineProperty(c,i.RUN_KEY,{value:d?{runIds:d}:void 0,configurable:!0}),c}async _generateCached({prompts:e,cache:t,llmStringKey:r,parsedOptions:n,handledOptions:s,runId:o}){let l=await a.CallbackManager.configure(s.callbacks,this.callbacks,s.tags,this.tags,s.metadata,this.metadata,{verbose:this.verbose}),u={options:n,invocation_params:this?.invocationParams(n),batch_size:e.length},c=await l?.handleLLMStart(this.toJSON(),e,o,void 0,u,void 0,void 0,s?.runName),d=[],p=(await Promise.allSettled(e.map(async(e,n)=>{let i=await t.lookup(e,r);return null==i&&d.push(n),i}))).map((e,t)=>({result:e,runManager:c?.[t]})).filter(({result:e})=>"fulfilled"===e.status&&null!=e.value||"rejected"===e.status),h=[];await Promise.all(p.map(async({result:e,runManager:t},r)=>{if("fulfilled"!==e.status)return await t?.handleLLMError(e.reason,void 0,void 0,void 0,{cached:!0}),Promise.reject(e.reason);{let n=e.value;return h[r]=n.map(e=>(e.generationInfo={...e.generationInfo,tokenUsage:{}},e)),n.length&&await t?.handleLLMNewToken(n[0].text),t?.handleLLMEnd({generations:[n]},void 0,void 0,void 0,{cached:!0})}}));let f={generations:h,missingPromptIndices:d,startedRunManagers:c};return Object.defineProperty(f,i.RUN_KEY,{value:c?{runIds:c?.map(e=>e.runId)}:void 0,configurable:!0}),f}async generate(e,t,r){let n;if(!Array.isArray(e))throw Error("Argument 'prompts' is expected to be a string[]");n=Array.isArray(t)?{stop:t}:t;let[i,a]=this._separateRunnableConfigFromCallOptionsCompat(n);if(i.callbacks=i.callbacks??r,!this.cache)return this._generateUncached(e,a,i);let{cache:s}=this,o=this._getSerializedCacheKeyParametersForCall(a),{generations:l,missingPromptIndices:u,startedRunManagers:c}=await this._generateCached({prompts:e,cache:s,llmStringKey:o,parsedOptions:a,handledOptions:i,runId:i.runId}),d={};if(u.length>0){let t=await this._generateUncached(u.map(t=>e[t]),a,i,void 0!==c?u.map(e=>c?.[e]):void 0);await Promise.all(t.generations.map(async(t,r)=>{let n=u[r];return l[n]=t,s.update(e[n],o,t)})),d=t.llmOutput??{}}return{generations:l,llmOutput:d}}async call(e,t,r){let{generations:n}=await this.generate([e],t,r);return n[0][0].text}async predict(e,t,r){return this.call(e,t,r)}async predictMessages(e,t,r){let i=(0,n.getBufferString)(e),a=await this.call(i,t,r);return new n.AIMessage(a)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}}r.BaseLLM=u,r.LLM=class extends u{async _generate(e,t,r){return{generations:await Promise.all(e.map((e,n)=>this._call(e,{...t,promptIndex:n},r).then(e=>[{text:e}])))}}}},39280,(e,t,r)=>{t.exports=e.r(14921)},67070,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Ollama=void 0;let n=e.r(24976),i=e.r(39280),a=e.r(76370);class s extends i.LLM{static lc_name(){return"Ollama"}constructor(e){super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"llama3"}),Object.defineProperty(this,"baseUrl",{enumerable:!0,configurable:!0,writable:!0,value:"http://localhost:11434"}),Object.defineProperty(this,"keepAlive",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"embeddingOnly",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"f16KV",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitsAll",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lowVram",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mainGpu",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostatEta",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostatTau",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numBatch",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numCtx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numGpu",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numKeep",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numPredict",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numThread",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"penalizeNewline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repeatLastN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repeatPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tfsZ",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"typicalP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useMLock",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useMMap",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vocabOnly",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"format",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=e?.model??this.model,this.baseUrl=e?.baseUrl?.endsWith("/")?e?.baseUrl.slice(0,-1):e?.baseUrl??this.baseUrl,this.client=new a.Ollama({fetch:e?.fetch,host:this.baseUrl,headers:e?.headers}),this.keepAlive=e?.keepAlive,this.embeddingOnly=e?.embeddingOnly,this.f16KV=e?.f16Kv,this.frequencyPenalty=e?.frequencyPenalty,this.logitsAll=e?.logitsAll,this.lowVram=e?.lowVram,this.mainGpu=e?.mainGpu,this.mirostat=e?.mirostat,this.mirostatEta=e?.mirostatEta,this.mirostatTau=e?.mirostatTau,this.numBatch=e?.numBatch,this.numCtx=e?.numCtx,this.numGpu=e?.numGpu,this.numKeep=e?.numKeep,this.numPredict=e?.numPredict,this.numThread=e?.numThread,this.penalizeNewline=e?.penalizeNewline,this.presencePenalty=e?.presencePenalty,this.repeatLastN=e?.repeatLastN,this.repeatPenalty=e?.repeatPenalty,this.temperature=e?.temperature,this.stop=e?.stop,this.tfsZ=e?.tfsZ,this.topK=e?.topK,this.topP=e?.topP,this.typicalP=e?.typicalP,this.useMLock=e?.useMlock,this.useMMap=e?.useMmap,this.vocabOnly=e?.vocabOnly,this.format=e?.format}_llmType(){return"ollama"}invocationParams(e){return{model:this.model,format:this.format,keep_alive:this.keepAlive,images:e?.images,options:{embedding_only:this.embeddingOnly,f16_kv:this.f16KV,frequency_penalty:this.frequencyPenalty,logits_all:this.logitsAll,low_vram:this.lowVram,main_gpu:this.mainGpu,mirostat:this.mirostat,mirostat_eta:this.mirostatEta,mirostat_tau:this.mirostatTau,num_batch:this.numBatch,num_ctx:this.numCtx,num_gpu:this.numGpu,num_keep:this.numKeep,num_predict:this.numPredict,num_thread:this.numThread,penalize_newline:this.penalizeNewline,presence_penalty:this.presencePenalty,repeat_last_n:this.repeatLastN,repeat_penalty:this.repeatPenalty,temperature:this.temperature,stop:e?.stop??this.stop,tfs_z:this.tfsZ,top_k:this.topK,top_p:this.topP,typical_p:this.typicalP,use_mlock:this.useMLock,use_mmap:this.useMMap,vocab_only:this.vocabOnly}}}async *_streamResponseChunks(e,t,r){for await(let i of(await this.caller.call(async()=>this.client.generate({...this.invocationParams(t),prompt:e,stream:!0})))){if(t.signal?.aborted)throw Error("This operation was aborted");i.done?yield new n.GenerationChunk({text:"",generationInfo:{model:i.model,total_duration:i.total_duration,load_duration:i.load_duration,prompt_eval_count:i.prompt_eval_count,prompt_eval_duration:i.prompt_eval_duration,eval_count:i.eval_count,eval_duration:i.eval_duration}}):(yield new n.GenerationChunk({text:i.response,generationInfo:{...i,response:void 0}}),await r?.handleLLMNewToken(i.response??""))}}async _call(e,t,r){let n=[];for await(let i of this._streamResponseChunks(e,t,r))n.push(i.text);return n.join("")}}r.Ollama=s},71048,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(58240),r),i(e.r(45153),r),i(e.r(99860),r),i(e.r(67070),r)},58257,(e,t,r)=>{t.exports=e.r(71048)},99441,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.__setModuleDefault=r.__createBinding=void 0,r.__classPrivateFieldSet=function(e,t,r,n,i){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},r.__classPrivateFieldGet=function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},r.__exportStar=function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},r.__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=a(e),s=0;s<r.length;s++)"default"!==r[s]&&n(t,e,r[s]);return i(t,e),t};var n=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};r.__createBinding=n;var i=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};r.__setModuleDefault=i;var a=function(e){return(a=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(e)}},87978,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.uuid4=void 0,r.uuid4=function(){let{crypto:e}=globalThis;if(e?.randomUUID)return r.uuid4=e.randomUUID.bind(e),e.randomUUID();let t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^n()&15>>e/4).toString(16))}},64684,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.castToError=void 0,r.isAbortError=function(e){return"object"==typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))},r.castToError=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){let t=Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return Error(JSON.stringify(e))}catch{}}return Error(e)}},93064,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InvalidWebhookSignatureError=r.ContentFilterFinishReasonError=r.LengthFinishReasonError=r.InternalServerError=r.RateLimitError=r.UnprocessableEntityError=r.ConflictError=r.NotFoundError=r.PermissionDeniedError=r.AuthenticationError=r.BadRequestError=r.APIConnectionTimeoutError=r.APIConnectionError=r.APIUserAbortError=r.APIError=r.OpenAIError=void 0;let n=e.r(64684);class i extends Error{}r.OpenAIError=i;class a extends i{constructor(e,t,r,n){super(`${a.makeMessage(e,t,r)}`),this.status=e,this.headers=n,this.requestID=n?.get("x-request-id"),this.error=t,this.code=t?.code,this.param=t?.param,this.type=t?.type}static makeMessage(e,t,r){let n=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&n?`${e} ${n}`:e?`${e} status code (no body)`:n||"(no status code or body)"}static generate(e,t,r,i){if(!e||!i)return new s({message:r,cause:(0,n.castToError)(t)});let m=t?.error;return 400===e?new o(e,m,r,i):401===e?new l(e,m,r,i):403===e?new u(e,m,r,i):404===e?new c(e,m,r,i):409===e?new d(e,m,r,i):422===e?new p(e,m,r,i):429===e?new h(e,m,r,i):e>=500?new f(e,m,r,i):new a(e,m,r,i)}}r.APIError=a,r.APIUserAbortError=class extends a{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}};class s extends a{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}r.APIConnectionError=s,r.APIConnectionTimeoutError=class extends s{constructor({message:e}={}){super({message:e??"Request timed out."})}};class o extends a{}r.BadRequestError=o;class l extends a{}r.AuthenticationError=l;class u extends a{}r.PermissionDeniedError=u;class c extends a{}r.NotFoundError=c;class d extends a{}r.ConflictError=d;class p extends a{}r.UnprocessableEntityError=p;class h extends a{}r.RateLimitError=h;class f extends a{}r.InternalServerError=f,r.LengthFinishReasonError=class extends i{constructor(){super("Could not parse response content as the length limit was reached")}},r.ContentFilterFinishReasonError=class extends i{constructor(){super("Could not parse response content as the request was rejected by the content filter")}},r.InvalidWebhookSignatureError=class extends Error{constructor(e){super(e)}}},14291,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.safeJSON=r.maybeCoerceBoolean=r.maybeCoerceFloat=r.maybeCoerceInteger=r.coerceBoolean=r.coerceFloat=r.coerceInteger=r.validatePositiveInteger=r.ensurePresent=r.isReadonlyArray=r.isArray=r.isAbsoluteURL=void 0,r.maybeObj=function(e){return"object"!=typeof e?{}:e??{}},r.isEmptyObj=function(e){if(!e)return!0;for(let t in e)return!1;return!0},r.hasOwn=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.isObj=function(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)};let n=e.r(93064),i=/^[a-z][a-z0-9+.-]*:/i;r.isAbsoluteURL=e=>i.test(e),r.isArray=e=>(r.isArray=Array.isArray,(0,r.isArray)(e)),r.isReadonlyArray=r.isArray,r.ensurePresent=e=>{if(null==e)throw new n.OpenAIError(`Expected a value to be given but received ${e} instead.`);return e},r.validatePositiveInteger=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new n.OpenAIError(`${e} must be an integer`);if(t<0)throw new n.OpenAIError(`${e} must be a positive integer`);return t},r.coerceInteger=e=>{if("number"==typeof e)return Math.round(e);if("string"==typeof e)return parseInt(e,10);throw new n.OpenAIError(`Could not coerce ${e} (type: ${typeof e}) into a number`)},r.coerceFloat=e=>{if("number"==typeof e)return e;if("string"==typeof e)return parseFloat(e);throw new n.OpenAIError(`Could not coerce ${e} (type: ${typeof e}) into a number`)},r.coerceBoolean=e=>"boolean"==typeof e?e:"string"==typeof e?"true"===e:!!e,r.maybeCoerceInteger=e=>{if(void 0!==e)return(0,r.coerceInteger)(e)},r.maybeCoerceFloat=e=>{if(void 0!==e)return(0,r.coerceFloat)(e)},r.maybeCoerceBoolean=e=>{if(void 0!==e)return(0,r.coerceBoolean)(e)},r.safeJSON=e=>{try{return JSON.parse(e)}catch(e){return}}},32271,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sleep=void 0,r.sleep=e=>new Promise(t=>setTimeout(t,e))},4287,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.VERSION=void 0,r.VERSION="5.12.2"},7365,(e,t,r)=>{"use strict";let n;Object.defineProperty(r,"__esModule",{value:!0}),r.getPlatformHeaders=r.isRunningInBrowser=void 0;let i=e.r(4287);r.isRunningInBrowser=()=>!1;let a=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",s=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";r.getPlatformHeaders=()=>n??(n=(()=>{let e="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":i.VERSION,"X-Stainless-OS":s(Deno.build.os),"X-Stainless-Arch":a(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":i.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":i.VERSION,"X-Stainless-OS":s(globalThis.process.platform??"unknown"),"X-Stainless-Arch":a(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let t=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let r=t.exec(navigator.userAgent);if(r){let t=r[1]||0,n=r[2]||0,i=r[3]||0;return{browser:e,version:`${t}.${n}.${i}`}}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":i.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":i.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})())},10461,(e,t,r)=>{"use strict";function n(...e){let t=globalThis.ReadableStream;if(void 0===t)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}async function i(e){if(null===e||"object"!=typeof e)return;if(e[Symbol.asyncIterator])return void await e[Symbol.asyncIterator]().return?.();let t=e.getReader(),r=t.cancel();t.releaseLock(),await r}Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaultFetch=function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")},r.makeReadableStream=n,r.ReadableStreamFrom=function(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return n({start(){},async pull(e){let{done:r,value:n}=await t.next();r?e.close():e.enqueue(n)},async cancel(){await t.return?.()}})},r.ReadableStreamToAsyncIterable=function(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}},r.CancelReadableStream=i},18258,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FallbackEncoder=void 0,r.FallbackEncoder=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)})},47298,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RFC3986=r.RFC1738=r.formatters=r.default_formatter=r.default_format=void 0,r.default_format="RFC3986",r.default_formatter=e=>String(e),r.formatters={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:r.default_formatter},r.RFC1738="RFC1738",r.RFC3986="RFC3986"},79602,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.encode=r.has=void 0,r.merge=function e(t,n,a={}){if(!n)return t;if("object"!=typeof n){if((0,i.isArray)(t))t.push(n);else{if(!t||"object"!=typeof t)return[t,n];(a&&(a.plainObjects||a.allowPrototypes)||!(0,r.has)(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(n);let s=t;return((0,i.isArray)(t)&&!(0,i.isArray)(n)&&(s=function(e,t){let r=t&&t.plainObjects?Object.create(null):{};for(let t=0;t<e.length;++t)void 0!==e[t]&&(r[t]=e[t]);return r}(t,a)),(0,i.isArray)(t)&&(0,i.isArray)(n))?(n.forEach(function(n,i){if((0,r.has)(t,i)){let r=t[i];r&&"object"==typeof r&&n&&"object"==typeof n?t[i]=e(r,n,a):t.push(n)}else t[i]=n}),t):Object.keys(n).reduce(function(t,i){let s=n[i];return(0,r.has)(t,i)?t[i]=e(t[i],s,a):t[i]=s,t},s)},r.assign_single_source=function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},r.decode=function(e,t,r){let n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},r.compact=function(e){let t=[{obj:{o:e},prop:"o"}],r=[];for(let e=0;e<t.length;++e){let n=t[e],i=n.obj[n.prop],a=Object.keys(i);for(let e=0;e<a.length;++e){let n=a[e],s=i[n];"object"==typeof s&&null!==s&&-1===r.indexOf(s)&&(t.push({obj:i,prop:n}),r.push(s))}}for(;t.length>1;){let e=t.pop();if(!e)continue;let r=e.obj[e.prop];if((0,i.isArray)(r)){let t=[];for(let e=0;e<r.length;++e)void 0!==r[e]&&t.push(r[e]);e.obj[e.prop]=t}}return e},r.is_regexp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},r.is_buffer=function(e){return!!e&&"object"==typeof e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},r.combine=function(e,t){return[].concat(e,t)},r.maybe_map=function(e,t){if((0,i.isArray)(e)){let r=[];for(let n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)};let n=e.r(47298),i=e.r(14291);r.has=(e,t)=>(r.has=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),(0,r.has)(e,t));let a=(()=>{let e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();r.encode=(e,t,r,i,s)=>{if(0===e.length)return e;let o=e;if("symbol"==typeof e?o=Symbol.prototype.toString.call(e):"string"!=typeof e&&(o=String(e)),"iso-8859-1"===r)return escape(o).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});let l="";for(let e=0;e<o.length;e+=1024){let t=o.length>=1024?o.slice(e,e+1024):o,r=[];for(let e=0;e<t.length;++e){let i=t.charCodeAt(e);if(45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122||s===n.RFC1738&&(40===i||41===i)){r[r.length]=t.charAt(e);continue}if(i<128){r[r.length]=a[i];continue}if(i<2048){r[r.length]=a[192|i>>6]+a[128|63&i];continue}if(i<55296||i>=57344){r[r.length]=a[224|i>>12]+a[128|i>>6&63]+a[128|63&i];continue}e+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(e)),r[r.length]=a[240|i>>18]+a[128|i>>12&63]+a[128|i>>6&63]+a[128|63&i]}l+=r.join("")}return l}},90046,(e,t,r)=>{"use strict";let n;Object.defineProperty(r,"__esModule",{value:!0}),r.stringify=function(e,t={}){let r,n=e,d=function(e=u){let t;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw TypeError("Encoder has to be a function.");let r=e.charset||u.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=a.default_format;if(void 0!==e.format){if(!(0,i.has)(a.formatters,e.format))throw TypeError("Unknown format option provided.");n=e.format}let l=a.formatters[n],c=u.filter;if(("function"==typeof e.filter||(0,s.isArray)(e.filter))&&(c=e.filter),t=e.arrayFormat&&e.arrayFormat in o?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":u.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw TypeError("`commaRoundTrip` must be a boolean, or absent");let d=void 0===e.allowDots?!0==!!e.encodeDotInKeys||u.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:u.addQueryPrefix,allowDots:d,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:u.allowEmptyArrays,arrayFormat:t,charset:r,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:u.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?u.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:u.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:u.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:u.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:u.encodeValuesOnly,filter:c,format:n,formatter:l,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:u.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:u.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:u.strictNullHandling}}(t);"function"==typeof d.filter?n=(0,d.filter)("",n):(0,s.isArray)(d.filter)&&(r=d.filter);let p=[];if("object"!=typeof n||null===n)return"";let h=o[d.arrayFormat],f="comma"===h&&d.commaRoundTrip;r||(r=Object.keys(n)),d.sort&&r.sort(d.sort);let m=new WeakMap;for(let e=0;e<r.length;++e){let t=r[e];d.skipNulls&&null===n[t]||l(p,function e(t,r,n,a,o,d,p,h,f,m,g,y,b,_,v,w,O,P){var S;let E,k=t,I=P,A=0,T=!1;for(;void 0!==(I=I.get(c))&&!T;){let e=I.get(t);if(A+=1,void 0!==e)if(e===A)throw RangeError("Cyclic object value");else T=!0;void 0===I.get(c)&&(A=0)}if("function"==typeof m?k=m(r,k):k instanceof Date?k=b?.(k):"comma"===n&&(0,s.isArray)(k)&&(k=(0,i.maybe_map)(k,function(e){return e instanceof Date?b?.(e):e})),null===k){if(d)return f&&!w?f(r,u.encoder,O,"key",_):r;k=""}if("string"==typeof(S=k)||"number"==typeof S||"boolean"==typeof S||"symbol"==typeof S||"bigint"==typeof S||(0,i.is_buffer)(k)){if(f){let e=w?r:f(r,u.encoder,O,"key",_);return[v?.(e)+"="+v?.(f(k,u.encoder,O,"value",_))]}return[v?.(r)+"="+v?.(String(k))]}let C=[];if(void 0===k)return C;if("comma"===n&&(0,s.isArray)(k))w&&f&&(k=(0,i.maybe_map)(k,f)),E=[{value:k.length>0?k.join(",")||null:void 0}];else if((0,s.isArray)(m))E=m;else{let e=Object.keys(k);E=g?e.sort(g):e}let j=h?String(r).replace(/\./g,"%2E"):String(r),x=a&&(0,s.isArray)(k)&&1===k.length?j+"[]":j;if(o&&(0,s.isArray)(k)&&0===k.length)return x+"[]";for(let r=0;r<E.length;++r){let i=E[r],u="object"==typeof i&&void 0!==i.value?i.value:k[i];if(p&&null===u)continue;let S=y&&h?i.replace(/\./g,"%2E"):i,I=(0,s.isArray)(k)?"function"==typeof n?n(x,S):x:x+(y?"."+S:"["+S+"]");P.set(t,A);let T=new WeakMap;T.set(c,P),l(C,e(u,I,n,a,o,d,p,h,"comma"===n&&w&&(0,s.isArray)(k)?null:f,m,g,y,b,_,v,w,O,T))}return C}(n[t],t,h,f,d.allowEmptyArrays,d.strictNullHandling,d.skipNulls,d.encodeDotInKeys,d.encode?d.encoder:null,d.filter,d.sort,d.allowDots,d.serializeDate,d.format,d.formatter,d.encodeValuesOnly,d.charset,m))}let g=p.join(d.delimiter),y=!0===d.addQueryPrefix?"?":"";return d.charsetSentinel&&("iso-8859-1"===d.charset?y+="utf8=%26%2310003%3B&":y+="utf8=%E2%9C%93&"),g.length>0?y+g:""};let i=e.r(79602),a=e.r(47298),s=e.r(14291),o={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},l=function(e,t){Array.prototype.push.apply(e,(0,s.isArray)(t)?t:[t])},u={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:i.encode,encodeValuesOnly:!1,format:a.default_format,formatter:a.default_formatter,indices:!1,serializeDate:e=>(n??(n=Function.prototype.call.bind(Date.prototype.toISOString)))(e),skipNulls:!1,strictNullHandling:!1},c={}},22093,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.formats=r.stringify=void 0;let n=e.r(47298);r.formats={formatters:n.formatters,RFC1738:n.RFC1738,RFC3986:n.RFC3986,default:n.default_format};var i=e.r(90046);Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return i.stringify}})},90780,(e,t,r)=>{"use strict";let n,i;Object.defineProperty(r,"__esModule",{value:!0}),r.concatBytes=function(e){let t=0;for(let r of e)t+=r.length;let r=new Uint8Array(t),n=0;for(let t of e)r.set(t,n),n+=t.length;return r},r.encodeUTF8=function(e){let t;return(n??(n=(t=new globalThis.TextEncoder).encode.bind(t)))(e)},r.decodeUTF8=function(e){let t;return(i??(i=(t=new globalThis.TextDecoder).decode.bind(t)))(e)}},13736,(e,t,r)=>{"use strict";var n,i;Object.defineProperty(r,"__esModule",{value:!0}),r.LineDecoder=void 0,r.findDoubleNewlineIndex=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1};let a=e.r(99441),s=e.r(90780);class o{constructor(){n.set(this,void 0),i.set(this,void 0),a.__classPrivateFieldSet(this,n,new Uint8Array,"f"),a.__classPrivateFieldSet(this,i,null,"f")}decode(e){let t;if(null==e)return[];let r=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?(0,s.encodeUTF8)(e):e;a.__classPrivateFieldSet(this,n,(0,s.concatBytes)([a.__classPrivateFieldGet(this,n,"f"),r]),"f");let o=[];for(;null!=(t=function(e,t){for(let r=t??0;r<e.length;r++){if(10===e[r])return{preceding:r,index:r+1,carriage:!1};if(13===e[r])return{preceding:r,index:r+1,carriage:!0}}return null}(a.__classPrivateFieldGet(this,n,"f"),a.__classPrivateFieldGet(this,i,"f")));){if(t.carriage&&null==a.__classPrivateFieldGet(this,i,"f")){a.__classPrivateFieldSet(this,i,t.index,"f");continue}if(null!=a.__classPrivateFieldGet(this,i,"f")&&(t.index!==a.__classPrivateFieldGet(this,i,"f")+1||t.carriage)){o.push((0,s.decodeUTF8)(a.__classPrivateFieldGet(this,n,"f").subarray(0,a.__classPrivateFieldGet(this,i,"f")-1))),a.__classPrivateFieldSet(this,n,a.__classPrivateFieldGet(this,n,"f").subarray(a.__classPrivateFieldGet(this,i,"f")),"f"),a.__classPrivateFieldSet(this,i,null,"f");continue}let e=null!==a.__classPrivateFieldGet(this,i,"f")?t.preceding-1:t.preceding,r=(0,s.decodeUTF8)(a.__classPrivateFieldGet(this,n,"f").subarray(0,e));o.push(r),a.__classPrivateFieldSet(this,n,a.__classPrivateFieldGet(this,n,"f").subarray(t.index),"f"),a.__classPrivateFieldSet(this,i,null,"f")}return o}flush(){return a.__classPrivateFieldGet(this,n,"f").length?this.decode("\n"):[]}}r.LineDecoder=o,n=new WeakMap,i=new WeakMap,o.NEWLINE_CHARS=new Set(["\n","\r"]),o.NEWLINE_REGEXP=/\r\n|[\n\r]/g},49434,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.formatRequestDetails=r.parseLogLevel=void 0,r.loggerFor=u;let n=e.r(14291),i={off:0,error:200,warn:300,info:400,debug:500};function a(){}function s(e,t,r){return!t||i[e]>i[r]?a:t[e].bind(t)}r.parseLogLevel=(e,t,r)=>{if(e){if((0,n.hasOwn)(i,e))return e;u(r).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(i))}`)}};let o={error:a,warn:a,info:a,debug:a},l=new WeakMap;function u(e){let t=e.logger,r=e.logLevel??"off";if(!t)return o;let n=l.get(t);if(n&&n[0]===r)return n[1];let i={error:s("error",t,r),warn:s("warn",t,r),info:s("info",t,r),debug:s("debug",t,r)};return l.set(t,[r,i]),i}r.formatRequestDetails=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([e,t])=>[e,"authorization"===e.toLowerCase()||"cookie"===e.toLowerCase()||"set-cookie"===e.toLowerCase()?"***":t]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e)},77842,(e,t,r)=>{"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.Stream=void 0,r._iterSSEMessages=f;let i=e.r(99441),a=e.r(93064),s=e.r(10461),o=e.r(13736),l=e.r(10461),u=e.r(64684),c=e.r(90780),d=e.r(49434),p=e.r(93064);class h{constructor(e,t,r){this.iterator=e,n.set(this,void 0),this.controller=t,i.__classPrivateFieldSet(this,n,r,"f")}static fromSSEResponse(e,t,r){let n=!1,i=r?(0,d.loggerFor)(r):console;async function*s(){if(n)throw new a.OpenAIError("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(let n of f(e,t))if(!r){if(n.data.startsWith("[DONE]")){r=!0;continue}if(null!==n.event&&n.event.startsWith("thread.")){let e;try{e=JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if("error"==n.event)throw new p.APIError(void 0,e.error,e.message,void 0);yield{event:n.event,data:e}}else{let t;try{t=JSON.parse(n.data)}catch(e){throw i.error("Could not parse message into JSON:",n.data),i.error("From chunk:",n.raw),e}if(t&&t.error)throw new p.APIError(void 0,t.error,void 0,e.headers);yield t}}r=!0}catch(e){if((0,u.isAbortError)(e))return;throw e}finally{r||t.abort()}}return new h(s,t,r)}static fromReadableStream(e,t,r){let n=!1;async function*i(){let t=new o.LineDecoder;for await(let r of(0,l.ReadableStreamToAsyncIterable)(e))for(let e of t.decode(r))yield e;for(let e of t.flush())yield e}return new h(async function*(){if(n)throw new a.OpenAIError("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let e=!1;try{for await(let t of i())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if((0,u.isAbortError)(e))return;throw e}finally{e||t.abort()}},t,r)}[(n=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let e=[],t=[],r=this.iterator(),a=n=>({next:()=>{if(0===n.length){let n=r.next();e.push(n),t.push(n)}return n.shift()}});return[new h(()=>a(e),this.controller,i.__classPrivateFieldGet(this,n,"f")),new h(()=>a(t),this.controller,i.__classPrivateFieldGet(this,n,"f"))]}toReadableStream(){let e,t=this;return(0,s.makeReadableStream)({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:r,done:n}=await e.next();if(n)return t.close();let i=(0,c.encodeUTF8)(JSON.stringify(r)+"\n");t.enqueue(i)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}}async function*f(e,t){if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new a.OpenAIError("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new a.OpenAIError("Attempted to iterate over a response with no body")}let r=new g,n=new o.LineDecoder;for await(let t of m((0,l.ReadableStreamToAsyncIterable)(e.body)))for(let e of n.decode(t)){let t=r.decode(e);t&&(yield t)}for(let e of n.flush()){let t=r.decode(e);t&&(yield t)}}async function*m(e){let t=new Uint8Array;for await(let r of e){let e;if(null==r)continue;let n=r instanceof ArrayBuffer?new Uint8Array(r):"string"==typeof r?(0,c.encodeUTF8)(r):r,i=new Uint8Array(t.length+n.length);for(i.set(t),i.set(n,t.length),t=i;-1!==(e=(0,o.findDoubleNewlineIndex)(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}r.Stream=h;class g{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,n]=function(e,t){let r=e.indexOf(":");return -1!==r?[e.substring(0,r),t,e.substring(r+t.length)]:[e,"",""]}(e,":");return n.startsWith(" ")&&(n=n.substring(1)),"event"===t?this.event=n:"data"===t&&this.data.push(n),null}}},38828,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaultParseResponse=a,r.addRequestID=s;let n=e.r(77842),i=e.r(49434);async function a(e,t){let{response:r,requestLogID:a,retryOfRequestLogID:o,startTime:l}=t,u=await (async()=>{if(t.options.stream)return((0,i.loggerFor)(e).debug("response",r.status,r.url,r.headers,r.body),t.options.__streamClass)?t.options.__streamClass.fromSSEResponse(r,t.controller,e):n.Stream.fromSSEResponse(r,t.controller,e);if(204===r.status)return null;if(t.options.__binaryResponse)return r;let a=r.headers.get("content-type"),o=a?.split(";")[0]?.trim();return o?.includes("application/json")||o?.endsWith("+json")?s(await r.json(),r):await r.text()})();return(0,i.loggerFor)(e).debug(`[${a}] response parsed`,(0,i.formatRequestDetails)({retryOfRequestLogID:o,url:r.url,status:r.status,body:u,durationMs:Date.now()-l})),u}function s(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}},35079,(e,t,r)=>{"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.APIPromise=void 0;let i=e.r(99441),a=e.r(38828);class s extends Promise{constructor(e,t,r=a.defaultParseResponse){super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=r,n.set(this,void 0),i.__classPrivateFieldSet(this,n,e,"f")}_thenUnwrap(e){return new s(i.__classPrivateFieldGet(this,n,"f"),this.responsePromise,async(t,r)=>(0,a.addRequestID)(e(await this.parseResponse(t,r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(i.__classPrivateFieldGet(this,n,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}r.APIPromise=s,n=new WeakMap},3830,(e,t,r)=>{"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.CursorPage=r.Page=r.PagePromise=r.AbstractPage=void 0;let i=e.r(99441),a=e.r(93064),s=e.r(38828),o=e.r(35079),l=e.r(14291);class u{constructor(e,t,r,a){n.set(this,void 0),i.__classPrivateFieldSet(this,n,e,"f"),this.options=a,this.response=t,this.body=r}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageRequestOptions()}async getNextPage(){let e=this.nextPageRequestOptions();if(!e)throw new a.OpenAIError("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await i.__classPrivateFieldGet(this,n,"f").requestAPIList(this.constructor,e)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(n=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}}r.AbstractPage=u;class c extends o.APIPromise{constructor(e,t,r){super(e,t,async(e,t)=>new r(e,t.response,await (0,s.defaultParseResponse)(e,t),t.options))}async *[Symbol.asyncIterator](){for await(let e of(await this))yield e}}r.PagePromise=c,r.Page=class extends u{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}},r.CursorPage=class extends u{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){let e=this.getPaginatedItems(),t=e[e.length-1]?.id;return t?{...this.options,query:{...(0,l.maybeObj)(this.options.query),after:t}}:null}}},13256,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createForm=r.multipartFormRequestOptions=r.maybeMultipartFormRequestOptions=r.isAsyncIterable=r.checkFileSupport=void 0,r.makeFile=i,r.getName=a;let n=e.r(10461);function i(e,t,n){return(0,r.checkFileSupport)(),new File(e,t??"unknown_file",n)}function a(e){return("object"==typeof e&&null!==e&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}r.checkFileSupport=()=>{if("undefined"==typeof File){let{process:e}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof e?.versions?.node&&20>parseInt(e.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}},r.isAsyncIterable=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator];let s=async(e,t)=>c(e.body)?{...e,body:await (0,r.createForm)(e.body,t)}:e;r.maybeMultipartFormRequestOptions=s;let o=async(e,t)=>({...e,body:await (0,r.createForm)(e.body,t)});r.multipartFormRequestOptions=o;let l=new WeakMap;r.createForm=async(e,t)=>{if(!await function(e){let t="function"==typeof e?e:e.fetch,r=l.get(t);if(r)return r;let n=(async()=>{try{let e="Response"in t?t.Response:(await t("data:,")).constructor,r=new FormData;if(r.toString()===await new e(r).text())return!1;return!0}catch{return!0}})();return l.set(t,n),n}(t))throw TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let r=new FormData;return await Promise.all(Object.entries(e||{}).map(([e,t])=>d(r,e,t))),r};let u=e=>e instanceof Blob&&"name"in e,c=e=>{if((e=>"object"==typeof e&&null!==e&&(e instanceof Response||(0,r.isAsyncIterable)(e)||u(e)))(e))return!0;if(Array.isArray(e))return e.some(c);if(e&&"object"==typeof e){for(let t in e)if(c(e[t]))return!0}return!1},d=async(e,t,s)=>{if(void 0!==s){if(null==s)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof s||"number"==typeof s||"boolean"==typeof s)e.append(t,String(s));else if(s instanceof Response)e.append(t,i([await s.blob()],a(s)));else if((0,r.isAsyncIterable)(s))e.append(t,i([await new Response((0,n.ReadableStreamFrom)(s)).blob()],a(s)));else if(u(s))e.append(t,s,a(s));else if(Array.isArray(s))await Promise.all(s.map(r=>d(e,t+"[]",r)));else if("object"==typeof s)await Promise.all(Object.entries(s).map(([r,n])=>d(e,`${t}[${r}]`,n)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${s} instead`)}}},38873,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toFile=s;let n=e.r(13256),i=e.r(13256),a=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer;async function s(e,t,r){let s,l;if((0,i.checkFileSupport)(),null!=(s=e=await e)&&"object"==typeof s&&"string"==typeof s.name&&"number"==typeof s.lastModified&&a(s))return e instanceof File?e:(0,n.makeFile)([await e.arrayBuffer()],e.name);if(null!=(l=e)&&"object"==typeof l&&"string"==typeof l.url&&"function"==typeof l.blob){let i=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),(0,n.makeFile)(await o(i),t,r)}let u=await o(e);if(t||(t=(0,n.getName)(e)),!r?.type){let e=u.find(e=>"object"==typeof e&&"type"in e&&e.type);"string"==typeof e&&(r={...r,type:e})}return(0,n.makeFile)(u,t,r)}async function o(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(a(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if((0,n.isAsyncIterable)(e))for await(let r of e)t.push(...await o(r));else{let t=e?.constructor?.name;throw Error(`Unexpected data type: ${typeof e}${t?`; constructor: ${t}`:""}${function(e){if("object"!=typeof e||null===e)return"";let t=Object.getOwnPropertyNames(e);return`; props: [${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`)}return t}},93876,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toFile=void 0;var n=e.r(38873);Object.defineProperty(r,"toFile",{enumerable:!0,get:function(){return n.toFile}})},78465,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.APIResource=void 0,r.APIResource=class{constructor(e){this._client=e}}},32943,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.path=r.createPathTagFunction=void 0,r.encodeURIPath=i;let n=e.r(93064);function i(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}let a=Object.freeze(Object.create(null));r.createPathTagFunction=(e=i)=>function(t,...r){let i;if(1===t.length)return t[0];let s=!1,o=[],l=t.reduce((t,n,i)=>{/[?#]/.test(n)&&(s=!0);let l=r[i],u=(s?encodeURIComponent:e)(""+l);return i!==r.length&&(null==l||"object"==typeof l&&l.toString===Object.getPrototypeOf(Object.getPrototypeOf(l.hasOwnProperty??a)??a)?.toString)&&(u=l+"",o.push({start:t.length+n.length,length:u.length,error:`Value of type ${Object.prototype.toString.call(l).slice(8,-1)} is not a valid path parameter`})),t+n+(i===r.length?"":u)},""),u=l.split(/[?#]/,1)[0],c=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(i=c.exec(u));)o.push({start:i.index,length:i[0].length,error:`Value "${i[0]}" can't be safely passed as a path parameter`});if(o.sort((e,t)=>e.start-t.start),o.length>0){let e=0,t=o.reduce((t,r)=>{let n=" ".repeat(r.start-e),i="^".repeat(r.length);return e=r.start+r.length,t+n+i},"");throw new n.OpenAIError(`Path parameters result in path with invalid segments:
${o.map(e=>e.error).join("\n")}
${l}
${t}`)}return l},r.path=(0,r.createPathTagFunction)(i)},36239,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Messages=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(32943);class s extends n.APIResource{list(e,t={},r){return this._client.getAPIList((0,a.path)`/chat/completions/${e}/messages`,i.CursorPage,{query:t,...r})}}r.Messages=s},43163,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),e.r(99441).__exportStar(e.r(93064),r)},26636,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isChatCompletionFunctionTool=i,r.makeParseableResponseFormat=function(e,t){let r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),r},r.makeParseableTextFormat=function(e,t){let r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),r},r.isAutoParsableResponseFormat=a,r.makeParseableTool=function(e,{parser:t,callback:r}){let n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:r,enumerable:!1}}),n},r.isAutoParsableTool=s,r.maybeParseChatCompletion=function(e,t){return t&&l(t)?o(e,t):{...e,choices:e.choices.map(e=>(u(e.message.tool_calls),{...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}}))}},r.parseChatCompletion=o,r.shouldParseToolCall=function(e,t){if(!e||!("tools"in e)||!e.tools)return!1;let r=e.tools?.find(e=>i(e)&&e.function?.name===t.function.name);return i(r)&&(s(r)||r?.function.strict||!1)},r.hasAutoParseableInput=l,r.assertToolCallsAreChatCompletionFunctionToolCalls=u,r.validateInputTools=function(e){for(let t of e??[]){if("function"!==t.type)throw new n.OpenAIError(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new n.OpenAIError(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}};let n=e.r(43163);function i(e){return void 0!==e&&"function"in e&&void 0!==e.function}function a(e){return e?.$brand==="auto-parseable-response-format"}function s(e){return e?.$brand==="auto-parseable-tool"}function o(e,t){let r=e.choices.map(e=>{var r,a;if("length"===e.finish_reason)throw new n.LengthFinishReasonError;if("content_filter"===e.finish_reason)throw new n.ContentFilterFinishReasonError;return u(e.message.tool_calls),{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:e.message.tool_calls?.map(e=>(function(e,t){let r=e.tools?.find(e=>i(e)&&e.function?.name===t.function.name);return{...t,function:{...t.function,parsed_arguments:s(r)?r.$parseRaw(t.function.arguments):r?.function.strict?JSON.parse(t.function.arguments):null}}})(t,e))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?(r=t,a=e.message.content,r.response_format?.type!=="json_schema"?null:r.response_format?.type==="json_schema"?"$parseRaw"in r.response_format?r.response_format.$parseRaw(a):JSON.parse(a):null):null}}});return{...e,choices:r}}function l(e){return!!a(e.response_format)||(e.tools?.some(e=>s(e)||"function"===e.type&&!0===e.function.strict)??!1)}function u(e){for(let t of e||[])if("function"!==t.type)throw new n.OpenAIError(`Currently only \`function\` tool calls are supported; Received \`${t.type}\``)}},42147,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isToolMessage=r.isAssistantMessage=void 0,r.isPresent=function(e){return null!=e},r.isAssistantMessage=e=>e?.role==="assistant",r.isToolMessage=e=>e?.role==="tool"},56132,(e,t,r)=>{"use strict";var n,i,a,s,o,l,u,c,d,p,h,f,m;Object.defineProperty(r,"__esModule",{value:!0}),r.EventStream=void 0;let g=e.r(99441),y=e.r(43163);r.EventStream=class{constructor(){n.add(this),this.controller=new AbortController,i.set(this,void 0),a.set(this,()=>{}),s.set(this,()=>{}),o.set(this,void 0),l.set(this,()=>{}),u.set(this,()=>{}),c.set(this,{}),d.set(this,!1),p.set(this,!1),h.set(this,!1),f.set(this,!1),g.__classPrivateFieldSet(this,i,new Promise((e,t)=>{g.__classPrivateFieldSet(this,a,e,"f"),g.__classPrivateFieldSet(this,s,t,"f")}),"f"),g.__classPrivateFieldSet(this,o,new Promise((e,t)=>{g.__classPrivateFieldSet(this,l,e,"f"),g.__classPrivateFieldSet(this,u,t,"f")}),"f"),g.__classPrivateFieldGet(this,i,"f").catch(()=>{}),g.__classPrivateFieldGet(this,o,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},g.__classPrivateFieldGet(this,n,"m",m).bind(this))},0)}_connected(){this.ended||(g.__classPrivateFieldGet(this,a,"f").call(this),this._emit("connect"))}get ended(){return g.__classPrivateFieldGet(this,d,"f")}get errored(){return g.__classPrivateFieldGet(this,p,"f")}get aborted(){return g.__classPrivateFieldGet(this,h,"f")}abort(){this.controller.abort()}on(e,t){return(g.__classPrivateFieldGet(this,c,"f")[e]||(g.__classPrivateFieldGet(this,c,"f")[e]=[])).push({listener:t}),this}off(e,t){let r=g.__classPrivateFieldGet(this,c,"f")[e];if(!r)return this;let n=r.findIndex(e=>e.listener===t);return n>=0&&r.splice(n,1),this}once(e,t){return(g.__classPrivateFieldGet(this,c,"f")[e]||(g.__classPrivateFieldGet(this,c,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{g.__classPrivateFieldSet(this,f,!0,"f"),"error"!==e&&this.once("error",r),this.once(e,t)})}async done(){g.__classPrivateFieldSet(this,f,!0,"f"),await g.__classPrivateFieldGet(this,o,"f")}_emit(e,...t){if(g.__classPrivateFieldGet(this,d,"f"))return;"end"===e&&(g.__classPrivateFieldSet(this,d,!0,"f"),g.__classPrivateFieldGet(this,l,"f").call(this));let r=g.__classPrivateFieldGet(this,c,"f")[e];if(r&&(g.__classPrivateFieldGet(this,c,"f")[e]=r.filter(e=>!e.once),r.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];g.__classPrivateFieldGet(this,f,"f")||r?.length||Promise.reject(e),g.__classPrivateFieldGet(this,s,"f").call(this,e),g.__classPrivateFieldGet(this,u,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];g.__classPrivateFieldGet(this,f,"f")||r?.length||Promise.reject(e),g.__classPrivateFieldGet(this,s,"f").call(this,e),g.__classPrivateFieldGet(this,u,"f").call(this,e),this._emit("end")}}_emitFinal(){}},i=new WeakMap,a=new WeakMap,s=new WeakMap,o=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakMap,d=new WeakMap,p=new WeakMap,h=new WeakMap,f=new WeakMap,n=new WeakSet,m=function(e){if(g.__classPrivateFieldSet(this,p,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new y.APIUserAbortError),e instanceof y.APIUserAbortError)return g.__classPrivateFieldSet(this,h,!0,"f"),this._emit("abort",e);if(e instanceof y.OpenAIError)return this._emit("error",e);if(e instanceof Error){let t=new y.OpenAIError(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new y.OpenAIError(String(e)))}},43443,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ParsingToolFunction=void 0,r.isRunnableFunctionWithParse=function(e){return"function"==typeof e.parse},r.ParsingToolFunction=class{constructor(e){this.type="function",this.function=e}}},96746,(e,t,r)=>{"use strict";var n,i,a,s,o,l,u,c;Object.defineProperty(r,"__esModule",{value:!0}),r.AbstractChatCompletionRunner=void 0;let d=e.r(99441),p=e.r(43163),h=e.r(26636),f=e.r(42147),m=e.r(56132),g=e.r(43443);class y extends m.EventStream{constructor(){super(...arguments),n.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);let t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(0,f.isToolMessage)(e)&&e.content)this._emit("functionToolCallResult",e.content);else if((0,f.isAssistantMessage)(e)&&e.tool_calls)for(let t of e.tool_calls)"function"===t.type&&this._emit("functionToolCall",t.function)}}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new p.OpenAIError("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),d.__classPrivateFieldGet(this,n,"m",i).call(this)}async finalMessage(){return await this.done(),d.__classPrivateFieldGet(this,n,"m",a).call(this)}async finalFunctionToolCall(){return await this.done(),d.__classPrivateFieldGet(this,n,"m",s).call(this)}async finalFunctionToolCallResult(){return await this.done(),d.__classPrivateFieldGet(this,n,"m",o).call(this)}async totalUsage(){return await this.done(),d.__classPrivateFieldGet(this,n,"m",l).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=d.__classPrivateFieldGet(this,n,"m",a).call(this);t&&this._emit("finalMessage",t);let r=d.__classPrivateFieldGet(this,n,"m",i).call(this);r&&this._emit("finalContent",r);let u=d.__classPrivateFieldGet(this,n,"m",s).call(this);u&&this._emit("finalFunctionToolCall",u);let c=d.__classPrivateFieldGet(this,n,"m",o).call(this);null!=c&&this._emit("finalFunctionToolCallResult",c),this._chatCompletions.some(e=>e.usage)&&this._emit("totalUsage",d.__classPrivateFieldGet(this,n,"m",l).call(this))}async _createChatCompletion(e,t,r){let i=r?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),d.__classPrivateFieldGet(this,n,"m",u).call(this,t);let a=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion((0,h.parseChatCompletion)(a,t))}async _runChatCompletion(e,t,r){for(let e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,r)}async _runTools(e,t,r){let i="tool",{tool_choice:a="auto",stream:s,...o}=t,l="string"!=typeof a&&"function"===a.type&&a?.function?.name,{maxChatCompletions:u=10}=r||{},f=t.tools.map(e=>{if((0,h.isAutoParsableTool)(e)){if(!e.$callback)throw new p.OpenAIError("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e}),m={};for(let e of f)"function"===e.type&&(m[e.function.name||e.function.function.name]=e.function);let y="tools"in t?f.map(e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e):void 0;for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<u;++t){let t=await this._createChatCompletion(e,{...o,tool_choice:a,tools:y,messages:[...this.messages]},r),s=t.choices[0]?.message;if(!s)throw new p.OpenAIError("missing message in ChatCompletion response");if(!s.tool_calls?.length)break;for(let e of s.tool_calls){let t;if("function"!==e.type)continue;let r=e.id,{name:a,arguments:s}=e.function,o=m[a];if(o){if(l&&l!==a){let e=`Invalid tool_call: ${JSON.stringify(a)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:i,tool_call_id:r,content:e});continue}}else{let e=`Invalid tool_call: ${JSON.stringify(a)}. Available options are: ${Object.keys(m).map(e=>JSON.stringify(e)).join(", ")}. Please try again`;this._addMessage({role:i,tool_call_id:r,content:e});continue}try{t=(0,g.isRunnableFunctionWithParse)(o)?await o.parse(s):s}catch(t){let e=t instanceof Error?t.message:String(t);this._addMessage({role:i,tool_call_id:r,content:e});continue}let u=await o.function(t,this),p=d.__classPrivateFieldGet(this,n,"m",c).call(this,u);if(this._addMessage({role:i,tool_call_id:r,content:p}),l)return}}}}r.AbstractChatCompletionRunner=y,n=new WeakSet,i=function(){return d.__classPrivateFieldGet(this,n,"m",a).call(this).content??null},a=function(){let e=this.messages.length;for(;e-- >0;){let t=this.messages[e];if((0,f.isAssistantMessage)(t))return{...t,content:t.content??null,refusal:t.refusal??null}}throw new p.OpenAIError("stream ended without producing a ChatCompletionMessage with role=assistant")},s=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if((0,f.isAssistantMessage)(t)&&t?.tool_calls?.length)return t.tool_calls.filter(e=>"function"===e.type).at(-1)?.function}},o=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if((0,f.isToolMessage)(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some(e=>"assistant"===e.role&&e.tool_calls?.some(e=>"function"===e.type&&e.id===t.tool_call_id)))return t.content}},l=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},u=function(e){if(null!=e.n&&e.n>1)throw new p.OpenAIError("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},c=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)}},78051,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChatCompletionRunner=void 0;let n=e.r(96746),i=e.r(42147);class a extends n.AbstractChatCompletionRunner{static runTools(e,t,r){let n=new a,i={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,i)),n}_addMessage(e,t=!0){super._addMessage(e,t),(0,i.isAssistantMessage)(e)&&e.content&&this._emit("content",e.content)}}r.ChatCompletionRunner=a},67552,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MalformedJSON=r.PartialJSON=r.partialParse=void 0;let n={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,INF:384,ALL:511};class i extends Error{}r.PartialJSON=i;class a extends Error{}r.MalformedJSON=a;r.partialParse=e=>(function(e,t=n.ALL){if("string"!=typeof e)throw TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw Error(`${e} is empty`);return((e,t)=>{let r=e.length,s=0,o=e=>{throw new i(`${e} at position ${s}`)},l=e=>{throw new a(`${e} at position ${s}`)},u=()=>(f(),s>=r&&o("Unexpected end of input"),'"'===e[s])?c():"{"===e[s]?d():"["===e[s]?p():"null"===e.substring(s,s+4)||n.NULL&t&&r-s<4&&"null".startsWith(e.substring(s))?(s+=4,null):"true"===e.substring(s,s+4)||n.BOOL&t&&r-s<4&&"true".startsWith(e.substring(s))?(s+=4,!0):"false"===e.substring(s,s+5)||n.BOOL&t&&r-s<5&&"false".startsWith(e.substring(s))?(s+=5,!1):"Infinity"===e.substring(s,s+8)||n.INFINITY&t&&r-s<8&&"Infinity".startsWith(e.substring(s))?(s+=8,1/0):"-Infinity"===e.substring(s,s+9)||n.MINUS_INFINITY&t&&1<r-s&&r-s<9&&"-Infinity".startsWith(e.substring(s))?(s+=9,-1/0):"NaN"===e.substring(s,s+3)||n.NAN&t&&r-s<3&&"NaN".startsWith(e.substring(s))?(s+=3,NaN):h(),c=()=>{let i=s,a=!1;for(s++;s<r&&('"'!==e[s]||a&&"\\"===e[s-1]);)a="\\"===e[s]&&!a,s++;if('"'==e.charAt(s))try{return JSON.parse(e.substring(i,++s-Number(a)))}catch(e){l(String(e))}else if(n.STR&t)try{return JSON.parse(e.substring(i,s-Number(a))+'"')}catch(t){return JSON.parse(e.substring(i,e.lastIndexOf("\\"))+'"')}o("Unterminated string literal")},d=()=>{s++,f();let i={};try{for(;"}"!==e[s];){if(f(),s>=r&&n.OBJ&t)return i;let a=c();f(),s++;try{let e=u();Object.defineProperty(i,a,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(e){if(n.OBJ&t)return i;throw e}f(),","===e[s]&&s++}}catch(e){if(n.OBJ&t)return i;o("Expected '}' at end of object")}return s++,i},p=()=>{s++;let r=[];try{for(;"]"!==e[s];)r.push(u()),f(),","===e[s]&&s++}catch(e){if(n.ARR&t)return r;o("Expected ']' at end of array")}return s++,r},h=()=>{if(0===s){"-"===e&&n.NUM&t&&o("Not sure what '-' is");try{return JSON.parse(e)}catch(r){if(n.NUM&t)try{if("."===e[e.length-1])return JSON.parse(e.substring(0,e.lastIndexOf(".")));return JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}l(String(r))}}let i=s;for("-"===e[s]&&s++;e[s]&&!",]}".includes(e[s]);)s++;s!=r||n.NUM&t||o("Unterminated number literal");try{return JSON.parse(e.substring(i,s))}catch(r){"-"===e.substring(i,s)&&n.NUM&t&&o("Not sure what '-' is");try{return JSON.parse(e.substring(i,e.lastIndexOf("e")))}catch(e){l(String(e))}}},f=()=>{for(;s<r&&" \n\r	".includes(e[s]);)s++};return u()})(e.trim(),t)})(e,n.ALL^n.NUM)},40680,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),e.r(99441).__exportStar(e.r(77842),r)},46386,(e,t,r)=>{"use strict";var n,i,a,s,o,l,u,c,d,p,h,f;Object.defineProperty(r,"__esModule",{value:!0}),r.ChatCompletionStream=void 0;let m=e.r(99441),g=e.r(67552),y=e.r(43163),b=e.r(26636),_=e.r(40680),v=e.r(96746);class w extends v.AbstractChatCompletionRunner{constructor(e){super(),n.add(this),i.set(this,void 0),a.set(this,void 0),s.set(this,void 0),m.__classPrivateFieldSet(this,i,e,"f"),m.__classPrivateFieldSet(this,a,[],"f")}get currentChatCompletionSnapshot(){return m.__classPrivateFieldGet(this,s,"f")}static fromReadableStream(e){let t=new w(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){let n=new w(t);return n._run(()=>n._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createChatCompletion(e,t,r){super._createChatCompletion;let i=r?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),m.__classPrivateFieldGet(this,n,"m",o).call(this);let a=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});for await(let e of(this._connected(),a))m.__classPrivateFieldGet(this,n,"m",u).call(this,e);if(a.controller.signal?.aborted)throw new y.APIUserAbortError;return this._addChatCompletion(m.__classPrivateFieldGet(this,n,"m",p).call(this))}async _fromReadableStream(e,t){let r,i=t?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),m.__classPrivateFieldGet(this,n,"m",o).call(this),this._connected();let a=_.Stream.fromReadableStream(e,this.controller);for await(let e of a)r&&r!==e.id&&this._addChatCompletion(m.__classPrivateFieldGet(this,n,"m",p).call(this)),m.__classPrivateFieldGet(this,n,"m",u).call(this,e),r=e.id;if(a.controller.signal?.aborted)throw new y.APIUserAbortError;return this._addChatCompletion(m.__classPrivateFieldGet(this,n,"m",p).call(this))}[(i=new WeakMap,a=new WeakMap,s=new WeakMap,n=new WeakSet,o=function(){this.ended||m.__classPrivateFieldSet(this,s,void 0,"f")},l=function(e){let t=m.__classPrivateFieldGet(this,a,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},m.__classPrivateFieldGet(this,a,"f")[e.index]=t),t},u=function(e){if(this.ended)return;let t=m.__classPrivateFieldGet(this,n,"m",f).call(this,e);for(let r of(this._emit("chunk",e,t),e.choices)){let e=t.choices[r.index];null!=r.delta.content&&e.message?.role==="assistant"&&e.message?.content&&(this._emit("content",r.delta.content,e.message.content),this._emit("content.delta",{delta:r.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=r.delta.refusal&&e.message?.role==="assistant"&&e.message?.refusal&&this._emit("refusal.delta",{delta:r.delta.refusal,snapshot:e.message.refusal}),r.logprobs?.content!=null&&e.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:r.logprobs?.content,snapshot:e.logprobs?.content??[]}),r.logprobs?.refusal!=null&&e.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:r.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});let i=m.__classPrivateFieldGet(this,n,"m",l).call(this,e);for(let t of(e.finish_reason&&(m.__classPrivateFieldGet(this,n,"m",d).call(this,e),null!=i.current_tool_call_index&&m.__classPrivateFieldGet(this,n,"m",c).call(this,e,i.current_tool_call_index)),r.delta.tool_calls??[]))i.current_tool_call_index!==t.index&&(m.__classPrivateFieldGet(this,n,"m",d).call(this,e),null!=i.current_tool_call_index&&m.__classPrivateFieldGet(this,n,"m",c).call(this,e,i.current_tool_call_index)),i.current_tool_call_index=t.index;for(let t of r.delta.tool_calls??[]){let r=e.message.tool_calls?.[t.index];r?.type&&(r?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:r.function?.name,index:t.index,arguments:r.function.arguments,parsed_arguments:r.function.parsed_arguments,arguments_delta:t.function?.arguments??""}):S(r?.type))}}},c=function(e,t){if(m.__classPrivateFieldGet(this,n,"m",l).call(this,e).done_tool_calls.has(t))return;let r=e.message.tool_calls?.[t];if(!r)throw Error("no tool call snapshot");if(!r.type)throw Error("tool call snapshot missing `type`");if("function"===r.type){let e=m.__classPrivateFieldGet(this,i,"f")?.tools?.find(e=>(0,b.isChatCompletionFunctionTool)(e)&&e.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:t,arguments:r.function.arguments,parsed_arguments:(0,b.isAutoParsableTool)(e)?e.$parseRaw(r.function.arguments):e?.function.strict?JSON.parse(r.function.arguments):null})}else S(r.type)},d=function(e){let t=m.__classPrivateFieldGet(this,n,"m",l).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;let r=m.__classPrivateFieldGet(this,n,"m",h).call(this);this._emit("content.done",{content:e.message.content,parsed:r?r.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},p=function(){if(this.ended)throw new y.OpenAIError("stream has ended, this shouldn't happen");let e=m.__classPrivateFieldGet(this,s,"f");if(!e)throw new y.OpenAIError("request ended without sending any chunks");return m.__classPrivateFieldSet(this,s,void 0,"f"),m.__classPrivateFieldSet(this,a,[],"f"),function(e,t){let{id:r,choices:n,created:i,model:a,system_fingerprint:s,...o}=e,l={...o,id:r,choices:n.map(({message:t,finish_reason:r,index:n,logprobs:i,...a})=>{if(!r)throw new y.OpenAIError(`missing finish_reason for choice ${n}`);let{content:s=null,function_call:o,tool_calls:l,...u}=t,c=t.role;if(!c)throw new y.OpenAIError(`missing role for choice ${n}`);if(o){let{arguments:e,name:l}=o;if(null==e)throw new y.OpenAIError(`missing function_call.arguments for choice ${n}`);if(!l)throw new y.OpenAIError(`missing function_call.name for choice ${n}`);return{...a,message:{content:s,function_call:{arguments:e,name:l},role:c,refusal:t.refusal??null},finish_reason:r,index:n,logprobs:i}}return l?{...a,index:n,finish_reason:r,logprobs:i,message:{...u,role:c,content:s,refusal:t.refusal??null,tool_calls:l.map((t,r)=>{let{function:i,type:a,id:s,...o}=t,{arguments:l,name:u,...c}=i||{};if(null==s)throw new y.OpenAIError(`missing choices[${n}].tool_calls[${r}].id
${O(e)}`);if(null==a)throw new y.OpenAIError(`missing choices[${n}].tool_calls[${r}].type
${O(e)}`);if(null==u)throw new y.OpenAIError(`missing choices[${n}].tool_calls[${r}].function.name
${O(e)}`);if(null==l)throw new y.OpenAIError(`missing choices[${n}].tool_calls[${r}].function.arguments
${O(e)}`);return{...o,id:s,type:a,function:{...c,name:u,arguments:l}}})}}:{...a,message:{...u,content:s,role:c,refusal:t.refusal??null},finish_reason:r,index:n,logprobs:i}}),created:i,model:a,object:"chat.completion",...s?{system_fingerprint:s}:{}};return(0,b.maybeParseChatCompletion)(l,t)}(e,m.__classPrivateFieldGet(this,i,"f"))},h=function(){let e=m.__classPrivateFieldGet(this,i,"f")?.response_format;return(0,b.isAutoParsableResponseFormat)(e)?e:null},f=function(e){var t,r,a,o;let l=m.__classPrivateFieldGet(this,s,"f"),{choices:u,...c}=e;for(let{delta:u,finish_reason:d,index:p,logprobs:f=null,..._}of(l?Object.assign(l,c):l=m.__classPrivateFieldSet(this,s,{...c,choices:[]},"f"),e.choices)){let e=l.choices[p];if(e||(e=l.choices[p]={finish_reason:d,index:p,message:{},logprobs:f,..._}),f)if(e.logprobs){let{content:n,refusal:i,...a}=f;P(a),Object.assign(e.logprobs,a),n&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...n)),i&&((r=e.logprobs).refusal??(r.refusal=[]),e.logprobs.refusal.push(...i))}else e.logprobs=Object.assign({},f);if(d&&(e.finish_reason=d,m.__classPrivateFieldGet(this,i,"f")&&(0,b.hasAutoParseableInput)(m.__classPrivateFieldGet(this,i,"f")))){if("length"===d)throw new y.LengthFinishReasonError;if("content_filter"===d)throw new y.ContentFilterFinishReasonError}if(Object.assign(e,_),!u)continue;let{content:s,refusal:c,function_call:v,role:w,tool_calls:O,...S}=u;if(P(S),Object.assign(e.message,S),c&&(e.message.refusal=(e.message.refusal||"")+c),w&&(e.message.role=w),v&&(e.message.function_call?(v.name&&(e.message.function_call.name=v.name),v.arguments&&((a=e.message.function_call).arguments??(a.arguments=""),e.message.function_call.arguments+=v.arguments)):e.message.function_call=v),s&&(e.message.content=(e.message.content||"")+s,!e.message.refusal&&m.__classPrivateFieldGet(this,n,"m",h).call(this)&&(e.message.parsed=(0,g.partialParse)(e.message.content))),O)for(let{index:t,id:r,type:n,function:a,...s}of(e.message.tool_calls||(e.message.tool_calls=[]),O)){let l=(o=e.message.tool_calls)[t]??(o[t]={});Object.assign(l,s),r&&(l.id=r),n&&(l.type=n),a&&(l.function??(l.function={name:a.name??"",arguments:""})),a?.name&&(l.function.name=a.name),a?.arguments&&(l.function.arguments+=a.arguments,(0,b.shouldParseToolCall)(m.__classPrivateFieldGet(this,i,"f"),l)&&(l.function.parsed_arguments=(0,g.partialParse)(l.function.arguments)))}}return l},Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("chunk",r=>{let n=t.shift();n?n.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),this.on("error",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new _.Stream(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function O(e){return JSON.stringify(e)}function P(e){}function S(e){}r.ChatCompletionStream=w},46704,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChatCompletionStreamingRunner=void 0;let n=e.r(46386);class i extends n.ChatCompletionStream{static fromReadableStream(e){let t=new i(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,r){let n=new i(t),a={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,a)),n}}r.ChatCompletionStreamingRunner=i},31392,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChatCompletionRunner=r.ChatCompletionStream=r.ParsingToolFunction=r.ChatCompletionStreamingRunner=r.Completions=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(36239)),s=e.r(36239),o=e.r(3830),l=e.r(32943),u=e.r(78051),c=e.r(46704),d=e.r(46386),p=e.r(26636);class h extends i.APIResource{constructor(){super(...arguments),this.messages=new a.Messages(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get((0,l.path)`/chat/completions/${e}`,t)}update(e,t,r){return this._client.post((0,l.path)`/chat/completions/${e}`,{body:t,...r})}list(e={},t){return this._client.getAPIList("/chat/completions",o.CursorPage,{query:e,...t})}delete(e,t){return this._client.delete((0,l.path)`/chat/completions/${e}`,t)}parse(e,t){return(0,p.validateInputTools)(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(t=>(0,p.parseChatCompletion)(t,e))}runTools(e,t){return e.stream?c.ChatCompletionStreamingRunner.runTools(this._client,e,t):u.ChatCompletionRunner.runTools(this._client,e,t)}stream(e,t){return d.ChatCompletionStream.createChatCompletion(this._client,e,t)}}r.Completions=h;var f=e.r(46704);Object.defineProperty(r,"ChatCompletionStreamingRunner",{enumerable:!0,get:function(){return f.ChatCompletionStreamingRunner}});var m=e.r(43443);Object.defineProperty(r,"ParsingToolFunction",{enumerable:!0,get:function(){return m.ParsingToolFunction}});var g=e.r(46386);Object.defineProperty(r,"ChatCompletionStream",{enumerable:!0,get:function(){return g.ChatCompletionStream}});var y=e.r(78051);Object.defineProperty(r,"ChatCompletionRunner",{enumerable:!0,get:function(){return y.ChatCompletionRunner}}),h.Messages=s.Messages},93685,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Chat=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(31392)),s=e.r(31392);class o extends i.APIResource{constructor(){super(...arguments),this.completions=new a.Completions(this._client)}}r.Chat=o,o.Completions=s.Completions},64634,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Messages=r.Completions=void 0;let n=e.r(99441);var i=e.r(31392);Object.defineProperty(r,"Completions",{enumerable:!0,get:function(){return i.Completions}}),n.__exportStar(e.r(31392),r);var a=e.r(36239);Object.defineProperty(r,"Messages",{enumerable:!0,get:function(){return a.Messages}})},56379,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Completions=r.Chat=void 0;var n=e.r(93685);Object.defineProperty(r,"Chat",{enumerable:!0,get:function(){return n.Chat}});var i=e.r(64634);Object.defineProperty(r,"Completions",{enumerable:!0,get:function(){return i.Completions}})},55362,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},23402,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isEmptyHeaders=r.buildHeaders=void 0;let n=e.r(14291),i=Symbol("brand.privateNullableHeaders");function*a(e){let t;if(!e)return;if(i in e){let{values:t,nulls:r}=e;for(let e of(yield*t.entries(),r))yield[e,null];return}let r=!1;for(let i of(e instanceof Headers?t=e.entries():(0,n.isReadonlyArray)(e)?t=e:(r=!0,t=Object.entries(e??{})),t)){let e=i[0];if("string"!=typeof e)throw TypeError("expected header name to be a string");let t=(0,n.isReadonlyArray)(i[1])?i[1]:[i[1]],a=!1;for(let n of t)void 0!==n&&(r&&!a&&(a=!0,yield[e,null]),yield[e,n])}}r.buildHeaders=e=>{let t=new Headers,r=new Set;for(let n of e){let e=new Set;for(let[i,s]of a(n)){let n=i.toLowerCase();e.has(n)||(t.delete(i),e.add(n)),null===s?(t.delete(i),r.add(n)):(t.append(i,s),r.delete(n))}}return{[i]:!0,values:t,nulls:r}},r.isEmptyHeaders=e=>{for(let t of a(e))return!1;return!0}},19778,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Speech=void 0;let n=e.r(78465),i=e.r(23402);class a extends n.APIResource{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:(0,i.buildHeaders)([{Accept:"application/octet-stream"},t?.headers]),__binaryResponse:!0})}}r.Speech=a},985,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Transcriptions=void 0;let n=e.r(78465),i=e.r(13256);class a extends n.APIResource{create(e,t){return this._client.post("/audio/transcriptions",(0,i.multipartFormRequestOptions)({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}r.Transcriptions=a},25968,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Translations=void 0;let n=e.r(78465),i=e.r(13256);class a extends n.APIResource{create(e,t){return this._client.post("/audio/translations",(0,i.multipartFormRequestOptions)({body:e,...t,__metadata:{model:e.model}},this._client))}}r.Translations=a},50479,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Audio=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(19778)),s=e.r(19778),o=n.__importStar(e.r(985)),l=e.r(985),u=n.__importStar(e.r(25968)),c=e.r(25968);class d extends i.APIResource{constructor(){super(...arguments),this.transcriptions=new o.Transcriptions(this._client),this.translations=new u.Translations(this._client),this.speech=new a.Speech(this._client)}}r.Audio=d,d.Transcriptions=l.Transcriptions,d.Translations=c.Translations,d.Speech=s.Speech},89274,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Batches=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(32943);class s extends n.APIResource{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get((0,a.path)`/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/batches",i.CursorPage,{query:e,...t})}cancel(e,t){return this._client.post((0,a.path)`/batches/${e}/cancel`,t)}}r.Batches=s},84159,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Assistants=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(23402),s=e.r(32943);class o extends n.APIResource{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get((0,s.path)`/assistants/${e}`,{...t,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,r){return this._client.post((0,s.path)`/assistants/${e}`,{body:t,...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e={},t){return this._client.getAPIList("/assistants",i.CursorPage,{query:e,...t,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete((0,s.path)`/assistants/${e}`,{...t,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}r.Assistants=o},29334,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Sessions=void 0;let n=e.r(78465),i=e.r(23402);class a extends n.APIResource{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:(0,i.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}r.Sessions=a},60587,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TranscriptionSessions=void 0;let n=e.r(78465),i=e.r(23402);class a extends n.APIResource{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:(0,i.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}r.TranscriptionSessions=a},82318,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Realtime=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(29334)),s=e.r(29334),o=n.__importStar(e.r(60587)),l=e.r(60587);class u extends i.APIResource{constructor(){super(...arguments),this.sessions=new a.Sessions(this._client),this.transcriptionSessions=new o.TranscriptionSessions(this._client)}}r.Realtime=u,u.Sessions=s.Sessions,u.TranscriptionSessions=l.TranscriptionSessions},38935,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Messages=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(23402),s=e.r(32943);class o extends n.APIResource{create(e,t,r){return this._client.post((0,s.path)`/threads/${e}/messages`,{body:t,...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,t,r){let{thread_id:n}=t;return this._client.get((0,s.path)`/threads/${n}/messages/${e}`,{...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,t,r){let{thread_id:n,...i}=t;return this._client.post((0,s.path)`/threads/${n}/messages/${e}`,{body:i,...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t={},r){return this._client.getAPIList((0,s.path)`/threads/${e}/messages`,i.CursorPage,{query:t,...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,t,r){let{thread_id:n}=t;return this._client.delete((0,s.path)`/threads/${n}/messages/${e}`,{...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}r.Messages=o},26035,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Steps=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(23402),s=e.r(32943);class o extends n.APIResource{retrieve(e,t,r){let{thread_id:n,run_id:i,...o}=t;return this._client.get((0,s.path)`/threads/${n}/runs/${i}/steps/${e}`,{query:o,...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t,r){let{thread_id:n,...o}=t;return this._client.getAPIList((0,s.path)`/threads/${n}/runs/${e}/steps`,i.CursorPage,{query:o,...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}r.Steps=o},46288,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toFloat32Array=r.fromBase64=r.toBase64=void 0;let n=e.r(93064),i=e.r(90780);r.toBase64=e=>{if(!e)return"";if(void 0!==globalThis.Buffer)return globalThis.Buffer.from(e).toString("base64");if("string"==typeof e&&(e=(0,i.encodeUTF8)(e)),"undefined"!=typeof btoa)return btoa(String.fromCharCode.apply(null,e));throw new n.OpenAIError("Cannot generate base64 string; Expected `Buffer` or `btoa` to be defined")},r.fromBase64=e=>{if(void 0!==globalThis.Buffer){let t=globalThis.Buffer.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}if("undefined"!=typeof atob){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}throw new n.OpenAIError("Cannot decode base64 string; Expected `Buffer` or `atob` to be defined")},r.toFloat32Array=e=>{if("undefined"!=typeof Buffer){let t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}{let t=atob(e),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);return Array.from(new Float32Array(n.buffer))}}},27773,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.readEnv=void 0,r.readEnv=e=>void 0!==globalThis.process?globalThis.process.env?.[e]?.trim()??void 0:void 0!==globalThis.Deno?globalThis.Deno.env?.get?.(e)?.trim():void 0},75008,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(99441);n.__exportStar(e.r(14291),r),n.__exportStar(e.r(46288),r),n.__exportStar(e.r(27773),r),n.__exportStar(e.r(49434),r),n.__exportStar(e.r(87978),r),n.__exportStar(e.r(32271),r)},44754,(e,t,r)=>{"use strict";var n,i,a,s,o,l,u,c,d,p,h,f,m,g,y,b,_,v,w,O,P,S,E;Object.defineProperty(r,"__esModule",{value:!0}),r.AssistantStream=void 0;let k=e.r(99441),I=e.r(40680),A=e.r(43163),T=e.r(56132),C=e.r(75008);class j extends T.EventStream{constructor(){super(...arguments),n.add(this),a.set(this,[]),s.set(this,{}),o.set(this,{}),l.set(this,void 0),u.set(this,void 0),c.set(this,void 0),d.set(this,void 0),p.set(this,void 0),h.set(this,void 0),f.set(this,void 0),m.set(this,void 0),g.set(this,void 0)}[(a=new WeakMap,s=new WeakMap,o=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakMap,d=new WeakMap,p=new WeakMap,h=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,n=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("event",r=>{let n=t.shift();n?n.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),this.on("error",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let t=new i;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){let r=t?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();let i=I.Stream.fromReadableStream(e,this.controller);for await(let e of i)k.__classPrivateFieldGet(this,n,"m",y).call(this,e);if(i.controller.signal?.aborted)throw new A.APIUserAbortError;return this._addRun(k.__classPrivateFieldGet(this,n,"m",b).call(this))}toReadableStream(){return new I.Stream(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,n){let a=new i;return a._run(()=>a._runToolAssistantStream(e,t,r,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,t,r,i){let a=i?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));let s={...r,stream:!0},o=await e.submitToolOutputs(t,s,{...i,signal:this.controller.signal});for await(let e of(this._connected(),o))k.__classPrivateFieldGet(this,n,"m",y).call(this,e);if(o.controller.signal?.aborted)throw new A.APIUserAbortError;return this._addRun(k.__classPrivateFieldGet(this,n,"m",b).call(this))}static createThreadAssistantStream(e,t,r){let n=new i;return n._run(()=>n._threadAssistantStream(e,t,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),n}static createAssistantStream(e,t,r,n){let a=new i;return a._run(()=>a._runAssistantStream(e,t,r,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return k.__classPrivateFieldGet(this,f,"f")}currentRun(){return k.__classPrivateFieldGet(this,m,"f")}currentMessageSnapshot(){return k.__classPrivateFieldGet(this,l,"f")}currentRunStepSnapshot(){return k.__classPrivateFieldGet(this,g,"f")}async finalRunSteps(){return await this.done(),Object.values(k.__classPrivateFieldGet(this,s,"f"))}async finalMessages(){return await this.done(),Object.values(k.__classPrivateFieldGet(this,o,"f"))}async finalRun(){if(await this.done(),!k.__classPrivateFieldGet(this,u,"f"))throw Error("Final run was not received.");return k.__classPrivateFieldGet(this,u,"f")}async _createThreadAssistantStream(e,t,r){let i=r?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));let a={...t,stream:!0},s=await e.createAndRun(a,{...r,signal:this.controller.signal});for await(let e of(this._connected(),s))k.__classPrivateFieldGet(this,n,"m",y).call(this,e);if(s.controller.signal?.aborted)throw new A.APIUserAbortError;return this._addRun(k.__classPrivateFieldGet(this,n,"m",b).call(this))}async _createAssistantStream(e,t,r,i){let a=i?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));let s={...r,stream:!0},o=await e.create(t,s,{...i,signal:this.controller.signal});for await(let e of(this._connected(),o))k.__classPrivateFieldGet(this,n,"m",y).call(this,e);if(o.controller.signal?.aborted)throw new A.APIUserAbortError;return this._addRun(k.__classPrivateFieldGet(this,n,"m",b).call(this))}static accumulateDelta(e,t){for(let[r,n]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=n;continue}let t=e[r];if(null==t||"index"===r||"type"===r){e[r]=n;continue}if("string"==typeof t&&"string"==typeof n)t+=n;else if("number"==typeof t&&"number"==typeof n)t+=n;else if((0,C.isObj)(t)&&(0,C.isObj)(n))t=this.accumulateDelta(t,n);else if(Array.isArray(t)&&Array.isArray(n)){if(t.every(e=>"string"==typeof e||"number"==typeof e)){t.push(...n);continue}for(let e of n){if(!(0,C.isObj)(e))throw Error(`Expected array delta entry to be an object but got: ${e}`);let r=e.index;if(null==r)throw console.error(e),Error("Expected array delta entry to have an `index` property");if("number"!=typeof r)throw Error(`Expected array delta entry \`index\` property to be a number but got ${r}`);let n=t[r];null==n?t.push(e):t[r]=this.accumulateDelta(n,e)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${n}, accValue: ${t}`);e[r]=t}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,n){return await this._createAssistantStream(t,e,r,n)}async _runToolAssistantStream(e,t,r,n){return await this._createToolAssistantStream(t,e,r,n)}}r.AssistantStream=j,i=j,y=function(e){if(!this.ended)switch(k.__classPrivateFieldSet(this,f,e,"f"),k.__classPrivateFieldGet(this,n,"m",w).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":k.__classPrivateFieldGet(this,n,"m",E).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":k.__classPrivateFieldGet(this,n,"m",v).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":k.__classPrivateFieldGet(this,n,"m",_).call(this,e);break;case"error":throw Error("Encountered an error event in event processing - errors should be processed earlier")}},b=function(){if(this.ended)throw new A.OpenAIError("stream has ended, this shouldn't happen");if(!k.__classPrivateFieldGet(this,u,"f"))throw Error("Final run has not been received");return k.__classPrivateFieldGet(this,u,"f")},_=function(e){let[t,r]=k.__classPrivateFieldGet(this,n,"m",P).call(this,e,k.__classPrivateFieldGet(this,l,"f"));for(let e of(k.__classPrivateFieldSet(this,l,t,"f"),k.__classPrivateFieldGet(this,o,"f")[t.id]=t,r)){let r=t.content[e.index];r?.type=="text"&&this._emit("textCreated",r.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let r of e.data.delta.content){if("text"==r.type&&r.text){let e=r.text,n=t.content[r.index];if(n&&"text"==n.type)this._emit("textDelta",e,n.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=k.__classPrivateFieldGet(this,c,"f")){if(k.__classPrivateFieldGet(this,d,"f"))switch(k.__classPrivateFieldGet(this,d,"f").type){case"text":this._emit("textDone",k.__classPrivateFieldGet(this,d,"f").text,k.__classPrivateFieldGet(this,l,"f"));break;case"image_file":this._emit("imageFileDone",k.__classPrivateFieldGet(this,d,"f").image_file,k.__classPrivateFieldGet(this,l,"f"))}k.__classPrivateFieldSet(this,c,r.index,"f")}k.__classPrivateFieldSet(this,d,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==k.__classPrivateFieldGet(this,c,"f")){let t=e.data.content[k.__classPrivateFieldGet(this,c,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,k.__classPrivateFieldGet(this,l,"f"));break;case"text":this._emit("textDone",t.text,k.__classPrivateFieldGet(this,l,"f"))}}k.__classPrivateFieldGet(this,l,"f")&&this._emit("messageDone",e.data),k.__classPrivateFieldSet(this,l,void 0,"f")}},v=function(e){let t=k.__classPrivateFieldGet(this,n,"m",O).call(this,e);switch(k.__classPrivateFieldSet(this,g,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let r=e.data.delta;if(r.step_details&&"tool_calls"==r.step_details.type&&r.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(let e of r.step_details.tool_calls)e.index==k.__classPrivateFieldGet(this,p,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(k.__classPrivateFieldGet(this,h,"f")&&this._emit("toolCallDone",k.__classPrivateFieldGet(this,h,"f")),k.__classPrivateFieldSet(this,p,e.index,"f"),k.__classPrivateFieldSet(this,h,t.step_details.tool_calls[e.index],"f"),k.__classPrivateFieldGet(this,h,"f")&&this._emit("toolCallCreated",k.__classPrivateFieldGet(this,h,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":k.__classPrivateFieldSet(this,g,void 0,"f"),"tool_calls"==e.data.step_details.type&&k.__classPrivateFieldGet(this,h,"f")&&(this._emit("toolCallDone",k.__classPrivateFieldGet(this,h,"f")),k.__classPrivateFieldSet(this,h,void 0,"f")),this._emit("runStepDone",e.data,t)}},w=function(e){k.__classPrivateFieldGet(this,a,"f").push(e),this._emit("event",e)},O=function(e){switch(e.event){case"thread.run.step.created":return k.__classPrivateFieldGet(this,s,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=k.__classPrivateFieldGet(this,s,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){let n=i.accumulateDelta(t,r.delta);k.__classPrivateFieldGet(this,s,"f")[e.data.id]=n}return k.__classPrivateFieldGet(this,s,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":k.__classPrivateFieldGet(this,s,"f")[e.data.id]=e.data}if(k.__classPrivateFieldGet(this,s,"f")[e.data.id])return k.__classPrivateFieldGet(this,s,"f")[e.data.id];throw Error("No snapshot available")},P=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let i=e.data;if(i.delta.content)for(let e of i.delta.content)if(e.index in t.content){let r=t.content[e.index];t.content[e.index]=k.__classPrivateFieldGet(this,n,"m",S).call(this,e,r)}else t.content[e.index]=e,r.push(e);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},S=function(e,t){return i.accumulateDelta(t,e)},E=function(e){switch(k.__classPrivateFieldSet(this,m,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":k.__classPrivateFieldSet(this,u,e.data,"f"),k.__classPrivateFieldGet(this,h,"f")&&(this._emit("toolCallDone",k.__classPrivateFieldGet(this,h,"f")),k.__classPrivateFieldSet(this,h,void 0,"f"))}}},18068,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Runs=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(26035)),s=e.r(26035),o=e.r(3830),l=e.r(23402),u=e.r(44754),c=e.r(32271),d=e.r(32943);class p extends i.APIResource{constructor(){super(...arguments),this.steps=new a.Steps(this._client)}create(e,t,r){let{include:n,...i}=t;return this._client.post((0,d.path)`/threads/${e}/runs`,{query:{include:n},body:i,...r,headers:(0,l.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers]),stream:t.stream??!1})}retrieve(e,t,r){let{thread_id:n}=t;return this._client.get((0,d.path)`/threads/${n}/runs/${e}`,{...r,headers:(0,l.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,t,r){let{thread_id:n,...i}=t;return this._client.post((0,d.path)`/threads/${n}/runs/${e}`,{body:i,...r,headers:(0,l.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t={},r){return this._client.getAPIList((0,d.path)`/threads/${e}/runs`,o.CursorPage,{query:t,...r,headers:(0,l.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}cancel(e,t,r){let{thread_id:n}=t;return this._client.post((0,d.path)`/threads/${n}/runs/${e}/cancel`,{...r,headers:(0,l.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,t,r){let n=await this.create(e,t,r);return await this.poll(n.id,{thread_id:e},r)}createAndStream(e,t,r){return u.AssistantStream.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){let n=(0,l.buildHeaders)([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:i,response:a}=await this.retrieve(e,t,{...r,headers:{...r?.headers,...n}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let s=5e3;if(r?.pollIntervalMs)s=r.pollIntervalMs;else{let e=a.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(s=t)}}await (0,c.sleep)(s);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,r){return u.AssistantStream.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r){let{thread_id:n,...i}=t;return this._client.post((0,d.path)`/threads/${n}/runs/${e}/submit_tool_outputs`,{body:i,...r,headers:(0,l.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers]),stream:t.stream??!1})}async submitToolOutputsAndPoll(e,t,r){let n=await this.submitToolOutputs(e,t,r);return await this.poll(n.id,t,r)}submitToolOutputsStream(e,t,r){return u.AssistantStream.createToolAssistantStream(e,this._client.beta.threads.runs,t,r)}}r.Runs=p,p.Steps=s.Steps},12597,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Threads=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(38935)),s=e.r(38935),o=n.__importStar(e.r(18068)),l=e.r(18068),u=e.r(23402),c=e.r(44754),d=e.r(32943);class p extends i.APIResource{constructor(){super(...arguments),this.runs=new o.Runs(this._client),this.messages=new a.Messages(this._client)}create(e={},t){return this._client.post("/threads",{body:e,...t,headers:(0,u.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get((0,d.path)`/threads/${e}`,{...t,headers:(0,u.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,r){return this._client.post((0,d.path)`/threads/${e}`,{body:t,...r,headers:(0,u.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,t){return this._client.delete((0,d.path)`/threads/${e}`,{...t,headers:(0,u.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:(0,u.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers]),stream:e.stream??!1})}async createAndRunPoll(e,t){let r=await this.createAndRun(e,t);return await this.runs.poll(r.id,{thread_id:r.thread_id},t)}createAndRunStream(e,t){return c.AssistantStream.createThreadAssistantStream(e,this._client.beta.threads,t)}}r.Threads=p,p.Runs=l.Runs,p.Messages=s.Messages},29912,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Beta=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(84159)),s=e.r(84159),o=n.__importStar(e.r(82318)),l=e.r(82318),u=n.__importStar(e.r(12597)),c=e.r(12597);class d extends i.APIResource{constructor(){super(...arguments),this.realtime=new o.Realtime(this._client),this.assistants=new a.Assistants(this._client),this.threads=new u.Threads(this._client)}}r.Beta=d,d.Realtime=l.Realtime,d.Assistants=s.Assistants,d.Threads=c.Threads},90825,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Completions=void 0;let n=e.r(78465);class i extends n.APIResource{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}r.Completions=i},45457,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Content=void 0;let n=e.r(78465),i=e.r(23402),a=e.r(32943);class s extends n.APIResource{retrieve(e,t,r){let{container_id:n}=t;return this._client.get((0,a.path)`/containers/${n}/files/${e}/content`,{...r,headers:(0,i.buildHeaders)([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0})}}r.Content=s},66740,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Files=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(45457)),s=e.r(45457),o=e.r(3830),l=e.r(23402),u=e.r(13256),c=e.r(32943);class d extends i.APIResource{constructor(){super(...arguments),this.content=new a.Content(this._client)}create(e,t,r){return this._client.post((0,c.path)`/containers/${e}/files`,(0,u.multipartFormRequestOptions)({body:t,...r},this._client))}retrieve(e,t,r){let{container_id:n}=t;return this._client.get((0,c.path)`/containers/${n}/files/${e}`,r)}list(e,t={},r){return this._client.getAPIList((0,c.path)`/containers/${e}/files`,o.CursorPage,{query:t,...r})}delete(e,t,r){let{container_id:n}=t;return this._client.delete((0,c.path)`/containers/${n}/files/${e}`,{...r,headers:(0,l.buildHeaders)([{Accept:"*/*"},r?.headers])})}}r.Files=d,d.Content=s.Content},62577,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Containers=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(66740)),s=e.r(66740),o=e.r(3830),l=e.r(23402),u=e.r(32943);class c extends i.APIResource{constructor(){super(...arguments),this.files=new a.Files(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get((0,u.path)`/containers/${e}`,t)}list(e={},t){return this._client.getAPIList("/containers",o.CursorPage,{query:e,...t})}delete(e,t){return this._client.delete((0,u.path)`/containers/${e}`,{...t,headers:(0,l.buildHeaders)([{Accept:"*/*"},t?.headers])})}}r.Containers=c,c.Files=s.Files},3593,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Embeddings=void 0;let n=e.r(78465),i=e.r(75008);class a extends n.APIResource{create(e,t){let r=!!e.encoding_format,n=r?e.encoding_format:"base64";r&&(0,i.loggerFor)(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);let a=this._client.post("/embeddings",{body:{...e,encoding_format:n},...t});return r?a:((0,i.loggerFor)(this._client).debug("embeddings/decoding base64 embeddings from base64"),a._thenUnwrap(e=>(e&&e.data&&e.data.forEach(e=>{let t=e.embedding;e.embedding=(0,i.toFloat32Array)(t)}),e)))}}r.Embeddings=a},48559,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.OutputItems=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(32943);class s extends n.APIResource{retrieve(e,t,r){let{eval_id:n,run_id:i}=t;return this._client.get((0,a.path)`/evals/${n}/runs/${i}/output_items/${e}`,r)}list(e,t,r){let{eval_id:n,...s}=t;return this._client.getAPIList((0,a.path)`/evals/${n}/runs/${e}/output_items`,i.CursorPage,{query:s,...r})}}r.OutputItems=s},83250,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Runs=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(48559)),s=e.r(48559),o=e.r(3830),l=e.r(32943);class u extends i.APIResource{constructor(){super(...arguments),this.outputItems=new a.OutputItems(this._client)}create(e,t,r){return this._client.post((0,l.path)`/evals/${e}/runs`,{body:t,...r})}retrieve(e,t,r){let{eval_id:n}=t;return this._client.get((0,l.path)`/evals/${n}/runs/${e}`,r)}list(e,t={},r){return this._client.getAPIList((0,l.path)`/evals/${e}/runs`,o.CursorPage,{query:t,...r})}delete(e,t,r){let{eval_id:n}=t;return this._client.delete((0,l.path)`/evals/${n}/runs/${e}`,r)}cancel(e,t,r){let{eval_id:n}=t;return this._client.post((0,l.path)`/evals/${n}/runs/${e}`,r)}}r.Runs=u,u.OutputItems=s.OutputItems},5531,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Evals=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(83250)),s=e.r(83250),o=e.r(3830),l=e.r(32943);class u extends i.APIResource{constructor(){super(...arguments),this.runs=new a.Runs(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get((0,l.path)`/evals/${e}`,t)}update(e,t,r){return this._client.post((0,l.path)`/evals/${e}`,{body:t,...r})}list(e={},t){return this._client.getAPIList("/evals",o.CursorPage,{query:e,...t})}delete(e,t){return this._client.delete((0,l.path)`/evals/${e}`,t)}}r.Evals=u,u.Runs=s.Runs},58549,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Files=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(23402),s=e.r(32271),o=e.r(43163),l=e.r(13256),u=e.r(32943);class c extends n.APIResource{create(e,t){return this._client.post("/files",(0,l.multipartFormRequestOptions)({body:e,...t},this._client))}retrieve(e,t){return this._client.get((0,u.path)`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",i.CursorPage,{query:e,...t})}delete(e,t){return this._client.delete((0,u.path)`/files/${e}`,t)}content(e,t){return this._client.get((0,u.path)`/files/${e}/content`,{...t,headers:(0,a.buildHeaders)([{Accept:"application/binary"},t?.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=18e5}={}){let n=new Set(["processed","error","deleted"]),i=Date.now(),a=await this.retrieve(e);for(;!a.status||!n.has(a.status);)if(await (0,s.sleep)(t),a=await this.retrieve(e),Date.now()-i>r)throw new o.APIConnectionTimeoutError({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return a}}r.Files=c},68767,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Methods=void 0;let n=e.r(78465);class i extends n.APIResource{}r.Methods=i},85621,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Graders=void 0;let n=e.r(78465);class i extends n.APIResource{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}}r.Graders=i},92757,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Alpha=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(85621)),s=e.r(85621);class o extends i.APIResource{constructor(){super(...arguments),this.graders=new a.Graders(this._client)}}r.Alpha=o,o.Graders=s.Graders},25297,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Permissions=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(32943);class s extends n.APIResource{create(e,t,r){return this._client.getAPIList((0,a.path)`/fine_tuning/checkpoints/${e}/permissions`,i.Page,{body:t,method:"post",...r})}retrieve(e,t={},r){return this._client.get((0,a.path)`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...r})}delete(e,t,r){let{fine_tuned_model_checkpoint:n}=t;return this._client.delete((0,a.path)`/fine_tuning/checkpoints/${n}/permissions/${e}`,r)}}r.Permissions=s},13122,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Checkpoints=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(25297)),s=e.r(25297);class o extends i.APIResource{constructor(){super(...arguments),this.permissions=new a.Permissions(this._client)}}r.Checkpoints=o,o.Permissions=s.Permissions},86201,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Checkpoints=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(32943);class s extends n.APIResource{list(e,t={},r){return this._client.getAPIList((0,a.path)`/fine_tuning/jobs/${e}/checkpoints`,i.CursorPage,{query:t,...r})}}r.Checkpoints=s},52382,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Jobs=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(86201)),s=e.r(86201),o=e.r(3830),l=e.r(32943);class u extends i.APIResource{constructor(){super(...arguments),this.checkpoints=new a.Checkpoints(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get((0,l.path)`/fine_tuning/jobs/${e}`,t)}list(e={},t){return this._client.getAPIList("/fine_tuning/jobs",o.CursorPage,{query:e,...t})}cancel(e,t){return this._client.post((0,l.path)`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return this._client.getAPIList((0,l.path)`/fine_tuning/jobs/${e}/events`,o.CursorPage,{query:t,...r})}pause(e,t){return this._client.post((0,l.path)`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post((0,l.path)`/fine_tuning/jobs/${e}/resume`,t)}}r.Jobs=u,u.Checkpoints=s.Checkpoints},59472,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FineTuning=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(68767)),s=e.r(68767),o=n.__importStar(e.r(92757)),l=e.r(92757),u=n.__importStar(e.r(13122)),c=e.r(13122),d=n.__importStar(e.r(52382)),p=e.r(52382);class h extends i.APIResource{constructor(){super(...arguments),this.methods=new a.Methods(this._client),this.jobs=new d.Jobs(this._client),this.checkpoints=new u.Checkpoints(this._client),this.alpha=new o.Alpha(this._client)}}r.FineTuning=h,h.Methods=s.Methods,h.Jobs=p.Jobs,h.Checkpoints=c.Checkpoints,h.Alpha=l.Alpha},18648,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GraderModels=void 0;let n=e.r(78465);class i extends n.APIResource{}r.GraderModels=i},36575,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Graders=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(18648)),s=e.r(18648);class o extends i.APIResource{constructor(){super(...arguments),this.graderModels=new a.GraderModels(this._client)}}r.Graders=o,o.GraderModels=s.GraderModels},8869,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Images=void 0;let n=e.r(78465),i=e.r(13256);class a extends n.APIResource{createVariation(e,t){return this._client.post("/images/variations",(0,i.multipartFormRequestOptions)({body:e,...t},this._client))}edit(e,t){return this._client.post("/images/edits",(0,i.multipartFormRequestOptions)({body:e,...t,stream:e.stream??!1},this._client))}generate(e,t){return this._client.post("/images/generations",{body:e,...t,stream:e.stream??!1})}}r.Images=a},94709,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Models=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(32943);class s extends n.APIResource{retrieve(e,t){return this._client.get((0,a.path)`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",i.Page,e)}delete(e,t){return this._client.delete((0,a.path)`/models/${e}`,t)}}r.Models=s},78321,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Moderations=void 0;let n=e.r(78465);class i extends n.APIResource{create(e,t){return this._client.post("/moderations",{body:e,...t})}}r.Moderations=i},4368,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.maybeParseResponse=function(e,t){return t&&s(t)?a(e,t):{...e,output_parsed:null,output:e.output.map(e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map(e=>({...e,parsed:null}))}:e)}},r.parseResponse=a,r.hasAutoParseableInput=s,r.makeParseableResponseTool=function(e,{parser:t,callback:r}){let n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:r,enumerable:!1}}),n},r.isAutoParsableTool=o,r.shouldParseToolCall=function(e,t){if(!e)return!1;let r=l(e.tools??[],t.name);return o(r)||r?.strict||!1},r.validateInputTools=function(e){for(let t of e??[]){if("function"!==t.type)throw new n.OpenAIError(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new n.OpenAIError(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}},r.addOutputText=u;let n=e.r(43163),i=e.r(26636);function a(e,t){let r=e.output.map(e=>{if("function_call"===e.type)return{...e,parsed_arguments:function(e,t){let r=l(e.tools??[],t.name);return{...t,...t,parsed_arguments:o(r)?r.$parseRaw(t.arguments):r?.strict?JSON.parse(t.arguments):null}}(t,e)};if("message"===e.type){let r=e.content.map(e=>{var r,n;return"output_text"===e.type?{...e,parsed:(r=t,n=e.text,r.text?.format?.type!=="json_schema"?null:"$parseRaw"in r.text?.format?(r.text?.format).$parseRaw(n):JSON.parse(n))}:e});return{...e,content:r}}return e}),n=Object.assign({},e,{output:r});return Object.getOwnPropertyDescriptor(e,"output_text")||u(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(let e of n.output)if("message"===e.type){for(let t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed}return null}}),n}function s(e){return!!(0,i.isAutoParsableResponseFormat)(e.text?.format)}function o(e){return e?.$brand==="auto-parseable-tool"}function l(e,t){return e.find(e=>"function"===e.type&&e.name===t)}function u(e){let t=[];for(let r of e.output)if("message"===r.type)for(let e of r.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}},93571,(e,t,r)=>{"use strict";var n,i,a,s,o,l,u,c;Object.defineProperty(r,"__esModule",{value:!0}),r.ResponseStream=void 0;let d=e.r(99441),p=e.r(43163),h=e.r(56132),f=e.r(4368);class m extends h.EventStream{constructor(e){super(),n.add(this),i.set(this,void 0),a.set(this,void 0),s.set(this,void 0),d.__classPrivateFieldSet(this,i,e,"f")}static createResponse(e,t,r){let n=new m(t);return n._run(()=>n._createOrRetrieveResponse(e,t,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createOrRetrieveResponse(e,t,r){let i,a=r?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),d.__classPrivateFieldGet(this,n,"m",o).call(this);let s=null;for await(let a of("response_id"in t?(i=await e.responses.retrieve(t.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),s=t.starting_after??null):i=await e.responses.create({...t,stream:!0},{...r,signal:this.controller.signal}),this._connected(),i))d.__classPrivateFieldGet(this,n,"m",l).call(this,a,s);if(i.controller.signal?.aborted)throw new p.APIUserAbortError;return d.__classPrivateFieldGet(this,n,"m",u).call(this)}[(i=new WeakMap,a=new WeakMap,s=new WeakMap,n=new WeakSet,o=function(){this.ended||d.__classPrivateFieldSet(this,a,void 0,"f")},l=function(e,t){if(this.ended)return;let r=(e,r)=>{(null==t||r.sequence_number>t)&&this._emit(e,r)},i=d.__classPrivateFieldGet(this,n,"m",c).call(this,e);switch(r("event",e),e.type){case"response.output_text.delta":{let t=i.output[e.output_index];if(!t)throw new p.OpenAIError(`missing output at index ${e.output_index}`);if("message"===t.type){let n=t.content[e.content_index];if(!n)throw new p.OpenAIError(`missing content at index ${e.content_index}`);if("output_text"!==n.type)throw new p.OpenAIError(`expected content to be 'output_text', got ${n.type}`);r("response.output_text.delta",{...e,snapshot:n.text})}break}case"response.function_call_arguments.delta":{let t=i.output[e.output_index];if(!t)throw new p.OpenAIError(`missing output at index ${e.output_index}`);"function_call"===t.type&&r("response.function_call_arguments.delta",{...e,snapshot:t.arguments});break}default:r(e.type,e)}},u=function(){var e,t;if(this.ended)throw new p.OpenAIError("stream has ended, this shouldn't happen");let r=d.__classPrivateFieldGet(this,a,"f");if(!r)throw new p.OpenAIError("request ended without sending any events");d.__classPrivateFieldSet(this,a,void 0,"f");let n=(e=r,t=d.__classPrivateFieldGet(this,i,"f"),(0,f.maybeParseResponse)(e,t));return d.__classPrivateFieldSet(this,s,n,"f"),n},c=function(e){let t=d.__classPrivateFieldGet(this,a,"f");if(!t){if("response.created"!==e.type)throw new p.OpenAIError(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return d.__classPrivateFieldSet(this,a,e.response,"f")}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{let r=t.output[e.output_index];if(!r)throw new p.OpenAIError(`missing output at index ${e.output_index}`);"message"===r.type&&r.content.push(e.part);break}case"response.output_text.delta":{let r=t.output[e.output_index];if(!r)throw new p.OpenAIError(`missing output at index ${e.output_index}`);if("message"===r.type){let t=r.content[e.content_index];if(!t)throw new p.OpenAIError(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new p.OpenAIError(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{let r=t.output[e.output_index];if(!r)throw new p.OpenAIError(`missing output at index ${e.output_index}`);"function_call"===r.type&&(r.arguments+=e.delta);break}case"response.completed":d.__classPrivateFieldSet(this,a,e.response,"f")}return t},Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("event",r=>{let n=t.shift();n?n.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),this.on("error",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();let e=d.__classPrivateFieldGet(this,s,"f");if(!e)throw new p.OpenAIError("stream ended without producing a ChatCompletion");return e}}r.ResponseStream=m},75588,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InputItems=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(32943);class s extends n.APIResource{list(e,t={},r){return this._client.getAPIList((0,a.path)`/responses/${e}/input_items`,i.CursorPage,{query:t,...r})}}r.InputItems=s},2198,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Responses=void 0;let n=e.r(99441),i=e.r(4368),a=e.r(93571),s=e.r(78465),o=n.__importStar(e.r(75588)),l=e.r(75588),u=e.r(23402),c=e.r(32943);class d extends s.APIResource{constructor(){super(...arguments),this.inputItems=new o.InputItems(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(e=>("object"in e&&"response"===e.object&&(0,i.addOutputText)(e),e))}retrieve(e,t={},r){return this._client.get((0,c.path)`/responses/${e}`,{query:t,...r,stream:t?.stream??!1})._thenUnwrap(e=>("object"in e&&"response"===e.object&&(0,i.addOutputText)(e),e))}delete(e,t){return this._client.delete((0,c.path)`/responses/${e}`,{...t,headers:(0,u.buildHeaders)([{Accept:"*/*"},t?.headers])})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(t=>(0,i.parseResponse)(t,e))}stream(e,t){return a.ResponseStream.createResponse(this._client,e,t)}cancel(e,t){return this._client.post((0,c.path)`/responses/${e}/cancel`,t)}}r.Responses=d,d.InputItems=l.InputItems},93617,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Parts=void 0;let n=e.r(78465),i=e.r(13256),a=e.r(32943);class s extends n.APIResource{create(e,t,r){return this._client.post((0,a.path)`/uploads/${e}/parts`,(0,i.multipartFormRequestOptions)({body:t,...r},this._client))}}r.Parts=s},41516,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Uploads=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(93617)),s=e.r(93617),o=e.r(32943);class l extends i.APIResource{constructor(){super(...arguments),this.parts=new a.Parts(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post((0,o.path)`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post((0,o.path)`/uploads/${e}/complete`,{body:t,...r})}}r.Uploads=l,l.Parts=s.Parts},36195,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.allSettledWithThrow=void 0,r.allSettledWithThrow=async e=>{let t=await Promise.allSettled(e),r=t.filter(e=>"rejected"===e.status);if(r.length){for(let e of r)console.error(e.reason);throw Error(`${r.length} promise(s) failed - see the above errors`)}let n=[];for(let e of t)"fulfilled"===e.status&&n.push(e.value);return n}},90270,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FileBatches=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(23402),s=e.r(32271),o=e.r(36195),l=e.r(32943);class u extends n.APIResource{create(e,t,r){return this._client.post((0,l.path)`/vector_stores/${e}/file_batches`,{body:t,...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,t,r){let{vector_store_id:n}=t;return this._client.get((0,l.path)`/vector_stores/${n}/file_batches/${e}`,{...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}cancel(e,t,r){let{vector_store_id:n}=t;return this._client.post((0,l.path)`/vector_stores/${n}/file_batches/${e}/cancel`,{...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,t,r){let n=await this.create(e,t);return await this.poll(e,n.id,r)}listFiles(e,t,r){let{vector_store_id:n,...s}=t;return this._client.getAPIList((0,l.path)`/vector_stores/${n}/file_batches/${e}/files`,i.CursorPage,{query:s,...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async poll(e,t,r){let n=(0,a.buildHeaders)([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:i,response:a}=await this.retrieve(t,{vector_store_id:e},{...r,headers:n}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(r?.pollIntervalMs)o=r.pollIntervalMs;else{let e=a.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(o=t)}}await (0,s.sleep)(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},n){if(null==t||0==t.length)throw Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let i=Math.min(n?.maxConcurrency??5,t.length),a=this._client,s=t.values(),l=[...r];async function u(e){for(let t of e){let e=await a.files.create({file:t,purpose:"assistants"},n);l.push(e.id)}}let c=Array(i).fill(s).map(u);return await (0,o.allSettledWithThrow)(c),await this.createAndPoll(e,{file_ids:l})}}r.FileBatches=u},49269,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Files=void 0;let n=e.r(78465),i=e.r(3830),a=e.r(23402),s=e.r(75008),o=e.r(32943);class l extends n.APIResource{create(e,t,r){return this._client.post((0,o.path)`/vector_stores/${e}/files`,{body:t,...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,t,r){let{vector_store_id:n}=t;return this._client.get((0,o.path)`/vector_stores/${n}/files/${e}`,{...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,t,r){let{vector_store_id:n,...i}=t;return this._client.post((0,o.path)`/vector_stores/${n}/files/${e}`,{body:i,...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t={},r){return this._client.getAPIList((0,o.path)`/vector_stores/${e}/files`,i.CursorPage,{query:t,...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,t,r){let{vector_store_id:n}=t;return this._client.delete((0,o.path)`/vector_stores/${n}/files/${e}`,{...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,t,r){let n=await this.create(e,t,r);return await this.poll(e,n.id,r)}async poll(e,t,r){let n=(0,a.buildHeaders)([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){let i=await this.retrieve(t,{vector_store_id:e},{...r,headers:n}).withResponse(),a=i.data;switch(a.status){case"in_progress":let o=5e3;if(r?.pollIntervalMs)o=r.pollIntervalMs;else{let e=i.response.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(o=t)}}await (0,s.sleep)(o);break;case"failed":case"completed":return a}}}async upload(e,t,r){let n=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:n.id},r)}async uploadAndPoll(e,t,r){let n=await this.upload(e,t,r);return await this.poll(e,n.id,r)}content(e,t,r){let{vector_store_id:n}=t;return this._client.getAPIList((0,o.path)`/vector_stores/${n}/files/${e}/content`,i.Page,{...r,headers:(0,a.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}r.Files=l},51147,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.VectorStores=void 0;let n=e.r(99441),i=e.r(78465),a=n.__importStar(e.r(90270)),s=e.r(90270),o=n.__importStar(e.r(49269)),l=e.r(49269),u=e.r(3830),c=e.r(23402),d=e.r(32943);class p extends i.APIResource{constructor(){super(...arguments),this.files=new o.Files(this._client),this.fileBatches=new a.FileBatches(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:(0,c.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get((0,d.path)`/vector_stores/${e}`,{...t,headers:(0,c.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,r){return this._client.post((0,d.path)`/vector_stores/${e}`,{body:t,...r,headers:(0,c.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e={},t){return this._client.getAPIList("/vector_stores",u.CursorPage,{query:e,...t,headers:(0,c.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete((0,d.path)`/vector_stores/${e}`,{...t,headers:(0,c.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}search(e,t,r){return this._client.getAPIList((0,d.path)`/vector_stores/${e}/search`,u.Page,{body:t,method:"post",...r,headers:(0,c.buildHeaders)([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}r.VectorStores=p,p.Files=l.Files,p.FileBatches=s.FileBatches},17315,(e,t,r)=>{"use strict";var n,i,a;Object.defineProperty(r,"__esModule",{value:!0}),r.Webhooks=void 0;let s=e.r(99441),o=e.r(43163),l=e.r(78465),u=e.r(23402);class c extends l.APIResource{constructor(){super(...arguments),n.add(this)}async unwrap(e,t,r=this._client.webhookSecret,n=300){return await this.verifySignature(e,t,r,n),JSON.parse(e)}async verifySignature(e,t,r=this._client.webhookSecret,l=300){if("undefined"==typeof crypto||"function"!=typeof crypto.subtle.importKey||"function"!=typeof crypto.subtle.verify)throw Error("Webhook signature verification is only supported when the `crypto` global is defined");s.__classPrivateFieldGet(this,n,"m",i).call(this,r);let c=(0,u.buildHeaders)([t]).values,d=s.__classPrivateFieldGet(this,n,"m",a).call(this,c,"webhook-signature"),p=s.__classPrivateFieldGet(this,n,"m",a).call(this,c,"webhook-timestamp"),h=s.__classPrivateFieldGet(this,n,"m",a).call(this,c,"webhook-id"),f=parseInt(p,10);if(isNaN(f))throw new o.InvalidWebhookSignatureError("Invalid webhook timestamp format");let m=Math.floor(Date.now()/1e3);if(m-f>l)throw new o.InvalidWebhookSignatureError("Webhook timestamp is too old");if(f>m+l)throw new o.InvalidWebhookSignatureError("Webhook timestamp is too new");let g=d.split(" ").map(e=>e.startsWith("v1,")?e.substring(3):e),y=r.startsWith("whsec_")?Buffer.from(r.replace("whsec_",""),"base64"):Buffer.from(r,"utf-8"),b=h?`${h}.${p}.${e}`:`${p}.${e}`,_=await crypto.subtle.importKey("raw",y,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(let e of g)try{let t=Buffer.from(e,"base64");if(await crypto.subtle.verify("HMAC",_,t,new TextEncoder().encode(b)))return}catch{continue}throw new o.InvalidWebhookSignatureError("The given webhook signature does not match the expected signature")}}r.Webhooks=c,n=new WeakSet,i=function(e){if("string"!=typeof e||0===e.length)throw Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},a=function(e,t){if(!e)throw Error("Headers are required");let r=e.get(t);if(null==r)throw Error(`Missing required header: ${t}`);return r}},22044,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Webhooks=r.VectorStores=r.Uploads=r.Responses=r.Moderations=r.Models=r.Images=r.Graders=r.FineTuning=r.Files=r.Evals=r.Embeddings=r.Containers=r.Completions=r.Beta=r.Batches=r.Audio=void 0;let n=e.r(99441);n.__exportStar(e.r(56379),r),n.__exportStar(e.r(55362),r);var i=e.r(50479);Object.defineProperty(r,"Audio",{enumerable:!0,get:function(){return i.Audio}});var a=e.r(89274);Object.defineProperty(r,"Batches",{enumerable:!0,get:function(){return a.Batches}});var s=e.r(29912);Object.defineProperty(r,"Beta",{enumerable:!0,get:function(){return s.Beta}});var o=e.r(90825);Object.defineProperty(r,"Completions",{enumerable:!0,get:function(){return o.Completions}});var l=e.r(62577);Object.defineProperty(r,"Containers",{enumerable:!0,get:function(){return l.Containers}});var u=e.r(3593);Object.defineProperty(r,"Embeddings",{enumerable:!0,get:function(){return u.Embeddings}});var c=e.r(5531);Object.defineProperty(r,"Evals",{enumerable:!0,get:function(){return c.Evals}});var d=e.r(58549);Object.defineProperty(r,"Files",{enumerable:!0,get:function(){return d.Files}});var p=e.r(59472);Object.defineProperty(r,"FineTuning",{enumerable:!0,get:function(){return p.FineTuning}});var h=e.r(36575);Object.defineProperty(r,"Graders",{enumerable:!0,get:function(){return h.Graders}});var f=e.r(8869);Object.defineProperty(r,"Images",{enumerable:!0,get:function(){return f.Images}});var m=e.r(94709);Object.defineProperty(r,"Models",{enumerable:!0,get:function(){return m.Models}});var g=e.r(78321);Object.defineProperty(r,"Moderations",{enumerable:!0,get:function(){return g.Moderations}});var y=e.r(2198);Object.defineProperty(r,"Responses",{enumerable:!0,get:function(){return y.Responses}});var b=e.r(41516);Object.defineProperty(r,"Uploads",{enumerable:!0,get:function(){return b.Uploads}});var _=e.r(51147);Object.defineProperty(r,"VectorStores",{enumerable:!0,get:function(){return _.VectorStores}});var v=e.r(17315);Object.defineProperty(r,"Webhooks",{enumerable:!0,get:function(){return v.Webhooks}})},30109,(e,t,r)=>{"use strict";var n,i,a,s;Object.defineProperty(r,"__esModule",{value:!0}),r.OpenAI=void 0;let o=e.r(99441),l=e.r(87978),u=e.r(14291),c=e.r(32271),d=e.r(64684),p=e.r(7365),h=o.__importStar(e.r(10461)),f=o.__importStar(e.r(18258)),m=o.__importStar(e.r(22093)),g=e.r(4287),y=o.__importStar(e.r(93064)),b=o.__importStar(e.r(3830)),_=o.__importStar(e.r(93876)),v=o.__importStar(e.r(22044)),w=e.r(35079),O=e.r(89274),P=e.r(90825),S=e.r(3593),E=e.r(58549),k=e.r(8869),I=e.r(94709),A=e.r(78321),T=e.r(17315),C=e.r(50479),j=e.r(29912),x=e.r(93685),$=e.r(62577),N=e.r(5531),R=e.r(59472),M=e.r(36575),D=e.r(2198),L=e.r(41516),U=e.r(51147),F=e.r(7365),z=e.r(23402),B=e.r(27773),G=e.r(49434),Z=e.r(14291);class K{constructor({baseURL:e=(0,B.readEnv)("OPENAI_BASE_URL"),apiKey:t=(0,B.readEnv)("OPENAI_API_KEY"),organization:r=(0,B.readEnv)("OPENAI_ORG_ID")??null,project:s=(0,B.readEnv)("OPENAI_PROJECT_ID")??null,webhookSecret:l=(0,B.readEnv)("OPENAI_WEBHOOK_SECRET")??null,...u}={}){if(n.add(this),a.set(this,void 0),this.completions=new v.Completions(this),this.chat=new v.Chat(this),this.embeddings=new v.Embeddings(this),this.files=new v.Files(this),this.images=new v.Images(this),this.audio=new v.Audio(this),this.moderations=new v.Moderations(this),this.models=new v.Models(this),this.fineTuning=new v.FineTuning(this),this.graders=new v.Graders(this),this.vectorStores=new v.VectorStores(this),this.webhooks=new v.Webhooks(this),this.beta=new v.Beta(this),this.batches=new v.Batches(this),this.uploads=new v.Uploads(this),this.responses=new v.Responses(this),this.evals=new v.Evals(this),this.containers=new v.Containers(this),void 0===t)throw new y.OpenAIError("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");let c={apiKey:t,organization:r,project:s,webhookSecret:l,...u,baseURL:e||"https://api.openai.com/v1"};if(!c.dangerouslyAllowBrowser&&(0,F.isRunningInBrowser)())throw new y.OpenAIError("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");this.baseURL=c.baseURL,this.timeout=c.timeout??i.DEFAULT_TIMEOUT,this.logger=c.logger??console;let d="warn";this.logLevel=d,this.logLevel=(0,G.parseLogLevel)(c.logLevel,"ClientOptions.logLevel",this)??(0,G.parseLogLevel)((0,B.readEnv)("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??d,this.fetchOptions=c.fetchOptions,this.maxRetries=c.maxRetries??2,this.fetch=c.fetch??h.getDefaultFetch(),o.__classPrivateFieldSet(this,a,f.FallbackEncoder,"f"),this._options=c,this.apiKey=t,this.organization=r,this.project=s,this.webhookSecret=l}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){}async authHeaders(e){return(0,z.buildHeaders)([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return m.stringify(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${g.VERSION}`}defaultIdempotencyKey(){return`stainless-node-retry-${(0,l.uuid4)()}`}makeStatusError(e,t,r,n){return y.APIError.generate(e,t,r,n)}buildURL(e,t,r){let i=!o.__classPrivateFieldGet(this,n,"m",s).call(this)&&r||this.baseURL,a=new URL((0,u.isAbsoluteURL)(e)?e:i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return(0,Z.isEmptyObj)(l)||(t={...l,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(a.search=this.stringifyQuery(t)),a.toString()}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(r=>({method:e,path:t,...r})))}request(e,t=null){return new w.APIPromise(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,r){let n=await e,i=n.maxRetries??this.maxRetries;null==t&&(t=i),await this.prepareOptions(n);let{req:a,url:s,timeout:o}=await this.buildRequest(n,{retryCount:i-t});await this.prepareRequest(a,{url:s,options:n});let l="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),c=void 0===r?"":`, retryOf: ${r}`,p=Date.now();if((0,G.loggerFor)(this).debug(`[${l}] sending request`,(0,G.formatRequestDetails)({retryOfRequestLogID:r,method:n.method,url:s,options:n,headers:a.headers})),n.signal?.aborted)throw new y.APIUserAbortError;let f=new AbortController,m=await this.fetchWithTimeout(s,a,o,f).catch(d.castToError),g=Date.now();if(m instanceof Error){let e=`retrying, ${t} attempts remaining`;if(n.signal?.aborted)throw new y.APIUserAbortError;let i=(0,d.isAbortError)(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(t)return(0,G.loggerFor)(this).info(`[${l}] connection ${i?"timed out":"failed"} - ${e}`),(0,G.loggerFor)(this).debug(`[${l}] connection ${i?"timed out":"failed"} (${e})`,(0,G.formatRequestDetails)({retryOfRequestLogID:r,url:s,durationMs:g-p,message:m.message})),this.retryRequest(n,t,r??l);if((0,G.loggerFor)(this).info(`[${l}] connection ${i?"timed out":"failed"} - error; no more retries left`),(0,G.loggerFor)(this).debug(`[${l}] connection ${i?"timed out":"failed"} (error; no more retries left)`,(0,G.formatRequestDetails)({retryOfRequestLogID:r,url:s,durationMs:g-p,message:m.message})),i)throw new y.APIConnectionTimeoutError;throw new y.APIConnectionError({cause:m})}let b=[...m.headers.entries()].filter(([e])=>"x-request-id"===e).map(([e,t])=>", "+e+": "+JSON.stringify(t)).join(""),_=`[${l}${c}${b}] ${a.method} ${s} ${m.ok?"succeeded":"failed"} with status ${m.status} in ${g-p}ms`;if(!m.ok){let e=await this.shouldRetry(m);if(t&&e){let e=`retrying, ${t} attempts remaining`;return await h.CancelReadableStream(m.body),(0,G.loggerFor)(this).info(`${_} - ${e}`),(0,G.loggerFor)(this).debug(`[${l}] response error (${e})`,(0,G.formatRequestDetails)({retryOfRequestLogID:r,url:m.url,status:m.status,headers:m.headers,durationMs:g-p})),this.retryRequest(n,t,r??l,m.headers)}let i=e?"error; no more retries left":"error; not retryable";(0,G.loggerFor)(this).info(`${_} - ${i}`);let a=await m.text().catch(e=>(0,d.castToError)(e).message),s=(0,u.safeJSON)(a),o=s?void 0:a;throw(0,G.loggerFor)(this).debug(`[${l}] response error (${i})`,(0,G.formatRequestDetails)({retryOfRequestLogID:r,url:m.url,status:m.status,headers:m.headers,message:o,durationMs:Date.now()-p})),this.makeStatusError(m.status,s,o,m.headers)}return(0,G.loggerFor)(this).info(_),(0,G.loggerFor)(this).debug(`[${l}] response start`,(0,G.formatRequestDetails)({retryOfRequestLogID:r,url:m.url,status:m.status,headers:m.headers,durationMs:g-p})),{response:m,options:n,controller:f,requestLogID:l,retryOfRequestLogID:r,startTime:p}}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}requestAPIList(e,t){let r=this.makeRequest(t,null,void 0);return new b.PagePromise(this,r,e)}async fetchWithTimeout(e,t,r,n){let{signal:i,method:a,...s}=t||{};i&&i.addEventListener("abort",()=>n.abort());let o=setTimeout(()=>n.abort(),r),l=globalThis.ReadableStream&&s.body instanceof globalThis.ReadableStream||"object"==typeof s.body&&null!==s.body&&Symbol.asyncIterator in s.body,u={signal:n.signal,...l?{duplex:"half"}:{},method:"GET",...s};a&&(u.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,u)}finally{clearTimeout(o)}}async shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||!!(e.status>=500))}async retryRequest(e,t,r,n){let i,a=n?.get("retry-after-ms");if(a){let e=parseFloat(a);Number.isNaN(e)||(i=e)}let s=n?.get("retry-after");if(s&&!i){let e=parseFloat(s);i=Number.isNaN(e)?Date.parse(s)-Date.now():1e3*e}if(!(i&&0<=i&&i<6e4)){let r=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(t,r)}return await (0,c.sleep)(i),this.makeRequest(e,t-1,r)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}async buildRequest(e,{retryCount:t=0}={}){let r={...e},{method:n,path:i,query:a,defaultBaseURL:s}=r,o=this.buildURL(i,a,s);"timeout"in r&&(0,u.validatePositiveInteger)("timeout",r.timeout),r.timeout=r.timeout??this.timeout;let{bodyHeaders:l,body:c}=this.buildBody({options:r}),d=await this.buildHeaders({options:e,method:n,bodyHeaders:l,retryCount:t});return{req:{method:n,headers:d,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&c instanceof globalThis.ReadableStream&&{duplex:"half"},...c&&{body:c},...this.fetchOptions??{},...r.fetchOptions??{}},url:o,timeout:r.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:r,retryCount:n}){let i={};this.idempotencyHeader&&"get"!==t&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);let a=(0,z.buildHeaders)([i,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(n),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...(0,p.getPlatformHeaders)(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(a),a.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};let r=(0,z.buildHeaders)([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||"string"==typeof e&&r.values.has("content-type")||e instanceof Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:"object"==typeof e&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&"function"==typeof e.next)?{bodyHeaders:void 0,body:h.ReadableStreamFrom(e)}:o.__classPrivateFieldGet(this,a,"f").call(this,{body:e,headers:r})}}r.OpenAI=K,i=K,a=new WeakMap,n=new WeakSet,s=function(){return"https://api.openai.com/v1"!==this.baseURL},K.OpenAI=i,K.DEFAULT_TIMEOUT=6e5,K.OpenAIError=y.OpenAIError,K.APIError=y.APIError,K.APIConnectionError=y.APIConnectionError,K.APIConnectionTimeoutError=y.APIConnectionTimeoutError,K.APIUserAbortError=y.APIUserAbortError,K.NotFoundError=y.NotFoundError,K.ConflictError=y.ConflictError,K.RateLimitError=y.RateLimitError,K.BadRequestError=y.BadRequestError,K.AuthenticationError=y.AuthenticationError,K.InternalServerError=y.InternalServerError,K.PermissionDeniedError=y.PermissionDeniedError,K.UnprocessableEntityError=y.UnprocessableEntityError,K.InvalidWebhookSignatureError=y.InvalidWebhookSignatureError,K.toFile=_.toFile,K.Completions=P.Completions,K.Chat=x.Chat,K.Embeddings=S.Embeddings,K.Files=E.Files,K.Images=k.Images,K.Audio=C.Audio,K.Moderations=A.Moderations,K.Models=I.Models,K.FineTuning=R.FineTuning,K.Graders=M.Graders,K.VectorStores=U.VectorStores,K.Webhooks=T.Webhooks,K.Beta=j.Beta,K.Batches=O.Batches,K.Uploads=L.Uploads,K.Responses=D.Responses,K.Evals=N.Evals,K.Containers=$.Containers},31764,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AzureOpenAI=void 0;let n=e.r(99441).__importStar(e.r(43163)),i=e.r(75008),a=e.r(30109),s=e.r(23402);class o extends a.OpenAI{constructor({baseURL:e=(0,i.readEnv)("OPENAI_BASE_URL"),apiKey:t=(0,i.readEnv)("AZURE_OPENAI_API_KEY"),apiVersion:r=(0,i.readEnv)("OPENAI_API_VERSION"),endpoint:a,deployment:s,azureADTokenProvider:o,dangerouslyAllowBrowser:l,...c}={}){if(!r)throw new n.OpenAIError("The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).");if("function"==typeof o&&(l=!0),!o&&!t)throw new n.OpenAIError("Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.");if(o&&t)throw new n.OpenAIError("The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.");if(t??(t=u),c.defaultQuery={...c.defaultQuery,"api-version":r},e){if(a)throw new n.OpenAIError("baseURL and endpoint are mutually exclusive")}else{if(a||(a=process.env.AZURE_OPENAI_ENDPOINT),!a)throw new n.OpenAIError("Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable");e=`${a}/openai`}super({apiKey:t,baseURL:e,...c,...void 0!==l?{dangerouslyAllowBrowser:l}:{}}),this.apiVersion="",this._azureADTokenProvider=o,this.apiVersion=r,this.deploymentName=s}async buildRequest(e,t={}){if(l.has(e.path)&&"post"===e.method&&void 0!==e.body){if(!(0,i.isObj)(e.body))throw Error("Expected request body to be an object");let t=this.deploymentName||e.body.model||e.__metadata?.model;void 0===t||this.baseURL.includes("/deployments")||(e.path=`/deployments/${t}${e.path}`)}return super.buildRequest(e,t)}async _getAzureADToken(){if("function"==typeof this._azureADTokenProvider){let e=await this._azureADTokenProvider();if(!e||"string"!=typeof e)throw new n.OpenAIError(`Expected 'azureADTokenProvider' argument to return a string but it returned ${e}`);return e}}async authHeaders(e){}async prepareOptions(e){if(e.headers=(0,s.buildHeaders)([e.headers]),e.headers.values.get("Authorization")||e.headers.values.get("api-key"))return super.prepareOptions(e);let t=await this._getAzureADToken();if(t)e.headers.values.set("Authorization",`Bearer ${t}`);else if(this.apiKey!==u)e.headers.values.set("api-key",this.apiKey);else throw new n.OpenAIError("Unable to handle auth");return super.prepareOptions(e)}}r.AzureOpenAI=o;let l=new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations","/batches","/images/edits"]),u="<Missing Key>"},69871,(e,t,r)=>{"use strict";Object.defineProperty(r=t.exports=function(...e){return new r.default(...e)},"__esModule",{value:!0}),r.AzureOpenAI=r.InvalidWebhookSignatureError=r.UnprocessableEntityError=r.PermissionDeniedError=r.InternalServerError=r.AuthenticationError=r.BadRequestError=r.RateLimitError=r.ConflictError=r.NotFoundError=r.APIUserAbortError=r.APIConnectionTimeoutError=r.APIConnectionError=r.APIError=r.OpenAIError=r.PagePromise=r.OpenAI=r.APIPromise=r.toFile=r.default=void 0;var n=e.r(30109);Object.defineProperty(r,"default",{enumerable:!0,get:function(){return n.OpenAI}});var i=e.r(93876);Object.defineProperty(r,"toFile",{enumerable:!0,get:function(){return i.toFile}});var a=e.r(35079);Object.defineProperty(r,"APIPromise",{enumerable:!0,get:function(){return a.APIPromise}});var s=e.r(30109);Object.defineProperty(r,"OpenAI",{enumerable:!0,get:function(){return s.OpenAI}});var o=e.r(3830);Object.defineProperty(r,"PagePromise",{enumerable:!0,get:function(){return o.PagePromise}});var l=e.r(93064);Object.defineProperty(r,"OpenAIError",{enumerable:!0,get:function(){return l.OpenAIError}}),Object.defineProperty(r,"APIError",{enumerable:!0,get:function(){return l.APIError}}),Object.defineProperty(r,"APIConnectionError",{enumerable:!0,get:function(){return l.APIConnectionError}}),Object.defineProperty(r,"APIConnectionTimeoutError",{enumerable:!0,get:function(){return l.APIConnectionTimeoutError}}),Object.defineProperty(r,"APIUserAbortError",{enumerable:!0,get:function(){return l.APIUserAbortError}}),Object.defineProperty(r,"NotFoundError",{enumerable:!0,get:function(){return l.NotFoundError}}),Object.defineProperty(r,"ConflictError",{enumerable:!0,get:function(){return l.ConflictError}}),Object.defineProperty(r,"RateLimitError",{enumerable:!0,get:function(){return l.RateLimitError}}),Object.defineProperty(r,"BadRequestError",{enumerable:!0,get:function(){return l.BadRequestError}}),Object.defineProperty(r,"AuthenticationError",{enumerable:!0,get:function(){return l.AuthenticationError}}),Object.defineProperty(r,"InternalServerError",{enumerable:!0,get:function(){return l.InternalServerError}}),Object.defineProperty(r,"PermissionDeniedError",{enumerable:!0,get:function(){return l.PermissionDeniedError}}),Object.defineProperty(r,"UnprocessableEntityError",{enumerable:!0,get:function(){return l.UnprocessableEntityError}}),Object.defineProperty(r,"InvalidWebhookSignatureError",{enumerable:!0,get:function(){return l.InvalidWebhookSignatureError}});var u=e.r(31764);Object.defineProperty(r,"AzureOpenAI",{enumerable:!0,get:function(){return u.AzureOpenAI}})},17549,(e,t,r)=>{t.exports=e.r(73718)},95435,(e,t,r)=>{t.exports=e.r(85864)},73444,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.JsonOutputKeyToolsParser=r.JsonOutputToolsParser=void 0,r.parseToolCall=l,r.convertLangChainToolCallToOpenAI=function(e){if(void 0===e.id)throw Error('All OpenAI tool calls must have an "id" field.');return{id:e.id,type:"function",function:{name:e.name,arguments:JSON.stringify(e.args)}}},r.makeInvalidToolCall=function(e,t){return{name:e.function?.name,args:e.function?.arguments,id:e.id,error:t,type:"invalid_tool_call"}};let n=e.r(6245),i=e.r(20087),a=e.r(84928),s=e.r(46404),o=e.r(29164);function l(e,t){let r;if(void 0===e.function)return;if(t?.partial)try{r=(0,i.parsePartialJson)(e.function.arguments??"{}")}catch(e){return}else try{r=JSON.parse(e.function.arguments)}catch(t){throw new n.OutputParserException([`Function "${e.function.name}" arguments:`,"",e.function.arguments,"\nare not valid JSON.",`Error: ${t.message}`].join("\n"))}let a={name:e.function.name,args:r,type:"tool_call"};return t?.returnId&&(a.id=e.id),a}class u extends a.BaseCumulativeTransformOutputParser{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=e?.returnId??this.returnId}_diff(){throw Error("Not supported.")}async parse(){throw Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,t=!0){let r,n=e[0].message;if((0,s.isAIMessage)(n)&&n.tool_calls?.length?r=n.tool_calls.map(e=>{let{id:t,...r}=e;return this.returnId?{id:t,...r}:r}):void 0!==n.additional_kwargs.tool_calls&&(r=JSON.parse(JSON.stringify(n.additional_kwargs.tool_calls)).map(e=>l(e,{returnId:this.returnId,partial:t}))),!r)return[];let i=[];for(let e of r)if(void 0!==e){let t={type:e.name,args:e.args,id:e.id};i.push(t)}return i}}r.JsonOutputToolsParser=u,r.JsonOutputKeyToolsParser=class extends u{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(void 0===this.zodSchema)return e;let t=await (0,o.interopSafeParseAsync)(this.zodSchema,e);if(t.success)return t.data;throw new n.OutputParserException(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error?.issues)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){let t=(await super.parsePartialResult(e)).filter(e=>e.type===this.keyName),r=t;if(t.length)return(this.returnId||(r=t.map(e=>e.args)),this.returnSingle)?r[0]:r}async parseResult(e){let t=(await super.parsePartialResult(e,!1)).filter(e=>e.type===this.keyName),r=t;return t.length?(this.returnId||(r=t.map(e=>e.args)),this.returnSingle)?this._validateResult(r[0]):await Promise.all(r.map(e=>this._validateResult(e))):void 0}}},23991,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(73444),r)},69177,(e,t,r)=>{t.exports=e.r(23991)},44766,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getEndpoint=function(e){let{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:r,azureOpenAIApiKey:n,azureOpenAIBasePath:i,baseURL:a,azureADTokenProvider:s,azureOpenAIEndpoint:o}=e;if((n||s)&&i&&t)return`${i}/${t}`;if((n||s)&&o&&t)return`${o}/openai/deployments/${t}`;if(n||s){if(!r)throw Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${r}.openai.azure.com/openai/deployments/${t}`}return a}},45889,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaultOptions=r.ignoreOverride=void 0,r.ignoreOverride=Symbol("Let zodToJsonSchema decide on which parser to use");let n={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};r.getDefaultOptions=e=>"string"==typeof e?{...n,basePath:["#"],definitions:{},name:e}:{...n,basePath:["#"],definitions:{},...e}},26167,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.zodDef=void 0,r.isEmptyObj=function(e){if(!e)return!0;for(let t in e)return!1;return!0},r.zodDef=e=>"_def"in e?e._def:e},45148,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getRefs=void 0;let n=e.r(45889),i=e.r(26167);r.getRefs=e=>{let t=(0,n.getDefaultOptions)(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:r,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map(([e,r])=>[(0,i.zodDef)(r),{def:(0,i.zodDef)(r),path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}}},96474,(e,t,r)=>{"use strict";function n(e,t,r,n){n?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}Object.defineProperty(r,"__esModule",{value:!0}),r.addErrorMessage=n,r.setResponseValueAndErrors=function(e,t,r,i,a){e[t]=r,n(e,t,i,a)}},60750,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseAnyDef=function(){return{}}},93534,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseArrayDef=function(e,t){let r={type:"array"};return e.type?._def?.typeName!==n.ZodFirstPartyTypeKind.ZodAny&&(r.items=(0,a.parseDef)(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&(0,i.setResponseValueAndErrors)(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&(0,i.setResponseValueAndErrors)(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&((0,i.setResponseValueAndErrors)(r,"minItems",e.exactLength.value,e.exactLength.message,t),(0,i.setResponseValueAndErrors)(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r};let n=e.r(99243),i=e.r(96474),a=e.r(97081)},68810,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseBigintDef=function(e,t){let r={type:"integer",format:"int64"};if(!e.checks)return r;for(let i of e.checks)switch(i.kind){case"min":"jsonSchema7"===t.target?i.inclusive?(0,n.setResponseValueAndErrors)(r,"minimum",i.value,i.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMinimum",i.value,i.message,t):(i.inclusive||(r.exclusiveMinimum=!0),(0,n.setResponseValueAndErrors)(r,"minimum",i.value,i.message,t));break;case"max":"jsonSchema7"===t.target?i.inclusive?(0,n.setResponseValueAndErrors)(r,"maximum",i.value,i.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMaximum",i.value,i.message,t):(i.inclusive||(r.exclusiveMaximum=!0),(0,n.setResponseValueAndErrors)(r,"maximum",i.value,i.message,t));break;case"multipleOf":(0,n.setResponseValueAndErrors)(r,"multipleOf",i.value,i.message,t)}return r};let n=e.r(96474)},64165,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseBooleanDef=function(){return{type:"boolean"}}},23444,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseBrandedDef=function(e,t){return(0,n.parseDef)(e.type._def,t)};let n=e.r(97081)},8754,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseCatchDef=void 0;let n=e.r(97081);r.parseCatchDef=(e,t)=>(0,n.parseDef)(e.innerType._def,t)},98357,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseDateDef=function e(t,r,n){let a=n??r.dateStrategy;if(Array.isArray(a))return{anyOf:a.map((n,i)=>e(t,r,n))};switch(a){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return i(t,r)}};let n=e.r(96474),i=(e,t)=>{let r={type:"integer",format:"unix-time"};if("openApi3"===t.target)return r;for(let i of e.checks)switch(i.kind){case"min":(0,n.setResponseValueAndErrors)(r,"minimum",i.value,i.message,t);break;case"max":(0,n.setResponseValueAndErrors)(r,"maximum",i.value,i.message,t)}return r}},61650,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseDefaultDef=function(e,t){return{...(0,n.parseDef)(e.innerType._def,t),default:e.defaultValue()}};let n=e.r(97081)},71411,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseEffectsDef=function(e,t,r){return"input"===t.effectStrategy?(0,n.parseDef)(e.schema._def,t,r):{}};let n=e.r(97081)},79021,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseEnumDef=function(e){return{type:"string",enum:[...e.values]}}},74050,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseIntersectionDef=function(e,t){let r=[(0,n.parseDef)(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),(0,n.parseDef)(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),i="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0,a=[];return r.forEach(e=>{if((!("type"in e)||"string"!==e.type)&&"allOf"in e)a.push(...e.allOf),void 0===e.unevaluatedProperties&&(i=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...n}=e;t=n}else i=void 0;a.push(t)}}),a.length?{allOf:a,...i}:void 0};let n=e.r(97081)},24323,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseLiteralDef=function(e,t){let r=typeof e.value;return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===r?"integer":r,enum:[e.value]}:{type:"bigint"===r?"integer":r,const:e.value}}},29817,(e,t,r)=>{"use strict";let n;Object.defineProperty(r,"__esModule",{value:!0}),r.zodPatterns=void 0,r.parseStringDef=function(e,t){let n={type:"string"};function l(e){return"escape"===t.patternStrategy?a(e):e}if(e.checks)for(let a of e.checks)switch(a.kind){case"min":(0,i.setResponseValueAndErrors)(n,"minLength","number"==typeof n.minLength?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":(0,i.setResponseValueAndErrors)(n,"maxLength","number"==typeof n.maxLength?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":s(n,"email",a.message,t);break;case"format:idn-email":s(n,"idn-email",a.message,t);break;case"pattern:zod":o(n,r.zodPatterns.email,a.message,t)}break;case"url":s(n,"uri",a.message,t);break;case"uuid":s(n,"uuid",a.message,t);break;case"regex":o(n,a.regex,a.message,t);break;case"cuid":o(n,r.zodPatterns.cuid,a.message,t);break;case"cuid2":o(n,r.zodPatterns.cuid2,a.message,t);break;case"startsWith":o(n,RegExp(`^${l(a.value)}`),a.message,t);break;case"endsWith":o(n,RegExp(`${l(a.value)}$`),a.message,t);break;case"datetime":s(n,"date-time",a.message,t);break;case"date":s(n,"date",a.message,t);break;case"time":s(n,"time",a.message,t);break;case"duration":s(n,"duration",a.message,t);break;case"length":(0,i.setResponseValueAndErrors)(n,"minLength","number"==typeof n.minLength?Math.max(n.minLength,a.value):a.value,a.message,t),(0,i.setResponseValueAndErrors)(n,"maxLength","number"==typeof n.maxLength?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":o(n,RegExp(l(a.value)),a.message,t);break;case"ip":"v6"!==a.version&&s(n,"ipv4",a.message,t),"v4"!==a.version&&s(n,"ipv6",a.message,t);break;case"emoji":o(n,r.zodPatterns.emoji,a.message,t);break;case"ulid":o(n,r.zodPatterns.ulid,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":s(n,"binary",a.message,t);break;case"contentEncoding:base64":(0,i.setResponseValueAndErrors)(n,"contentEncoding","base64",a.message,t);break;case"pattern:zod":o(n,r.zodPatterns.base64,a.message,t)}break;case"nanoid":o(n,r.zodPatterns.nanoid,a.message,t)}return n};let i=e.r(96474);r.zodPatterns={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===n&&(n=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),n),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};let a=e=>Array.from(e).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),s=(e,t,r,n)=>{e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&n.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&n.errorMessages&&{errorMessage:{format:r}}})):(0,i.setResponseValueAndErrors)(e,"format",t,r,n)},o=(e,t,r,n)=>{e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&n.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:l(t,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):(0,i.setResponseValueAndErrors)(e,"pattern",l(t,n),r,n)},l=(e,t)=>{let r="function"==typeof e?e():e;if(!t.applyRegexFlags||!r.flags)return r.source;let n={i:r.flags.includes("i"),m:r.flags.includes("m"),s:r.flags.includes("s")},i=n.i?r.source.toLowerCase():r.source,a="",s=!1,o=!1,l=!1;for(let e=0;e<i.length;e++){if(s){a+=i[e],s=!1;continue}if(n.i){if(o){if(i[e].match(/[a-z]/)){l?(a+=i[e],a+=`${i[e-2]}-${i[e]}`.toUpperCase(),l=!1):"-"===i[e+1]&&i[e+2]?.match(/[a-z]/)?(a+=i[e],l=!0):a+=`${i[e]}${i[e].toUpperCase()}`;continue}}else if(i[e].match(/[a-z]/)){a+=`[${i[e]}${i[e].toUpperCase()}]`;continue}}if(n.m){if("^"===i[e]){a+=`(^|(?<=[\r
]))`;continue}else if("$"===i[e]){a+=`($|(?=[\r
]))`;continue}}if(n.s&&"."===i[e]){a+=o?`${i[e]}\r
`:`[${i[e]}\r
]`;continue}a+=i[e],"\\"===i[e]?s=!0:o&&"]"===i[e]?o=!1:o||"["!==i[e]||(o=!0)}try{new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),r.source}return a}},42468,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseRecordDef=function(e,t){if("openApi3"===t.target&&e.keyType?._def.typeName===n.ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,n)=>({...r,[n]:(0,i.parseDef)(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",n]})??{}}),{}),additionalProperties:!1};let r={type:"object",additionalProperties:(0,i.parseDef)(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if("openApi3"===t.target)return r;if(e.keyType?._def.typeName===n.ZodFirstPartyTypeKind.ZodString&&e.keyType._def.checks?.length){let n=Object.entries((0,a.parseStringDef)(e.keyType._def,t)).reduce((e,[t,r])=>"type"===t?e:{...e,[t]:r},{});return{...r,propertyNames:n}}return e.keyType?._def.typeName===n.ZodFirstPartyTypeKind.ZodEnum?{...r,propertyNames:{enum:e.keyType._def.values}}:r};let n=e.r(99243),i=e.r(97081),a=e.r(29817)},7053,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseMapDef=function(e,t){return"record"===t.mapStrategy?(0,i.parseRecordDef)(e,t):{type:"array",maxItems:125,items:{type:"array",items:[(0,n.parseDef)(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},(0,n.parseDef)(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}};let n=e.r(97081),i=e.r(42468)},28101,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseNativeEnumDef=function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),n=Array.from(new Set(r.map(e=>typeof e)));return{type:1===n.length?"string"===n[0]?"string":"number":["string","number"],enum:r}}},35695,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseNeverDef=function(){return{not:{}}}},17562,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseNullDef=function(e){return"openApi3"===e.target?{enum:["null"],nullable:!0}:{type:"null"}}},66037,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.primitiveMappings=void 0,r.parseUnionDef=function(e,t){if("openApi3"===t.target)return i(e,t);let n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(e=>e._def.typeName in r.primitiveMappings&&(!e._def.checks||!e._def.checks.length))){let e=n.reduce((e,t)=>{let n=r.primitiveMappings[t._def.typeName];return n&&!e.includes(n)?[...e,n]:e},[]);return{type:e.length>1?e:e[0]}}if(n.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=n.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===n.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:n.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(n.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:n.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return i(e,t)};let n=e.r(97081);r.primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};let i=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>(0,n.parseDef)(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0}},31060,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseNullableDef=function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target||"property"===t.nullableStrategy?{type:i.primitiveMappings[e.innerType._def.typeName],nullable:!0}:{type:[i.primitiveMappings[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){let r=(0,n.parseDef)(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}let r=(0,n.parseDef)(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}};let n=e.r(97081),i=e.r(66037)},81586,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseNumberDef=function(e,t){let r={type:"number"};if(!e.checks)return r;for(let i of e.checks)switch(i.kind){case"int":r.type="integer",(0,n.addErrorMessage)(r,"type",i.message,t);break;case"min":"jsonSchema7"===t.target?i.inclusive?(0,n.setResponseValueAndErrors)(r,"minimum",i.value,i.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMinimum",i.value,i.message,t):(i.inclusive||(r.exclusiveMinimum=!0),(0,n.setResponseValueAndErrors)(r,"minimum",i.value,i.message,t));break;case"max":"jsonSchema7"===t.target?i.inclusive?(0,n.setResponseValueAndErrors)(r,"maximum",i.value,i.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMaximum",i.value,i.message,t):(i.inclusive||(r.exclusiveMaximum=!0),(0,n.setResponseValueAndErrors)(r,"maximum",i.value,i.message,t));break;case"multipleOf":(0,n.setResponseValueAndErrors)(r,"multipleOf",i.value,i.message,t)}return r};let n=e.r(96474)},88400,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseObjectDef=function(e,t){let r={type:"object",...Object.entries(e.shape()).reduce((e,[r,i])=>{if(void 0===i||void 0===i._def)return e;let a=[...t.currentPath,"properties",r],s=(0,n.parseDef)(i._def,{...t,currentPath:a,propertyPath:a});if(void 0===s)return e;if(t.openaiStrictMode&&i.isOptional()&&!i.isNullable()&&void 0===i._def?.defaultValue)throw Error(`Zod field at \`${a.join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required`);return{properties:{...e.properties,[r]:s},required:i.isOptional()&&!t.openaiStrictMode?e.required:[...e.required,r]}},{properties:{},required:[]}),additionalProperties:"strict"===t.removeAdditionalStrategy?"ZodNever"===e.catchall._def.typeName?"strict"!==e.unknownKeys:(0,n.parseDef)(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:(0,n.parseDef)(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0};return r.required.length||delete r.required,r};let n=e.r(97081)},9388,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseOptionalDef=void 0;let n=e.r(97081);r.parseOptionalDef=(e,t)=>{if(t.propertyPath&&t.currentPath.slice(0,t.propertyPath.length).toString()===t.propertyPath.toString())return(0,n.parseDef)(e.innerType._def,{...t,currentPath:t.currentPath});let r=(0,n.parseDef)(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}}},5841,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parsePipelineDef=void 0;let n=e.r(97081);r.parsePipelineDef=(e,t)=>{if("input"===t.pipeStrategy)return(0,n.parseDef)(e.in._def,t);if("output"===t.pipeStrategy)return(0,n.parseDef)(e.out._def,t);let r=(0,n.parseDef)(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),i=(0,n.parseDef)(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,i].filter(e=>void 0!==e)}}},49078,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parsePromiseDef=function(e,t){return(0,n.parseDef)(e.type._def,t)};let n=e.r(97081)},53855,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseSetDef=function(e,t){let r={type:"array",uniqueItems:!0,items:(0,i.parseDef)(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&(0,n.setResponseValueAndErrors)(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&(0,n.setResponseValueAndErrors)(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r};let n=e.r(96474),i=e.r(97081)},95785,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseTupleDef=function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>(0,n.parseDef)(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:(0,n.parseDef)(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>(0,n.parseDef)(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}};let n=e.r(97081)},97953,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseUndefinedDef=function(){return{not:{}}}},24659,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseUnknownDef=function(){return{}}},64808,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseReadonlyDef=void 0;let n=e.r(97081);r.parseReadonlyDef=(e,t)=>(0,n.parseDef)(e.innerType._def,t)},97081,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseDef=R;let n=e.r(99243),i=e.r(60750),a=e.r(93534),s=e.r(68810),o=e.r(64165),l=e.r(23444),u=e.r(8754),c=e.r(98357),d=e.r(61650),p=e.r(71411),h=e.r(79021),f=e.r(74050),m=e.r(24323),g=e.r(7053),y=e.r(28101),b=e.r(35695),_=e.r(17562),v=e.r(31060),w=e.r(81586),O=e.r(88400),P=e.r(9388),S=e.r(5841),E=e.r(49078),k=e.r(42468),I=e.r(53855),A=e.r(29817),T=e.r(95785),C=e.r(97953),j=e.r(66037),x=e.r(24659),$=e.r(64808),N=e.r(45889);function R(e,t,r=!1){let n=t.seen.get(e);if(t.override){let i=t.override?.(e,t,n,r);if(i!==N.ignoreOverride)return i}if(n&&!r){let e=M(n,t);if(void 0!==e)return"$ref"in e&&t.seenRefs.add(e.$ref),e}let i={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,i);let a=L(e,e.typeName,t,r);return a&&U(e,t,a),i.jsonSchema=a,a}let M=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":let r=e.path.slice(t.basePath.length+1).join("_");return r!==t.name&&"duplicate-ref"===t.nameStrategy&&(t.definitions[r]=e.def),{$ref:[...t.basePath,t.definitionPath,r].join("/")};case"relative":return{$ref:D(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},D=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},L=(e,t,r,N)=>{switch(t){case n.ZodFirstPartyTypeKind.ZodString:return(0,A.parseStringDef)(e,r);case n.ZodFirstPartyTypeKind.ZodNumber:return(0,w.parseNumberDef)(e,r);case n.ZodFirstPartyTypeKind.ZodObject:return(0,O.parseObjectDef)(e,r);case n.ZodFirstPartyTypeKind.ZodBigInt:return(0,s.parseBigintDef)(e,r);case n.ZodFirstPartyTypeKind.ZodBoolean:return(0,o.parseBooleanDef)();case n.ZodFirstPartyTypeKind.ZodDate:return(0,c.parseDateDef)(e,r);case n.ZodFirstPartyTypeKind.ZodUndefined:return(0,C.parseUndefinedDef)();case n.ZodFirstPartyTypeKind.ZodNull:return(0,_.parseNullDef)(r);case n.ZodFirstPartyTypeKind.ZodArray:return(0,a.parseArrayDef)(e,r);case n.ZodFirstPartyTypeKind.ZodUnion:case n.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return(0,j.parseUnionDef)(e,r);case n.ZodFirstPartyTypeKind.ZodIntersection:return(0,f.parseIntersectionDef)(e,r);case n.ZodFirstPartyTypeKind.ZodTuple:return(0,T.parseTupleDef)(e,r);case n.ZodFirstPartyTypeKind.ZodRecord:return(0,k.parseRecordDef)(e,r);case n.ZodFirstPartyTypeKind.ZodLiteral:return(0,m.parseLiteralDef)(e,r);case n.ZodFirstPartyTypeKind.ZodEnum:return(0,h.parseEnumDef)(e);case n.ZodFirstPartyTypeKind.ZodNativeEnum:return(0,y.parseNativeEnumDef)(e);case n.ZodFirstPartyTypeKind.ZodNullable:return(0,v.parseNullableDef)(e,r);case n.ZodFirstPartyTypeKind.ZodOptional:return(0,P.parseOptionalDef)(e,r);case n.ZodFirstPartyTypeKind.ZodMap:return(0,g.parseMapDef)(e,r);case n.ZodFirstPartyTypeKind.ZodSet:return(0,I.parseSetDef)(e,r);case n.ZodFirstPartyTypeKind.ZodLazy:return R(e.getter()._def,r);case n.ZodFirstPartyTypeKind.ZodPromise:return(0,E.parsePromiseDef)(e,r);case n.ZodFirstPartyTypeKind.ZodNaN:case n.ZodFirstPartyTypeKind.ZodNever:return(0,b.parseNeverDef)();case n.ZodFirstPartyTypeKind.ZodEffects:return(0,p.parseEffectsDef)(e,r,N);case n.ZodFirstPartyTypeKind.ZodAny:return(0,i.parseAnyDef)();case n.ZodFirstPartyTypeKind.ZodUnknown:return(0,x.parseUnknownDef)();case n.ZodFirstPartyTypeKind.ZodDefault:return(0,d.parseDefaultDef)(e,r);case n.ZodFirstPartyTypeKind.ZodBranded:return(0,l.parseBrandedDef)(e,r);case n.ZodFirstPartyTypeKind.ZodReadonly:return(0,$.parseReadonlyDef)(e,r);case n.ZodFirstPartyTypeKind.ZodCatch:return(0,u.parseCatchDef)(e,r);case n.ZodFirstPartyTypeKind.ZodPipeline:return(0,S.parsePipelineDef)(e,r);case n.ZodFirstPartyTypeKind.ZodFunction:case n.ZodFirstPartyTypeKind.ZodVoid:case n.ZodFirstPartyTypeKind.ZodSymbol:default:return}},U=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r)},5670,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.zodToJsonSchema=void 0;let n=e.r(97081),i=e.r(45148),a=e.r(26167);r.zodToJsonSchema=(e,t)=>{let r=(0,i.getRefs)(t),s="string"==typeof t?t:t?.nameStrategy==="title"?void 0:t?.name,o=(0,n.parseDef)(e._def,void 0===s?r:{...r,currentPath:[...r.basePath,r.definitionPath,s]},!1)??{},l="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==l&&(o.title=l);let u=(()=>{if((0,a.isEmptyObj)(r.definitions))return;let e={},t=new Set;for(let i=0;i<500;i++){let i=Object.entries(r.definitions).filter(([e])=>!t.has(e));if(0===i.length)break;for(let[s,o]of i)e[s]=(0,n.parseDef)((0,a.zodDef)(o),{...r,currentPath:[...r.basePath,r.definitionPath,s]},!0)??{},t.add(s)}return e})(),c=void 0===s?u?{...o,[r.definitionPath]:u}:o:"duplicate-ref"===r.nameStrategy?{...o,...u||r.seenRefs.size?{[r.definitionPath]:{...u,...r.seenRefs.size?{[s]:o}:void 0}}:void 0}:{$ref:[..."relative"===r.$refStrategy?[]:r.basePath,r.definitionPath,s].join("/"),[r.definitionPath]:{...u,[s]:o}};return"jsonSchema7"===r.target?c.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"===r.target&&(c.$schema="https://json-schema.org/draft/2019-09/schema#"),c}},25881,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(99441);n.__exportStar(e.r(45889),r),n.__exportStar(e.r(45148),r),n.__exportStar(e.r(96474),r),n.__exportStar(e.r(97081),r),n.__exportStar(e.r(60750),r),n.__exportStar(e.r(93534),r),n.__exportStar(e.r(68810),r),n.__exportStar(e.r(64165),r),n.__exportStar(e.r(23444),r),n.__exportStar(e.r(8754),r),n.__exportStar(e.r(98357),r),n.__exportStar(e.r(61650),r),n.__exportStar(e.r(71411),r),n.__exportStar(e.r(79021),r),n.__exportStar(e.r(74050),r),n.__exportStar(e.r(24323),r),n.__exportStar(e.r(7053),r),n.__exportStar(e.r(28101),r),n.__exportStar(e.r(35695),r),n.__exportStar(e.r(17562),r),n.__exportStar(e.r(31060),r),n.__exportStar(e.r(81586),r),n.__exportStar(e.r(88400),r),n.__exportStar(e.r(9388),r),n.__exportStar(e.r(5841),r),n.__exportStar(e.r(49078),r),n.__exportStar(e.r(64808),r),n.__exportStar(e.r(42468),r),n.__exportStar(e.r(53855),r),n.__exportStar(e.r(29817),r),n.__exportStar(e.r(95785),r),n.__exportStar(e.r(97953),r),n.__exportStar(e.r(66037),r),n.__exportStar(e.r(24659),r),n.__exportStar(e.r(5670),r),r.default=e.r(5670).zodToJsonSchema},25471,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.zodResponseFormat=function(e,t,r){return(0,n.makeParseableResponseFormat)({type:"json_schema",json_schema:{...r,name:t,strict:!0,schema:s(e,{name:t})}},t=>e.parse(JSON.parse(t)))},r.zodTextFormat=function(e,t,r){return(0,n.makeParseableTextFormat)({type:"json_schema",...r,name:t,strict:!0,schema:s(e,{name:t})},t=>e.parse(JSON.parse(t)))},r.zodFunction=function(e){return(0,n.makeParseableTool)({type:"function",function:{name:e.name,parameters:s(e.parameters,{name:e.name}),strict:!0,...e.description?{description:e.description}:void 0}},{callback:e.function,parser:t=>e.parameters.parse(JSON.parse(t))})},r.zodResponsesFunction=function(e){return(0,a.makeParseableResponseTool)({type:"function",name:e.name,parameters:s(e.parameters,{name:e.name}),strict:!0,...e.description?{description:e.description}:void 0},{callback:e.function,parser:t=>e.parameters.parse(JSON.parse(t))})};let n=e.r(26636),i=e.r(25881),a=e.r(4368);function s(e,t){return(0,i.zodToJsonSchema)(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}},56285,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.addLangChainErrorFields=function(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/
`,e}},57273,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.formatToOpenAITool=r.formatToOpenAIFunction=void 0,r.wrapOpenAIClientError=function(e){let t;return e.constructor.name===n.APIConnectionTimeoutError.name?(t=Error(e.message)).name="TimeoutError":e.constructor.name===n.APIUserAbortError.name?(t=Error(e.message)).name="AbortError":t=400===e.status&&e.message.includes("tool_calls")?(0,u.addLangChainErrorFields)(e,"INVALID_TOOL_RESULTS"):401===e.status?(0,u.addLangChainErrorFields)(e,"MODEL_AUTHENTICATION"):429===e.status?(0,u.addLangChainErrorFields)(e,"MODEL_RATE_LIMIT"):404===e.status?(0,u.addLangChainErrorFields)(e,"MODEL_NOT_FOUND"):e,t},r.formatToOpenAIAssistantTool=function(e){return{type:"function",function:{name:e.name,description:e.description,parameters:(0,a.isInteropZodSchema)(e.schema)?(0,s.toJsonSchema)(e.schema):e.schema}}},r.formatToOpenAIToolChoice=function(e){if(e){if("any"===e||"required"===e)return"required";if("auto"===e)return"auto";if("none"===e)return"none";else if("string"==typeof e)return{type:"function",function:{name:e}};else return e}},r.interopZodResponseFormat=function(e,t,r){if((0,a.isZodSchemaV3)(e))return(0,l.zodResponseFormat)(e,t,r);if((0,a.isZodSchemaV4)(e))return function(e,t){let r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),r}({type:"json_schema",json_schema:{...r,name:t,strict:!0,schema:(0,o.toJSONSchema)(e,{cycles:"ref",reused:"ref",override(e){e.jsonSchema.title=t}})}},t=>(0,o.parse)(e,JSON.parse(t)));throw Error("Unsupported schema response format")};let n=e.r(69871),i=e.r(42200);Object.defineProperty(r,"formatToOpenAIFunction",{enumerable:!0,get:function(){return i.convertToOpenAIFunction}}),Object.defineProperty(r,"formatToOpenAITool",{enumerable:!0,get:function(){return i.convertToOpenAITool}});let a=e.r(15225),s=e.r(63656),o=e.r(92491),l=e.r(25471),u=e.r(56285)},40931,(e,t,r)=>{"use strict";function n(e,t){let r=[];for(let[n,a]of Object.entries(e.properties??{}))a.description&&t<2&&r.push(`// ${a.description}`),e.required?.includes(n)?r.push(`${n}: ${i(a,t)},`):r.push(`${n}?: ${i(a,t)},`);return r.map(e=>" ".repeat(t)+e).join("\n")}function i(e,t){if(void 0!==e.anyOf&&Array.isArray(e.anyOf))return e.anyOf.map(e=>i(e,t)).join(" | ");switch(e.type){case"string":if(e.enum)return e.enum.map(e=>`"${e}"`).join(" | ");return"string";case"number":if(e.enum)return e.enum.map(e=>`${e}`).join(" | ");return"number";case"integer":if(e.enum)return e.enum.map(e=>`${e}`).join(" | ");return"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",n(e,t+2),"}"].join("\n");case"array":if(e.items)return`${i(e.items,t)}[]`;return"any[]";default:return""}}Object.defineProperty(r,"__esModule",{value:!0}),r.formatFunctionDefinitions=function(e){let t=["namespace functions {",""];for(let r of e)r.description&&t.push(`// ${r.description}`),Object.keys(r.parameters.properties??{}).length>0?(t.push(`type ${r.name} = (_: {`),t.push(n(r.parameters,0)),t.push("}) => any;")):t.push(`type ${r.name} = () => any;`),t.push("");return t.push("} // namespace functions"),t.join("\n")}},95010,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r._convertToOpenAITool=function(e,t){let r;return"function"===(r=(0,n.isLangChainTool)(e)?(0,i.formatToOpenAITool)(e):e).type&&t?.strict!==void 0&&(r.function.strict=t.strict),r},r.isBuiltInTool=function(e){return"type"in e&&"function"!==e.type&&"custom"!==e.type},r.isBuiltInToolChoice=function(e){return null!=e&&"object"==typeof e&&"type"in e&&"function"!==e.type},r.isCustomTool=function(e){return"object"==typeof e&&null!==e&&"metadata"in e&&"object"==typeof e.metadata&&null!==e.metadata&&"customTool"in e.metadata&&"object"==typeof e.metadata.customTool&&null!==e.metadata.customTool},r.isOpenAICustomTool=function(e){return"type"in e&&"custom"===e.type&&"custom"in e&&"object"==typeof e.custom&&null!==e.custom},r.parseCustomToolCall=function(e){if("custom_tool_call"===e.type)return{...e,type:"tool_call",call_id:e.id,id:e.call_id,name:e.name,isCustomTool:!0,args:{input:e.input}}},r.isCustomToolCall=function(e){return"tool_call"===e.type&&"isCustomTool"in e&&!0===e.isCustomTool},r.convertCompletionsCustomTool=function(e){return{type:"custom",name:e.custom.name,description:e.custom.description,format:(()=>{if(e.custom.format){if("grammar"===e.custom.format.type)return{type:"grammar",definition:e.custom.format.grammar.definition,syntax:e.custom.format.grammar.syntax};if("text"===e.custom.format.type)return{type:"text"}}})()}},r.convertResponsesCustomTool=function(e){return{type:"custom",custom:{name:e.name,description:e.description,format:(()=>{if(e.format){if("grammar"===e.format.type)return{type:"grammar",grammar:{definition:e.format.definition,syntax:e.format.syntax}};if("text"===e.format.type)return{type:"text"}}})()}}};let n=e.r(42200),i=e.r(57273)},84847,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.handleMultiModalOutput=function(e,t){return t&&"object"==typeof t&&"images"in t&&Array.isArray(t.images)?[{type:"text",text:e,source_type:"text"},...t.images.filter(e=>"string"==typeof e?.image_url?.url).map(e=>({type:"image",url:e.image_url.url,source_type:"url"}))]:e}},111,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChatOpenAI=r.ChatOpenAICompletions=r.ChatOpenAIResponses=r.BaseChatOpenAI=void 0,r.messageToOpenAIRole=w,r._convertMessagesToOpenAIParams=P;let n=e.r(69871),i=e.r(22991),a=e.r(24976),s=e.r(17549),o=e.r(11144),l=e.r(95435),u=e.r(78541),c=e.r(62421),d=e.r(69177),p=e.r(15225),h=e.r(63656),f=e.r(44766),m=e.r(57273),g=e.r(40931),y=e.r(95010),b=e.r(84847),_="__openai_function_call_ids__";function v(e){return!!e&&!!(/^o\d/.test(e??"")||e.startsWith("gpt-5")&&!e.startsWith("gpt-5-chat"))}function w(e){let t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":if(!i.ChatMessage.isInstance(e))throw Error("Invalid generic chat message");return"system"!==e.role&&"developer"!==e.role&&"assistant"!==e.role&&"user"!==e.role&&"function"!==e.role&&"tool"!==e.role&&console.warn(`Unknown message role: ${e.role}`),e.role;default:throw Error(`Unknown message type: ${t}`)}}let O={providerName:"ChatOpenAI",fromStandardTextBlock:e=>({type:"text",text:e.text}),fromStandardImageBlock(e){if("url"===e.source_type)return{type:"image_url",image_url:{url:e.url,...e.metadata?.detail?{detail:e.metadata.detail}:{}}};if("base64"===e.source_type)return{type:"image_url",image_url:{url:`data:${e.mime_type??""};base64,${e.data}`,...e.metadata?.detail?{detail:e.metadata.detail}:{}}};throw Error(`Image content blocks with source_type ${e.source_type} are not supported for ChatOpenAI`)},fromStandardAudioBlock(e){if("url"===e.source_type){let t,r=(0,i.parseBase64DataUrl)({dataUrl:e.url});if(!r)throw Error(`URL audio blocks with source_type ${e.source_type} must be formatted as a data URL for ChatOpenAI`);let n=r.mime_type||e.mime_type||"";try{t=(0,i.parseMimeType)(n)}catch{throw Error(`Audio blocks with source_type ${e.source_type} must have mime type of audio/wav or audio/mp3`)}if("audio"!==t.type||"wav"!==t.subtype&&"mp3"!==t.subtype)throw Error(`Audio blocks with source_type ${e.source_type} must have mime type of audio/wav or audio/mp3`);return{type:"input_audio",input_audio:{format:t.subtype,data:r.data}}}if("base64"===e.source_type){let t;try{t=(0,i.parseMimeType)(e.mime_type??"")}catch{throw Error(`Audio blocks with source_type ${e.source_type} must have mime type of audio/wav or audio/mp3`)}if("audio"!==t.type||"wav"!==t.subtype&&"mp3"!==t.subtype)throw Error(`Audio blocks with source_type ${e.source_type} must have mime type of audio/wav or audio/mp3`);return{type:"input_audio",input_audio:{format:t.subtype,data:e.data}}}throw Error(`Audio content blocks with source_type ${e.source_type} are not supported for ChatOpenAI`)},fromStandardFileBlock(e){if("url"===e.source_type){if(!(0,i.parseBase64DataUrl)({dataUrl:e.url}))throw Error(`URL file blocks with source_type ${e.source_type} must be formatted as a data URL for ChatOpenAI`);return{type:"file",file:{file_data:e.url,...e.metadata?.filename||e.metadata?.name?{filename:e.metadata?.filename||e.metadata?.name}:{}}}}if("base64"===e.source_type)return{type:"file",file:{file_data:`data:${e.mime_type??""};base64,${e.data}`,...e.metadata?.filename||e.metadata?.name||e.metadata?.title?{filename:e.metadata?.filename||e.metadata?.name||e.metadata?.title}:{}}};if("id"===e.source_type)return{type:"file",file:{file_id:e.id}};throw Error(`File content blocks with source_type ${e.source_type} are not supported for ChatOpenAI`)}};function P(e,t){return e.flatMap(e=>{let r=w(e);"system"===r&&v(t)&&(r="developer");let n={role:r,content:"string"==typeof e.content?e.content:e.content.map(e=>(0,i.isDataContentBlock)(e)?(0,i.convertToProviderContentBlock)(e,O):e)};return(null!=e.name&&(n.name=e.name),null!=e.additional_kwargs.function_call&&(n.function_call=e.additional_kwargs.function_call,n.content=""),(0,i.isAIMessage)(e)&&e.tool_calls?.length?(n.tool_calls=e.tool_calls.map(d.convertLangChainToolCallToOpenAI),n.content=""):(null!=e.additional_kwargs.tool_calls&&(n.tool_calls=e.additional_kwargs.tool_calls),null!=e.tool_call_id&&(n.tool_call_id=e.tool_call_id)),e.additional_kwargs.audio&&"object"==typeof e.additional_kwargs.audio&&"id"in e.additional_kwargs.audio)?[n,{role:"assistant",audio:{id:e.additional_kwargs.audio.id}}]:n})}class S extends o.BaseChatModel{_llmType(){return"openai"}static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning","reasoningEffort","service_tier"]}get lc_secrets(){return{apiKey:"OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{apiKey:"openai_api_key",modelName:"model",reasoningEffort:"reasoning_effort"}}get lc_serializable_keys(){return["configuration","logprobs","topLogprobs","prefixMessages","supportsStrictToolCalling","modalities","audio","temperature","maxTokens","topP","frequencyPenalty","presencePenalty","n","logitBias","user","streaming","streamUsage","model","modelName","modelKwargs","stop","stopSequences","timeout","apiKey","cache","maxConcurrency","maxRetries","verbose","callbacks","tags","metadata","disableStreaming","zdrEnabled","reasoning","reasoningEffort","promptCacheKey","verbosity"]}getLsParams(e){let t=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??void 0,ls_max_tokens:t.max_tokens??void 0,ls_stop:e.stop}}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}constructor(e){super(e??{}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoning",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"zdrEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"service_tier",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"promptCacheKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbosity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"defaultOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.apiKey=e?.apiKey??e?.configuration?.apiKey??(0,s.getEnvironmentVariable)("OPENAI_API_KEY"),this.organization=e?.configuration?.organization??(0,s.getEnvironmentVariable)("OPENAI_ORGANIZATION"),this.model=e?.model??e?.modelName??this.model,this.modelKwargs=e?.modelKwargs??{},this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.logprobs=e?.logprobs,this.topLogprobs=e?.topLogprobs,this.n=e?.n??this.n,this.logitBias=e?.logitBias,this.stop=e?.stopSequences??e?.stop,this.stopSequences=this.stop,this.user=e?.user,this.__includeRawResponse=e?.__includeRawResponse,this.audio=e?.audio,this.modalities=e?.modalities,this.reasoning=e?.reasoning??e?.reasoningEffort?{effort:e.reasoningEffort}:void 0,this.maxTokens=e?.maxCompletionTokens??e?.maxTokens,this.disableStreaming=e?.disableStreaming===!0,this.streaming=e?.streaming===!0,this.promptCacheKey=e?.promptCacheKey??this.promptCacheKey,this.verbosity=e?.verbosity??this.verbosity,e?.streaming===!1&&(this.disableStreaming=!0),!0===this.disableStreaming&&(this.streaming=!1),this.streamUsage=e?.streamUsage??this.streamUsage,this.disableStreaming&&(this.streamUsage=!1),this.clientConfig={apiKey:this.apiKey,organization:this.organization,dangerouslyAllowBrowser:!0,...e?.configuration},e?.supportsStrictToolCalling!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling),e?.service_tier!==void 0&&(this.service_tier=e.service_tier),this.zdrEnabled=e?.zdrEnabled??!1}_getReasoningParams(e){let t;if(v(this.model))return void 0!==this.reasoning&&(t={...t,...this.reasoning}),e?.reasoning!==void 0&&(t={...t,...e.reasoning}),t}_getResponseFormat(e){return e&&"json_schema"===e.type&&e.json_schema.schema&&(0,p.isInteropZodSchema)(e.json_schema.schema)?(0,m.interopZodResponseFormat)(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}_combineCallOptions(e){return{...this.defaultOptions,...e??{}}}_getClientOptions(e){if(!this.client){let e={baseURL:this.clientConfig.baseURL},t=(0,f.getEndpoint)(e),r={...this.clientConfig,baseURL:t,timeout:this.timeout,maxRetries:0};r.baseURL||delete r.baseURL,this.client=new n.OpenAI(r)}return{...this.clientConfig,...e}}_convertChatOpenAIToolToCompletionsTool(e,t){return(0,y.isCustomTool)(e)?(0,y.convertResponsesCustomTool)(e.metadata.customTool):(0,l.isOpenAITool)(e)?t?.strict!==void 0?{...e,function:{...e.function,strict:t.strict}}:e:(0,y._convertToOpenAITool)(e,t)}bindTools(e,t){let r;return t?.strict!==void 0?r=t.strict:void 0!==this.supportsStrictToolCalling&&(r=this.supportsStrictToolCalling),this.withConfig({tools:e.map(e=>(0,y.isBuiltInTool)(e)?e:this._convertChatOpenAIToolToCompletionsTool(e,{strict:r})),...t})}async stream(e,t){return super.stream(e,this._combineCallOptions(t))}async invoke(e,t){return super.invoke(e,this._combineCallOptions(t))}_combineLLMOutput(...e){return e.reduce((e,t)=>(t&&t.tokenUsage&&(e.tokenUsage.completionTokens+=t.tokenUsage.completionTokens??0,e.tokenUsage.promptTokens+=t.tokenUsage.promptTokens??0,e.tokenUsage.totalTokens+=t.tokenUsage.totalTokens??0),e),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}async getNumTokensFromMessages(e){let t=0,r=0,n=0;"gpt-3.5-turbo-0301"===this.model?(r=4,n=-1):(r=3,n=1);let i=await Promise.all(e.map(async e=>{let i=await this.getNumTokens(e.content),a=await this.getNumTokens(w(e)),s=void 0!==e.name?n+await this.getNumTokens(e.name):0,o=i+r+a+s;if("function"===e._getType()&&(o-=2),e.additional_kwargs?.function_call&&(o+=3),e?.additional_kwargs.function_call?.name&&(o+=await this.getNumTokens(e.additional_kwargs.function_call?.name)),e.additional_kwargs.function_call?.arguments)try{o+=await this.getNumTokens(JSON.stringify(JSON.parse(e.additional_kwargs.function_call?.arguments)))}catch(t){console.error("Error parsing function arguments",t,JSON.stringify(e.additional_kwargs.function_call)),o+=await this.getNumTokens(e.additional_kwargs.function_call?.arguments)}return t+=o,o}));return{totalCount:t+=3,countPerMessage:i}}async _getNumTokensFromGenerations(e){return(await Promise.all(e.map(async e=>e.message.additional_kwargs?.function_call?(await this.getNumTokensFromMessages([e.message])).countPerMessage[0]:await this.getNumTokens(e.message.content)))).reduce((e,t)=>e+t,0)}async _getEstimatedTokenCountFromPrompt(e,t,r){let n=(await this.getNumTokensFromMessages(e)).totalCount;if(t&&"auto"!==r){let e=(0,g.formatFunctionDefinitions)(t);n+=await this.getNumTokens(e),n+=9}return t&&e.find(e=>"system"===e._getType())&&(n-=4),"none"===r?n+=1:"object"==typeof r&&(n+=await this.getNumTokens(r.name)+4),n}_getStructuredOutputMethod(e){let t={...e};if(this.model.startsWith("gpt-3")||this.model.startsWith("gpt-4-")||"gpt-4"===this.model)"jsonSchema"===t.method&&console.warn(`[WARNING]: JSON Schema is not supported for model "${this.model}". Falling back to tool calling.`);else if(t?.method===void 0)return"jsonSchema";return t.method}withStructuredOutput(e,t){let r,n,i,a,s,o;if(void 0!==e&&"object"==typeof e.schema?(r=e.schema,n=e.name,i=e.method,a=e.includeRaw):(r=e,n=t?.name,i=t?.method,a=t?.includeRaw),t?.strict!==void 0&&"jsonMode"===i)throw Error("Argument `strict` is only supported for `method` = 'function_calling'");if("jsonMode"===(i=this._getStructuredOutputMethod({...t,method:i}))){o=(0,p.isInteropZodSchema)(r)?c.StructuredOutputParser.fromZodSchema(r):new c.JsonOutputParser;let e=(0,h.toJsonSchema)(r);s=this.withConfig({response_format:{type:"json_object"},ls_structured_output_format:{kwargs:{method:"json_mode"},schema:{title:n??"extract",...e}}})}else if("jsonSchema"===i){let e={name:n??"extract",description:(0,p.getSchemaDescription)(r),schema:r,strict:t?.strict},i=(0,h.toJsonSchema)(e.schema);if(s=this.withConfig({response_format:{type:"json_schema",json_schema:e},ls_structured_output_format:{kwargs:{method:"json_schema"},schema:{title:e.name,description:e.description,...i}}}),(0,p.isInteropZodSchema)(r)){let e=c.StructuredOutputParser.fromZodSchema(r);o=u.RunnableLambda.from(t=>"parsed"in t.additional_kwargs?t.additional_kwargs.parsed:e)}else o=new c.JsonOutputParser}else{let e=n??"extract";if((0,p.isInteropZodSchema)(r)){let n=(0,h.toJsonSchema)(r);s=this.withConfig({tools:[{type:"function",function:{name:e,description:n.description,parameters:n}}],tool_choice:{type:"function",function:{name:e}},ls_structured_output_format:{kwargs:{method:"function_calling"},schema:{title:e,...n}},...t?.strict!==void 0?{strict:t.strict}:{}}),o=new d.JsonOutputKeyToolsParser({returnSingle:!0,keyName:e,zodSchema:r})}else{let n;"string"==typeof r.name&&"object"==typeof r.parameters&&null!=r.parameters?(n=r,e=r.name):n={name:e=r.title??e,description:r.description??"",parameters:r};let i=(0,h.toJsonSchema)(r);s=this.withConfig({tools:[{type:"function",function:n}],tool_choice:{type:"function",function:{name:e}},ls_structured_output_format:{kwargs:{method:"function_calling"},schema:{title:e,...i}},...t?.strict!==void 0?{strict:t.strict}:{}}),o=new d.JsonOutputKeyToolsParser({returnSingle:!0,keyName:e})}}if(!a)return s.pipe(o);let l=u.RunnablePassthrough.assign({parsed:(e,t)=>o.invoke(e.raw,t)}),f=u.RunnablePassthrough.assign({parsed:()=>null}),m=l.withFallbacks({fallbacks:[f]});return u.RunnableSequence.from([{raw:s},m])}}r.BaseChatOpenAI=S;class E extends S{invocationParams(e){let t;e?.strict!==void 0?t=e.strict:void 0!==this.supportsStrictToolCalling&&(t=this.supportsStrictToolCalling);let r={model:this.model,temperature:this.temperature,top_p:this.topP,user:this.user,stream:this.streaming,previous_response_id:e?.previous_response_id,truncation:e?.truncation,include:e?.include,tools:e?.tools?.length?this._reduceChatOpenAITools(e.tools,{stream:this.streaming,strict:t}):void 0,tool_choice:(0,y.isBuiltInToolChoice)(e?.tool_choice)?e?.tool_choice:(()=>{let t=(0,m.formatToOpenAIToolChoice)(e?.tool_choice);if("object"==typeof t&&"type"in t){if("function"===t.type)return{type:"function",name:t.function.name};else if("allowed_tools"===t.type)return{type:"allowed_tools",mode:t.allowed_tools.mode,tools:t.allowed_tools.tools};else if("custom"===t.type)return{type:"custom",name:t.custom.name}}})(),text:(()=>{if(e?.text)return e.text;let t=this._getResponseFormat(e?.response_format);return t?.type==="json_schema"?null!=t.json_schema.schema?{format:{type:"json_schema",schema:t.json_schema.schema,description:t.json_schema.description,name:t.json_schema.name,strict:t.json_schema.strict},verbosity:e?.verbosity}:void 0:{format:t,verbosity:e?.verbosity}})(),parallel_tool_calls:e?.parallel_tool_calls,max_output_tokens:-1===this.maxTokens?void 0:this.maxTokens,prompt_cache_key:e?.promptCacheKey??this.promptCacheKey,...this.zdrEnabled?{store:!1}:{},...this.modelKwargs},n=this._getReasoningParams(e);return void 0!==n&&(r.reasoning=n),r}async _generate(e,t){let r=this.invocationParams(t);if(r.stream){let r;for await(let n of this._streamResponseChunks(e,t))n.message.response_metadata={...n.generationInfo,...n.message.response_metadata},r=r?.concat(n)??n;return{generations:r?[r]:[],llmOutput:{estimatedTokenUsage:r?.message?.usage_metadata}}}{let n=this._convertMessagesToResponsesParams(e),i=await this.completionWithRetry({input:n,...r,stream:!1},{signal:t?.signal,...t?.options});return{generations:[{text:i.output_text,message:this._convertResponsesMessageToBaseMessage(i)}],llmOutput:{id:i.id,estimatedTokenUsage:i.usage?{promptTokens:i.usage.input_tokens,completionTokens:i.usage.output_tokens,totalTokens:i.usage.total_tokens}:void 0}}}}async *_streamResponseChunks(e,t,r){for await(let n of(await this.completionWithRetry({...this.invocationParams(t),input:this._convertMessagesToResponsesParams(e),stream:!0},t))){let e=this._convertResponsesDeltaToBaseMessageChunk(n);null!=e&&(yield e,await r?.handleLLMNewToken(e.text||"",{prompt:t.promptIndex??0,completion:0},void 0,void 0,void 0,{chunk:e}))}}async completionWithRetry(e,t){return this.caller.call(async()=>{let r=this._getClientOptions(t);try{if(e.text?.format?.type==="json_schema"&&!e.stream)return await this.client.responses.parse(e,r);return await this.client.responses.create(e,r)}catch(e){throw(0,m.wrapOpenAIClientError)(e)}})}_convertResponsesMessageToBaseMessage(e){let t;if(e.error){let t=Error(e.error.message);throw t.name=e.error.code,t}let r=[],n=[],a=[],s={model:e.model,created_at:e.created_at,id:e.id,incomplete_details:e.incomplete_details,metadata:e.metadata,object:e.object,status:e.status,user:e.user,service_tier:e.service_tier,model_name:e.model},o={};for(let i of e.output)if("message"===i.type)t=i.id,r.push(...i.content.flatMap(e=>"output_text"===e.type?("parsed"in e&&null!=e.parsed&&(o.parsed=e.parsed),{type:"text",text:e.text,annotations:e.annotations}):"refusal"===e.type?(o.refusal=e.refusal,[]):e));else if("function_call"===i.type){let e={function:{name:i.name,arguments:i.arguments},id:i.call_id};try{n.push((0,d.parseToolCall)(e,{returnId:!0}))}catch(r){let t;"object"==typeof r&&null!=r&&"message"in r&&"string"==typeof r.message&&(t=r.message),a.push((0,d.makeInvalidToolCall)(e,t))}o[_]??={},i.id&&(o[_][i.call_id]=i.id)}else if("reasoning"===i.type)o.reasoning=i;else if("custom_tool_call"===i.type){let e=(0,y.parseCustomToolCall)(i);e?n.push(e):a.push((0,d.makeInvalidToolCall)(i,"Malformed custom tool call"))}else o.tool_outputs??=[],o.tool_outputs.push(i);return new i.AIMessage({id:t,content:r,tool_calls:n,invalid_tool_calls:a,usage_metadata:e.usage,additional_kwargs:o,response_metadata:s})}_convertResponsesDeltaToBaseMessageChunk(e){let t,r,n=[],s={},o=[],l={},u={};if("response.output_text.delta"===e.type)n.push({type:"text",text:e.delta,index:e.content_index});else if("response.output_text.annotation.added"===e.type)n.push({type:"text",text:"",annotations:[e.annotation],index:e.content_index});else if("response.output_item.added"===e.type&&"message"===e.item.type)r=e.item.id;else if("response.output_item.added"===e.type&&"function_call"===e.item.type)o.push({type:"tool_call_chunk",name:e.item.name,args:e.item.arguments,id:e.item.call_id,index:e.output_index}),u[_]={[e.item.call_id]:e.item.id};else if("response.output_item.done"===e.type&&["web_search_call","file_search_call","computer_call","code_interpreter_call","mcp_call","mcp_list_tools","mcp_approval_request","image_generation_call","custom_tool_call"].includes(e.item.type))u.tool_outputs=[e.item];else if("response.created"===e.type)l.id=e.response.id,l.model_name=e.response.model,l.model=e.response.model;else if("response.completed"===e.type){let r=this._convertResponsesMessageToBaseMessage(e.response);for(let[n,i]of(t=e.response.usage,e.response.text?.format?.type==="json_schema"&&(u.parsed??=JSON.parse(r.text)),Object.entries(e.response)))"id"!==n&&(l[n]=i)}else if("response.function_call_arguments.delta"===e.type||"response.custom_tool_call_input.delta"===e.type)o.push({type:"tool_call_chunk",args:e.delta,index:e.output_index});else if("response.web_search_call.completed"===e.type||"response.file_search_call.completed"===e.type)s={tool_outputs:{id:e.item_id,type:e.type.replace("response.","").replace(".completed",""),status:"completed"}};else if("response.refusal.done"===e.type)u.refusal=e.refusal;else if("response.output_item.added"===e.type&&"item"in e&&"reasoning"===e.item.type){let t=e.item.summary?e.item.summary.map((e,t)=>({...e,index:t})):void 0;u.reasoning={id:e.item.id,type:e.item.type,...t?{summary:t}:{}}}else if("response.reasoning_summary_part.added"===e.type)u.reasoning={type:"reasoning",summary:[{...e.part,index:e.summary_index}]};else if("response.reasoning_summary_text.delta"===e.type)u.reasoning={type:"reasoning",summary:[{text:e.delta,type:"summary_text",index:e.summary_index}]};else if("response.image_generation_call.partial_image"===e.type)return null;else return null;return new a.ChatGenerationChunk({text:n.map(e=>e.text).join(""),message:new i.AIMessageChunk({id:r,content:n,tool_call_chunks:o,usage_metadata:t,additional_kwargs:u,response_metadata:l}),generationInfo:s})}_convertMessagesToResponsesParams(e){return e.flatMap(e=>{let t=e.additional_kwargs,r=w(e);if("system"===r&&v(this.model)&&(r="developer"),"function"===r)throw Error("Function messages are not supported in Responses API");if("tool"===r)return t?.type==="computer_call_output"?{type:"computer_call_output",output:(()=>{if("string"==typeof e.content)return{type:"computer_screenshot",image_url:e.content};if(Array.isArray(e.content)){let t=e.content.find(e=>"computer_screenshot"===e.type);if(t)return t;let r=e.content.find(e=>"image_url"===e.type);if(r)return{type:"computer_screenshot",image_url:"string"==typeof r.image_url?r.image_url:r.image_url.url}}throw Error("Invalid computer call output")})(),call_id:e.tool_call_id}:e.metadata?.customTool?{type:"custom_tool_call_output",call_id:e.tool_call_id,output:e.content}:{type:"function_call_output",call_id:e.tool_call_id,id:e.id?.startsWith("fc_")?e.id:void 0,output:"string"!=typeof e.content?JSON.stringify(e.content):e.content};if("assistant"===r){if(!this.zdrEnabled&&null!=e.response_metadata.output&&Array.isArray(e.response_metadata.output)&&e.response_metadata.output.length>0&&e.response_metadata.output.every(e=>"type"in e))return e.response_metadata.output;let r=[];if(t?.reasoning&&!this.zdrEnabled){let e=this._convertReasoningSummary(t.reasoning);r.push(e)}let{content:n}=e;t?.refusal&&("string"==typeof n&&(n=[{type:"output_text",text:n,annotations:[]}]),n=[...n,{type:"refusal",refusal:t.refusal}]),("string"==typeof n||n.length>0)&&r.push({type:"message",role:"assistant",...e.id&&!this.zdrEnabled&&e.id.startsWith("msg_")?{id:e.id}:{},content:"string"==typeof n?n:n.flatMap(e=>"text"===e.type?{type:"output_text",text:e.text,annotations:e.annotations??[]}:"output_text"===e.type||"refusal"===e.type?e:[])});let a=t?.[_];(0,i.isAIMessage)(e)&&e.tool_calls?.length?r.push(...e.tool_calls.map(e=>(0,y.isCustomToolCall)(e)?{type:"custom_tool_call",id:e.call_id,call_id:e.id??"",input:e.args.input,name:e.name}:{type:"function_call",name:e.name,arguments:JSON.stringify(e.args),call_id:e.id,...this.zdrEnabled?{id:a?.[e.id]}:{}})):t?.tool_calls&&r.push(...t.tool_calls.map(e=>({type:"function_call",name:e.function.name,call_id:e.id,arguments:e.function.arguments,...this.zdrEnabled?{id:a?.[e.id]}:{}})));let s=e.response_metadata.output?.length?e.response_metadata.output:t.tool_outputs,o=["computer_call","mcp_call","code_interpreter_call","image_generation_call"];if(null!=s){let e=s?.filter(e=>o.includes(e.type));e.length>0&&r.push(...e)}return r}if("user"===r||"system"===r||"developer"===r){if("string"==typeof e.content)return{type:"message",role:r,content:e.content};let t=[],n=e.content.flatMap(e=>("mcp_approval_response"===e.type&&t.push({type:"mcp_approval_response",approval_request_id:e.approval_request_id,approve:e.approve}),(0,i.isDataContentBlock)(e))?(0,i.convertToProviderContentBlock)(e,O):"text"===e.type?{type:"input_text",text:e.text}:"image_url"===e.type?{type:"input_image",image_url:"string"==typeof e.image_url?e.image_url:e.image_url.url,detail:"string"==typeof e.image_url?"auto":e.image_url.detail}:"input_text"===e.type||"input_image"===e.type||"input_file"===e.type?e:[]);return n.length>0&&t.push({type:"message",role:r,content:n}),t}return console.warn(`Unsupported role found when converting to OpenAI Responses API: ${r}`),[]})}_convertReasoningSummary(e){let t=(e.summary.length>1?e.summary.reduce((e,t)=>{let r=e.at(-1);return r.index===t.index?r.text+=t.text:e.push(t),e},[{...e.summary[0]}]):e.summary).map(e=>Object.fromEntries(Object.entries(e).filter(([e])=>"index"!==e)));return{...e,summary:t}}_reduceChatOpenAITools(e,t){let r=[];for(let n of e)(0,y.isBuiltInTool)(n)?("image_generation"===n.type&&t?.stream&&(n.partial_images=1),r.push(n)):(0,l.isOpenAITool)(n)?r.push({type:"function",name:n.function.name,parameters:n.function.parameters,description:n.function.description,strict:t?.strict??null}):(0,y.isOpenAICustomTool)(n)&&r.push((0,y.convertCompletionsCustomTool)(n));return r}}r.ChatOpenAIResponses=E;class k extends S{invocationParams(e,t){let r;e?.strict!==void 0?r=e.strict:void 0!==this.supportsStrictToolCalling&&(r=this.supportsStrictToolCalling);let n={};e?.stream_options!==void 0?n={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||t?.streaming)&&(n={stream_options:{include_usage:!0}});let i={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:e?.stop??this.stopSequences,user:this.user,stream:this.streaming,functions:e?.functions,function_call:e?.function_call,tools:e?.tools?.length?e.tools.map(e=>this._convertChatOpenAIToolToCompletionsTool(e,{strict:r})):void 0,tool_choice:(0,m.formatToOpenAIToolChoice)(e?.tool_choice),response_format:this._getResponseFormat(e?.response_format),seed:e?.seed,...n,parallel_tool_calls:e?.parallel_tool_calls,...this.audio||e?.audio?{audio:this.audio||e?.audio}:{},...this.modalities||e?.modalities?{modalities:this.modalities||e?.modalities}:{},...this.modelKwargs,prompt_cache_key:e?.promptCacheKey??this.promptCacheKey,verbosity:e?.verbosity??this.verbosity};e?.prediction!==void 0&&(i.prediction=e.prediction),void 0!==this.service_tier&&(i.service_tier=this.service_tier),e?.service_tier!==void 0&&(i.service_tier=e.service_tier);let a=this._getReasoningParams(e);return void 0!==a&&void 0!==a.effort&&(i.reasoning_effort=a.effort),v(i.model)?i.max_completion_tokens=-1===this.maxTokens?void 0:this.maxTokens:i.max_tokens=-1===this.maxTokens?void 0:this.maxTokens,i}async _generate(e,t,r){let n={},a=this.invocationParams(t),s=P(e,this.model);if(a.stream){let i=this._streamResponseChunks(e,t,r),a={};for await(let e of i){e.message.response_metadata={...e.generationInfo,...e.message.response_metadata};let t=e.generationInfo?.completion??0;void 0===a[t]?a[t]=e:a[t]=a[t].concat(e)}let s=Object.entries(a).sort(([e],[t])=>parseInt(e,10)-parseInt(t,10)).map(([e,t])=>t),{functions:o,function_call:l}=this.invocationParams(t),u=await this._getEstimatedTokenCountFromPrompt(e,o,l),c=await this._getNumTokensFromGenerations(s);return n.input_tokens=u,n.output_tokens=c,n.total_tokens=u+c,{generations:s,llmOutput:{estimatedTokenUsage:{promptTokens:n.input_tokens,completionTokens:n.output_tokens,totalTokens:n.total_tokens}}}}{let e=await this.completionWithRetry({...a,stream:!1,messages:s},{signal:t?.signal,...t?.options}),{completion_tokens:r,prompt_tokens:o,total_tokens:l,prompt_tokens_details:u,completion_tokens_details:c}=e?.usage??{};r&&(n.output_tokens=(n.output_tokens??0)+r),o&&(n.input_tokens=(n.input_tokens??0)+o),l&&(n.total_tokens=(n.total_tokens??0)+l),(u?.audio_tokens!==null||u?.cached_tokens!==null)&&(n.input_token_details={...u?.audio_tokens!==null&&{audio:u?.audio_tokens},...u?.cached_tokens!==null&&{cache_read:u?.cached_tokens}}),(c?.audio_tokens!==null||c?.reasoning_tokens!==null)&&(n.output_token_details={...c?.audio_tokens!==null&&{audio:c?.audio_tokens},...c?.reasoning_tokens!==null&&{reasoning:c?.reasoning_tokens}});let d=[];for(let t of e?.choices??[]){let r={text:t.message?.content??"",message:this._convertCompletionsMessageToBaseMessage(t.message??{role:"assistant"},e)};r.generationInfo={...t.finish_reason?{finish_reason:t.finish_reason}:{},...t.logprobs?{logprobs:t.logprobs}:{}},(0,i.isAIMessage)(r.message)&&(r.message.usage_metadata=n),r.message=new i.AIMessage(Object.fromEntries(Object.entries(r.message).filter(([e])=>!e.startsWith("lc_")))),d.push(r)}return{generations:d,llmOutput:{tokenUsage:{promptTokens:n.input_tokens,completionTokens:n.output_tokens,totalTokens:n.total_tokens}}}}}async *_streamResponseChunks(e,t,r){let n,s,o=P(e,this.model),l={...this.invocationParams(t,{streaming:!0}),messages:o,stream:!0};for await(let e of(await this.completionWithRetry(l,t))){let i=e?.choices?.[0];if(e.usage&&(s=e.usage),!i)continue;let{delta:o}=i;if(!o)continue;let l=this._convertCompletionsDeltaToBaseMessageChunk(o,e,n);n=o.role??n;let u={prompt:t.promptIndex??0,completion:i.index??0};if("string"!=typeof l.content){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}let c={...u};null!=i.finish_reason&&(c.finish_reason=i.finish_reason,c.system_fingerprint=e.system_fingerprint,c.model_name=e.model,c.service_tier=e.service_tier),this.logprobs&&(c.logprobs=i.logprobs);let d=new a.ChatGenerationChunk({message:l,text:l.content,generationInfo:c});yield d,await r?.handleLLMNewToken(d.text??"",u,void 0,void 0,void 0,{chunk:d})}if(s){let e={...s.prompt_tokens_details?.audio_tokens!==null&&{audio:s.prompt_tokens_details?.audio_tokens},...s.prompt_tokens_details?.cached_tokens!==null&&{cache_read:s.prompt_tokens_details?.cached_tokens}},t={...s.completion_tokens_details?.audio_tokens!==null&&{audio:s.completion_tokens_details?.audio_tokens},...s.completion_tokens_details?.reasoning_tokens!==null&&{reasoning:s.completion_tokens_details?.reasoning_tokens}},r=new a.ChatGenerationChunk({message:new i.AIMessageChunk({content:"",response_metadata:{usage:{...s}},usage_metadata:{input_tokens:s.prompt_tokens,output_tokens:s.completion_tokens,total_tokens:s.total_tokens,...Object.keys(e).length>0&&{input_token_details:e},...Object.keys(t).length>0&&{output_token_details:t}}}),text:""});yield r}if(t.signal?.aborted)throw Error("AbortError")}async completionWithRetry(e,t){let r=this._getClientOptions(t),n=e.response_format&&"json_schema"===e.response_format.type;return this.caller.call(async()=>{try{if(n&&!e.stream)return await this.client.chat.completions.parse(e,r);return await this.client.chat.completions.create(e,r)}catch(e){throw(0,m.wrapOpenAIClientError)(e)}})}_convertCompletionsMessageToBaseMessage(e,t){let r=e.tool_calls;if("assistant"!==e.role)return new i.ChatMessage(e.content||"",e.role??"unknown");{let n=[],a=[];for(let e of r??[])try{n.push((0,d.parseToolCall)(e,{returnId:!0}))}catch(t){a.push((0,d.makeInvalidToolCall)(e,t.message))}let s={function_call:e.function_call,tool_calls:r};void 0!==this.__includeRawResponse&&(s.__raw_response=t);let o={model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};e.audio&&(s.audio=e.audio);let l=(0,b.handleMultiModalOutput)(e.content||"",t.choices?.[0]?.message);return new i.AIMessage({content:l,tool_calls:n,invalid_tool_calls:a,additional_kwargs:s,response_metadata:o,id:t.id})}}_convertCompletionsDeltaToBaseMessageChunk(e,t,r){let n,a=e.role??r,s=e.content??"";n=e.function_call?{function_call:e.function_call}:e.tool_calls?{tool_calls:e.tool_calls}:{},this.__includeRawResponse&&(n.__raw_response=t),e.audio&&(n.audio={...e.audio,index:t.choices[0].index});let o={usage:{...t.usage}};if("user"===a)return new i.HumanMessageChunk({content:s,response_metadata:o});if("assistant"===a){let r=[];if(Array.isArray(e.tool_calls))for(let t of e.tool_calls)r.push({name:t.function?.name,args:t.function?.arguments,id:t.id,index:t.index,type:"tool_call_chunk"});return new i.AIMessageChunk({content:s,tool_call_chunks:r,additional_kwargs:n,id:t.id,response_metadata:o})}if("system"===a)return new i.SystemMessageChunk({content:s,response_metadata:o});if("developer"===a)return new i.SystemMessageChunk({content:s,response_metadata:o,additional_kwargs:{__openai_role__:"developer"}});if("function"===a)return new i.FunctionMessageChunk({content:s,additional_kwargs:n,name:e.name,response_metadata:o});else if("tool"===a)return new i.ToolMessageChunk({content:s,additional_kwargs:n,tool_call_id:e.tool_call_id,response_metadata:o});else return new i.ChatMessageChunk({content:s,role:a,response_metadata:o})}}r.ChatOpenAICompletions=k;class I extends S{get lc_serializable_keys(){return[...super.lc_serializable_keys,"useResponsesApi"]}constructor(e){super(e),Object.defineProperty(this,"fields",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"useResponsesApi",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"responses",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"completions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.useResponsesApi=e?.useResponsesApi??!1,this.responses=e?.responses??new E(e),this.completions=e?.completions??new k(e)}_useResponsesApi(e){let t=e?.tools?.some(y.isBuiltInTool),r=e?.previous_response_id!=null||e?.text!=null||e?.truncation!=null||e?.include!=null||e?.reasoning?.summary!=null||this.reasoning?.summary!=null,n=e?.tools?.some(y.isOpenAICustomTool);return this.useResponsesApi||t||r||n}getLsParams(e){let t=this._combineCallOptions(e);return this._useResponsesApi(e)?this.responses.getLsParams(t):this.completions.getLsParams(t)}invocationParams(e){let t=this._combineCallOptions(e);return this._useResponsesApi(e)?this.responses.invocationParams(t):this.completions.invocationParams(t)}async _generate(e,t,r){return this._useResponsesApi(t)?this.responses._generate(e,t):this.completions._generate(e,t,r)}async *_streamResponseChunks(e,t,r){if(this._useResponsesApi(t))return void(yield*this.responses._streamResponseChunks(e,this._combineCallOptions(t),r));yield*this.completions._streamResponseChunks(e,this._combineCallOptions(t),r)}withConfig(e){let t=new I(this.fields);return t.defaultOptions={...this.defaultOptions,...e},t}}r.ChatOpenAI=I},21890,(e,t,r)=>{"use strict";function n(e){return"undefined"!=typeof Headers&&null!==e&&"object"==typeof e&&"[object Headers]"===Object.prototype.toString.call(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.isHeaders=n,r.normalizeHeaders=function(e){return Object.fromEntries((n(e)?e:Array.isArray(e)?new Headers(e):"object"==typeof e&&null!==e&&"values"in e&&n(e.values)?e.values:"object"==typeof e&&null!==e?new Headers(Object.entries(e).filter(([,e])=>"string"==typeof e).map(([e,t])=>[e,t])):new Headers).entries())}},57219,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AzureChatOpenAI=void 0;let n=e.r(69871),i=e.r(17549),a=e.r(111),s=e.r(44766),o=e.r(21890),l={openAIApiKey:"openai_api_key",openAIApiVersion:"openai_api_version",openAIBasePath:"openai_api_base",deploymentName:"deployment_name",azureOpenAIEndpoint:"azure_endpoint",azureOpenAIApiVersion:"openai_api_version",azureOpenAIBasePath:"openai_api_base",azureOpenAIApiDeploymentName:"deployment_name"},u={azureOpenAIApiKey:"AZURE_OPENAI_API_KEY"},c=["azureOpenAIApiKey","azureOpenAIApiVersion","azureOpenAIBasePath","azureOpenAIEndpoint","azureOpenAIApiInstanceName","azureOpenAIApiDeploymentName","deploymentName","openAIApiKey","openAIApiVersion"];function d(e){if(this.azureOpenAIApiKey=e?.azureOpenAIApiKey??e?.openAIApiKey??e?.apiKey??(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_KEY"),this.azureOpenAIApiInstanceName=e?.azureOpenAIApiInstanceName??(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=e?.azureOpenAIApiDeploymentName??e?.deploymentName??(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=e?.azureOpenAIApiVersion??e?.openAIApiVersion??(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=e?.azureOpenAIBasePath??(0,i.getEnvironmentVariable)("AZURE_OPENAI_BASE_PATH"),this.azureOpenAIEndpoint=e?.azureOpenAIEndpoint??(0,i.getEnvironmentVariable)("AZURE_OPENAI_ENDPOINT"),this.azureADTokenProvider=e?.azureADTokenProvider,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw Error("Azure OpenAI API key or Token Provider not found")}function p(e){if(!this.client){let e={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,azureADTokenProvider:this.azureADTokenProvider,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},t=(0,s.getEndpoint)(e),r={...this.clientConfig,baseURL:t,timeout:this.timeout,maxRetries:0};this.azureADTokenProvider||(r.apiKey=e.azureOpenAIApiKey),r.baseURL||delete r.baseURL;let a=(0,i.getEnv)();("node"===a||"deno"===a)&&(a=`(${a}/${process.version}; ${process.platform}; ${process.arch})`);let l=(0,o.normalizeHeaders)(r.defaultHeaders);r.defaultHeaders={...r.defaultHeaders,"User-Agent":l["User-Agent"]?`langchainjs-azure-openai/2.0.0 (${a})${l["User-Agent"]}`:`langchainjs-azure-openai/2.0.0 (${a})`},this.client=new n.AzureOpenAI({apiVersion:this.azureOpenAIApiVersion,azureADTokenProvider:this.azureADTokenProvider,deployment:this.azureOpenAIApiDeploymentName,...r})}let t={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.query={"api-version":this.azureOpenAIApiVersion,...t.query}),t}function h(e){function t(e){return"object"==typeof e&&null!=e}if(t(e)&&t(e.kwargs)){if(delete e.kwargs.azure_openai_base_path,delete e.kwargs.azure_openai_api_deployment_name,delete e.kwargs.azure_openai_api_key,delete e.kwargs.azure_openai_api_version,delete e.kwargs.azure_open_ai_base_path,!e.kwargs.azure_endpoint&&this.azureOpenAIEndpoint&&(e.kwargs.azure_endpoint=this.azureOpenAIEndpoint),!e.kwargs.azure_endpoint&&this.azureOpenAIBasePath){let t=this.azureOpenAIBasePath.split("/openai/deployments/");if(2===t.length&&t[0].startsWith("http")){let[r]=t;e.kwargs.azure_endpoint=r}}if(!e.kwargs.azure_endpoint&&this.azureOpenAIApiInstanceName&&(e.kwargs.azure_endpoint=`https://${this.azureOpenAIApiInstanceName}.openai.azure.com/`),!e.kwargs.deployment_name&&this.azureOpenAIApiDeploymentName&&(e.kwargs.deployment_name=this.azureOpenAIApiDeploymentName),!e.kwargs.deployment_name&&this.azureOpenAIBasePath){let t=this.azureOpenAIBasePath.split("/openai/deployments/");if(2===t.length){let[,r]=t;e.kwargs.deployment_name=r}}e.kwargs.azure_endpoint&&e.kwargs.deployment_name&&e.kwargs.openai_api_base&&delete e.kwargs.openai_api_base,e.kwargs.azure_openai_api_instance_name&&e.kwargs.azure_endpoint&&delete e.kwargs.azure_openai_api_instance_name}return e}class f extends a.ChatOpenAIResponses{_llmType(){return"azure_openai"}get lc_aliases(){return{...super.lc_aliases,...l}}get lc_secrets(){return{...super.lc_secrets,...u}}get lc_serializable_keys(){return[...super.lc_serializable_keys,...c]}getLsParams(e){let t=super.getLsParams(e);return t.ls_provider="azure",t}constructor(e){super(e),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),d.call(this,e)}_getClientOptions(e){return p.call(this,e)}toJSON(){return h.call(this,super.toJSON())}}class m extends a.ChatOpenAICompletions{_llmType(){return"azure_openai"}get lc_aliases(){return{...super.lc_aliases,...l}}get lc_secrets(){return{...super.lc_secrets,...u}}get lc_serializable_keys(){return[...super.lc_serializable_keys,...c]}getLsParams(e){let t=super.getLsParams(e);return t.ls_provider="azure",t}constructor(e){super(e),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),d.call(this,e)}_getClientOptions(e){return p.call(this,e)}toJSON(){return h.call(this,super.toJSON())}}class g extends a.ChatOpenAI{_llmType(){return"azure_openai"}get lc_aliases(){return{...super.lc_aliases,...l}}get lc_secrets(){return{...super.lc_secrets,...u}}get lc_serializable_keys(){return[...super.lc_serializable_keys,...c]}getLsParams(e){let t=super.getLsParams(e);return t.ls_provider="azure",t}constructor(e){super({...e,completions:new m(e),responses:new f(e)}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),d.call(this,e)}_getStructuredOutputMethod(e){let t={...e};return this.model.startsWith("gpt-4o")&&t?.method===void 0?"functionCalling":super._getStructuredOutputMethod(t)}toJSON(){return h.call(this,super.toJSON())}}r.AzureChatOpenAI=g},37092,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.chunkArray=void 0,r.chunkArray=(e,t)=>e.reduce((e,r,n)=>{let i=Math.floor(n/t),a=e[i]||[];return e[i]=a.concat([r]),e},[])},16511,(e,t,r)=>{t.exports=e.r(37092)},69931,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.OpenAI=void 0;let n=e.r(69871),i=e.r(95435),a=e.r(24976),s=e.r(17549),o=e.r(39280),l=e.r(16511),u=e.r(44766),c=e.r(57273);class d extends o.BaseLLM{static lc_name(){return"OpenAI"}get callKeys(){return[...super.callKeys,"options"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key"}}constructor(e){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"bestOf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo-instruct"}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=e?.apiKey??e?.openAIApiKey??(0,s.getEnvironmentVariable)("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.organization=e?.configuration?.organization??(0,s.getEnvironmentVariable)("OPENAI_ORGANIZATION"),this.model=e?.model??e?.modelName??this.model,(this.model?.startsWith("gpt-3.5-turbo")||this.model?.startsWith("gpt-4")||this.model?.startsWith("o1"))&&!this.model?.includes("-instruct"))throw Error(`Your chosen OpenAI model, "${this.model}", is a chat model and not a text-in/text-out LLM.
Passing it into the "OpenAI" class is no longer supported.
Please use the "ChatOpenAI" class instead.

See this page for more information:
|
â””> https://js.langchain.com/docs/integrations/chat/openai`);if(this.modelName=this.model,this.modelKwargs=e?.modelKwargs??{},this.batchSize=e?.batchSize??this.batchSize,this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.maxTokens=e?.maxTokens??this.maxTokens,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.n=e?.n??this.n,this.bestOf=e?.bestOf??this.bestOf,this.logitBias=e?.logitBias,this.stop=e?.stopSequences??e?.stop,this.stopSequences=this.stop,this.user=e?.user,this.streaming=e?.streaming??!1,this.streaming&&this.bestOf&&this.bestOf>1)throw Error("Cannot stream results when bestOf > 1");this.clientConfig={apiKey:this.apiKey,organization:this.organization,dangerouslyAllowBrowser:!0,...e?.configuration}}invocationParams(e){return{model:this.model,temperature:this.temperature,max_tokens:this.maxTokens,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,best_of:this.bestOf,logit_bias:this.logitBias,stop:e?.stop??this.stopSequences,user:this.user,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}async _generate(e,t,r){let n=(0,l.chunkArray)(e,this.batchSize),a=[],s={},o=this.invocationParams(t);if(-1===o.max_tokens){if(1!==e.length)throw Error("max_tokens set to -1 not supported for multiple inputs");o.max_tokens=await (0,i.calculateMaxTokens)({prompt:e[0],modelName:this.model})}for(let e=0;e<n.length;e+=1){let i=o.stream?await (async()=>{let i,a=[];for await(let s of(await this.completionWithRetry({...o,stream:!0,prompt:n[e]},t)))for(let e of(i||(i={id:s.id,object:s.object,created:s.created,model:s.model}),s.choices)){if(a[e.index]){let t=a[e.index];t.text+=e.text,t.finish_reason=e.finish_reason,t.logprobs=e.logprobs}else a[e.index]=e;r?.handleLLMNewToken(e.text,{prompt:Math.floor(e.index/this.n),completion:e.index%this.n})}if(t.signal?.aborted)throw Error("AbortError");return{...i,choices:a}})():await this.completionWithRetry({...o,stream:!1,prompt:n[e]},{signal:t.signal,...t.options});a.push(...i.choices);let{completion_tokens:l,prompt_tokens:u,total_tokens:c}=i.usage?i.usage:{completion_tokens:void 0,prompt_tokens:void 0,total_tokens:void 0};l&&(s.completionTokens=(s.completionTokens??0)+l),u&&(s.promptTokens=(s.promptTokens??0)+u),c&&(s.totalTokens=(s.totalTokens??0)+c)}return{generations:(0,l.chunkArray)(a,this.n).map(e=>e.map(e=>({text:e.text??"",generationInfo:{finishReason:e.finish_reason,logprobs:e.logprobs}}))),llmOutput:{tokenUsage:s}}}async *_streamResponseChunks(e,t,r){let n={...this.invocationParams(t),prompt:e,stream:!0};for await(let e of(await this.completionWithRetry(n,t))){let t=e?.choices[0];if(!t)continue;let n=new a.GenerationChunk({text:t.text,generationInfo:{finishReason:t.finish_reason}});yield n,r?.handleLLMNewToken(n.text??"")}if(t.signal?.aborted)throw Error("AbortError")}async completionWithRetry(e,t){let r=this._getClientOptions(t);return this.caller.call(async()=>{try{return await this.client.completions.create(e,r)}catch(e){throw(0,c.wrapOpenAIClientError)(e)}})}_getClientOptions(e){if(!this.client){let e={baseURL:this.clientConfig.baseURL},t=(0,u.getEndpoint)(e),r={...this.clientConfig,baseURL:t,timeout:this.timeout,maxRetries:0};r.baseURL||delete r.baseURL,this.client=new n.OpenAI(r)}return{...this.clientConfig,...e}}_llmType(){return"openai"}}r.OpenAI=d},26391,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AzureOpenAI=void 0;let n=e.r(69871),i=e.r(17549),a=e.r(69931),s=e.r(44766),o=e.r(21890);class l extends a.OpenAI{get lc_aliases(){return{...super.lc_aliases,openAIApiKey:"openai_api_key",openAIApiVersion:"openai_api_version",openAIBasePath:"openai_api_base",deploymentName:"deployment_name",azureOpenAIEndpoint:"azure_endpoint",azureOpenAIApiVersion:"openai_api_version",azureOpenAIBasePath:"openai_api_base",azureOpenAIApiDeploymentName:"deployment_name"}}get lc_secrets(){return{...super.lc_secrets,azureOpenAIApiKey:"AZURE_OPENAI_API_KEY"}}constructor(e){if(super(e),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.azureOpenAIApiDeploymentName=(e?.azureOpenAIApiCompletionsDeploymentName||e?.azureOpenAIApiDeploymentName)??((0,i.getEnvironmentVariable)("AZURE_OPENAI_API_COMPLETIONS_DEPLOYMENT_NAME")||(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_DEPLOYMENT_NAME")),this.azureOpenAIApiKey=e?.azureOpenAIApiKey??e?.openAIApiKey??e?.apiKey??(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_KEY"),this.azureOpenAIApiInstanceName=e?.azureOpenAIApiInstanceName??(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiVersion=e?.azureOpenAIApiVersion??e?.openAIApiVersion??(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=e?.azureOpenAIBasePath??(0,i.getEnvironmentVariable)("AZURE_OPENAI_BASE_PATH"),this.azureOpenAIEndpoint=e?.azureOpenAIEndpoint??(0,i.getEnvironmentVariable)("AZURE_OPENAI_ENDPOINT"),this.azureADTokenProvider=e?.azureADTokenProvider,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw Error("Azure OpenAI API key or Token Provider not found")}_getClientOptions(e){if(!this.client){let e={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,azureADTokenProvider:this.azureADTokenProvider,baseURL:this.clientConfig.baseURL},t=(0,s.getEndpoint)(e),r={...this.clientConfig,baseURL:t,timeout:this.timeout,maxRetries:0};this.azureADTokenProvider||(r.apiKey=e.azureOpenAIApiKey),r.baseURL||delete r.baseURL;let i=(0,o.normalizeHeaders)(r.defaultHeaders);r.defaultHeaders={...r.defaultHeaders,"User-Agent":i["User-Agent"]?`${i["User-Agent"]}: langchainjs-azure-openai-v2`:"langchainjs-azure-openai-v2"},this.client=new n.AzureOpenAI({apiVersion:this.azureOpenAIApiVersion,azureADTokenProvider:this.azureADTokenProvider,...r})}let t={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.query={"api-version":this.azureOpenAIApiVersion,...t.query}),t}toJSON(){let e=super.toJSON();function t(e){return"object"==typeof e&&null!=e}return t(e)&&t(e.kwargs)&&(delete e.kwargs.azure_openai_base_path,delete e.kwargs.azure_openai_api_deployment_name,delete e.kwargs.azure_openai_api_key,delete e.kwargs.azure_openai_api_version,delete e.kwargs.azure_open_ai_base_path),e}}r.AzureOpenAI=l},6402,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.OpenAIEmbeddings=void 0;let n=e.r(69871),i=e.r(17549),a=e.r(98175),s=e.r(16511),o=e.r(44766),l=e.r(57273);class u extends a.Embeddings{constructor(e){let t={maxConcurrency:2,...e};super(t),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:512}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"dimensions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"encodingFormat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let r=t?.apiKey??t?.openAIApiKey??(0,i.getEnvironmentVariable)("OPENAI_API_KEY");this.organization=t?.configuration?.organization??(0,i.getEnvironmentVariable)("OPENAI_ORGANIZATION"),this.model=t?.model??t?.modelName??this.model,this.modelName=this.model,this.batchSize=t?.batchSize??this.batchSize,this.stripNewLines=t?.stripNewLines??this.stripNewLines,this.timeout=t?.timeout,this.dimensions=t?.dimensions,this.encodingFormat=t?.encodingFormat,this.clientConfig={apiKey:r,organization:this.organization,dangerouslyAllowBrowser:!0,...e?.configuration}}async embedDocuments(e){let t=(0,s.chunkArray)(this.stripNewLines?e.map(e=>e.replace(/\n/g," ")):e,this.batchSize),r=t.map(e=>{let t={model:this.model,input:e};return this.dimensions&&(t.dimensions=this.dimensions),this.encodingFormat&&(t.encoding_format=this.encodingFormat),this.embeddingWithRetry(t)}),n=await Promise.all(r),i=[];for(let e=0;e<n.length;e+=1){let r=t[e],{data:a}=n[e];for(let e=0;e<r.length;e+=1)i.push(a[e].embedding)}return i}async embedQuery(e){let t={model:this.model,input:this.stripNewLines?e.replace(/\n/g," "):e};this.dimensions&&(t.dimensions=this.dimensions),this.encodingFormat&&(t.encoding_format=this.encodingFormat);let{data:r}=await this.embeddingWithRetry(t);return r[0].embedding}async embeddingWithRetry(e){if(!this.client){let e={baseURL:this.clientConfig.baseURL},t=(0,o.getEndpoint)(e),r={...this.clientConfig,baseURL:t,timeout:this.timeout,maxRetries:0};r.baseURL||delete r.baseURL,this.client=new n.OpenAI(r)}let t={};return this.caller.call(async()=>{try{return await this.client.embeddings.create(e,t)}catch(e){throw(0,l.wrapOpenAIClientError)(e)}})}}r.OpenAIEmbeddings=u},40178,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AzureOpenAIEmbeddings=void 0;let n=e.r(69871),i=e.r(17549),a=e.r(6402),s=e.r(44766),o=e.r(57273),l=e.r(21890);class u extends a.OpenAIEmbeddings{constructor(e){super(e),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.batchSize=e?.batchSize??1,this.azureOpenAIApiKey=e?.azureOpenAIApiKey??e?.apiKey??(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_KEY"),this.azureOpenAIApiVersion=e?.azureOpenAIApiVersion??e?.openAIApiVersion??(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=e?.azureOpenAIBasePath??(0,i.getEnvironmentVariable)("AZURE_OPENAI_BASE_PATH"),this.azureOpenAIApiInstanceName=e?.azureOpenAIApiInstanceName??(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(e?.azureOpenAIApiEmbeddingsDeploymentName||e?.azureOpenAIApiDeploymentName)??((0,i.getEnvironmentVariable)("AZURE_OPENAI_API_EMBEDDINGS_DEPLOYMENT_NAME")||(0,i.getEnvironmentVariable)("AZURE_OPENAI_API_DEPLOYMENT_NAME")),this.azureADTokenProvider=e?.azureADTokenProvider}async embeddingWithRetry(e){if(!this.client){let e={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,azureADTokenProvider:this.azureADTokenProvider,baseURL:this.clientConfig.baseURL},t=(0,s.getEndpoint)(e),r={...this.clientConfig,baseURL:t,timeout:this.timeout,maxRetries:0};this.azureADTokenProvider||(r.apiKey=e.azureOpenAIApiKey),r.baseURL||delete r.baseURL;let i=(0,l.normalizeHeaders)(r.defaultHeaders);r.defaultHeaders={...r.defaultHeaders,"User-Agent":i["User-Agent"]?`${i["User-Agent"]}: langchainjs-azure-openai-v2`:"langchainjs-azure-openai-v2"},this.client=new n.AzureOpenAI({apiVersion:this.azureOpenAIApiVersion,azureADTokenProvider:this.azureADTokenProvider,deployment:this.azureOpenAIApiDeploymentName,...r})}let t={};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.query={"api-version":this.azureOpenAIApiVersion,...t.query}),this.caller.call(async()=>{try{return await this.client.embeddings.create(e,t)}catch(e){throw(0,o.wrapOpenAIClientError)(e)}})}}r.AzureOpenAIEmbeddings=u},57582,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},10304,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseToolkit=r.DynamicStructuredTool=r.DynamicTool=r.Tool=r.StructuredTool=r.ToolInputParsingException=r.isStructuredToolParams=r.isStructuredTool=r.isRunnableToolLike=r.isLangChainTool=void 0,r.tool=function(e,t){let r=(0,d.isSimpleStringZodSchema)(t.schema),n=(0,p.validatesOnlyStrings)(t.schema);if(!t.schema||r||n)return new g({...t,description:t.description??(t.schema&&(0,d.getSchemaDescription)(t.schema))??`${t.name} tool`,func:async(t,r,n)=>new Promise((i,a)=>{let s=(0,o.patchConfig)(n,{callbacks:r?.getChild()});u.AsyncLocalStorageProviderSingleton.runWithConfig((0,o.pickRunnableConfigKeys)(s),async()=>{try{i(e(t,s))}catch(e){a(e)}})})});let i=t.schema,a=t.description??t.schema.description??`${t.name} tool`;return new y({...t,description:a,schema:i,func:async(t,r,n)=>new Promise((i,a)=>{let s=(0,o.patchConfig)(n,{callbacks:r?.getChild()});u.AsyncLocalStorageProviderSingleton.runWithConfig((0,o.pickRunnableConfigKeys)(s),async()=>{try{i(e(t,s))}catch(e){a(e)}})})})};let n=e.r(32770),i=e.r(10479),a=e.r(75622),s=e.r(85864),o=e.r(81425),l=e.r(85257),u=e.r(18807),c=e.r(25951);Object.defineProperty(r,"ToolInputParsingException",{enumerable:!0,get:function(){return c.ToolInputParsingException}});let d=e.r(29164),p=e.r(30952);var h=e.r(1388);Object.defineProperty(r,"isLangChainTool",{enumerable:!0,get:function(){return h.isLangChainTool}}),Object.defineProperty(r,"isRunnableToolLike",{enumerable:!0,get:function(){return h.isRunnableToolLike}}),Object.defineProperty(r,"isStructuredTool",{enumerable:!0,get:function(){return h.isStructuredTool}}),Object.defineProperty(r,"isStructuredToolParams",{enumerable:!0,get:function(){return h.isStructuredToolParams}});class f extends s.BaseLangChain{get lc_namespace(){return["langchain","tools"]}constructor(e){super(e??{}),Object.defineProperty(this,"returnDirect",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"verboseParsingErrors",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"responseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"content"}),Object.defineProperty(this,"defaultConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verboseParsingErrors=e?.verboseParsingErrors??this.verboseParsingErrors,this.responseFormat=e?.responseFormat??this.responseFormat,this.defaultConfig=e?.defaultConfig??this.defaultConfig,this.metadata=e?.metadata??this.metadata}async invoke(e,t){let r,n=(0,o.ensureConfig)((0,o.mergeConfigs)(this.defaultConfig,t));return(0,c._isToolCall)(e)?(r=e.args,n={...n,toolCall:e}):r=e,this.call(r,n)}async call(e,t,r){let n,s,o,u,p,h=(0,c._isToolCall)(e)?e.args:e;if((0,d.isInteropZodSchema)(this.schema))try{n=await (0,d.interopParseAsync)(this.schema,h)}catch(r){let t="Received tool input did not match expected schema";throw this.verboseParsingErrors&&(t=`${t}
Details: ${r.message}`),new c.ToolInputParsingException(t,JSON.stringify(e))}else{let t=(0,i.validate)(h,this.schema);if(!t.valid){let r="Received tool input did not match expected schema";throw this.verboseParsingErrors&&(r=`${r}
Details: ${t.errors.map(e=>`${e.keywordLocation}: ${e.error}`).join("\n")}`),new c.ToolInputParsingException(r,JSON.stringify(e))}n=h}let f=(0,a.parseCallbackConfigArg)(t),m=a.CallbackManager.configure(f.callbacks,this.callbacks,f.tags||r,this.tags,f.metadata,this.metadata,{verbose:this.verbose}),g=await m?.handleToolStart(this.toJSON(),"string"==typeof e?e:JSON.stringify(e),f.runId,void 0,void 0,void 0,f.runName);delete f.runId;try{s=await this._call(n,g,f)}catch(e){throw await g?.handleToolError(e),e}if("content_and_artifact"===this.responseFormat)if(Array.isArray(s)&&2===s.length)[o,u]=s;else throw Error(`Tool response format is "content_and_artifact" but the output was not a two-tuple.
Result: ${JSON.stringify(s)}`);else o=s;(0,c._isToolCall)(e)&&(p=e.id),!p&&(0,c._configHasToolCallId)(f)&&(p=f.toolCall.id);let y=function(e){let{content:t,artifact:r,toolCallId:n,metadata:i}=e;return!n||(0,l.isDirectToolOutput)(t)?t:new l.ToolMessage("string"==typeof t||Array.isArray(t)&&t.every(e=>"object"==typeof e)?{status:"success",content:t,artifact:r,tool_call_id:n,name:e.name,metadata:i}:{status:"success",content:function(e){try{return JSON.stringify(e,null,2)??""}catch(t){return`${e}`}}(t),artifact:r,tool_call_id:n,name:e.name,metadata:i})}({content:o,artifact:u,toolCallId:p,name:this.name,metadata:this.metadata});return await g?.handleToolEnd(y),y}}r.StructuredTool=f;class m extends f{constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:n.z.object({input:n.z.string().optional()}).transform(e=>e.input)})}call(e,t){return super.call("string"==typeof e||null==e?{input:e}:e,t)}}r.Tool=m;class g extends m{static lc_name(){return"DynamicTool"}constructor(e){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.func=e.func,this.returnDirect=e.returnDirect??this.returnDirect}async call(e,t){let r=(0,a.parseCallbackConfigArg)(t);return void 0===r.runName&&(r.runName=this.name),super.call(e,r)}async _call(e,t,r){return this.func(e,t,r)}}r.DynamicTool=g;class y extends f{static lc_name(){return"DynamicStructuredTool"}constructor(e){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.func=e.func,this.returnDirect=e.returnDirect??this.returnDirect,this.schema=e.schema}async call(e,t,r){let n=(0,a.parseCallbackConfigArg)(t);return void 0===n.runName&&(n.runName=this.name),super.call(e,n,r)}_call(e,t,r){return this.func(e,t,r)}}r.DynamicStructuredTool=y,r.BaseToolkit=class{getTools(){return this.tools}}},69045,(e,t,r)=>{t.exports=e.r(10304)},6564,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DallEAPIWrapper=void 0;let n=e.r(17549),i=e.r(69871),a=e.r(69045);class s extends a.Tool{static lc_name(){return"DallEAPIWrapper"}constructor(e){e?.responseFormat!==void 0&&["url","b64_json"].includes(e.responseFormat)&&(e.dallEResponseFormat=e.responseFormat,e.responseFormat="content"),super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:"A wrapper around OpenAI DALL-E API. Useful for when you need to generate images from a text description. Input should be an image description."}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"dall-e-3"}),Object.defineProperty(this,"style",{enumerable:!0,configurable:!0,writable:!0,value:"vivid"}),Object.defineProperty(this,"quality",{enumerable:!0,configurable:!0,writable:!0,value:"standard"}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:"1024x1024"}),Object.defineProperty(this,"dallEResponseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"url"}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let t={apiKey:e?.apiKey??e?.openAIApiKey??(0,n.getEnvironmentVariable)("OPENAI_API_KEY"),organization:e?.organization??(0,n.getEnvironmentVariable)("OPENAI_ORGANIZATION"),dangerouslyAllowBrowser:!0,baseURL:e?.baseUrl};this.client=new i.OpenAI(t),this.model=e?.model??e?.modelName??this.model,this.style=e?.style??this.style,this.quality=e?.quality??this.quality,this.n=e?.n??this.n,this.size=e?.size??this.size,this.dallEResponseFormat=e?.dallEResponseFormat??this.dallEResponseFormat,this.user=e?.user}processMultipleGeneratedUrls(e){return"url"===this.dallEResponseFormat?e.flatMap(e=>e.data?.flatMap(e=>e.url?{type:"image_url",image_url:e.url}:[]).filter(e=>void 0!==e&&"image_url"===e.type&&"string"==typeof e.image_url&&void 0!==e.image_url)??[]):e.flatMap(e=>e.data?.flatMap(e=>e.b64_json?{type:"image_url",image_url:{url:e.b64_json}}:[]).filter(e=>void 0!==e&&"image_url"===e.type&&"object"==typeof e.image_url&&"url"in e.image_url&&"string"==typeof e.image_url.url&&void 0!==e.image_url.url)??[])}async _call(e){let t={model:this.model,prompt:e,n:1,size:this.size,response_format:this.dallEResponseFormat,style:this.style,quality:this.quality,user:this.user};if(this.n>1){let e=await Promise.all(Array.from({length:this.n}).map(()=>this.client.images.generate(t)));return this.processMultipleGeneratedUrls(e)}let r=await this.client.images.generate(t),n="";return"url"===this.dallEResponseFormat?[n]=r.data?.map(e=>e.url).filter(e=>"undefined"!==e)??[]:[n]=r.data?.map(e=>e.b64_json).filter(e=>"undefined"!==e)??[],n}}r.DallEAPIWrapper=s,Object.defineProperty(s,"toolName",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"})},99620,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(6564),r)},17477,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.convertPromptToOpenAI=function(e){let t=e.toChatMessages();return{messages:(0,n._convertMessagesToOpenAIParams)(t)}};let n=e.r(111)},92595,(e,t,r)=>{t.exports=e.r(18807)},20725,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.customTool=function(e,t){return new a.DynamicTool({...t,description:"",metadata:{customTool:t},func:async(t,r,a)=>new Promise((s,o)=>{let l=(0,n.patchConfig)(a,{callbacks:r?.getChild()});i.AsyncLocalStorageProviderSingleton.runWithConfig((0,n.pickRunnableConfigKeys)(l),async()=>{try{s(e(t,l))}catch(e){o(e)}})})})};let n=e.r(78541),i=e.r(92595),a=e.r(69045)},13194,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.customTool=r.convertPromptToOpenAI=r.toFile=r.OpenAIClient=void 0;var a=e.r(69871);Object.defineProperty(r,"OpenAIClient",{enumerable:!0,get:function(){return a.OpenAI}}),Object.defineProperty(r,"toFile",{enumerable:!0,get:function(){return a.toFile}}),i(e.r(111),r),i(e.r(57219),r),i(e.r(69931),r),i(e.r(26391),r),i(e.r(40178),r),i(e.r(6402),r),i(e.r(57582),r),i(e.r(57273),r),i(e.r(44766),r),i(e.r(99620),r);var s=e.r(17477);Object.defineProperty(r,"convertPromptToOpenAI",{enumerable:!0,get:function(){return s.convertPromptToOpenAI}});var o=e.r(20725);Object.defineProperty(r,"customTool",{enumerable:!0,get:function(){return o.customTool}})},48133,(e,t,r)=>{t.exports=e.r(13194)},90817,(e,t,r)=>{"use strict";var n;r.SchemaType=void 0,function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"}(r.SchemaType||(r.SchemaType={})),r.ExecutableCodeLanguage=void 0,function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"}(r.ExecutableCodeLanguage||(r.ExecutableCodeLanguage={})),r.Outcome=void 0,function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"}(r.Outcome||(r.Outcome={}));let i=["user","model","function","system"];r.HarmCategory=void 0,function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"}(r.HarmCategory||(r.HarmCategory={})),r.HarmBlockThreshold=void 0,function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"}(r.HarmBlockThreshold||(r.HarmBlockThreshold={})),r.HarmProbability=void 0,function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(r.HarmProbability||(r.HarmProbability={})),r.BlockReason=void 0,function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"}(r.BlockReason||(r.BlockReason={})),r.FinishReason=void 0,function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.OTHER="OTHER"}(r.FinishReason||(r.FinishReason={})),r.TaskType=void 0,function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"}(r.TaskType||(r.TaskType={})),r.FunctionCallingMode=void 0,function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"}(r.FunctionCallingMode||(r.FunctionCallingMode={})),r.DynamicRetrievalMode=void 0,function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(r.DynamicRetrievalMode||(r.DynamicRetrievalMode={}));class a extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class s extends a{constructor(e,t){super(e),this.response=t}}class o extends a{constructor(e,t,r,n){super(e),this.status=t,this.statusText=r,this.errorDetails=n}}class l extends a{}class u extends a{}!function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"}(n||(n={}));class c{constructor(e,t,r,n,i){this.model=e,this.task=t,this.apiKey=r,this.stream=n,this.requestOptions=i}toString(){var e,t;let r=(null==(e=this.requestOptions)?void 0:e.apiVersion)||"v1beta",n=(null==(t=this.requestOptions)?void 0:t.baseUrl)||"https://generativelanguage.googleapis.com",i=`${n}/${r}/${this.model}:${this.task}`;return this.stream&&(i+="?alt=sse"),i}}async function d(e){var t;let r=new Headers;r.append("Content-Type","application/json"),r.append("x-goog-api-client",function(e){let t=[];return(null==e?void 0:e.apiClient)&&t.push(e.apiClient),t.push("genai-js/0.24.1"),t.join(" ")}(e.requestOptions)),r.append("x-goog-api-key",e.apiKey);let n=null==(t=e.requestOptions)?void 0:t.customHeaders;if(n){if(!(n instanceof Headers))try{n=new Headers(n)}catch(e){throw new l(`unable to convert customHeaders value ${JSON.stringify(n)} to Headers: ${e.message}`)}for(let[e,t]of n.entries()){if("x-goog-api-key"===e)throw new l(`Cannot set reserved header name ${e}`);if("x-goog-api-client"===e)throw new l(`Header name ${e} can only be set using the apiClient field`);r.append(e,t)}}return r}async function p(e,t,r,n,i,a){let s=new c(e,t,r,n,a);return{url:s.toString(),fetchOptions:Object.assign(Object.assign({},function(e){let t={};if((null==e?void 0:e.signal)!==void 0||(null==e?void 0:e.timeout)>=0){let r=new AbortController;(null==e?void 0:e.timeout)>=0&&setTimeout(()=>r.abort(),e.timeout),(null==e?void 0:e.signal)&&e.signal.addEventListener("abort",()=>{r.abort()}),t.signal=r.signal}return t}(a)),{method:"POST",headers:await d(s),body:i})}}async function h(e,t,r,n,i,a={},s=fetch){let{url:o,fetchOptions:l}=await p(e,t,r,n,i,a);return f(o,l,s)}async function f(e,t,r=fetch){let n;try{n=await r(e,t)}catch(r){var i=r,s=e;let t=i;throw"AbortError"===t.name?(t=new u(`Request aborted when fetching ${s.toString()}: ${i.message}`)).stack=i.stack:i instanceof o||i instanceof l||((t=new a(`Error fetching from ${s.toString()}: ${i.message}`)).stack=i.stack),t}return n.ok||await m(n,e),n}async function m(e,t){let r,n="";try{let t=await e.json();n=t.error.message,t.error.details&&(n+=` ${JSON.stringify(t.error.details)}`,r=t.error.details)}catch(e){}throw new o(`Error fetching from ${t.toString()}: [${e.status} ${e.statusText}] ${n}`,e.status,e.statusText,r)}function g(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),_(e.candidates[0]))throw new s(`${v(e)}`,e);return function(e){var t,r,n,i;let a=[];if(null==(r=null==(t=e.candidates)?void 0:t[0].content)?void 0:r.parts)for(let t of null==(i=null==(n=e.candidates)?void 0:n[0].content)?void 0:i.parts)t.text&&a.push(t.text),t.executableCode&&a.push("\n```"+t.executableCode.language+"\n"+t.executableCode.code+"\n```\n"),t.codeExecutionResult&&a.push("\n```\n"+t.codeExecutionResult.output+"\n```\n");return a.length>0?a.join(""):""}(e)}if(e.promptFeedback)throw new s(`Text not available. ${v(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),_(e.candidates[0]))throw new s(`${v(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),y(e)[0]}if(e.promptFeedback)throw new s(`Function call not available. ${v(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),_(e.candidates[0]))throw new s(`${v(e)}`,e);return y(e)}if(e.promptFeedback)throw new s(`Function call not available. ${v(e)}`,e)},e}function y(e){var t,r,n,i;let a=[];if(null==(r=null==(t=e.candidates)?void 0:t[0].content)?void 0:r.parts)for(let t of null==(i=null==(n=e.candidates)?void 0:n[0].content)?void 0:i.parts)t.functionCall&&a.push(t.functionCall);return a.length>0?a:void 0}let b=[r.FinishReason.RECITATION,r.FinishReason.SAFETY,r.FinishReason.LANGUAGE];function _(e){return!!e.finishReason&&b.includes(e.finishReason)}function v(e){var t,r,n;let i="";if((!e.candidates||0===e.candidates.length)&&e.promptFeedback)i+="Response was blocked",(null==(t=e.promptFeedback)?void 0:t.blockReason)&&(i+=` due to ${e.promptFeedback.blockReason}`),(null==(r=e.promptFeedback)?void 0:r.blockReasonMessage)&&(i+=`: ${e.promptFeedback.blockReasonMessage}`);else if(null==(n=e.candidates)?void 0:n[0]){let t=e.candidates[0];_(t)&&(i+=`Candidate was blocked due to ${t.finishReason}`,t.finishMessage&&(i+=`: ${t.finishMessage}`))}return i}function w(e){return this instanceof w?(this.v=e,this):new w(e)}"function"==typeof SuppressedError&&SuppressedError;let O=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;async function P(e){let t=[],r=e.getReader();for(;;){let{done:e,value:n}=await r.read();if(e)return g(function(e){let t=e[e.length-1],r={promptFeedback:null==t?void 0:t.promptFeedback};for(let t of e){if(t.candidates){let e=0;for(let n of t.candidates)if(r.candidates||(r.candidates=[]),r.candidates[e]||(r.candidates[e]={index:e}),r.candidates[e].citationMetadata=n.citationMetadata,r.candidates[e].groundingMetadata=n.groundingMetadata,r.candidates[e].finishReason=n.finishReason,r.candidates[e].finishMessage=n.finishMessage,r.candidates[e].safetyRatings=n.safetyRatings,n.content&&n.content.parts){r.candidates[e].content||(r.candidates[e].content={role:n.content.role||"user",parts:[]});let t={};for(let i of n.content.parts)i.text&&(t.text=i.text),i.functionCall&&(t.functionCall=i.functionCall),i.executableCode&&(t.executableCode=i.executableCode),i.codeExecutionResult&&(t.codeExecutionResult=i.codeExecutionResult),0===Object.keys(t).length&&(t.text=""),r.candidates[e].content.parts.push(t)}e++}t.usageMetadata&&(r.usageMetadata=t.usageMetadata)}return r}(t));t.push(n)}}async function S(e,t,r,i){let[s,o]=(function(e){let t=e.getReader();return new ReadableStream({start(e){let r="";return function n(){return t.read().then(({value:t,done:i})=>{let s;if(i)return r.trim()?void e.error(new a("Failed to parse stream")):void e.close();let o=(r+=t).match(O);for(;o;){try{s=JSON.parse(o[1])}catch(t){e.error(new a(`Error parsing JSON response: "${o[1]}"`));return}e.enqueue(s),o=(r=r.substring(o[0].length)).match(O)}return n()}).catch(e=>{let t=e;throw t.stack=e.stack,t="AbortError"===t.name?new u("Request aborted when reading from the stream"):new a("Error reading from the stream")})}()}})})((await h(t,n.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(r),i)).body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0}))).tee();return{stream:function(e){return function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),a=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){a.push([e,t,r,n])>1||o(e,t)})})}function o(e,t){try{var r;(r=i[e](t)).value instanceof w?Promise.resolve(r.value.v).then(l,u):c(a[0][2],r)}catch(e){c(a[0][3],e)}}function l(e){o("next",e)}function u(e){o("throw",e)}function c(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}}(this,arguments,function*(){let t=e.getReader();for(;;){let{value:e,done:r}=yield w(t.read());if(r)break;yield yield w(g(e))}})}(s),response:P(o)}}async function E(e,t,r,i){let a=await h(t,n.GENERATE_CONTENT,e,!1,JSON.stringify(r),i);return{response:g(await a.json())}}function k(e){if(null!=e){if("string"==typeof e)return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)if(!e.role)return{role:"system",parts:e.parts};else return e}}function I(e){let t=[];if("string"==typeof e)t=[{text:e}];else for(let r of e)"string"==typeof r?t.push({text:r}):t.push(r);var r=t;let n={role:"user",parts:[]},i={role:"function",parts:[]},s=!1,o=!1;for(let e of r)"functionResponse"in e?(i.parts.push(e),o=!0):(n.parts.push(e),s=!0);if(s&&o)throw new a("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!s&&!o)throw new a("No content is provided for sending chat message.");return s?n:i}function A(e){let t;return t=e.contents?e:{contents:[I(e)]},e.systemInstruction&&(t.systemInstruction=k(e.systemInstruction)),t}let T=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],C={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function j(e){var t;if(void 0===e.candidates||0===e.candidates.length)return!1;let r=null==(t=e.candidates[0])?void 0:t.content;if(void 0===r||void 0===r.parts||0===r.parts.length)return!1;for(let e of r.parts)if(void 0===e||0===Object.keys(e).length||void 0!==e.text&&""===e.text)return!1;return!0}let x="SILENT_ERROR";class ${constructor(e,t,r,n={}){this.model=t,this.params=r,this._requestOptions=n,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,(null==r?void 0:r.history)&&(!function(e){let t=!1;for(let r of e){let{role:e,parts:n}=r;if(!t&&"user"!==e)throw new a(`First content should be with role 'user', got ${e}`);if(!i.includes(e))throw new a(`Each item should include role field. Got ${e} but valid roles are: ${JSON.stringify(i)}`);if(!Array.isArray(n))throw new a("Content should have 'parts' property with an array of Parts");if(0===n.length)throw new a("Each Content should have at least one part");let s={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(let e of n)for(let t of T)t in e&&(s[t]+=1);let o=C[e];for(let t of T)if(!o.includes(t)&&s[t]>0)throw new a(`Content with role '${e}' can't contain '${t}' part`);t=!0}}(r.history),this._history=r.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var r,n,i,a,s,o;let l;await this._sendPromise;let u=I(e),c={safetySettings:null==(r=this.params)?void 0:r.safetySettings,generationConfig:null==(n=this.params)?void 0:n.generationConfig,tools:null==(i=this.params)?void 0:i.tools,toolConfig:null==(a=this.params)?void 0:a.toolConfig,systemInstruction:null==(s=this.params)?void 0:s.systemInstruction,cachedContent:null==(o=this.params)?void 0:o.cachedContent,contents:[...this._history,u]},d=Object.assign(Object.assign({},this._requestOptions),t);return this._sendPromise=this._sendPromise.then(()=>E(this._apiKey,this.model,c,d)).then(e=>{var t;if(j(e.response)){this._history.push(u);let r=Object.assign({parts:[],role:"model"},null==(t=e.response.candidates)?void 0:t[0].content);this._history.push(r)}else{let t=v(e.response);t&&console.warn(`sendMessage() was unsuccessful. ${t}. Inspect response object for details.`)}l=e}).catch(e=>{throw this._sendPromise=Promise.resolve(),e}),await this._sendPromise,l}async sendMessageStream(e,t={}){var r,n,i,a,s,o;await this._sendPromise;let l=I(e),u={safetySettings:null==(r=this.params)?void 0:r.safetySettings,generationConfig:null==(n=this.params)?void 0:n.generationConfig,tools:null==(i=this.params)?void 0:i.tools,toolConfig:null==(a=this.params)?void 0:a.toolConfig,systemInstruction:null==(s=this.params)?void 0:s.systemInstruction,cachedContent:null==(o=this.params)?void 0:o.cachedContent,contents:[...this._history,l]},c=Object.assign(Object.assign({},this._requestOptions),t),d=S(this._apiKey,this.model,u,c);return this._sendPromise=this._sendPromise.then(()=>d).catch(e=>{throw Error(x)}).then(e=>e.response).then(e=>{if(j(e)){this._history.push(l);let t=Object.assign({},e.candidates[0].content);t.role||(t.role="model"),this._history.push(t)}else{let t=v(e);t&&console.warn(`sendMessageStream() was unsuccessful. ${t}. Inspect response object for details.`)}}).catch(e=>{e.message!==x&&console.error(e)}),d}}async function N(e,t,r,i){return(await h(t,n.COUNT_TOKENS,e,!1,JSON.stringify(r),i)).json()}async function R(e,t,r,i){return(await h(t,n.EMBED_CONTENT,e,!1,JSON.stringify(r),i)).json()}async function M(e,t,r,i){let a=r.requests.map(e=>Object.assign(Object.assign({},e),{model:t}));return(await h(t,n.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:a}),i)).json()}class D{constructor(e,t,r={}){this.apiKey=e,this._requestOptions=r,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=k(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var r;let n=A(e),i=Object.assign(Object.assign({},this._requestOptions),t);return E(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(r=this.cachedContent)?void 0:r.name},n),i)}async generateContentStream(e,t={}){var r;let n=A(e),i=Object.assign(Object.assign({},this._requestOptions),t);return S(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(r=this.cachedContent)?void 0:r.name},n),i)}startChat(e){var t;return new $(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(t=this.cachedContent)?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){let r=function(e,t){var r;let n={model:null==t?void 0:t.model,generationConfig:null==t?void 0:t.generationConfig,safetySettings:null==t?void 0:t.safetySettings,tools:null==t?void 0:t.tools,toolConfig:null==t?void 0:t.toolConfig,systemInstruction:null==t?void 0:t.systemInstruction,cachedContent:null==(r=null==t?void 0:t.cachedContent)?void 0:r.name,contents:[]},i=null!=e.generateContentRequest;if(e.contents){if(i)throw new l("CountTokensRequest must have one of contents or generateContentRequest, not both.");n.contents=e.contents}else if(i)n=Object.assign(Object.assign({},n),e.generateContentRequest);else{let t=I(e);n.contents=[t]}return{generateContentRequest:n}}(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),n=Object.assign(Object.assign({},this._requestOptions),t);return N(this.apiKey,this.model,r,n)}async embedContent(e,t={}){let r="string"==typeof e||Array.isArray(e)?{content:I(e)}:e,n=Object.assign(Object.assign({},this._requestOptions),t);return R(this.apiKey,this.model,r,n)}async batchEmbedContents(e,t={}){let r=Object.assign(Object.assign({},this._requestOptions),t);return M(this.apiKey,this.model,e,r)}}r.ChatSession=$,r.GenerativeModel=D,r.GoogleGenerativeAI=class{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new a("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new D(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,r){if(!e.name)throw new l("Cached content must contain a `name` field.");if(!e.model)throw new l("Cached content must contain a `model` field.");for(let r of["model","systemInstruction"])if((null==t?void 0:t[r])&&e[r]&&(null==t?void 0:t[r])!==e[r]){if("model"===r&&(t.model.startsWith("models/")?t.model.replace("models/",""):t.model)===(e.model.startsWith("models/")?e.model.replace("models/",""):e.model))continue;throw new l(`Different value for "${r}" specified in modelParams (${t[r]}) and cachedContent (${e[r]})`)}let n=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new D(this.apiKey,n,r)}},r.GoogleGenerativeAIAbortError=u,r.GoogleGenerativeAIError=a,r.GoogleGenerativeAIFetchError=o,r.GoogleGenerativeAIRequestInputError=l,r.GoogleGenerativeAIResponseError=s,r.POSSIBLE_ROLES=i},37698,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.removeAdditionalProperties=a,r.schemaToGenerativeAIParameters=function(e){let{$schema:t,...r}=a((0,n.isInteropZodSchema)(e)?(0,i.toJsonSchema)(e):e);return r},r.jsonSchemaToGeminiParameters=function(e){let{$schema:t,...r}=a(e);return r};let n=e.r(15225),i=e.r(63656);function a(e){if("object"==typeof e&&null!==e){let t={...e};for(let e in"additionalProperties"in t&&delete t.additionalProperties,"$schema"in t&&delete t.$schema,"strict"in t&&delete t.strict,t)e in t&&(Array.isArray(t[e])?t[e]=t[e].map(a):"object"==typeof t[e]&&null!==t[e]&&(t[e]=a(t[e])));return t}return e}},88932,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="ffffffff-ffff-ffff-ffff-ffffffffffff"},50163,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="00000000-0000-0000-0000-000000000000"},61610,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i},13118,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(61610);r.default=function(e){return"string"==typeof e&&n.default.test(e)}},19776,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(13118);r.default=function(e){let t;if(!(0,n.default)(e))throw TypeError("Invalid UUID");return Uint8Array.of((t=parseInt(e.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,255&t,(t=parseInt(e.slice(9,13),16))>>>8,255&t,(t=parseInt(e.slice(14,18),16))>>>8,255&t,(t=parseInt(e.slice(19,23),16))>>>8,255&t,(t=parseInt(e.slice(24,36),16))/0x10000000000&255,t/0x100000000&255,t>>>24&255,t>>>16&255,t>>>8&255,255&t)}},23802,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.unsafeStringify=void 0;let n=e.r(13118),i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function a(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}r.unsafeStringify=a,r.default=function(e,t=0){let r=a(e,t);if(!(0,n.default)(r))throw TypeError("Stringified UUID is invalid");return r}},78916,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(54799),i=new Uint8Array(256),a=i.length;r.default=function(){return a>i.length-16&&((0,n.randomFillSync)(i),a=0),i.slice(a,a+=16)}},59582,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.updateV1State=void 0;let n=e.r(78916),i=e.r(23802),a={};function s(e,t,r){return e.msecs??=-1/0,e.nsecs??=0,t===e.msecs?(e.nsecs++,e.nsecs>=1e4&&(e.node=void 0,e.nsecs=0)):t>e.msecs?e.nsecs=0:t<e.msecs&&(e.node=void 0),e.node||(e.node=r.slice(10,16),e.node[0]|=1,e.clockseq=(r[8]<<8|r[9])&16383),e.msecs=t,e}function o(e,t,r,n,i,a,s=0){if(e.length<16)throw Error("Random bytes length must be >= 16");if(a){if(s<0||s+16>a.length)throw RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`)}else a=new Uint8Array(16),s=0;t??=Date.now(),r??=0,n??=(e[8]<<8|e[9])&16383,i??=e.slice(10,16);let l=((0xfffffff&(t+=122192928e5))*1e4+r)%0x100000000;a[s++]=l>>>24&255,a[s++]=l>>>16&255,a[s++]=l>>>8&255,a[s++]=255&l;let u=t/0x100000000*1e4&0xfffffff;a[s++]=u>>>8&255,a[s++]=255&u,a[s++]=u>>>24&15|16,a[s++]=u>>>16&255,a[s++]=n>>>8|128,a[s++]=255&n;for(let e=0;e<6;++e)a[s++]=i[e];return a}r.updateV1State=s,r.default=function(e,t,r){let l,u=e?._v6??!1;if(e){let t=Object.keys(e);1===t.length&&"_v6"===t[0]&&(e=void 0)}if(e)l=o(e.random??e.rng?.()??(0,n.default)(),e.msecs,e.nsecs,e.clockseq,e.node,t,r);else{let e=Date.now(),i=(0,n.default)();s(a,e,i),l=o(i,a.msecs,a.nsecs,u?void 0:a.clockseq,u?void 0:a.node,t,r)}return t??(0,i.unsafeStringify)(l)}},34074,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(19776),i=e.r(23802);r.default=function(e){var t;let r=(t="string"==typeof e?(0,n.default)(e):e,Uint8Array.of((15&t[6])<<4|t[7]>>4&15,(15&t[7])<<4|(240&t[4])>>4,(15&t[4])<<4|(240&t[5])>>4,(15&t[5])<<4|(240&t[0])>>4,(15&t[0])<<4|(240&t[1])>>4,(15&t[1])<<4|(240&t[2])>>4,96|15&t[2],t[3],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]));return"string"==typeof e?(0,i.unsafeStringify)(r):r}},73063,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(54799);r.default=function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),(0,n.createHash)("md5").update(e).digest()}},25806,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.URL=r.DNS=r.stringToBytes=void 0;let n=e.r(19776),i=e.r(23802);function a(e){let t=new Uint8Array((e=unescape(encodeURIComponent(e))).length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t}r.stringToBytes=a,r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r.default=function(e,t,r,s,o,l){let u="string"==typeof r?a(r):r,c="string"==typeof s?(0,n.default)(s):s;if("string"==typeof s&&(s=(0,n.default)(s)),s?.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let d=new Uint8Array(16+u.length);if(d.set(c),d.set(u,c.length),(d=t(d))[6]=15&d[6]|e,d[8]=63&d[8]|128,o){l=l||0;for(let e=0;e<16;++e)o[l+e]=d[e];return o}return(0,i.unsafeStringify)(d)}},48731,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.URL=r.DNS=void 0;let n=e.r(73063),i=e.r(25806);var a=e.r(25806);function s(e,t,r,a){return(0,i.default)(48,n.default,e,t,r,a)}Object.defineProperty(r,"DNS",{enumerable:!0,get:function(){return a.DNS}}),Object.defineProperty(r,"URL",{enumerable:!0,get:function(){return a.URL}}),s.DNS=i.DNS,s.URL=i.URL,r.default=s},88020,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={randomUUID:e.r(54799).randomUUID}},27887,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(88020),i=e.r(78916),a=e.r(23802);r.default=function(e,t,r){if(n.default.randomUUID&&!t&&!e)return n.default.randomUUID();let s=(e=e||{}).random??e.rng?.()??(0,i.default)();if(s.length<16)throw Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=s[e];return t}return(0,a.unsafeStringify)(s)}},72300,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(54799);r.default=function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),(0,n.createHash)("sha1").update(e).digest()}},81,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.URL=r.DNS=void 0;let n=e.r(72300),i=e.r(25806);var a=e.r(25806);function s(e,t,r,a){return(0,i.default)(80,n.default,e,t,r,a)}Object.defineProperty(r,"DNS",{enumerable:!0,get:function(){return a.DNS}}),Object.defineProperty(r,"URL",{enumerable:!0,get:function(){return a.URL}}),s.DNS=i.DNS,s.URL=i.URL,r.default=s},29152,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(23802),i=e.r(59582),a=e.r(34074);r.default=function(e,t,r){e??={},r??=0;let s=(0,i.default)({...e,_v6:!0},new Uint8Array(16));if(s=(0,a.default)(s),t){for(let e=0;e<16;e++)t[r+e]=s[e];return t}return(0,n.unsafeStringify)(s)}},87915,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(19776),i=e.r(23802);r.default=function(e){var t;let r=(t="string"==typeof e?(0,n.default)(e):e,Uint8Array.of((15&t[3])<<4|t[4]>>4&15,(15&t[4])<<4|(240&t[5])>>4,(15&t[5])<<4|15&t[6],t[7],(15&t[1])<<4|(240&t[2])>>4,(15&t[2])<<4|(240&t[3])>>4,16|(240&t[0])>>4,(15&t[0])<<4|(240&t[1])>>4,t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]));return"string"==typeof e?(0,i.unsafeStringify)(r):r}},20663,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.updateV7State=void 0;let n=e.r(78916),i=e.r(23802),a={};function s(e,t,r){return e.msecs??=-1/0,e.seq??=0,t>e.msecs?(e.seq=r[6]<<23|r[7]<<16|r[8]<<8|r[9],e.msecs=t):(e.seq=e.seq+1|0,0===e.seq&&e.msecs++),e}function o(e,t,r,n,i=0){if(e.length<16)throw Error("Random bytes length must be >= 16");if(n){if(i<0||i+16>n.length)throw RangeError(`UUID byte range ${i}:${i+15} is out of buffer bounds`)}else n=new Uint8Array(16),i=0;return t??=Date.now(),r??=127*e[6]<<24|e[7]<<16|e[8]<<8|e[9],n[i++]=t/0x10000000000&255,n[i++]=t/0x100000000&255,n[i++]=t/0x1000000&255,n[i++]=t/65536&255,n[i++]=t/256&255,n[i++]=255&t,n[i++]=112|r>>>28&15,n[i++]=r>>>20&255,n[i++]=128|r>>>14&63,n[i++]=r>>>6&255,n[i++]=r<<2&255|3&e[10],n[i++]=e[11],n[i++]=e[12],n[i++]=e[13],n[i++]=e[14],n[i++]=e[15],n}r.updateV7State=s,r.default=function(e,t,r){let l;if(e)l=o(e.random??e.rng?.()??(0,n.default)(),e.msecs,e.seq,t,r);else{let e=Date.now(),i=(0,n.default)();s(a,e,i),l=o(i,a.msecs,a.seq,t,r)}return t??(0,i.unsafeStringify)(l)}},53070,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let n=e.r(13118);r.default=function(e){if(!(0,n.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},71639,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.version=r.validate=r.v7=r.v6ToV1=r.v6=r.v5=r.v4=r.v3=r.v1ToV6=r.v1=r.stringify=r.parse=r.NIL=r.MAX=void 0;var n=e.r(88932);Object.defineProperty(r,"MAX",{enumerable:!0,get:function(){return n.default}});var i=e.r(50163);Object.defineProperty(r,"NIL",{enumerable:!0,get:function(){return i.default}});var a=e.r(19776);Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return a.default}});var s=e.r(23802);Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return s.default}});var o=e.r(59582);Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return o.default}});var l=e.r(34074);Object.defineProperty(r,"v1ToV6",{enumerable:!0,get:function(){return l.default}});var u=e.r(48731);Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return u.default}});var c=e.r(27887);Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return c.default}});var d=e.r(81);Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return d.default}});var p=e.r(29152);Object.defineProperty(r,"v6",{enumerable:!0,get:function(){return p.default}});var h=e.r(87915);Object.defineProperty(r,"v6ToV1",{enumerable:!0,get:function(){return h.default}});var f=e.r(20663);Object.defineProperty(r,"v7",{enumerable:!0,get:function(){return f.default}});var m=e.r(13118);Object.defineProperty(r,"validate",{enumerable:!0,get:function(){return m.default}});var g=e.r(53070);Object.defineProperty(r,"version",{enumerable:!0,get:function(){return g.default}})},62152,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getMessageAuthor=u,r.convertAuthorToRole=c,r.convertMessageContentToParts=p,r.convertBaseMessagesToContent=function(e,t,r=!1){return e.reduce((i,a,s)=>{if(!(0,n.isBaseMessage)(a))throw Error("Unsupported message input");let o=u(a);if("system"===o&&0!==s)throw Error("System message should be the first one");let l=c(o),d=i.content[i.content.length];if(!i.mergeWithPreviousContent&&d&&d.role===l)throw Error("Google Generative AI requires alternate messages between authors");let h=p(a,t,e.slice(0,s));if(i.mergeWithPreviousContent){let e=i.content[i.content.length-1];if(!e)throw Error("There was a problem parsing your system message. Please try a prompt without one.");return e.parts.push(...h),{mergeWithPreviousContent:!1,content:i.content}}let f=l;"function"!==f&&("system"!==f||r)||(f="user");let m={role:f,parts:h};return{mergeWithPreviousContent:"system"===o&&!r,content:[...i.content,m]}},{content:[],mergeWithPreviousContent:!1}).content},r.mapGenerateContentResultToChatResult=function(e,t){let r;if(!e.candidates||0===e.candidates.length||!e.candidates[0])return{generations:[],llmOutput:{filters:e.promptFeedback}};let i=e.functionCalls(),[a]=e.candidates,{content:s,...l}=a;r=Array.isArray(s?.parts)&&1===s.parts.length&&s.parts[0].text?s.parts[0].text:Array.isArray(s?.parts)&&s.parts.length>0?s.parts.map(e=>"text"in e?{type:"text",text:e.text}:"executableCode"in e?{type:"executableCode",executableCode:e.executableCode}:"codeExecutionResult"in e?{type:"codeExecutionResult",codeExecutionResult:e.codeExecutionResult}:e):[];let u="";if("string"==typeof r)u=r;else if(Array.isArray(r)&&r.length>0){let e=r.find(e=>"text"in e);u=e?.text??u}return{generations:[{text:u,message:new n.AIMessage({content:r??"",tool_calls:i?.map(e=>({...e,type:"tool_call",id:"id"in e&&"string"==typeof e.id?e.id:(0,o.v4)()})),additional_kwargs:{...l},usage_metadata:t?.usageMetadata}),generationInfo:l}],llmOutput:{tokenUsage:{promptTokens:t?.usageMetadata?.input_tokens,completionTokens:t?.usageMetadata?.output_tokens,totalTokens:t?.usageMetadata?.total_tokens}}}},r.convertResponseContentToChatGenerationChunk=function(e,t){let r;if(!e.candidates||0===e.candidates.length)return null;let a=e.functionCalls(),[s]=e.candidates,{content:l,...u}=s;r=Array.isArray(l?.parts)&&l.parts.every(e=>"text"in e)?l.parts.map(e=>e.text).join(""):Array.isArray(l?.parts)?l.parts.map(e=>"text"in e?{type:"text",text:e.text}:"executableCode"in e?{type:"executableCode",executableCode:e.executableCode}:"codeExecutionResult"in e?{type:"codeExecutionResult",codeExecutionResult:e.codeExecutionResult}:e):[];let c="";if(r&&"string"==typeof r)c=r;else if(Array.isArray(r)){let e=r.find(e=>"text"in e);c=e?.text??""}let d=[];return a&&d.push(...a.map(e=>({...e,args:JSON.stringify(e.args),index:t.index,type:"tool_call_chunk",id:"id"in e&&"string"==typeof e.id?e.id:(0,o.v4)()}))),new i.ChatGenerationChunk({text:c,message:new n.AIMessageChunk({content:r||"",name:l?l.role:void 0,tool_call_chunks:d,additional_kwargs:{},usage_metadata:t.usageMetadata}),generationInfo:u})},r.convertToGenerativeAITools=function(e){return e.every(e=>"functionDeclarations"in e&&Array.isArray(e.functionDeclarations))?e:[{functionDeclarations:e.map(e=>{if((0,a.isLangChainTool)(e)){let t=(0,l.schemaToGenerativeAIParameters)(e.schema);return"object"===t.type&&"properties"in t&&0===Object.keys(t.properties).length?{name:e.name,description:e.description}:{name:e.name,description:e.description,parameters:t}}return(0,s.isOpenAITool)(e)?{name:e.function.name,description:e.function.description??"A function available to call.",parameters:(0,l.jsonSchemaToGeminiParameters)(e.function.parameters)}:e})}]};let n=e.r(22991),i=e.r(24976),a=e.r(42200),s=e.r(95435),o=e.r(71639),l=e.r(37698);function u(e){let t=e._getType();return n.ChatMessage.isInstance(e)?e.role:"tool"===t?t:e.name??t}function c(e){switch(e){case"supervisor":case"ai":case"model":return"model";case"system":return"system";case"human":return"user";case"tool":case"function":return"function";default:throw Error(`Unknown / unsupported author: ${e}`)}}function d(e,t){if((0,n.isDataContentBlock)(e))return(0,n.convertToProviderContentBlock)(e,{providerName:"Google Gemini",fromStandardTextBlock:e=>({text:e.text}),fromStandardImageBlock(e){if(!t)throw Error("This model does not support images");if("url"===e.source_type){let t=(0,n.parseBase64DataUrl)({dataUrl:e.url});return t?{inlineData:{mimeType:t.mime_type,data:t.data}}:{fileData:{mimeType:e.mime_type??"",fileUri:e.url}}}if("base64"===e.source_type)return{inlineData:{mimeType:e.mime_type??"",data:e.data}};throw Error(`Unsupported source type: ${e.source_type}`)},fromStandardAudioBlock(e){if(!t)throw Error("This model does not support audio");if("url"===e.source_type){let t=(0,n.parseBase64DataUrl)({dataUrl:e.url});return t?{inlineData:{mimeType:t.mime_type,data:t.data}}:{fileData:{mimeType:e.mime_type??"",fileUri:e.url}}}if("base64"===e.source_type)return{inlineData:{mimeType:e.mime_type??"",data:e.data}};throw Error(`Unsupported source type: ${e.source_type}`)},fromStandardFileBlock(e){if(!t)throw Error("This model does not support files");if("text"===e.source_type)return{text:e.text};if("url"===e.source_type){let t=(0,n.parseBase64DataUrl)({dataUrl:e.url});return t?{inlineData:{mimeType:t.mime_type,data:t.data}}:{fileData:{mimeType:e.mime_type??"",fileUri:e.url}}}if("base64"===e.source_type)return{inlineData:{mimeType:e.mime_type??"",data:e.data}};throw Error(`Unsupported source type: ${e.source_type}`)}});if("text"===e.type)return{text:e.text};if("executableCode"===e.type)return{executableCode:e.executableCode};if("codeExecutionResult"===e.type)return{codeExecutionResult:e.codeExecutionResult};if("image_url"===e.type){let r;if(!t)throw Error("This model does not support images");if("string"==typeof e.image_url)r=e.image_url;else if("object"==typeof e.image_url&&"url"in e.image_url)r=e.image_url.url;else throw Error("Please provide image as base64 encoded data URL");let[n,i]=r.split(",");if(!n.startsWith("data:"))throw Error("Please provide image as base64 encoded data URL");let[a,s]=n.replace(/^data:/,"").split(";");if("base64"!==s)throw Error("Please provide image as base64 encoded data URL");return{inlineData:{data:i,mimeType:a}}}if("media"===e.type){if("mimeType"in e&&"data"in e)return{inlineData:{mimeType:e.mimeType,data:e.data}};if("mimeType"in e&&"fileUri"in e)return{fileData:{mimeType:e.mimeType,fileUri:e.fileUri}};throw Error("Invalid media content")}else if("tool_use"===e.type)return{functionCall:{name:e.name,args:e.input}};else if(e.type?.includes("/")&&2===e.type.split("/").length&&"data"in e&&"string"==typeof e.data)return{inlineData:{mimeType:e.type,data:e.data}};else if("functionCall"in e)return;else if("type"in e)throw Error(`Unknown content type ${e.type}`);else throw Error(`Unknown content ${JSON.stringify(e)}`)}function p(e,t,r){if((0,n.isToolMessage)(e)){let i=e.name??r.map(e=>(0,n.isAIMessage)(e)?e.tool_calls??[]:[]).flat().find(t=>t.id===e.tool_call_id)?.name;if(void 0===i)throw Error(`Google requires a tool name for each tool call response, and we could not infer a called tool name for ToolMessage "${e.id}" from your passed messages. Please populate a "name" field on that ToolMessage explicitly.`);let a=Array.isArray(e.content)?e.content.map(e=>d(e,t)).filter(e=>void 0!==e):e.content;return"error"===e.status?[{functionResponse:{name:i,response:{error:{details:a}}}}]:[{functionResponse:{name:i,response:{result:a}}}]}let i=[],a=[];return"string"==typeof e.content&&e.content&&a.push({text:e.content}),Array.isArray(e.content)&&a.push(...e.content.map(e=>d(e,t)).filter(e=>void 0!==e)),(0,n.isAIMessage)(e)&&e.tool_calls?.length&&(i=e.tool_calls.map(e=>({functionCall:{name:e.name,args:e.args}}))),[...a,...i]}},85006,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GoogleGenerativeAIToolsOutputParser=void 0;let n=e.r(62421),i=e.r(15225);class a extends n.BaseLLMOutputParser{static lc_name(){return"GoogleGenerativeAIToolsOutputParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","google_genai","output_parsers"]}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(void 0===this.zodSchema)return e;let t=await (0,i.interopSafeParseAsync)(this.zodSchema,e);if(t.success)return t.data;throw new n.OutputParserException(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error.issues)}`,JSON.stringify(e,null,2))}async parseResult(e){let t=e.flatMap(e=>{let{message:t}=e;return"tool_calls"in t&&Array.isArray(t.tool_calls)?t.tool_calls:[]});if(void 0===t[0])throw Error("No parseable tool calls provided to GoogleGenerativeAIToolsOutputParser.");let[r]=t;return await this._validateResult(r.args)}}r.GoogleGenerativeAIToolsOutputParser=a},25436,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.convertToolsToGenAI=function(e,t){let r=function(e){let t=[],r=[];return(e.forEach(e=>{if((0,i.isLangChainTool)(e)){let[r]=(0,s.convertToGenerativeAITools)([e]);r.functionDeclarations&&t.push(...r.functionDeclarations)}else if((0,a.isOpenAITool)(e)){var n;let{functionDeclarations:r}={functionDeclarations:[{name:(n=e).function.name,description:n.function.description,parameters:(0,o.removeAdditionalProperties)(n.function.parameters)}]};if(r)t.push(...r);else throw Error("Failed to convert OpenAI structured tool to GenerativeAI tool")}else r.push(e)}),r.find(e=>"functionDeclarations"in e))?r.map(e=>{if(t?.length>0&&"functionDeclarations"in e){let r={functionDeclarations:[...e.functionDeclarations||[],...t]};return t=[],r}return e}):[...r,...t.length>0?[{functionDeclarations:t}]:[]]}(e),l=function(e,t){if(!e.length||!t)return;let{toolChoice:r,allowedFunctionNames:i}=t,a={any:n.FunctionCallingMode.ANY,auto:n.FunctionCallingMode.AUTO,none:n.FunctionCallingMode.NONE};return r&&["any","auto","none"].includes(r)?{functionCallingConfig:{mode:a[r]??"MODE_UNSPECIFIED",allowedFunctionNames:i}}:"string"==typeof r||i?{functionCallingConfig:{mode:n.FunctionCallingMode.ANY,allowedFunctionNames:[...i??[],...r&&"string"==typeof r?[r]:[]]}}:void 0}(r,t);return{tools:r,toolConfig:l}};let n=e.r(90817),i=e.r(42200),a=e.r(95435),s=e.r(62152),o=e.r(37698)},88238,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChatGoogleGenerativeAI=void 0;let n=e.r(90817),i=e.r(17549),a=e.r(11144),s=e.r(78541),o=e.r(15225),l=e.r(62421),u=e.r(37698),c=e.r(62152),d=e.r(85006),p=e.r(25436);class h extends a.BaseChatModel{static lc_name(){return"ChatGoogleGenerativeAI"}get lc_secrets(){return{apiKey:"GOOGLE_API_KEY"}}get lc_aliases(){return{apiKey:"google_api_key"}}get _isMultimodalModel(){return this.model.includes("vision")||this.model.startsWith("gemini-1.5")||this.model.startsWith("gemini-2")||this.model.startsWith("gemma-3-")&&!this.model.startsWith("gemma-3-1b")}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","google_genai"]}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxOutputTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"safetySettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"json",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"convertSystemMessageToHumanContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=e.model.replace(/^models\//,""),this.maxOutputTokens=e.maxOutputTokens??this.maxOutputTokens,this.maxOutputTokens&&this.maxOutputTokens<0)throw Error("`maxOutputTokens` must be a positive integer");if(this.temperature=e.temperature??this.temperature,this.temperature&&(this.temperature<0||this.temperature>2))throw Error("`temperature` must be in the range of [0.0,2.0]");if(this.topP=e.topP??this.topP,this.topP&&this.topP<0)throw Error("`topP` must be a positive integer");if(this.topP&&this.topP>1)throw Error("`topP` must be below 1.");if(this.topK=e.topK??this.topK,this.topK&&this.topK<0)throw Error("`topK` must be a positive integer");if(this.stopSequences=e.stopSequences??this.stopSequences,this.apiKey=e.apiKey??(0,i.getEnvironmentVariable)("GOOGLE_API_KEY"),!this.apiKey)throw Error("Please set an API key for Google GenerativeAI in the environment variable GOOGLE_API_KEY or in the `apiKey` field of the ChatGoogleGenerativeAI constructor");if(this.safetySettings=e.safetySettings??this.safetySettings,this.safetySettings&&this.safetySettings.length>0&&new Set(this.safetySettings.map(e=>e.category)).size!==this.safetySettings.length)throw Error("The categories in `safetySettings` array must be unique");this.streaming=e.streaming??this.streaming,this.json=e.json,this.client=new n.GoogleGenerativeAI(this.apiKey).getGenerativeModel({model:this.model,safetySettings:this.safetySettings,generationConfig:{stopSequences:this.stopSequences,maxOutputTokens:this.maxOutputTokens,temperature:this.temperature,topP:this.topP,topK:this.topK,...this.json?{responseMimeType:"application/json"}:{}}},{apiVersion:e.apiVersion,baseUrl:e.baseUrl}),this.streamUsage=e.streamUsage??this.streamUsage}useCachedContent(e,t,r){this.apiKey&&(this.client=new n.GoogleGenerativeAI(this.apiKey).getGenerativeModelFromCachedContent(e,t,r))}get useSystemInstruction(){return"boolean"==typeof this.convertSystemMessageToHumanContent?!this.convertSystemMessageToHumanContent:this.computeUseSystemInstruction}get computeUseSystemInstruction(){return!("gemini-1.0-pro-001"===this.model||this.model.startsWith("gemini-pro-vision"))&&!this.model.startsWith("gemini-1.0-pro-vision")&&"gemini-pro"!==this.model&&!0}getLsParams(e){return{ls_provider:"google_genai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:this.client.generationConfig.temperature,ls_max_tokens:this.client.generationConfig.maxOutputTokens,ls_stop:e.stop}}_combineLLMOutput(){return[]}_llmType(){return"googlegenerativeai"}bindTools(e,t){return this.withConfig({tools:(0,p.convertToolsToGenAI)(e)?.tools,...t})}invocationParams(e){let t=e?.tools?.length?(0,p.convertToolsToGenAI)(e.tools,{toolChoice:e.tool_choice,allowedFunctionNames:e.allowedFunctionNames}):void 0;return e?.responseSchema?(this.client.generationConfig.responseSchema=e.responseSchema,this.client.generationConfig.responseMimeType="application/json"):(this.client.generationConfig.responseSchema=void 0,this.client.generationConfig.responseMimeType=this.json?"application/json":void 0),{...t?.tools?{tools:t.tools}:{},...t?.toolConfig?{toolConfig:t.toolConfig}:{}}}async _generate(e,t,r){let n,i=(0,c.convertBaseMessagesToContent)(e,this._isMultimodalModel,this.useSystemInstruction),a=i;if("system"===i[0].role){let[e]=i;this.client.systemInstruction=e,a=i.slice(1)}let s=this.invocationParams(t);if(this.streaming){let n=this._streamResponseChunks(e,t,r),i={};for await(let e of n){let t=e.generationInfo?.completion??0;void 0===i[t]?i[t]=e:i[t]=i[t].concat(e)}return{generations:Object.entries(i).sort(([e],[t])=>parseInt(e,10)-parseInt(t,10)).map(([e,t])=>t),llmOutput:{estimatedTokenUsage:{}}}}let o=await this.completionWithRetry({...s,contents:a});if("usageMetadata"in o.response){let e=o.response.usageMetadata;n={input_tokens:e.promptTokenCount??0,output_tokens:e.candidatesTokenCount??0,total_tokens:e.totalTokenCount??0}}let l=(0,c.mapGenerateContentResultToChatResult)(o.response,{usageMetadata:n});return l.generations?.length>0&&await r?.handleLLMNewToken(l.generations[0]?.text??""),l}async *_streamResponseChunks(e,t,r){let n,i=(0,c.convertBaseMessagesToContent)(e,this._isMultimodalModel,this.useSystemInstruction),a=i;if("system"===i[0].role){let[e]=i;this.client.systemInstruction=e,a=i.slice(1)}let s={...this.invocationParams(t),contents:a},o=await this.caller.callWithOptions({signal:t?.signal},async()=>{let{stream:e}=await this.client.generateContentStream(s);return e}),l=0,u=0,d=0,p=0;for await(let e of o){if("usageMetadata"in e&&void 0!==e.usageMetadata&&!1!==this.streamUsage&&!1!==t.streamUsage){n={input_tokens:e.usageMetadata.promptTokenCount??0,output_tokens:e.usageMetadata.candidatesTokenCount??0,total_tokens:e.usageMetadata.totalTokenCount??0};let t=e.usageMetadata.promptTokenCount??0;n.input_tokens=Math.max(0,t-l),l=t;let r=e.usageMetadata.candidatesTokenCount??0;n.output_tokens=Math.max(0,r-u),u=r;let i=e.usageMetadata.totalTokenCount??0;n.total_tokens=Math.max(0,i-d),d=i}let i=(0,c.convertResponseContentToChatGenerationChunk)(e,{usageMetadata:n,index:p});p+=1,i&&(yield i,await r?.handleLLMNewToken(i.text??""))}}async completionWithRetry(e,t){return this.caller.callWithOptions({signal:t?.signal},async()=>{try{return await this.client.generateContent(e)}catch(e){throw e.message?.includes("400 Bad Request")&&(e.status=400),e}})}withStructuredOutput(e,t){let r,n,i=t?.name,a=t?.method,c=t?.includeRaw;if("jsonMode"===a)throw Error('ChatGoogleGenerativeAI only supports "jsonSchema" or "functionCalling" as a method.');if("functionCalling"===a){let t,a=i??"extract";if((0,o.isInteropZodSchema)(e)){let r=(0,u.schemaToGenerativeAIParameters)(e);t=[{functionDeclarations:[{name:a,description:r.description??"A function available to call.",parameters:r}]}],n=new d.GoogleGenerativeAIToolsOutputParser({returnSingle:!0,keyName:a,zodSchema:e})}else{let r;"string"==typeof e.name&&"object"==typeof e.parameters&&null!=e.parameters?((r=e).parameters=(0,u.removeAdditionalProperties)(e.parameters),a=e.name):r={name:a,description:e.description??"",parameters:(0,u.removeAdditionalProperties)(e)},t=[{functionDeclarations:[r]}],n=new d.GoogleGenerativeAIToolsOutputParser({returnSingle:!0,keyName:a})}r=this.bindTools(t).withConfig({allowedFunctionNames:[a]})}else{let t=(0,u.schemaToGenerativeAIParameters)(e);r=this.withConfig({responseSchema:t}),n=new l.JsonOutputParser}if(!c)return r.pipe(n).withConfig({runName:"ChatGoogleGenerativeAIStructuredOutput"});let p=s.RunnablePassthrough.assign({parsed:(e,t)=>n.invoke(e.raw,t)}),h=s.RunnablePassthrough.assign({parsed:()=>null}),f=p.withFallbacks({fallbacks:[h]});return s.RunnableSequence.from([{raw:r},f]).withConfig({runName:"StructuredOutputRunnable"})}}r.ChatGoogleGenerativeAI=h},48976,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GoogleGenerativeAIEmbeddings=void 0;let n=e.r(90817),i=e.r(17549),a=e.r(98175),s=e.r(16511);class o extends a.Embeddings{constructor(e){if(super(e??{}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"embedding-001"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"embedding-001"}),Object.defineProperty(this,"taskType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"title",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxBatchSize",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.modelName=e?.model?.replace(/^models\//,"")??e?.modelName?.replace(/^models\//,"")??this.modelName,this.model=this.modelName,this.taskType=e?.taskType??this.taskType,this.title=e?.title??this.title,this.title&&"RETRIEVAL_DOCUMENT"!==this.taskType)throw Error("title can only be sepcified with TaskType.RETRIEVAL_DOCUMENT");if(this.apiKey=e?.apiKey??(0,i.getEnvironmentVariable)("GOOGLE_API_KEY"),!this.apiKey)throw Error("Please set an API key for Google GenerativeAI in the environmentb variable GOOGLE_API_KEY or in the `apiKey` field of the GoogleGenerativeAIEmbeddings constructor");this.client=new n.GoogleGenerativeAI(this.apiKey).getGenerativeModel({model:this.model},{baseUrl:e?.baseUrl})}_convertToContent(e){return{content:{role:"user",parts:[{text:this.stripNewLines?e.replace(/\n/g," "):e}]},taskType:this.taskType,title:this.title}}async _embedQueryContent(e){let t=this._convertToContent(e);return(await this.client.embedContent(t)).embedding.values??[]}async _embedDocumentsContent(e){let t=(0,s.chunkArray)(e,this.maxBatchSize),r=t.map(e=>({requests:e.map(e=>this._convertToContent(e))}));return(await Promise.allSettled(r.map(e=>this.client.batchEmbedContents(e)))).flatMap((e,r)=>"fulfilled"===e.status?e.value.embeddings.map(e=>e.values||[]):Array(t[r].length).fill([]))}embedQuery(e){return this.caller.call(this._embedQueryContent.bind(this),e)}embedDocuments(e){return this.caller.call(this._embedDocumentsContent.bind(this),e)}}r.GoogleGenerativeAIEmbeddings=o},55936,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(88238),r),i(e.r(48976),r)},44751,(e,t,r)=>{t.exports=e.r(55936)},76889,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createLocalModel=function(e){let t=process.env.OLLAMA_MODEL||"Red";return new n.ChatOllama({baseUrl:e.defaultLlmUrl||process.env.OLLAMA_BASE_URL||"http://localhost:11434",model:t,temperature:0})},r.createOpenAIModel=function(){return new i.ChatOpenAI({modelName:"gpt-5",temperature:0,streaming:!0,openAIApiKey:process.env.OPENAI_API_KEY})},r.createGeminiModel=function(){return new a.ChatGoogleGenerativeAI({model:"gemini-2.5-pro",temperature:0,streaming:!0,apiKey:process.env.GOOGLE_API_KEY})};let n=e.r(58257),i=e.r(48133),a=e.r(44751)},55201,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.summarizeInBackground=function(e,t,r){t.summarizeIfNeeded(e,e=>n(this,void 0,void 0,function*(){return(yield r.invoke([{role:"user",content:e}])).content})).catch(e=>console.error("[Red] Summarization failed:",e))},r.generateExecutiveSummaryInBackground=function(e,t,r){t.generateExecutiveSummary(e,e=>n(this,void 0,void 0,function*(){return(yield r.invoke([{role:"user",content:e}])).content})).catch(e=>console.error("[Red] Executive summary generation failed:",e))}},41532,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.generateTitleInBackground=function(e,t,r,i){return n(this,void 0,void 0,function*(){try{if(2!==t&&6!==t)return;let n=yield r.getMetadata(e);if(null==n?void 0:n.titleSetByUser)return;let a=yield r.getMessages(e),s=a.slice(0,Math.min(6,a.length)).map(e=>`${e.role.toUpperCase()}: ${e.content}`).join("\n"),o=`Based on this conversation, generate a short, descriptive title (3-6 words max). Only respond with the title, nothing else:

${s}`,l=(yield i.invoke([{role:"user",content:o}])).content.trim().replace(/^["']|["']$/g,""),u=`conversation:${e}:metadata`;yield r.redis.hset(u,"title",l),console.log(`[Red] Generated title for ${e}: "${l}"`)}catch(e){console.error("[Red] Title generation failed:",e)}})},r.setConversationTitle=function(e,t,r){return n(this,void 0,void 0,function*(){let n=`conversation:${e}:metadata`;yield r.redis.hset(n,{title:t,titleSetByUser:"true"}),console.log(`[Red] User set title for ${e}: "${t}"`)})},r.getConversationTitle=function(e,t){return n(this,void 0,void 0,function*(){let r=yield t.getMetadata(e);return(null==r?void 0:r.title)||null})}},21545,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};function i(e,t){return n(this,void 0,void 0,function*(){if(e)try{let r=`nodes:active:${e}`,n=Date.now();yield t.setex(r,20,n.toString()),console.log(`[Heartbeat] ${e} - alive`)}catch(e){console.error("[Heartbeat] Failed to send heartbeat:",e)}})}Object.defineProperty(r,"__esModule",{value:!0}),r.startHeartbeat=function(e,t){if(!e)throw console.warn("[Heartbeat] No nodeId set, skipping heartbeat"),Error("nodeId is required for heartbeat");i(e,t);let r=setInterval(()=>{i(e,t)},1e4);return console.log(`[Heartbeat] Started for node: ${e}`),r},r.sendHeartbeat=i,r.stopHeartbeat=function(e,t,r){return n(this,void 0,void 0,function*(){if(r&&clearInterval(r),e)try{let r=`nodes:active:${e}`;yield t.del(r),console.log(`[Heartbeat] Stopped for node: ${e}`)}catch(e){console.error("[Heartbeat] Failed to cleanup on stop:",e)}})},r.getActiveNodes=function(e){return n(this,void 0,void 0,function*(){try{return(yield e.keys("nodes:active:*")).map(e=>e.replace("nodes:active:",""))}catch(e){return console.error("[Heartbeat] Failed to get active nodes:",e),[]}})}},11554,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(55201),r),i(e.r(41532),r),i(e.r(21545),r)},78500,(e,t,r)=>{t.exports=e.x("node:async_hooks",()=>require("node:async_hooks"))},47035,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.initializeAsyncLocalStorageSingleton=function(){n.AsyncLocalStorageProviderSingleton.initializeGlobalInstance(new i.AsyncLocalStorage)};let n=e.r(92595),i=e.r(78500)},83134,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getSubgraphsSeenSet=r.RemoteException=r.UnreachableNodeError=r.MultipleSubgraphsError=r.InvalidUpdateError=r.EmptyChannelError=r.EmptyInputError=r.ParentCommand=r.NodeInterrupt=r.GraphInterrupt=r.GraphValueError=r.GraphRecursionError=r.GraphBubbleUp=r.BaseLangGraphError=void 0,r.isParentCommand=function(e){return void 0!==e&&e.name===o.unminifiable_name},r.isGraphBubbleUp=function(e){return void 0!==e&&!0===e.is_bubble_up},r.isGraphInterrupt=function(e){return void 0!==e&&[a.unminifiable_name,s.unminifiable_name].includes(e.name)};class n extends Error{constructor(e,t){let r=e??"";t?.lc_error_code&&(r=`${r}

Troubleshooting URL: https://langchain-ai.github.io/langgraphjs/troubleshooting/errors/${t.lc_error_code}/
`),super(r),Object.defineProperty(this,"lc_error_code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_error_code=t?.lc_error_code}}r.BaseLangGraphError=n;class i extends n{get is_bubble_up(){return!0}}r.GraphBubbleUp=i,r.GraphRecursionError=class extends n{constructor(e,t){super(e,t),this.name="GraphRecursionError"}static get unminifiable_name(){return"GraphRecursionError"}},r.GraphValueError=class extends n{constructor(e,t){super(e,t),this.name="GraphValueError"}static get unminifiable_name(){return"GraphValueError"}};class a extends i{constructor(e,t){super(JSON.stringify(e,null,2),t),Object.defineProperty(this,"interrupts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="GraphInterrupt",this.interrupts=e??[]}static get unminifiable_name(){return"GraphInterrupt"}}r.GraphInterrupt=a;class s extends a{constructor(e,t){super([{value:e}],t),this.name="NodeInterrupt"}static get unminifiable_name(){return"NodeInterrupt"}}r.NodeInterrupt=s;class o extends i{constructor(e){super(),Object.defineProperty(this,"command",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="ParentCommand",this.command=e}static get unminifiable_name(){return"ParentCommand"}}r.ParentCommand=o,r.EmptyInputError=class extends n{constructor(e,t){super(e,t),this.name="EmptyInputError"}static get unminifiable_name(){return"EmptyInputError"}},r.EmptyChannelError=class extends n{constructor(e,t){super(e,t),this.name="EmptyChannelError"}static get unminifiable_name(){return"EmptyChannelError"}},r.InvalidUpdateError=class extends n{constructor(e,t){super(e,t),this.name="InvalidUpdateError"}static get unminifiable_name(){return"InvalidUpdateError"}},r.MultipleSubgraphsError=class extends n{constructor(e,t){super(e,t),this.name="MultipleSubgraphError"}static get unminifiable_name(){return"MultipleSubgraphError"}},r.UnreachableNodeError=class extends n{constructor(e,t){super(e,t),this.name="UnreachableNodeError"}static get unminifiable_name(){return"UnreachableNodeError"}},r.RemoteException=class extends n{constructor(e,t){super(e,t),this.name="RemoteException"}static get unminifiable_name(){return"RemoteException"}},r.getSubgraphsSeenSet=()=>(void 0===globalThis[Symbol.for("LG_CHECKPOINT_SEEN_NS_SET")]&&(globalThis[Symbol.for("LG_CHECKPOINT_SEEN_NS_SET")]=new Set),globalThis[Symbol.for("LG_CHECKPOINT_SEEN_NS_SET")])},56491,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.uuid6=function(e){return(0,n.v6)({clockseq:e})},r.uuid5=function(e,t){let r=t.replace(/-/g,"").match(/.{2}/g).map(e=>parseInt(e,16));return(0,n.v5)(e,new Uint8Array(r))};let n=e.r(79403)},30455,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RESUME=r.INTERRUPT=r.SCHEDULED=r.ERROR=r.TASKS=void 0,r.TASKS="__pregel_tasks",r.ERROR="__error__",r.SCHEDULED="__scheduled__",r.INTERRUPT="__interrupt__",r.RESUME="__resume__"},11660,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.optionalImportEntrypoints=void 0,r.optionalImportEntrypoints=[]},46787,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},41594,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InMemoryChatMessageHistory=r.BaseListChatMessageHistory=r.BaseChatMessageHistory=void 0;let n=e.r(46893),i=e.r(39512);class a extends n.Serializable{async addMessages(e){for(let t of e)await this.addMessage(t)}}r.BaseChatMessageHistory=a;class s extends n.Serializable{addUserMessage(e){return this.addMessage(new i.HumanMessage(e))}addAIChatMessage(e){return this.addMessage(new i.AIMessage(e))}addAIMessage(e){return this.addMessage(new i.AIMessage(e))}async addMessages(e){for(let t of e)await this.addMessage(t)}clear(){throw Error("Not implemented.")}}r.BaseListChatMessageHistory=s,r.InMemoryChatMessageHistory=class extends s{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","stores","message","in_memory"]}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.messages=e??[]}async getMessages(){return this.messages}async addMessage(e){this.messages.push(e)}async clear(){this.messages=[]}}},64552,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Document=void 0,r.Document=class{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=void 0!==e.pageContent?e.pageContent.toString():"",this.metadata=e.metadata??{},this.id=e.id}}},96571,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MappingDocumentTransformer=r.BaseDocumentTransformer=void 0;let n=e.r(68974);class i extends n.Runnable{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","documents","transformers"]})}invoke(e,t){return this.transformDocuments(e)}}r.BaseDocumentTransformer=i,r.MappingDocumentTransformer=class extends i{async transformDocuments(e){let t=[];for(let r of e){let e=await this._transformDocument(r);t.push(e)}return t}}},11690,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(64552),r),i(e.r(96571),r)},27779,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseExampleSelector=void 0;let n=e.r(46893);class i extends n.Serializable{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","example_selectors","base"]})}}r.BaseExampleSelector=i},1276,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ConditionalPromptSelector=r.BasePromptSelector=void 0,r.isLLM=function(e){return"base_llm"===e._modelType()},r.isChatModel=function(e){return"base_chat_model"===e._modelType()};class n{async getPromptAsync(e,t){return this.getPrompt(e).partial(t?.partialVariables??{})}}r.BasePromptSelector=n,r.ConditionalPromptSelector=class extends n{constructor(e,t=[]){super(),Object.defineProperty(this,"defaultPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"conditionals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.defaultPrompt=e,this.conditionals=t}getPrompt(e){for(let[t,r]of this.conditionals)if(t(e))return r;return this.defaultPrompt}}},49260,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LengthBasedExampleSelector=void 0;let n=e.r(27779);function i(e){return e.split(/\n| /).length}class a extends n.BaseExampleSelector{constructor(e){super(e),Object.defineProperty(this,"examples",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"getTextLength",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,writable:!0,value:2048}),Object.defineProperty(this,"exampleTextLengths",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.examplePrompt=e.examplePrompt,this.maxLength=e.maxLength??2048,this.getTextLength=e.getTextLength??i}async addExample(e){this.examples.push(e);let t=await this.examplePrompt.format(e);this.exampleTextLengths.push(this.getTextLength(t))}async calculateExampleTextLengths(e,t){if(e.length>0)return e;let{examples:r,examplePrompt:n}=t;return(await Promise.all(r.map(e=>n.format(e)))).map(e=>this.getTextLength(e))}async selectExamples(e){let t=Object.values(e).join(" "),r=this.maxLength-this.getTextLength(t),n=0,i=[];for(;r>0&&n<this.examples.length;){let e=r-this.exampleTextLengths[n];if(e<0)break;i.push(this.examples[n]),r=e,n+=1}return i}static async fromExamples(e,t){let r=new a(t);return await Promise.all(e.map(e=>r.addExample(e))),r}}r.LengthBasedExampleSelector=a},28398,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SemanticSimilarityExampleSelector=void 0;let n=e.r(64552),i=e.r(27779);function a(e){return Object.keys(e).sort().map(t=>e[t])}class s extends i.BaseExampleSelector{constructor(e){if(super(e),Object.defineProperty(this,"vectorStoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleKeys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKeys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.exampleKeys=e.exampleKeys,this.inputKeys=e.inputKeys,void 0!==e.vectorStore)this.vectorStoreRetriever=e.vectorStore.asRetriever({k:e.k??4,filter:e.filter});else if(e.vectorStoreRetriever)this.vectorStoreRetriever=e.vectorStoreRetriever;else throw Error('You must specify one of "vectorStore" and "vectorStoreRetriever".')}async addExample(e){let t=a((this.inputKeys??Object.keys(e)).reduce((t,r)=>({...t,[r]:e[r]}),{})).join(" ");await this.vectorStoreRetriever.addDocuments([new n.Document({pageContent:t,metadata:e})])}async selectExamples(e){let t=a((this.inputKeys??Object.keys(e)).reduce((t,r)=>({...t,[r]:e[r]}),{})).join(" "),r=(await this.vectorStoreRetriever.invoke(t)).map(e=>e.metadata);return this.exampleKeys?r.map(e=>this.exampleKeys.reduce((t,r)=>({...t,[r]:e[r]}),{})):r}static async fromExamples(e,t,r,n={}){let i=n.inputKeys??null,o=e.map(e=>a(i?i.reduce((t,r)=>({...t,[r]:e[r]}),{}):e).join(" "));return new s({vectorStore:await r.fromTexts(o,e,t,n),k:n.k??4,exampleKeys:n.exampleKeys,inputKeys:n.inputKeys})}}r.SemanticSimilarityExampleSelector=s},11919,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(27779),r),i(e.r(1276),r),i(e.r(49260),r),i(e.r(28398),r)},58039,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getOutputValue=r.getInputValue=r.BaseMemory=void 0,r.getPromptInputKey=function(e,t){let r=Object.keys(e).filter(e=>!t.includes(e)&&"stop"!==e);if(1!==r.length)throw Error(`One input key expected, but got ${r.length}`);return r[0]},r.BaseMemory=class{};let n=(e,t)=>{if(void 0!==t)return e[t];let r=Object.keys(e);if(1===r.length)return e[r[0]]};r.getInputValue=(e,t)=>{let r=n(e,t);if(!r){let t=Object.keys(e);throw Error(`input values have ${t.length} keys, you must specify an input key or pass only 1 key as input`)}return r},r.getOutputValue=(e,t)=>{let r=n(e,t);if(!r&&""!==r){let t=Object.keys(e);throw Error(`output values have ${t.length} keys, you must specify an output key or pass only 1 key as output`)}return r}},79312,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseStringPromptTemplate=void 0;let n=e.r(63983),i=e.r(13741);class a extends i.BasePromptTemplate{async formatPromptValue(e){let t=await this.format(e);return new n.StringPromptValue(t)}}r.BaseStringPromptTemplate=a},56687,(e,t,r)=>{e.e,t.exports=function(){"use strict";var e=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===e.call(t)};function r(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(e,t){return null!=e&&"object"==typeof e&&t in e}var a=RegExp.prototype.test,s=/\S/,o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},l=/\s*/,u=/\s+/,c=/\s*=/,d=/\s*\}/,p=/#|\^|\/|>|\{|&|=|!/;function h(e){this.string=e,this.tail=e,this.pos=0}function f(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function m(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}h.prototype.eos=function(){return""===this.tail},h.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},h.prototype.scanUntil=function(e){var t,r=this.tail.search(e);switch(r){case -1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},f.prototype.push=function(e){return new f(e,this)},f.prototype.lookup=function(e){var t=this.cache;if(t.hasOwnProperty(e))s=t[e];else{for(var n,a,s,o,l,u,c=this,d=!1;c;){if(e.indexOf(".")>0)for(o=c.view,l=e.split("."),u=0;null!=o&&u<l.length;)u===l.length-1&&(d=i(o,l[u])||(n=o,a=l[u],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(a))),o=o[l[u++]];else o=c.view[e],d=i(c.view,e);if(d){s=o;break}c=c.parent}t[e]=s}return r(s)&&(s=s.call(this.view)),s},m.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},m.prototype.parse=function(e,r){var i=this.templateCache,o=e+":"+(r||g.tags).join(":"),f=void 0!==i,m=f?i.get(o):void 0;return void 0==m&&(m=function(e,r){if(!e)return[];var i,o,f,m,y,b,_,v,w,O=!1,P=[],S=[],E=[],k=!1,I=!1,A="",T=0;function C(){if(k&&!I)for(;E.length;)delete S[E.pop()];else E=[];k=!1,I=!1}function j(e){if("string"==typeof e&&(e=e.split(u,2)),!t(e)||2!==e.length)throw Error("Invalid tags: "+e);i=RegExp(n(e[0])+"\\s*"),o=RegExp("\\s*"+n(e[1])),f=RegExp("\\s*"+n("}"+e[1]))}j(r||g.tags);for(var x=new h(e);!x.eos();){if(m=x.pos,b=x.scanUntil(i))for(var $=0,N=b.length;$<N;++$)!function(e){return!a.call(s,e)}(_=b.charAt($))?(I=!0,O=!0,A+=" "):(E.push(S.length),A+=_),S.push(["text",_,m,m+1]),m+=1,"\n"===_&&(C(),A="",T=0,O=!1);if(!x.scan(i))break;if(k=!0,y=x.scan(p)||"name",x.scan(l),"="===y?(b=x.scanUntil(c),x.scan(c),x.scanUntil(o)):"{"===y?(b=x.scanUntil(f),x.scan(d),x.scanUntil(o),y="&"):b=x.scanUntil(o),!x.scan(o))throw Error("Unclosed tag at "+x.pos);if(v=">"==y?[y,b,m,x.pos,A,T,O]:[y,b,m,x.pos],T++,S.push(v),"#"===y||"^"===y)P.push(v);else if("/"===y){if(!(w=P.pop()))throw Error('Unopened section "'+b+'" at '+m);if(w[1]!==b)throw Error('Unclosed section "'+w[1]+'" at '+m)}else"name"===y||"{"===y||"&"===y?I=!0:"="===y&&j(b)}if(C(),w=P.pop())throw Error('Unclosed section "'+w[1]+'" at '+x.pos);return function(e){for(var t,r=[],n=r,i=[],a=0,s=e.length;a<s;++a)switch((t=e[a])[0]){case"#":case"^":n.push(t),i.push(t),n=t[4]=[];break;case"/":i.pop()[5]=t[2],n=i.length>0?i[i.length-1][4]:r;break;default:n.push(t)}return r}(function(e){for(var t,r,n=[],i=0,a=e.length;i<a;++i)(t=e[i])&&("text"===t[0]&&r&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(n.push(t),r=t));return n}(S))}(e,r),f&&i.set(o,m)),m},m.prototype.render=function(e,t,r,n){var i=this.getConfigTags(n),a=this.parse(e,i),s=t instanceof f?t:new f(t,void 0);return this.renderTokens(a,s,r,e,n)},m.prototype.renderTokens=function(e,t,r,n,i){for(var a,s,o,l="",u=0,c=e.length;u<c;++u)o=void 0,"#"===(s=(a=e[u])[0])?o=this.renderSection(a,t,r,n,i):"^"===s?o=this.renderInverted(a,t,r,n,i):">"===s?o=this.renderPartial(a,t,r,i):"&"===s?o=this.unescapedValue(a,t):"name"===s?o=this.escapedValue(a,t,i):"text"===s&&(o=this.rawValue(a)),void 0!==o&&(l+=o);return l},m.prototype.renderSection=function(e,n,i,a,s){var o=this,l="",u=n.lookup(e[1]);if(u){if(t(u))for(var c=0,d=u.length;c<d;++c)l+=this.renderTokens(e[4],n.push(u[c]),i,a,s);else if("object"==typeof u||"string"==typeof u||"number"==typeof u)l+=this.renderTokens(e[4],n.push(u),i,a,s);else if(r(u)){if("string"!=typeof a)throw Error("Cannot use higher-order sections without the original template");null!=(u=u.call(n.view,a.slice(e[3],e[5]),function(e){return o.render(e,n,i,s)}))&&(l+=u)}else l+=this.renderTokens(e[4],n,i,a,s);return l}},m.prototype.renderInverted=function(e,r,n,i,a){var s=r.lookup(e[1]);if(!s||t(s)&&0===s.length)return this.renderTokens(e[4],r,n,i,a)},m.prototype.indentPartial=function(e,t,r){for(var n=t.replace(/[^ \t]/g,""),i=e.split("\n"),a=0;a<i.length;a++)i[a].length&&(a>0||!r)&&(i[a]=n+i[a]);return i.join("\n")},m.prototype.renderPartial=function(e,t,n,i){if(n){var a=this.getConfigTags(i),s=r(n)?n(e[1]):n[e[1]];if(null!=s){var o=e[6],l=e[5],u=e[4],c=s;0==l&&u&&(c=this.indentPartial(s,u,o));var d=this.parse(c,a);return this.renderTokens(d,t,n,c,i)}}},m.prototype.unescapedValue=function(e,t){var r=t.lookup(e[1]);if(null!=r)return r},m.prototype.escapedValue=function(e,t,r){var n=this.getConfigEscape(r)||g.escape,i=t.lookup(e[1]);if(null!=i)return"number"==typeof i&&n===g.escape?String(i):n(i)},m.prototype.rawValue=function(e){return e[1]},m.prototype.getConfigTags=function(e){return t(e)?e:e&&"object"==typeof e?e.tags:void 0},m.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!t(e)?e.escape:void 0};var g={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(cache){y.templateCache=cache},get templateCache(){return y.templateCache}},y=new m;return g.clearCache=function(){return y.clearCache()},g.parse=function(e,t){return y.parse(e,t)},g.render=function(e,r,n,i){if("string"!=typeof e)throw TypeError('Invalid template! Template should be a "string" but "'+(t(e)?"array":typeof e)+'" was given as the first argument for mustache#render(template, view, partials)');return y.render(e,r,n,i)},g.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return o[e]})},g.Scanner=h,g.Context=f,g.Writer=m,g}()},32302,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.checkValidTemplate=r.parseTemplate=r.renderTemplate=r.DEFAULT_PARSER_MAPPING=r.DEFAULT_FORMATTER_MAPPING=r.interpolateMustache=r.interpolateFString=r.parseMustache=r.parseFString=void 0;let i=n(e.r(56687)),a=e.r(97898);function s(){i.default.escape=e=>e}r.parseFString=e=>{let t=e.split(""),r=[],n=(e,r)=>{for(let n=r;n<t.length;n+=1)if(e.includes(t[n]))return n;return -1},i=0;for(;i<t.length;)if("{"===t[i]&&i+1<t.length&&"{"===t[i+1])r.push({type:"literal",text:"{"}),i+=2;else if("}"===t[i]&&i+1<t.length&&"}"===t[i+1])r.push({type:"literal",text:"}"}),i+=2;else if("{"===t[i]){let e=n("}",i);if(e<0)throw Error("Unclosed '{' in template.");r.push({type:"variable",name:t.slice(i+1,e).join("")}),i=e+1}else if("}"===t[i])throw Error("Single '}' in template.");else{let e=n("{}",i),a=(e<0?t.slice(i):t.slice(i,e)).join("");r.push({type:"literal",text:a}),i=e<0?t.length:e}return r};let o=(e,t=[])=>{let r=[];for(let n of e)if("name"===n[0]){let e=n[1].includes(".")?n[1].split(".")[0]:n[1];r.push({type:"variable",name:e})}else if(["#","&","^",">"].includes(n[0])){if(r.push({type:"variable",name:n[1]}),"#"===n[0]&&n.length>4&&Array.isArray(n[4])){let e=[...t,n[1]],i=o(n[4],e);r.push(...i)}}else r.push({type:"literal",text:n[1]});return r};r.parseMustache=e=>(s(),o(i.default.parse(e))),r.interpolateFString=(e,t)=>(0,r.parseFString)(e).reduce((e,r)=>{if("variable"===r.type){if(r.name in t)return e+("string"==typeof t[r.name]?t[r.name]:JSON.stringify(t[r.name]));throw Error(`(f-string) Missing value for input ${r.name}`)}return e+r.text},""),r.interpolateMustache=(e,t)=>(s(),i.default.render(e,t)),r.DEFAULT_FORMATTER_MAPPING={"f-string":r.interpolateFString,mustache:r.interpolateMustache},r.DEFAULT_PARSER_MAPPING={"f-string":r.parseFString,mustache:r.parseMustache},r.renderTemplate=(e,t,n)=>{try{return r.DEFAULT_FORMATTER_MAPPING[t](e,n)}catch(e){throw(0,a.addLangChainErrorFields)(e,"INVALID_PROMPT_INPUT")}},r.parseTemplate=(e,t)=>r.DEFAULT_PARSER_MAPPING[t](e),r.checkValidTemplate=(e,t,n)=>{if(!(t in r.DEFAULT_FORMATTER_MAPPING)){let e=Object.keys(r.DEFAULT_FORMATTER_MAPPING);throw Error(`Invalid template format. Got \`${t}\`;
                         should be one of ${e}`)}try{let i=n.reduce((e,t)=>(e[t]="foo",e),{});Array.isArray(e)?e.forEach(e=>{if("text"===e.type)(0,r.renderTemplate)(e.text,t,i);else if("image_url"===e.type)if("string"==typeof e.image_url)(0,r.renderTemplate)(e.image_url,t,i);else{let n=e.image_url.url;(0,r.renderTemplate)(n,t,i)}else throw Error(`Invalid message template received. ${JSON.stringify(e,null,2)}`)}):(0,r.renderTemplate)(e,t,i)}catch(e){throw Error(`Invalid prompt schema: ${e.message}`)}}},24036,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PromptTemplate=void 0;let n=e.r(79312),i=e.r(32302);class a extends n.BaseStringPromptTemplate{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),"mustache"===e.templateFormat&&void 0===e.validateTemplate&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if("mustache"===this.templateFormat)throw Error("Mustache templates cannot be validated.");let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,i.checkValidTemplate)(this.template,this.templateFormat,e)}}_getPromptType(){return"prompt"}async format(e){let t=await this.mergePartialAndUserVariables(e);return(0,i.renderTemplate)(this.template,this.templateFormat,t)}static fromExamples(e,t,r,n="\n\n",i=""){return new a({inputVariables:r,template:[i,...e,t].join(n)})}static fromTemplate(e,t){let{templateFormat:r="f-string",...n}=t??{},s=new Set;return(0,i.parseTemplate)(e,r).forEach(e=>{"variable"===e.type&&s.add(e.name)}),new a({inputVariables:[...s],templateFormat:r,template:e,...n})}async partial(e){let t=this.inputVariables.filter(t=>!(t in e)),r={...this.partialVariables??{},...e};return new a({...this,inputVariables:t,partialVariables:r})}serialize(){if(void 0!==this.outputParser)throw Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw Error("Prompt template must have a template");return new a({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}r.PromptTemplate=a},50529,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ImagePromptTemplate=void 0;let n=e.r(63983),i=e.r(13741),a=e.r(32302);class s extends i.BasePromptTemplate{static lc_name(){return"ImagePromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","image"]}),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e.template,this.templateFormat=e.templateFormat??this.templateFormat,this.validateTemplate=e.validateTemplate??this.validateTemplate,this.additionalContentFields=e.additionalContentFields,this.validateTemplate){let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,a.checkValidTemplate)([{type:"image_url",image_url:this.template}],this.templateFormat,e)}}_getPromptType(){return"prompt"}async partial(e){let t=this.inputVariables.filter(t=>!(t in e)),r={...this.partialVariables??{},...e};return new s({...this,inputVariables:t,partialVariables:r})}async format(e){let t={};for(let[r,n]of Object.entries(this.template))"string"==typeof n?t[r]=(0,a.renderTemplate)(n,this.templateFormat,e):t[r]=n;let r=e.url||t.url,n=e.detail||t.detail;if(!r)throw Error("Must provide either an image URL.");if("string"!=typeof r)throw Error("url must be a string.");let i={url:r};return n&&(i.detail=n),i}async formatPromptValue(e){let t=await this.format(e);return new n.ImagePromptValue(t)}}r.ImagePromptTemplate=s},84695,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DictPromptTemplate=void 0;let n=e.r(68974),i=e.r(32302);class a extends n.Runnable{static lc_name(){return"DictPromptTemplate"}constructor(e){let t=e.templateFormat??"f-string",r=function e(t,r){let n=[];for(let a of Object.values(t))if("string"==typeof a)(0,i.parseTemplate)(a,r).forEach(e=>{"variable"===e.type&&n.push(e.name)});else if(Array.isArray(a))for(let t of a)"string"==typeof t?(0,i.parseTemplate)(t,r).forEach(e=>{"variable"===e.type&&n.push(e.name)}):"object"==typeof t&&n.push(...e(t,r));else"object"==typeof a&&null!==a&&n.push(...e(a,r));return Array.from(new Set(n))}(e.template,t);super({inputVariables:r,...e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","dict"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e.template,this.templateFormat=t,this.inputVariables=r}async format(e){return function e(t,r,n){let a={};for(let[s,o]of Object.entries(t))if("string"==typeof o)a[s]=(0,i.renderTemplate)(o,n,r);else if(Array.isArray(o)){let t=[];for(let a of o)"string"==typeof a?t.push((0,i.renderTemplate)(a,n,r)):"object"==typeof a&&t.push(e(a,r,n));a[s]=t}else"object"==typeof o&&null!==o?a[s]=e(o,r,n):a[s]=o;return a}(this.template,e,this.templateFormat)}async invoke(e){return await this._callWithConfig(this.format.bind(this),e,{runType:"prompt"})}}r.DictPromptTemplate=a},97990,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChatPromptTemplate=r.SystemMessagePromptTemplate=r.AIMessagePromptTemplate=r.HumanMessagePromptTemplate=r.ChatMessagePromptTemplate=r.BaseChatPromptTemplate=r.BaseMessageStringPromptTemplate=r.MessagesPlaceholder=r.BaseMessagePromptTemplate=void 0;let n=e.r(39512),i=e.r(63983),a=e.r(68974),s=e.r(79312),o=e.r(13741),l=e.r(24036),u=e.r(50529),c=e.r(32302),d=e.r(97898),p=e.r(84695);class h extends a.Runnable{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}async invoke(e,t){return this._callWithConfig(e=>this.formatMessages(e),e,{...t,runType:"prompt"})}}r.BaseMessagePromptTemplate=h;class f extends h{static lc_name(){return"MessagesPlaceholder"}constructor(e){"string"==typeof e&&(e={variableName:e}),super(e),Object.defineProperty(this,"variableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"optional",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.variableName=e.variableName,this.optional=e.optional??!1}get inputVariables(){return[this.variableName]}async formatMessages(e){let t,r=e[this.variableName];if(this.optional&&!r)return[];if(!r){let e=Error(`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages as an input value. Received: undefined`);throw e.name="InputFormatError",e}try{t=Array.isArray(r)?r.map(n.coerceMessageLikeToMessage):[(0,n.coerceMessageLikeToMessage)(r)]}catch(n){let e="string"==typeof r?r:JSON.stringify(r,null,2),t=Error(`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages or coerceable values as input.

Received value: ${e}

Additional message: ${n.message}`);throw t.name="InputFormatError",t.lc_error_code=n.lc_error_code,t}return t}}r.MessagesPlaceholder=f;class m extends h{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}r.BaseMessageStringPromptTemplate=m;class g extends o.BasePromptTemplate{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){let t=await this.formatMessages(e);return new i.ChatPromptValue(t)}}r.BaseChatPromptTemplate=g;class y extends m{static lc_name(){return"ChatMessagePromptTemplate"}constructor(e,t){"prompt"in e||(e={prompt:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}async format(e){return new n.ChatMessage(await this.prompt.format(e),this.role)}static fromTemplate(e,t,r){return new this(l.PromptTemplate.fromTemplate(e,{templateFormat:r?.templateFormat}),t)}}r.ChatMessagePromptTemplate=y;class b extends h{static _messageClass(){throw Error("Can not invoke _messageClass from inside _StringImageMessagePromptTemplate")}constructor(e,t){if("prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"additionalOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chatMessageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,Array.isArray(this.prompt)){let e=[];this.prompt.forEach(t=>{"inputVariables"in t&&(e=e.concat(t.inputVariables))}),this.inputVariables=e}else this.inputVariables=this.prompt.inputVariables;this.additionalOptions=t??this.additionalOptions}createMessage(e){let t=this.constructor;if(t._messageClass())return new(t._messageClass())({content:e});if(t.chatMessageClass){let r=t.chatMessageClass();return new r({content:e,role:this.getRoleFromMessageClass(r.lc_name())})}throw Error("No message class defined")}getRoleFromMessageClass(e){switch(e){case"HumanMessage":return"human";case"AIMessage":return"ai";case"SystemMessage":return"system";case"ChatMessage":return"chat";default:throw Error("Invalid message class name")}}static fromTemplate(e,t){if("string"==typeof e)return new this(l.PromptTemplate.fromTemplate(e,t));let r=[];for(let n of e)if("string"==typeof n)r.push(l.PromptTemplate.fromTemplate(n,t));else if(null===n);else if(!(null===n||"object"!=typeof n||Array.isArray(n))&&1===Object.keys(n).length&&"text"in n&&"string"==typeof n.text){let e="";"string"==typeof n.text&&(e=n.text??"");let i={...t,additionalContentFields:n};r.push(l.PromptTemplate.fromTemplate(e,i))}else if(!(null===n||"object"!=typeof n||Array.isArray(n))&&"image_url"in n&&("string"==typeof n.image_url||"object"==typeof n.image_url&&null!==n.image_url&&"url"in n.image_url&&"string"==typeof n.image_url.url)){let e,i=n.image_url??"",a=[];if("string"==typeof i){let r=(t?.templateFormat==="mustache"?(0,c.parseMustache)(i):(0,c.parseFString)(i)).flatMap(e=>"variable"===e.type?[e.name]:[]);if((r?.length??0)>0){if(r.length>1)throw Error(`Only one format variable allowed per image template.
Got: ${r}
From: ${i}`);a=[r[0]]}else a=[];i={url:i},e=new u.ImagePromptTemplate({template:i,inputVariables:a,templateFormat:t?.templateFormat,additionalContentFields:n})}else if("object"==typeof i){if("url"in i)a=(t?.templateFormat==="mustache"?(0,c.parseMustache)(i.url):(0,c.parseFString)(i.url)).flatMap(e=>"variable"===e.type?[e.name]:[]);else a=[];e=new u.ImagePromptTemplate({template:i,inputVariables:a,templateFormat:t?.templateFormat,additionalContentFields:n})}else throw Error("Invalid image template");r.push(e)}else"object"==typeof n&&r.push(new p.DictPromptTemplate({template:n,templateFormat:t?.templateFormat}));return new this({prompt:r,additionalOptions:t})}async format(e){if(this.prompt instanceof s.BaseStringPromptTemplate){let t=await this.prompt.format(e);return this.createMessage(t)}{let t=[];for(let r of this.prompt){let n={};if(!("inputVariables"in r))throw Error(`Prompt ${r} does not have inputVariables defined.`);for(let t of r.inputVariables)n={...n,[t]:e[t]};if(r instanceof s.BaseStringPromptTemplate){let e,i=await r.format(n);"additionalContentFields"in r&&(e=r.additionalContentFields),""!==i&&t.push({...e,type:"text",text:i})}else if(r instanceof u.ImagePromptTemplate){let e,i=await r.format(n);"additionalContentFields"in r&&(e=r.additionalContentFields),t.push({...e,type:"image_url",image_url:i})}else if(r instanceof p.DictPromptTemplate){let e,i=await r.format(n);"additionalContentFields"in r&&(e=r.additionalContentFields),t.push({...e,...i})}}return this.createMessage(t)}}async formatMessages(e){return[await this.format(e)]}}class _ extends b{static _messageClass(){return n.HumanMessage}static lc_name(){return"HumanMessagePromptTemplate"}}r.HumanMessagePromptTemplate=_;class v extends b{static _messageClass(){return n.AIMessage}static lc_name(){return"AIMessagePromptTemplate"}}r.AIMessagePromptTemplate=v;class w extends b{static _messageClass(){return n.SystemMessage}static lc_name(){return"SystemMessagePromptTemplate"}}r.SystemMessagePromptTemplate=w;class O extends g{static lc_name(){return"ChatPromptTemplate"}get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),"mustache"===e.templateFormat&&void 0===e.validateTemplate&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){let e=new Set;for(let t of this.promptMessages)if(!(t instanceof n.BaseMessage))for(let r of t.inputVariables)e.add(r);let t=this.inputVariables,r=new Set(this.partialVariables?t.concat(Object.keys(this.partialVariables)):t),i=new Set([...r].filter(t=>!e.has(t)));if(i.size>0)throw Error(`Input variables \`${[...i]}\` are not used in any of the prompt messages.`);let a=new Set([...e].filter(e=>!r.has(e)));if(a.size>0)throw Error(`Input variables \`${[...a]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async _parseImagePrompts(e,t){if("string"==typeof e.content)return e;let r=await Promise.all(e.content.map(async e=>{if("image_url"!==e.type)return e;let r="";r="string"==typeof e.image_url?e.image_url:e.image_url.url;let n=l.PromptTemplate.fromTemplate(r,{templateFormat:this.templateFormat}),i=await n.format(t);return"string"!=typeof e.image_url&&"url"in e.image_url?e.image_url.url=i:e.image_url=i,e}));return e.content=r,e}async formatMessages(e){let t=await this.mergePartialAndUserVariables(e),r=[];for(let e of this.promptMessages)if(e instanceof n.BaseMessage)r.push(await this._parseImagePrompts(e,t));else{let n;n="mustache"===this.templateFormat?{...t}:e.inputVariables.reduce((r,n)=>{if(!(n in t)&&!("MessagesPlaceholder"===e.constructor.lc_name()&&e.optional))throw(0,d.addLangChainErrorFields)(Error(`Missing value for input variable \`${n.toString()}\``),"INVALID_PROMPT_INPUT");return r[n]=t[n],r},{});let i=await e.formatMessages(n);r=r.concat(i)}return r}async partial(e){let t=this.inputVariables.filter(t=>!(t in e)),r={...this.partialVariables??{},...e};return new O({...this,inputVariables:t,partialVariables:r})}static fromTemplate(e,t){let r=new _({prompt:l.PromptTemplate.fromTemplate(e,t)});return this.fromMessages([r])}static fromMessages(e,t){let r=e.reduce((e,r)=>e.concat(r instanceof O?r.promptMessages:[function(e,t){let r;if("function"==typeof e.formatMessages||(0,n.isBaseMessage)(e))return e;if(Array.isArray(e)&&"placeholder"===e[0]){let r=e[1];if(t?.templateFormat==="mustache"&&"string"==typeof r&&"{{"===r.slice(0,2)&&"}}"===r.slice(-2))return new f({variableName:r.slice(2,-2),optional:!0});if("string"==typeof r&&"{"===r[0]&&"}"===r[r.length-1])return new f({variableName:r.slice(1,-1),optional:!0});throw Error(`Invalid placeholder template for format ${t?.templateFormat??'"f-string"'}: "${e[1]}". Expected a variable name surrounded by ${t?.templateFormat==="mustache"?"double":"single"} curly braces.`)}let i=(0,n.coerceMessageLikeToMessage)(e);if(r="string"==typeof i.content?i.content:i.content.map(e=>"text"in e?{...e,text:e.text}:"image_url"in e?{...e,image_url:e.image_url}:e),"human"===i._getType())return _.fromTemplate(r,t);if("ai"===i._getType())return v.fromTemplate(r,t);if("system"===i._getType())return w.fromTemplate(r,t);if(n.ChatMessage.isInstance(i))return y.fromTemplate(i.content,i.role,t);throw Error(`Could not coerce message prompt template from input. Received message type: "${i._getType()}".`)}(r,t)]),[]),i=e.reduce((e,t)=>t instanceof O?Object.assign(e,t.partialVariables):e,Object.create(null)),a=new Set;for(let e of r)if(!(e instanceof n.BaseMessage))for(let t of e.inputVariables)t in i||a.add(t);return new this({...t,inputVariables:[...a],promptMessages:r,partialVariables:i,templateFormat:t?.templateFormat})}static fromPromptMessages(e){return this.fromMessages(e)}}r.ChatPromptTemplate=O},23081,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FewShotChatMessagePromptTemplate=r.FewShotPromptTemplate=void 0;let n=e.r(79312),i=e.r(32302),a=e.r(24036),s=e.r(97990);class o extends n.BaseStringPromptTemplate{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"examples",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleSelector",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"suffix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"exampleSeparator",{enumerable:!0,configurable:!0,writable:!0,value:"\n\n"}),Object.defineProperty(this,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),void 0!==this.examples&&void 0!==this.exampleSelector)throw Error("Only one of 'examples' and 'example_selector' should be provided");if(void 0===this.examples&&void 0===this.exampleSelector)throw Error("One of 'examples' and 'example_selector' should be provided");if(this.validateTemplate){let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,i.checkValidTemplate)(this.prefix+this.suffix,this.templateFormat,e)}}_getPromptType(){return"few_shot"}static lc_name(){return"FewShotPromptTemplate"}async getExamples(e){if(void 0!==this.examples)return this.examples;if(void 0!==this.exampleSelector)return this.exampleSelector.selectExamples(e);throw Error("One of 'examples' and 'example_selector' should be provided")}async partial(e){let t=this.inputVariables.filter(t=>!(t in e)),r={...this.partialVariables??{},...e};return new o({...this,inputVariables:t,partialVariables:r})}async format(e){let t=await this.mergePartialAndUserVariables(e),r=await this.getExamples(t),n=await Promise.all(r.map(e=>this.examplePrompt.format(e))),a=[this.prefix,...n,this.suffix].join(this.exampleSeparator);return(0,i.renderTemplate)(a,this.templateFormat,t)}serialize(){if(this.exampleSelector||!this.examples)throw Error("Serializing an example selector is not currently supported");if(void 0!==this.outputParser)throw Error("Serializing an output parser is not currently supported");return{_type:this._getPromptType(),input_variables:this.inputVariables,example_prompt:this.examplePrompt.serialize(),example_separator:this.exampleSeparator,suffix:this.suffix,prefix:this.prefix,template_format:this.templateFormat,examples:this.examples}}static async deserialize(e){let t,{example_prompt:r}=e;if(!r)throw Error("Missing example prompt");let n=await a.PromptTemplate.deserialize(r);if(Array.isArray(e.examples))t=e.examples;else throw Error("Invalid examples format. Only list or string are supported.");return new o({inputVariables:e.input_variables,examplePrompt:n,examples:t,exampleSeparator:e.example_separator,prefix:e.prefix,suffix:e.suffix,templateFormat:e.template_format})}}r.FewShotPromptTemplate=o;class l extends s.BaseChatPromptTemplate{_getPromptType(){return"few_shot_chat"}static lc_name(){return"FewShotChatMessagePromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"examples",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleSelector",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"suffix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"exampleSeparator",{enumerable:!0,configurable:!0,writable:!0,value:"\n\n"}),Object.defineProperty(this,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.examples=e.examples,this.examplePrompt=e.examplePrompt,this.exampleSeparator=e.exampleSeparator??"\n\n",this.exampleSelector=e.exampleSelector,this.prefix=e.prefix??"",this.suffix=e.suffix??"",this.templateFormat=e.templateFormat??"f-string",this.validateTemplate=e.validateTemplate??!0,void 0!==this.examples&&void 0!==this.exampleSelector)throw Error("Only one of 'examples' and 'example_selector' should be provided");if(void 0===this.examples&&void 0===this.exampleSelector)throw Error("One of 'examples' and 'example_selector' should be provided");if(this.validateTemplate){let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,i.checkValidTemplate)(this.prefix+this.suffix,this.templateFormat,e)}}async getExamples(e){if(void 0!==this.examples)return this.examples;if(void 0!==this.exampleSelector)return this.exampleSelector.selectExamples(e);throw Error("One of 'examples' and 'example_selector' should be provided")}async formatMessages(e){let t=await this.mergePartialAndUserVariables(e),r=await this.getExamples(t);r=r.map(e=>{let t={};return this.examplePrompt.inputVariables.forEach(r=>{t[r]=e[r]}),t});let n=[];for(let e of r){let t=await this.examplePrompt.formatMessages(e);n.push(...t)}return n}async format(e){let t=await this.mergePartialAndUserVariables(e),r=await this.getExamples(t),n=(await Promise.all(r.map(e=>this.examplePrompt.formatMessages(e)))).flat().map(e=>e.content),a=[this.prefix,...n,this.suffix].join(this.exampleSeparator);return(0,i.renderTemplate)(a,this.templateFormat,t)}async partial(e){let t=this.inputVariables.filter(t=>!(t in e)),r={...this.partialVariables??{},...e};return new l({...this,inputVariables:t,partialVariables:r})}}r.FewShotChatMessagePromptTemplate=l},13741,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),s=0;s<a.length;s++)"default"!==a[s]&&n(r,t,a[s]);return i(r,t),r}}();Object.defineProperty(r,"__esModule",{value:!0}),r.BasePromptTemplate=void 0;let s=e.r(68974);class o extends s.Runnable{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let{inputVariables:t}=e;if(t.includes("stop"))throw Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){let t=this.partialVariables??{},r={};for(let[e,n]of Object.entries(t))"string"==typeof n?r[e]=n:r[e]=await n();return{...r,...e}}async invoke(e,t){let r={...this.metadata,...t?.metadata},n=[...this.tags??[],...t?.tags??[]];return this._callWithConfig(e=>this.formatPromptValue(e),e,{...t,tags:n,metadata:r,runType:"prompt"})}serialize(){throw Error("Use .toJSON() instead")}static async deserialize(t){switch(t._type){case"prompt":{let{PromptTemplate:r}=await Promise.resolve().then(()=>a(e.r(24036)));return r.deserialize(t)}case void 0:{let{PromptTemplate:r}=await Promise.resolve().then(()=>a(e.r(24036)));return r.deserialize({...t,_type:"prompt"})}case"few_shot":{let{FewShotPromptTemplate:r}=await Promise.resolve().then(()=>a(e.r(23081)));return r.deserialize(t)}default:throw Error(`Invalid prompt type in config: ${t._type}`)}}}r.BasePromptTemplate=o},17849,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PipelinePromptTemplate=void 0;let n=e.r(13741),i=e.r(97990);class a extends n.BasePromptTemplate{static lc_name(){return"PipelinePromptTemplate"}constructor(e){super({...e,inputVariables:[]}),Object.defineProperty(this,"pipelinePrompts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finalPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pipelinePrompts=e.pipelinePrompts,this.finalPrompt=e.finalPrompt,this.inputVariables=this.computeInputValues()}computeInputValues(){let e=this.pipelinePrompts.map(e=>e.name);return[...new Set(this.pipelinePrompts.map(t=>t.prompt.inputVariables.filter(t=>!e.includes(t))).flat())]}static extractRequiredInputValues(e,t){return t.reduce((t,r)=>(t[r]=e[r],t),{})}async formatPipelinePrompts(e){let t=await this.mergePartialAndUserVariables(e);for(let{name:e,prompt:r}of this.pipelinePrompts){let n=a.extractRequiredInputValues(t,r.inputVariables);r instanceof i.ChatPromptTemplate?t[e]=await r.formatMessages(n):t[e]=await r.format(n)}return a.extractRequiredInputValues(t,this.finalPrompt.inputVariables)}async formatPromptValue(e){return this.finalPrompt.formatPromptValue(await this.formatPipelinePrompts(e))}async format(e){return this.finalPrompt.format(await this.formatPipelinePrompts(e))}async partial(e){let t={...this};return t.inputVariables=this.inputVariables.filter(t=>!(t in e)),t.partialVariables={...this.partialVariables??{},...e},new a(t)}serialize(){throw Error("Not implemented.")}_getPromptType(){return"pipeline"}}r.PipelinePromptTemplate=a},6725,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},5476,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.StructuredPrompt=void 0;let n=e.r(68974),i=e.r(97990);function a(e){return"object"==typeof e&&null!=e&&"withStructuredOutput"in e&&"function"==typeof e.withStructuredOutput}class s extends i.ChatPromptTemplate{get lc_aliases(){return{...super.lc_aliases,schema:"schema_"}}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"method",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","structured"]}),this.schema=e.schema,this.method=e.method}pipe(e){if(a(e))return super.pipe(e.withStructuredOutput(this.schema));if("object"==typeof e&&null!=e&&"lc_id"in e&&Array.isArray(e.lc_id)&&"langchain_core/runnables/RunnableBinding"===e.lc_id.join("/")&&a(e.bound))return super.pipe(new n.RunnableBinding({bound:e.bound.withStructuredOutput(this.schema,...this.method?[{method:this.method}]:[]),kwargs:e.kwargs??{},config:e.config,configFactories:e.configFactories}));throw Error('Structured prompts need to be piped to a language model that supports the "withStructuredOutput()" method.')}static fromMessagesAndSchema(e,t,r){return s.fromMessages(e,{schema:t,method:r})}}r.StructuredPrompt=s},23744,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(13741),r),i(e.r(97990),r),i(e.r(23081),r),i(e.r(17849),r),i(e.r(24036),r),i(e.r(6725),r),i(e.r(79312),r),i(e.r(32302),r),i(e.r(50529),r),i(e.r(5476),r),i(e.r(84695),r)},96432,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseRetriever=void 0;let n=e.r(75622),i=e.r(68974),a=e.r(81425);class s extends i.Runnable{constructor(e){super(e),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callbacks=e?.callbacks,this.tags=e?.tags??[],this.metadata=e?.metadata??{},this.verbose=e?.verbose??!1}_getRelevantDocuments(e,t){throw Error("Not implemented!")}async invoke(e,t){return this.getRelevantDocuments(e,(0,a.ensureConfig)(t))}async getRelevantDocuments(e,t){let r=(0,a.ensureConfig)((0,n.parseCallbackConfigArg)(t)),i=await n.CallbackManager.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),s=await i?.handleRetrieverStart(this.toJSON(),e,r.runId,void 0,void 0,void 0,r.runName);try{let t=await this._getRelevantDocuments(e,s);return await s?.handleRetrieverEnd(t),t}catch(e){throw await s?.handleRetrieverError(e),e}}}r.BaseRetriever=s},6846,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InMemoryStore=r.BaseStore=void 0;let n=e.r(46893);class i extends n.Serializable{}r.BaseStore=i,r.InMemoryStore=class extends i{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","storage"]}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:{}})}async mget(e){return e.map(e=>this.store[e])}async mset(e){for(let[t,r]of e)this.store[t]=r}async mdelete(e){for(let t of e)delete this.store[t]}async *yieldKeys(e){for(let t of Object.keys(this.store))(void 0===e||t.startsWith(e))&&(yield t)}}},46915,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LangChainTracerV1=void 0;let n=e.r(12556),i=e.r(73718),a=e.r(25032);class s extends a.BaseTracer{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:(0,i.getEnvironmentVariable)("LANGCHAIN_ENDPOINT")||"http://localhost:1984"}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{"Content-Type":"application/json"}}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let e=(0,i.getEnvironmentVariable)("LANGCHAIN_API_KEY");e&&(this.headers["x-api-key"]=e)}async newSession(e){let t={start_time:Date.now(),name:e},r=await this.persistSession(t);return this.session=r,r}async loadSession(e){let t=`${this.endpoint}/sessions?name=${e}`;return this._handleSessionResponse(t)}async loadDefaultSession(){let e=`${this.endpoint}/sessions?name=default`;return this._handleSessionResponse(e)}async convertV2RunToRun(e){let t,r=this.session??await this.loadDefaultSession(),i=e.serialized;if("llm"===e.run_type){let a=e.inputs.prompts?e.inputs.prompts:e.inputs.messages.map(e=>(0,n.getBufferString)(e));t={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:i,type:e.run_type,session_id:r.id,prompts:a,response:e.outputs}}else if("chain"===e.run_type){let n=await Promise.all(e.child_runs.map(e=>this.convertV2RunToRun(e)));t={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:i,type:e.run_type,session_id:r.id,inputs:e.inputs,outputs:e.outputs,child_llm_runs:n.filter(e=>"llm"===e.type),child_chain_runs:n.filter(e=>"chain"===e.type),child_tool_runs:n.filter(e=>"tool"===e.type)}}else if("tool"===e.run_type){let n=await Promise.all(e.child_runs.map(e=>this.convertV2RunToRun(e)));t={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:i,type:e.run_type,session_id:r.id,tool_input:e.inputs.input,output:e.outputs?.output,action:JSON.stringify(i),child_llm_runs:n.filter(e=>"llm"===e.type),child_chain_runs:n.filter(e=>"chain"===e.type),child_tool_runs:n.filter(e=>"tool"===e.type)}}else throw Error(`Unknown run type: ${e.run_type}`);return t}async persistRun(e){let t,r;t="llm"===(r=void 0!==e.run_type?await this.convertV2RunToRun(e):e).type?`${this.endpoint}/llm-runs`:"chain"===r.type?`${this.endpoint}/chain-runs`:`${this.endpoint}/tool-runs`;let n=await fetch(t,{method:"POST",headers:this.headers,body:JSON.stringify(r)});n.ok||console.error(`Failed to persist run: ${n.status} ${n.statusText}`)}async persistSession(e){let t=`${this.endpoint}/sessions`,r=await fetch(t,{method:"POST",headers:this.headers,body:JSON.stringify(e)});return r.ok?{id:(await r.json()).id,...e}:(console.error(`Failed to persist session: ${r.status} ${r.statusText}, using default session.`),{id:1,...e})}async _handleSessionResponse(e){let t,r=await fetch(e,{method:"GET",headers:this.headers});if(!r.ok)return console.error(`Failed to load session: ${r.status} ${r.statusText}`),t={id:1,start_time:Date.now()},this.session=t,t;let n=await r.json();return 0===n.length?t={id:1,start_time:Date.now()}:[t]=n,this.session=t,t}}r.LangChainTracerV1=s},49762,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getTracingCallbackHandler=a,r.getTracingV2CallbackHandler=s;let n=e.r(64462),i=e.r(46915);async function a(e){let t=new i.LangChainTracerV1;return e?await t.loadSession(e):await t.loadDefaultSession(),t}async function s(){return new n.LangChainTracer}},64737,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RunCollectorCallbackHandler=void 0;let n=e.r(25032);class i extends n.BaseTracer{constructor({exampleId:e}={}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"run_collector"}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracedRuns",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.exampleId=e,this.tracedRuns=[]}async persistRun(e){let t={...e};t.reference_example_id=this.exampleId,this.tracedRuns.push(t)}}r.RunCollectorCallbackHandler=i},5016,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.cosine=function(e,t){let r=0,n=0,i=0;for(let a=0;a<e.length;a++)r+=e[a]*t[a],n+=e[a]*e[a],i+=t[a]*t[a];return r/(Math.sqrt(n)*Math.sqrt(i))}},97664,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.innerProduct=function(e,t){let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}},90508,(e,t,r)=>{"use strict";function n(e,t){let r=0;for(let n=0;n<e.length;n++)r+=(e[n]-t[n])*(e[n]-t[n]);return r}Object.defineProperty(r,"__esModule",{value:!0}),r.squaredEuclidean=n,r.euclidean=function(e,t){return Math.sqrt(n(e,t))}},49114,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.matrixFunc=s,r.normalize=function(e,t=!1){let r=e.reduce((e,t)=>Math.max(e,l(t).maxValue),0);return e.map(e=>e.map(e=>t?1-e/r:e/r))},r.cosineSimilarity=o,r.innerProduct=function(e,t){return s(e,t,i.innerProduct)},r.euclideanDistance=function(e,t){return s(e,t,a.euclidean)},r.maximalMarginalRelevance=function(e,t,r=.5,n=4){if(0>=Math.min(n,t.length))return[];let i=o(Array.isArray(e[0])?e:[e],t)[0],a=l(i).maxIndex,s=[t[a]],u=[a];for(;u.length<Math.min(n,t.length);){let e=-1/0,n=-1,a=o(t,s);i.forEach((t,i)=>{if(u.includes(i))return;let s=r*t-(1-r)*Math.max(...a[i]);s>e&&(e=s,n=i)}),s.push(t[n]),u.push(n)}return u};let n=e.r(5016),i=e.r(97664),a=e.r(90508);function s(e,t,r){if(0===e.length||0===e[0].length||0===t.length||0===t[0].length)return[[]];if(e[0].length!==t[0].length)throw Error(`Number of columns in X and Y must be the same. X has shape ${[e.length,e[0].length]} and Y has shape ${[t.length,t[0].length]}.`);return e.map(e=>t.map(t=>r(e,t)).map(e=>Number.isNaN(e)?0:e))}function o(e,t){return s(e,t,n.cosine)}function l(e){if(0===e.length)return{maxIndex:-1,maxValue:NaN};let t=e[0],r=0;for(let n=1;n<e.length;n+=1)e[n]>t&&(r=n,t=e[n]);return{maxIndex:r,maxValue:t}}},30491,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SaveableVectorStore=r.VectorStore=r.VectorStoreRetriever=void 0;let n=e.r(96432),i=e.r(46893);class a extends n.BaseRetriever{static lc_name(){return"VectorStoreRetriever"}get lc_namespace(){return["langchain_core","vectorstores"]}_vectorstoreType(){return this.vectorStore._vectorstoreType()}constructor(e){super(e),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"searchType",{enumerable:!0,configurable:!0,writable:!0,value:"similarity"}),Object.defineProperty(this,"searchKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.k=e.k??this.k,this.searchType=e.searchType??this.searchType,this.filter=e.filter,"mmr"===e.searchType&&(this.searchKwargs=e.searchKwargs)}async _getRelevantDocuments(e,t){if("mmr"===this.searchType){if("function"!=typeof this.vectorStore.maxMarginalRelevanceSearch)throw Error(`The vector store backing this retriever, ${this._vectorstoreType()} does not support max marginal relevance search.`);return this.vectorStore.maxMarginalRelevanceSearch(e,{k:this.k,filter:this.filter,...this.searchKwargs},t?.getChild("vectorstore"))}return this.vectorStore.similaritySearch(e,this.k,this.filter,t?.getChild("vectorstore"))}async addDocuments(e,t){return this.vectorStore.addDocuments(e,t)}}r.VectorStoreRetriever=a;class s extends i.Serializable{constructor(e,t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","vectorstores",this._vectorstoreType()]}),Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.embeddings=e}async delete(e){throw Error("Not implemented.")}async similaritySearch(e,t=4,r,n){return(await this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,r)).map(e=>e[0])}async similaritySearchWithScore(e,t=4,r,n){return this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,r)}static fromTexts(e,t,r,n){throw Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}static fromDocuments(e,t,r){throw Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}asRetriever(e,t,r,n,i,s){if("number"==typeof e)return new a({vectorStore:this,k:e,filter:t,tags:[...n??[],this._vectorstoreType()],metadata:i,verbose:s,callbacks:r});{let t={vectorStore:this,k:e?.k,filter:e?.filter,tags:[...e?.tags??[],this._vectorstoreType()],metadata:e?.metadata,verbose:e?.verbose,callbacks:e?.callbacks,searchType:e?.searchType};return new a(e?.searchType==="mmr"?{...t,searchKwargs:e.searchKwargs}:{...t})}}}r.VectorStore=s,r.SaveableVectorStore=class extends s{static load(e,t){throw Error("Not implemented")}}},94592,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FakeVectorStore=r.SingleRunExtractor=r.SyntheticEmbeddings=r.FakeEmbeddings=r.FakeTool=r.FakeTracer=r.FakeListChatMessageHistory=r.FakeChatMessageHistory=r.FakeListChatModel=r.FakeRetriever=r.FakeStreamingChatModel=r.FakeChatModel=r.FakeStreamingLLM=r.FakeLLM=r.FakeRunnable=r.FakeSplitIntoListParser=void 0;let n=e.r(41594),i=e.r(64552),a=e.r(79425),s=e.r(14921),o=e.r(39512),l=e.r(6245),u=e.r(13583),c=e.r(96432),d=e.r(68974),p=e.r(10304),h=e.r(25032),f=e.r(70736),m=e.r(30952),g=e.r(30491),y=e.r(5016);class b extends l.BaseOutputParser{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["tests","fake"]})}getFormatInstructions(){return""}async parse(e){return e.split(",").map(e=>e.trim())}}r.FakeSplitIntoListParser=b;class _ extends d.Runnable{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["tests","fake"]}),Object.defineProperty(this,"returnOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.returnOptions=e.returnOptions}async invoke(e,t){return this.returnOptions?t??{}:{input:e}}}r.FakeRunnable=_;class v extends s.LLM{constructor(e){super(e),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thrownErrorString",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.response=e.response,this.thrownErrorString=e.thrownErrorString}_llmType(){return"fake"}async _call(e,t,r){if(this.thrownErrorString)throw Error(this.thrownErrorString);let n=this.response??e;return await r?.handleLLMNewToken(n),n}}r.FakeLLM=v;class w extends s.LLM{constructor(e){super(e),Object.defineProperty(this,"sleep",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"responses",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thrownErrorString",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.sleep=e.sleep??this.sleep,this.responses=e.responses,this.thrownErrorString=e.thrownErrorString}_llmType(){return"fake"}async _call(e){if(this.thrownErrorString)throw Error(this.thrownErrorString);let t=this.responses?.[0];return this.responses=this.responses?.slice(1),t??e}async *_streamResponseChunks(e,t,r){if(this.thrownErrorString)throw Error(this.thrownErrorString);let n=this.responses?.[0];for(let t of(this.responses=this.responses?.slice(1),n??e))await new Promise(e=>setTimeout(e,this.sleep)),yield{text:t,generationInfo:{}},await r?.handleLLMNewToken(t)}}r.FakeStreamingLLM=w;class O extends a.BaseChatModel{_combineLLMOutput(){return[]}_llmType(){return"fake"}async _generate(e,t,r){if(t?.stop?.length)return{generations:[{message:new o.AIMessage(t.stop[0]),text:t.stop[0]}]};let n=e.map(e=>"string"==typeof e.content?e.content:JSON.stringify(e.content,null,2)).join("\n");return await r?.handleLLMNewToken(n),{generations:[{message:new o.AIMessage(n),text:n}],llmOutput:{}}}}r.FakeChatModel=O;class P extends a.BaseChatModel{constructor({sleep:e=50,responses:t=[],chunks:r=[],toolStyle:n="openai",thrownErrorString:i,...a}){super(a),Object.defineProperty(this,"sleep",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"responses",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"toolStyle",{enumerable:!0,configurable:!0,writable:!0,value:"openai"}),Object.defineProperty(this,"thrownErrorString",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.sleep=e,this.responses=t,this.chunks=r,this.toolStyle=n,this.thrownErrorString=i}_llmType(){return"fake"}bindTools(e){let t=[...this.tools,...e],r=t.map(e=>{switch(this.toolStyle){case"openai":return{type:"function",function:{name:e.name,description:e.description,parameters:(0,m.toJsonSchema)(e.schema)}};case"anthropic":return{name:e.name,description:e.description,input_schema:(0,m.toJsonSchema)(e.schema)};case"bedrock":return{toolSpec:{name:e.name,description:e.description,inputSchema:(0,m.toJsonSchema)(e.schema)}};case"google":return{name:e.name,description:e.description,parameters:(0,m.toJsonSchema)(e.schema)};default:throw Error(`Unsupported tool style: ${this.toolStyle}`)}}),n="google"===this.toolStyle?[{functionDeclarations:r}]:r,i=new P({sleep:this.sleep,responses:this.responses,chunks:this.chunks,toolStyle:this.toolStyle,thrownErrorString:this.thrownErrorString});return i.tools=t,i.withConfig({tools:n})}async _generate(e,t,r){if(this.thrownErrorString)throw Error(this.thrownErrorString);let n=this.responses?.[0]?.content??e[0].content??"";return{generations:[{text:"",message:new o.AIMessage({content:n,tool_calls:this.chunks?.[0]?.tool_calls})}]}}async *_streamResponseChunks(e,t,r){if(this.thrownErrorString)throw Error(this.thrownErrorString);if(this.chunks?.length){for(let e of this.chunks){let t=new u.ChatGenerationChunk({message:new o.AIMessageChunk({content:e.content,tool_calls:e.tool_calls,additional_kwargs:e.additional_kwargs??{}}),text:e.content?.toString()??""});yield t,await r?.handleLLMNewToken(e.content,void 0,void 0,void 0,void 0,{chunk:t})}return}let n=this.responses?.[0]??new o.AIMessage("string"==typeof e[0].content?e[0].content:"");for(let e of"string"==typeof n.content?n.content:""){await new Promise(e=>setTimeout(e,this.sleep));let t=new u.ChatGenerationChunk({message:new o.AIMessageChunk({content:e}),text:e});yield t,await r?.handleLLMNewToken(e,void 0,void 0,void 0,void 0,{chunk:t})}}}r.FakeStreamingChatModel=P;class S extends c.BaseRetriever{constructor(e){super(),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["test","fake"]}),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:[new i.Document({pageContent:"foo"}),new i.Document({pageContent:"bar"})]}),this.output=e?.output??this.output}async _getRelevantDocuments(e){return this.output}}r.FakeRetriever=S;class E extends a.BaseChatModel{static lc_name(){return"FakeListChatModel"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"responses",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"i",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"sleep",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"emitCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1});let{responses:t,sleep:r,emitCustomEvent:n}=e;this.responses=t,this.sleep=r,this.emitCustomEvent=n??this.emitCustomEvent}_combineLLMOutput(){return[]}_llmType(){return"fake-list"}async _generate(e,t,r){if(await this._sleepIfRequested(),t?.thrownErrorString)throw Error(t.thrownErrorString);if(this.emitCustomEvent&&await r?.handleCustomEvent("some_test_event",{someval:!0}),t?.stop?.length)return{generations:[this._formatGeneration(t.stop[0])]};{let e=this._currentResponse();return this._incrementResponse(),{generations:[this._formatGeneration(e)],llmOutput:{}}}}_formatGeneration(e){return{message:new o.AIMessage(e),text:e}}async *_streamResponseChunks(e,t,r){let n=this._currentResponse();for await(let e of(this._incrementResponse(),this.emitCustomEvent&&await r?.handleCustomEvent("some_test_event",{someval:!0}),n)){if(await this._sleepIfRequested(),t?.thrownErrorString)throw Error(t.thrownErrorString);let n=this._createResponseChunk(e);yield n,r?.handleLLMNewToken(e)}}async _sleepIfRequested(){void 0!==this.sleep&&await this._sleep()}async _sleep(){return new Promise(e=>{setTimeout(()=>e(),this.sleep)})}_createResponseChunk(e){return new u.ChatGenerationChunk({message:new o.AIMessageChunk({content:e}),text:e})}_currentResponse(){return this.responses[this.i]}_incrementResponse(){this.i<this.responses.length-1?this.i+=1:this.i=0}withStructuredOutput(e,t){return d.RunnableLambda.from(async e=>{let t=await this.invoke(e);if(t.tool_calls?.[0]?.args)return t.tool_calls[0].args;if("string"==typeof t.content)return JSON.parse(t.content);throw Error("No structured output found")})}}r.FakeListChatModel=E;class k extends n.BaseChatMessageHistory{constructor(){super(),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","message","fake"]}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:[]})}async getMessages(){return this.messages}async addMessage(e){this.messages.push(e)}async addUserMessage(e){this.messages.push(new o.HumanMessage(e))}async addAIChatMessage(e){this.messages.push(new o.AIMessage(e))}async clear(){this.messages=[]}}r.FakeChatMessageHistory=k;class I extends n.BaseListChatMessageHistory{constructor(){super(),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","message","fake"]}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:[]})}async addMessage(e){this.messages.push(e)}async getMessages(){return this.messages}}r.FakeListChatMessageHistory=I;class A extends h.BaseTracer{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"fake_tracer"}),Object.defineProperty(this,"runs",{enumerable:!0,configurable:!0,writable:!0,value:[]})}persistRun(e){return this.runs.push(e),Promise.resolve()}}r.FakeTracer=A;class T extends p.StructuredTool{constructor(e){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}async _call(e,t){return JSON.stringify(e)}}r.FakeTool=T;class C extends f.Embeddings{constructor(e){super(e??{})}embedDocuments(e){return Promise.resolve(e.map(()=>[.1,.2,.3,.4]))}embedQuery(e){return Promise.resolve([.1,.2,.3,.4])}}r.FakeEmbeddings=C;class j extends f.Embeddings{constructor(e){super(e??{}),Object.defineProperty(this,"vectorSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorSize=e?.vectorSize??4}async embedDocuments(e){return Promise.all(e.map(e=>this.embedQuery(e)))}async embedQuery(e){let t=e,r=(t=t.toLowerCase().replaceAll(/[^a-z ]/g,"")).length%this.vectorSize,n=0===r?0:this.vectorSize-r,i=t.length+n,a=(t=t.padEnd(i," ")).length/this.vectorSize,s=[];for(let e=0;e<t.length;e+=a)s.push(t.slice(e,e+a));return s.map(e=>{let t=0;for(let r=0;r<e.length;r+=1)t+=" "===e?0:e.charCodeAt(r);return t%26/26})}}r.SyntheticEmbeddings=j;class x extends h.BaseTracer{constructor(){super(),Object.defineProperty(this,"runPromiseResolver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"single_run_extractor"}),this.runPromise=new Promise(e=>{this.runPromiseResolver=e})}async persistRun(e){this.runPromiseResolver(e)}async extract(){return this.runPromise}}r.SingleRunExtractor=x;class $ extends g.VectorStore{_vectorstoreType(){return"memory"}constructor(e,{similarity:t,...r}={}){super(e,r),Object.defineProperty(this,"memoryVectors",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"similarity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.similarity=t??y.cosine}async addDocuments(e){let t=e.map(({pageContent:e})=>e);return this.addVectors(await this.embeddings.embedDocuments(t),e)}async addVectors(e,t){let r=e.map((e,r)=>({content:t[r].pageContent,embedding:e,metadata:t[r].metadata}));this.memoryVectors=this.memoryVectors.concat(r)}async similaritySearchVectorWithScore(e,t,r){let n=this.memoryVectors.filter(e=>!r||r(new i.Document({metadata:e.metadata,pageContent:e.content})));return n.map((t,r)=>({similarity:this.similarity(e,t.embedding),index:r})).sort((e,t)=>e.similarity>t.similarity?-1:0).slice(0,t).map(e=>[new i.Document({metadata:n[e.index].metadata,pageContent:n[e.index].content}),e.similarity])}static async fromTexts(e,t,r,n){let a=[];for(let r=0;r<e.length;r+=1){let n=Array.isArray(t)?t[r]:t,s=new i.Document({pageContent:e[r],metadata:n});a.push(s)}return $.fromDocuments(a,r,n)}static async fromDocuments(e,t,r){let n=new this(t,r);return await n.addDocuments(e),n}static async fromExistingIndex(e,t){return new this(e,t)}}r.FakeVectorStore=$},33716,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),s=0;s<a.length;s++)"default"!==a[s]&&n(r,t,a[s]);return i(r,t),r}}();Object.defineProperty(r,"__esModule",{value:!0}),r.vectorstores=r.utils__types=r.utils__tiktoken=r.utils__testing=r.utils__stream=r.utils__math=r.utils__json_schema=r.utils__json_patch=r.utils__hash=r.utils__function_calling=r.utils__env=r.utils__chunk_array=r.utils__async_caller=r.tracers__tracer_langchain_v1=r.tracers__tracer_langchain=r.tracers__run_collector=r.tracers__log_stream=r.tracers__initialize=r.tracers__console=r.tracers__base=r.tools=r.stores=r.retrievers=r.runnables=r.prompt_values=r.prompts=r.outputs=r.output_parsers=r.messages=r.memory=r.load__serializable=r.language_models__llms=r.language_models__chat_models=r.language_models__base=r.example_selectors=r.embeddings=r.documents=r.chat_history=r.callbacks__promises=r.callbacks__manager=r.callbacks__base=r.caches=r.agents=void 0,r.agents=a(e.r(46787)),r.caches=a(e.r(88041)),r.callbacks__base=a(e.r(9255)),r.callbacks__manager=a(e.r(75622)),r.callbacks__promises=a(e.r(34372)),r.chat_history=a(e.r(41594)),r.documents=a(e.r(11690)),r.embeddings=a(e.r(70736)),r.example_selectors=a(e.r(11919)),r.language_models__base=a(e.r(85864)),r.language_models__chat_models=a(e.r(79425)),r.language_models__llms=a(e.r(14921)),r.load__serializable=a(e.r(46893)),r.memory=a(e.r(58039)),r.messages=a(e.r(39512)),r.output_parsers=a(e.r(60105)),r.outputs=a(e.r(13583)),r.prompts=a(e.r(23744)),r.prompt_values=a(e.r(63983)),r.runnables=a(e.r(29495)),r.retrievers=a(e.r(96432)),r.stores=a(e.r(6846)),r.tools=a(e.r(10304)),r.tracers__base=a(e.r(25032)),r.tracers__console=a(e.r(50181)),r.tracers__initialize=a(e.r(49762)),r.tracers__log_stream=a(e.r(1529)),r.tracers__run_collector=a(e.r(64737)),r.tracers__tracer_langchain=a(e.r(64462)),r.tracers__tracer_langchain_v1=a(e.r(46915)),r.utils__async_caller=a(e.r(1344)),r.utils__chunk_array=a(e.r(37092)),r.utils__env=a(e.r(73718)),r.utils__function_calling=a(e.r(61789)),r.utils__hash=a(e.r(47882)),r.utils__json_patch=a(e.r(30943)),r.utils__json_schema=a(e.r(30952)),r.utils__math=a(e.r(49114)),r.utils__stream=a(e.r(62350)),r.utils__testing=a(e.r(94592)),r.utils__tiktoken=a(e.r(22905)),r.utils__types=a(e.r(42235)),r.vectorstores=a(e.r(30491))},26118,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),s=0;s<a.length;s++)"default"!==a[s]&&n(r,t,a[s]);return i(r,t),r}}();Object.defineProperty(r,"__esModule",{value:!0}),r.load=p;let s=e.r(46893),o=e.r(11660),l=a(e.r(33716)),u=e.r(97767),c=e.r(73718);async function d(e){let{optionalImportsMap:t={},optionalImportEntrypoints:r=[],importMap:n={},secretsMap:i={},path:a=["$"]}=this,p=a.join(".");if("object"==typeof e&&null!==e&&!Array.isArray(e)&&"lc"in e&&"type"in e&&"id"in e&&1===e.lc&&"secret"===e.type){let[t]=e.id;if(t in i)return i[t];{let e=(0,c.getEnvironmentVariable)(t);if(e)return e;throw Error(`Missing key "${t}" for ${p} in load(secretsMap={})`)}}if("object"==typeof e&&null!==e&&!Array.isArray(e)&&"lc"in e&&"type"in e&&"id"in e&&1===e.lc&&"not_implemented"===e.type){let t=JSON.stringify(e);throw Error(`Trying to load an object that doesn't implement serialization: ${p} -> ${t}`)}if("object"==typeof e&&null!==e&&!Array.isArray(e)&&"lc"in e&&"type"in e&&"id"in e&&"kwargs"in e&&1===e.lc){let i=JSON.stringify(e),[c,...h]=e.id.slice().reverse(),f=h.reverse(),m=null,g=[f.join("/")];"langchain_community"===f[0]&&g.push(["langchain",...f.slice(1)].join("/"));let y=g.find(e=>e in t);if(o.optionalImportEntrypoints.concat(r).includes(f.join("/"))||y)if(void 0!==y)m=await t[y];else throw Error(`Missing key "${f.join("/")}" for ${p} in load(optionalImportsMap={})`);else{let e,t;if("langchain"===f[0]||"langchain_core"===f[0])e=({langchain_core:l,langchain:n})[f[0]],f.shift();else throw Error(`Invalid namespace: ${p} -> ${i}`);if(0===f.length)throw Error(`Invalid namespace: ${p} -> ${i}`);do{if((t=f.join("__"))in e)break;f.pop()}while(f.length>0)t in e&&(m=e[t])}if("object"!=typeof m||null===m)throw Error(`Invalid namespace: ${p} -> ${i}`);let b=m[c]??Object.values(m).find(e=>"function"==typeof e&&(0,s.get_lc_unique_name)(e)===c);if("function"!=typeof b)throw Error(`Invalid identifer: ${p} -> ${i}`);let _=await d.call({...this,path:[...a,"kwargs"]},e.kwargs);if("constructor"===e.type){let e=new b((0,u.mapKeys)(_,u.keyFromJson,function(e){let t={};for(let r=e;r&&r.prototype;r=Object.getPrototypeOf(r))Object.assign(t,Reflect.get(r.prototype,"lc_aliases"));return Object.entries(t).reduce((e,[t,r])=>(e[r]=t,e),{})}(b)));return Object.defineProperty(e.constructor,"name",{value:c}),e}throw Error(`Invalid type: ${p} -> ${i}`)}if("object"==typeof e&&null!==e)if(Array.isArray(e))return Promise.all(e.map((e,t)=>d.call({...this,path:[...a,`${t}`]},e)));else return Object.fromEntries(await Promise.all(Object.entries(e).map(async([e,t])=>[e,await d.call({...this,path:[...a,e]},t)])));return e}async function p(e,t){let r=JSON.parse(e);return d.call({...t},r)}},77847,(e,t,r)=>{t.exports=e.r(26118)},79839,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.stringify=function(e,t,r,o){void 0===o&&(o={depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}),function e(t,r,i,a,o,l,u){if(l+=1,"object"==typeof t&&null!==t){for(c=0;c<a.length;c++)if(a[c]===t)return void s("[Circular]",t,r,o);if(void 0!==u.depthLimit&&l>u.depthLimit||void 0!==u.edgesLimit&&i+1>u.edgesLimit)return void s(n,t,r,o);if(a.push(t),Array.isArray(t))for(c=0;c<t.length;c++)e(t[c],c,c,a,t,l,u);else{var c,d=Object.keys(t);for(c=0;c<d.length;c++){var p=d[c];e(t[p],p,c,a,t,l,u)}}a.pop()}}(e,"",0,[],void 0,0,o);try{var l;u=0===a.length?JSON.stringify(e,t,r):JSON.stringify(e,(l=t,l=void 0!==l?l:function(e,t){return t},function(e,t){if(a.length>0)for(var r=0;r<a.length;r++){var n=a[r];if(n[1]===e&&n[0]===t){t=n[2],a.splice(r,1);break}}return l.call(this,e,t)}),r)}catch(e){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==i.length;){var u,c=i.pop();4===c.length?Object.defineProperty(c[0],c[1],c[3]):c[0][c[1]]=c[2]}}return u};var n="[...]",i=[],a=[];function s(e,t,r,n){var s=Object.getOwnPropertyDescriptor(n,r);void 0!==s.get?s.configurable?(Object.defineProperty(n,r,{value:e}),i.push([n,r,t,s])):a.push([t,r,e]):(n[r]=e,i.push([n,r,t]))}},51306,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.JsonPlusSerializer=void 0;let n=e.r(77847),i=e.r(79839);async function a(e){if(e&&"object"==typeof e)if(Array.isArray(e))return await Promise.all(e.map(e=>a(e)));else{let t={};for(let[r,n]of Object.entries(e))t[r]=await a(n);if(2===t.lc&&"undefined"===t.type)return;if(2===t.lc&&"constructor"===t.type&&Array.isArray(t.id))try{let e;switch(t.id[t.id.length-1]){case"Set":e=Set;break;case"Map":e=Map;break;case"RegExp":e=RegExp;break;case"Error":e=Error;break;default:return t}if(t.method)return e[t.method](...t.args||[]);return new e(...t.args||[])}catch(e){}else if(null!==t&&1===t.lc&&"constructor"===t.type&&Array.isArray(t.id))return(0,n.load)(JSON.stringify(t));return t}return e}function s(e,t,r,n){return{lc:2,type:"constructor",id:[e.name],method:t??null,args:r??[],kwargs:n??{}}}r.JsonPlusSerializer=class{_dumps(e){return new TextEncoder().encode((0,i.stringify)(e,(e,t)=>(function(e){if(void 0===e)return{lc:2,type:"undefined"};if(e instanceof Set||e instanceof Map)return s(e.constructor,void 0,[Array.from(e)]);if(e instanceof RegExp)return s(RegExp,void 0,[e.source,e.flags]);if(e instanceof Error)return s(e.constructor,void 0,[e.message]);if(e?.lg_name==="Send")return{node:e.node,args:e.args};else return e})(t)))}async dumpsTyped(e){return e instanceof Uint8Array?["bytes",e]:["json",this._dumps(e)]}async _loads(e){return a(JSON.parse(e))}async loadsTyped(e,t){if("bytes"===e)return"string"==typeof t?new TextEncoder().encode(t):t;if("json"===e)return this._loads("string"==typeof t?t:new TextDecoder().decode(t));throw Error(`Unknown serialization type: ${e}`)}}},40315,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.WRITES_IDX_MAP=r.BaseCheckpointSaver=void 0,r.deepCopy=s,r.emptyCheckpoint=function(){return{v:4,id:(0,n.uuid6)(-2),ts:new Date().toISOString(),channel_values:{},channel_versions:{},versions_seen:{}}},r.copyCheckpoint=function(e){return{v:e.v,id:e.id,ts:e.ts,channel_values:{...e.channel_values},channel_versions:{...e.channel_versions},versions_seen:s(e.versions_seen)}},r.compareChannelVersions=o,r.maxChannelVersion=function(...e){return e.reduce((e,t,r)=>0===r?t:o(e,t)>=0?e:t)},r.getCheckpointId=function(e){return e.configurable?.checkpoint_id||e.configurable?.thread_ts||""};let n=e.r(56491),i=e.r(30455),a=e.r(51306);function s(e){if("object"!=typeof e||null===e)return e;let t=Array.isArray(e)?[]:{};for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=s(e[r]));return t}function o(e,t){return"number"==typeof e&&"number"==typeof t?Math.sign(e-t):String(e).localeCompare(String(t))}r.BaseCheckpointSaver=class{constructor(e){Object.defineProperty(this,"serde",{enumerable:!0,configurable:!0,writable:!0,value:new a.JsonPlusSerializer}),this.serde=e||this.serde}async get(e){let t=await this.getTuple(e);return t?t.checkpoint:void 0}getNextVersion(e){if("string"==typeof e)throw Error("Please override this method to use string versions.");return void 0!==e&&"number"==typeof e?e+1:1}},r.WRITES_IDX_MAP={[i.ERROR]:-1,[i.SCHEDULED]:-2,[i.INTERRUPT]:-3,[i.RESUME]:-4}},81636,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MemorySaver=void 0;let n=e.r(40315),i=e.r(30455);function a(e,t,r){return JSON.stringify([e,t,r])}class s extends n.BaseCheckpointSaver{constructor(e){super(e),Object.defineProperty(this,"storage",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"writes",{enumerable:!0,configurable:!0,writable:!0,value:{}})}async _migratePendingSends(e,t,r,s){let o=a(t,r,s),l=await Promise.all(Object.values(this.writes[o]??{}).filter(([e,t])=>t===i.TASKS).map(async([e,t,r])=>await this.serde.loadsTyped("json",r)));e.channel_values??={},e.channel_values[i.TASKS]=l,e.channel_versions??={},e.channel_versions[i.TASKS]=Object.keys(e.channel_versions).length>0?(0,n.maxChannelVersion)(...Object.values(e.channel_versions)):this.getNextVersion(void 0)}async getTuple(e){let t=e.configurable?.thread_id,r=e.configurable?.checkpoint_ns??"",i=(0,n.getCheckpointId)(e);if(i){let n=this.storage[t]?.[r]?.[i];if(void 0!==n){let[s,o,l]=n,u=a(t,r,i),c=await this.serde.loadsTyped("json",s);c.v<4&&void 0!==l&&await this._migratePendingSends(c,t,r,l);let d=await Promise.all(Object.values(this.writes[u]||{}).map(async([e,t,r])=>[e,t,await this.serde.loadsTyped("json",r)])),p={config:e,checkpoint:c,metadata:await this.serde.loadsTyped("json",o),pendingWrites:d};return void 0!==l&&(p.parentConfig={configurable:{thread_id:t,checkpoint_ns:r,checkpoint_id:l}}),p}}else{let e=this.storage[t]?.[r];if(void 0!==e){i=Object.keys(e).sort((e,t)=>t.localeCompare(e))[0];let[n,s,o]=e[i],l=a(t,r,i),u=await this.serde.loadsTyped("json",n);u.v<4&&void 0!==o&&await this._migratePendingSends(u,t,r,o);let c=await Promise.all(Object.values(this.writes[l]||{}).map(async([e,t,r])=>[e,t,await this.serde.loadsTyped("json",r)])),d={config:{configurable:{thread_id:t,checkpoint_id:i,checkpoint_ns:r}},checkpoint:u,metadata:await this.serde.loadsTyped("json",s),pendingWrites:c};return void 0!==o&&(d.parentConfig={configurable:{thread_id:t,checkpoint_ns:r,checkpoint_id:o}}),d}}}async *list(e,t){let{before:r,limit:n,filter:i}=t??{},s=e.configurable?.thread_id?[e.configurable?.thread_id]:Object.keys(this.storage),o=e.configurable?.checkpoint_ns,l=e.configurable?.checkpoint_id;for(let e of s)for(let t of Object.keys(this.storage[e]??{}))if(void 0===o||t===o)for(let[s,[o,u,c]]of Object.entries(this.storage[e]?.[t]??{}).sort((e,t)=>t[0].localeCompare(e[0]))){if(l&&s!==l||r&&r.configurable?.checkpoint_id&&s>=r.configurable.checkpoint_id)continue;let d=await this.serde.loadsTyped("json",u);if(i&&!Object.entries(i).every(([e,t])=>d[e]===t))continue;if(void 0!==n){if(n<=0)break;n-=1}let p=a(e,t,s),h=Object.values(this.writes[p]||{}),f=await Promise.all(h.map(async([e,t,r])=>[e,t,await this.serde.loadsTyped("json",r)])),m=await this.serde.loadsTyped("json",o);m.v<4&&void 0!==c&&await this._migratePendingSends(m,e,t,c);let g={config:{configurable:{thread_id:e,checkpoint_ns:t,checkpoint_id:s}},checkpoint:m,metadata:d,pendingWrites:f};void 0!==c&&(g.parentConfig={configurable:{thread_id:e,checkpoint_ns:t,checkpoint_id:c}}),yield g}}async put(e,t,r){let i=(0,n.copyCheckpoint)(t),a=e.configurable?.thread_id,s=e.configurable?.checkpoint_ns??"";if(void 0===a)throw Error('Failed to put checkpoint. The passed RunnableConfig is missing a required "thread_id" field in its "configurable" property.');this.storage[a]||(this.storage[a]={}),this.storage[a][s]||(this.storage[a][s]={});let[[,o],[,l]]=await Promise.all([this.serde.dumpsTyped(i),this.serde.dumpsTyped(r)]);return this.storage[a][s][t.id]=[o,l,e.configurable?.checkpoint_id],{configurable:{thread_id:a,checkpoint_ns:s,checkpoint_id:t.id}}}async putWrites(e,t,r){let i=e.configurable?.thread_id,s=e.configurable?.checkpoint_ns,o=e.configurable?.checkpoint_id;if(void 0===i)throw Error('Failed to put writes. The passed RunnableConfig is missing a required "thread_id" field in its "configurable" property');if(void 0===o)throw Error('Failed to put writes. The passed RunnableConfig is missing a required "checkpoint_id" field in its "configurable" property.');let l=a(i,s,o),u=this.writes[l];void 0===this.writes[l]&&(this.writes[l]={}),await Promise.all(t.map(async([e,t],i)=>{let[,a]=await this.serde.dumpsTyped(t),s=[r,n.WRITES_IDX_MAP[e]||i],o=`${s[0]},${s[1]}`;s[1]>=0&&u&&o in u||(this.writes[l][o]=[r,e,a])}))}async deleteThread(e){for(let t of(delete this.storage[e],Object.keys(this.writes)))(function(e){let[t,r,n]=JSON.parse(e);return{threadId:t,checkpointNamespace:r,checkpointId:n}})(t).threadId===e&&delete this.writes[t]}}r.MemorySaver=s},59554,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},79009,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},43080,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseStore=r.InvalidNamespaceError=void 0,r.getTextAtPath=function(e,t){let r=t.split("."),n=e;for(let e of r){if(e.includes("[")){let[t,r]=e.split("["),i=r.replace("]","");if(!n[t])return[];if("*"===i){let e=[];for(let r of n[t])"string"==typeof r&&e.push(r);return e}let a=parseInt(i,10);if(Number.isNaN(a))return[];n=n[t][a]}else n=n[e];if(void 0===n)return[]}return"string"==typeof n?[n]:[]},r.tokenizePath=function(e){return e.split(".")};class n extends Error{constructor(e){super(e),this.name="InvalidNamespaceError"}}r.InvalidNamespaceError=n,r.BaseStore=class{async get(e,t){return(await this.batch([{namespace:e,key:t}]))[0]}async search(e,t={}){let{filter:r,limit:n=10,offset:i=0,query:a}=t;return(await this.batch([{namespacePrefix:e,filter:r,limit:n,offset:i,query:a}]))[0]}async put(e,t,r,i){if(0===e.length)throw new n("Namespace cannot be empty.");for(let t of e){if("string"!=typeof t)throw new n(`Invalid namespace label '${t}' found in ${e}. Namespace labels must be strings, but got ${typeof t}.`);if(t.includes("."))throw new n(`Invalid namespace label '${t}' found in ${e}. Namespace labels cannot contain periods ('.').`);if(""===t)throw new n(`Namespace labels cannot be empty strings. Got ${t} in ${e}`)}if("langgraph"===e[0])throw new n(`Root label for namespace cannot be "langgraph". Got: ${e}`);await this.batch([{namespace:e,key:t,value:r,index:i}])}async delete(e,t){await this.batch([{namespace:e,key:t,value:null}])}async listNamespaces(e={}){let{prefix:t,suffix:r,maxDepth:n,limit:i=100,offset:a=0}=e,s=[];return t&&s.push({matchType:"prefix",path:t}),r&&s.push({matchType:"suffix",path:r}),(await this.batch([{matchConditions:s.length?s:void 0,maxDepth:n,limit:i,offset:a}]))[0]}start(){}stop(){}}},64724,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AsyncBatchedStore=void 0;let n=e.r(43080);class i extends n.BaseStore{constructor(e){super(),Object.defineProperty(this,"lg_name",{enumerable:!0,configurable:!0,writable:!0,value:"AsyncBatchedStore"}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"nextKey",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"running",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"processingTask",{enumerable:!0,configurable:!0,writable:!0,value:null}),this.store=(e=>"lg_name"in e&&"AsyncBatchedStore"===e.lg_name?e.store:e)(e)}get isRunning(){return this.running}async batch(e){throw Error("The `batch` method is not implemented on `AsyncBatchedStore`.\n Instead, it calls the `batch` method on the wrapped store.\n If you are seeing this error, something is wrong.")}async get(e,t){return this.enqueueOperation({namespace:e,key:t})}async search(e,t){let{filter:r,limit:n=10,offset:i=0,query:a}=t||{};return this.enqueueOperation({namespacePrefix:e,filter:r,limit:n,offset:i,query:a})}async put(e,t,r){return this.enqueueOperation({namespace:e,key:t,value:r})}async delete(e,t){return this.enqueueOperation({namespace:e,key:t,value:null})}start(){this.running||(this.running=!0,this.processingTask=this.processBatchQueue())}async stop(){this.running=!1,this.processingTask&&await this.processingTask}enqueueOperation(e){return new Promise((t,r)=>{let n=this.nextKey;this.nextKey+=1,this.queue.set(n,{operation:e,resolve:t,reject:r})})}async processBatchQueue(){for(;this.running;){if(await new Promise(e=>{setTimeout(e,0)}),0===this.queue.size)continue;let e=new Map(this.queue);this.queue.clear();try{let t=Array.from(e.values()).map(({operation:e})=>e),r=await this.store.batch(t);e.forEach(({resolve:t},n)=>{let i=Array.from(e.keys()).indexOf(n);t(r[i])})}catch(t){e.forEach(({reject:e})=>{e(t)})}}}toJSON(){return{queue:this.queue,nextKey:this.nextKey,running:this.running,store:"[LangGraphStore]"}}}r.AsyncBatchedStore=i},12306,(e,t,r)=>{"use strict";function n(e){if(!e)return[];let t=[],r=[],n=0;for(;n<e.length;){let i=e[n];if("["===i){r.length&&(t.push(r.join("")),r=[]);let i=1,a=["["];for(n+=1;n<e.length&&i>0;)"["===e[n]?i+=1:"]"===e[n]&&(i-=1),a.push(e[n]),n+=1;t.push(a.join(""));continue}if("{"===i){r.length&&(t.push(r.join("")),r=[]);let i=1,a=["{"];for(n+=1;n<e.length&&i>0;)"{"===e[n]?i+=1:"}"===e[n]&&(i-=1),a.push(e[n]),n+=1;t.push(a.join(""));continue}"."===i?r.length&&(t.push(r.join("")),r=[]):r.push(i);n+=1}return r.length&&t.push(r.join("")),t}Object.defineProperty(r,"__esModule",{value:!0}),r.tokenizePath=n,r.compareValues=function(e,t){return"object"==typeof t&&null!==t&&Object.keys(t).every(e=>"$eq"===e||"$ne"===e||"$gt"===e||"$gte"===e||"$lt"===e||"$lte"===e||"$in"===e||"$nin"===e)?Object.keys(t).filter(e=>e.startsWith("$")).every(r=>{let n=t[r];switch(r){case"$eq":return e===n;case"$ne":return e!==n;case"$gt":return Number(e)>Number(n);case"$gte":return Number(e)>=Number(n);case"$lt":return Number(e)<Number(n);case"$lte":return Number(e)<=Number(n);case"$in":return!!Array.isArray(n)&&n.includes(e);case"$nin":return!Array.isArray(n)||!n.includes(e);default:return!1}}):e===t},r.getTextAtPath=function(e,t){return t&&"$"!==t?function e(t,r,i){if(i>=r.length)return"string"==typeof t||"number"==typeof t||"boolean"==typeof t?[String(t)]:null==t?[]:Array.isArray(t)||"object"==typeof t?[JSON.stringify(t,null,2)]:[];let a=r[i],s=[];if(0===i&&"$"===a&&s.push(JSON.stringify(t,null,2)),a.startsWith("[")&&a.endsWith("]")){if(!Array.isArray(t))return[];let n=a.slice(1,-1);if("*"===n)for(let n of t)s.push(...e(n,r,i+1));else try{let a=parseInt(n,10);a<0&&(a=t.length+a),a>=0&&a<t.length&&s.push(...e(t[a],r,i+1))}catch{return[]}}else if(a.startsWith("{")&&a.endsWith("}")){if("object"!=typeof t||null===t)return[];for(let e of a.slice(1,-1).split(",").map(e=>e.trim())){let r=n(e);if(r.length){let e=t;for(let t of r)if(e&&"object"==typeof e&&t in e)e=e[t];else{e=void 0;break}void 0!==e&&("string"==typeof e||"number"==typeof e||"boolean"==typeof e?s.push(String(e)):(Array.isArray(e)||"object"==typeof e)&&s.push(JSON.stringify(e,null,2)))}}}else if("*"===a){if(Array.isArray(t))for(let n of t)s.push(...e(n,r,i+1));else if("object"==typeof t&&null!==t)for(let n of Object.values(t))s.push(...e(n,r,i+1))}else"object"==typeof t&&null!==t&&a in t&&s.push(...e(t[a],r,i+1));return s}(e,Array.isArray(t)?t:n(t),0):[JSON.stringify(e,null,2)]},r.cosineSimilarity=function(e,t){if(e.length!==t.length)throw Error("Vectors must have the same length");let r=e.reduce((e,r,n)=>e+r*t[n],0),n=Math.sqrt(e.reduce((e,t)=>e+t*t,0)),i=Math.sqrt(t.reduce((e,t)=>e+t*t,0));return 0===n||0===i?0:r/(n*i)}},83982,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MemoryStore=r.InMemoryStore=void 0;let n=e.r(43080),i=e.r(12306);class a extends n.BaseStore{constructor(e){super(),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"vectors",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"_indexConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e?.index&&(this._indexConfig={...e.index,__tokenizedFields:(e.index.fields??["$"]).map(e=>[e,"$"===e?[e]:(0,i.tokenizePath)(e)])})}async batch(e){let t=[],r=new Map,n=new Map;for(let i=0;i<e.length;i+=1){let a=e[i];if("key"in a&&"namespace"in a&&!("value"in a))t.push(this.getOperation(a));else if("namespacePrefix"in a){let e=this.filterItems(a);n.set(i,[a,e]),t.push(null)}else if("value"in a){let e=`${a.namespace.join(":")}:${a.key}`;r.set(e,a),t.push(null)}else"matchConditions"in a&&t.push(this.listNamespacesOperation(a))}if(n.size>0)if(this._indexConfig?.embeddings){let e=new Set;for(let[t]of n.values())t.query&&e.add(t.query);let r=e.size>0?await Promise.all(Array.from(e).map(e=>this._indexConfig.embeddings.embedQuery(e))):[],i=Object.fromEntries(Array.from(e).map((e,t)=>[e,r[t]]));for(let[e,[r,a]]of n.entries())if(r.query&&i[r.query]){let n=i[r.query],s=this.scoreResults(a,n,r.offset??0,r.limit??10);t[e]=s}else t[e]=this.paginateResults(a.map(e=>({...e,score:void 0})),r.offset??0,r.limit??10)}else for(let[e,[r,i]]of n.entries())t[e]=this.paginateResults(i.map(e=>({...e,score:void 0})),r.offset??0,r.limit??10);if(r.size>0&&this._indexConfig?.embeddings){let e=this.extractTexts(Array.from(r.values()));if(Object.keys(e).length>0){let t=await this._indexConfig.embeddings.embedDocuments(Object.keys(e));this.insertVectors(e,t)}}for(let e of r.values())this.putOperation(e);return t}getOperation(e){let t=e.namespace.join(":");return this.data.get(t)?.get(e.key)??null}putOperation(e){let t=e.namespace.join(":");this.data.has(t)||this.data.set(t,new Map);let r=this.data.get(t);if(null===e.value)r.delete(e.key);else{let t=new Date;if(r.has(e.key)){let n=r.get(e.key);n.value=e.value,n.updatedAt=t}else r.set(e.key,{value:e.value,key:e.key,namespace:e.namespace,createdAt:t,updatedAt:t})}}listNamespacesOperation(e){let t=Array.from(this.data.keys()).map(e=>e.split(":"));return e.matchConditions&&e.matchConditions.length>0&&(t=t.filter(t=>e.matchConditions.every(e=>this.doesMatch(e,t)))),void 0!==e.maxDepth&&(t=Array.from(new Set(t.map(t=>t.slice(0,e.maxDepth).join(":")))).map(e=>e.split(":"))),t.sort((e,t)=>e.join(":").localeCompare(t.join(":"))),t.slice(e.offset??0,(e.offset??0)+(e.limit??t.length))}doesMatch(e,t){let{matchType:r,path:n}=e;if("prefix"===r)return!(n.length>t.length)&&n.every((e,r)=>{let n=t[r];return"*"===e||n===e});if("suffix"===r)return!(n.length>t.length)&&n.every((e,r)=>{let i=t[t.length-n.length+r];return"*"===e||i===e});throw Error(`Unsupported match type: ${r}`)}filterItems(e){let t=[];for(let[r,n]of this.data.entries())r.startsWith(e.namespacePrefix.join(":"))&&t.push(...n.values());let r=t;return e.filter&&(r=t.filter(t=>Object.entries(e.filter).every(([e,r])=>(0,i.compareValues)(t.value[e],r)))),r}scoreResults(e,t,r=0,n=10){let i=[],a=[],s=[];for(let t of e){let e=this.getVectors(t);if(e.length)for(let r of e)i.push(t),a.push(r);else s.push(t)}let o=this.cosineSimilarity(t,a).map((e,t)=>[e,i[t]]).sort((e,t)=>t[0]-e[0]),l=new Set,u=[];for(let[e,t]of o){let i=`${t.namespace.join(":")}:${t.key}`;if(l.has(i))continue;let a=l.size;if(a>=r+n)break;if(a<r){l.add(i);continue}l.add(i),u.push([e,t])}if(s.length&&u.length<n)for(let e of s.slice(0,n-u.length)){let t=`${e.namespace.join(":")}:${e.key}`;l.has(t)||(l.add(t),u.push([void 0,e]))}return u.map(([e,t])=>({...t,score:e}))}paginateResults(e,t,r){return e.slice(t,t+r)}extractTexts(e){if(!e.length||!this._indexConfig)return{};let t={};for(let r of e)if(null!==r.value&&!1!==r.index)for(let[e,n]of null===r.index||void 0===r.index?this._indexConfig.__tokenizedFields??[]:r.index.map(e=>[e,(0,i.tokenizePath)(e)])){let a=(0,i.getTextAtPath)(r.value,n);a.length&&(a.length>1?a.forEach((n,i)=>{t[n]||(t[n]=[]),t[n].push([r.namespace,r.key,`${e}.${i}`])}):(t[a[0]]||(t[a[0]]=[]),t[a[0]].push([r.namespace,r.key,e])))}return t}insertVectors(e,t){for(let[r,n]of Object.entries(e)){let e=t.shift();if(!e)throw Error(`No embedding found for text: ${r}`);for(let[t,r,i]of n){let n=t.join(":");this.vectors.has(n)||this.vectors.set(n,new Map);let a=this.vectors.get(n);a.has(r)||a.set(r,new Map),a.get(r).set(i,e)}}}getVectors(e){let t=e.namespace.join(":"),r=e.key;if(!this.vectors.has(t))return[];let n=this.vectors.get(t);if(!n.has(r))return[];let i=Array.from(n.get(r).values());return i.length?i:[]}cosineSimilarity(e,t){if(!t.length)return[];let r=t.map(t=>t.reduce((t,r,n)=>t+r*e[n],0)),n=Math.sqrt(e.reduce((e,t)=>e+t*t,0)),i=t.map(e=>Math.sqrt(e.reduce((e,t)=>e+t*t,0)));return r.map((e,t)=>{let r=i[t];return n&&r?e/(n*r):0})}get indexConfig(){return this._indexConfig}}r.InMemoryStore=a,r.MemoryStore=class extends a{}},46423,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(43080),r),i(e.r(64724),r),i(e.r(83982),r)},17532,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseCache=void 0;let n=e.r(51306);r.BaseCache=class{constructor(e){Object.defineProperty(this,"serde",{enumerable:!0,configurable:!0,writable:!0,value:new n.JsonPlusSerializer}),this.serde=e||this.serde}}},75848,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InMemoryCache=void 0;let n=e.r(17532);class i extends n.BaseCache{constructor(){super(...arguments),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:{}})}async get(e){if(!e.length)return[];let t=Date.now();return(await Promise.all(e.map(async e=>{let[r,n]=e,i=r.join(",");if(i in this.cache&&n in this.cache[i]){let r=this.cache[i][n];if(null==r.exp||t<r.exp)return[{key:e,value:await this.serde.loadsTyped(r.enc,r.val)}];delete this.cache[i][n]}return[]}))).flat()}async set(e){let t=Date.now();for(let{key:r,value:n,ttl:i}of e){let[e,a]=r,s=e.join(","),[o,l]=await this.serde.dumpsTyped(n),u=null!=i?1e3*i+t:null;this.cache[s]??={},this.cache[s][a]={enc:o,val:l,exp:u}}}async clear(e){if(!e.length){this.cache={};return}for(let t of e){let e=t.join(",");e in this.cache&&delete this.cache[e]}}}r.InMemoryCache=i},83068,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(17532),r),i(e.r(75848),r)},99905,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.MemorySaver=void 0;var a=e.r(81636);Object.defineProperty(r,"MemorySaver",{enumerable:!0,get:function(){return a.MemorySaver}}),i(e.r(40315),r),i(e.r(56491),r),i(e.r(59554),r),i(e.r(79009),r),i(e.r(30455),r),i(e.r(46423),r),i(e.r(83068),r)},77978,(e,t,r)=>{t.exports=e.r(99905)},99935,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseChannel=void 0,r.isBaseChannel=a,r.getOnlyChannels=o,r.emptyChannels=function(e,t){let r=o(e),n={};for(let e in r){if(!Object.prototype.hasOwnProperty.call(r,e))continue;let i=t.channel_values[e];n[e]=r[e].fromCheckpoint(i)}return Object.assign(n,{[s]:!0}),n},r.createCheckpoint=function(e,t,r,a){let s;if(void 0===t)s=e.channel_values;else for(let e in s={},t)if(Object.prototype.hasOwnProperty.call(t,e))try{s[e]=t[e].checkpoint()}catch(e){if(e.name===i.EmptyChannelError.unminifiable_name);else throw e}let o={};for(let t in e.versions_seen)Object.prototype.hasOwnProperty.call(e.versions_seen,t)&&(o[t]={...e.versions_seen[t]});return{v:4,id:a?.id??(0,n.uuid6)(r),ts:new Date().toISOString(),channel_values:s,channel_versions:{...e.channel_versions},versions_seen:o}};let n=e.r(77978),i=e.r(83134);function a(e){return null!=e&&!0===e.lg_is_channel}r.BaseChannel=class{constructor(){Object.defineProperty(this,"ValueType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"UpdateType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lg_is_channel",{enumerable:!0,configurable:!0,writable:!0,value:!0})}consume(){return!1}finish(){return!1}isAvailable(){try{return this.get(),!0}catch(e){if(e.name===i.EmptyChannelError.unminifiable_name)return!1;throw e}}};let s=Symbol.for("LG_IS_ONLY_BASE_CHANNEL");function o(e){if(!0===e[s])return e;let t={};for(let r in e){if(!Object.prototype.hasOwnProperty.call(e,r))continue;let n=e[r];a(n)&&(t[r]=n)}return Object.assign(t,{[s]:!0}),t}},69979,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BinaryOperatorAggregate=void 0;let n=e.r(83134),i=e.r(99935);class a extends i.BaseChannel{constructor(e,t){super(),Object.defineProperty(this,"lc_graph_name",{enumerable:!0,configurable:!0,writable:!0,value:"BinaryOperatorAggregate"}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"operator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"initialValueFactory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.operator=e,this.initialValueFactory=t,this.value=t?.()}fromCheckpoint(e){let t=new a(this.operator,this.initialValueFactory);return void 0!==e&&(t.value=e),t}update(e){let t=e;if(!t.length)return!1;for(let e of(void 0===this.value&&([this.value]=t,t=t.slice(1)),t))void 0!==this.value&&(this.value=this.operator(this.value,e));return!0}get(){if(void 0===this.value)throw new n.EmptyChannelError;return this.value}checkpoint(){if(void 0===this.value)throw new n.EmptyChannelError;return this.value}isAvailable(){return void 0!==this.value}}r.BinaryOperatorAggregate=a},13180,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LastValueAfterFinish=r.LastValue=void 0;let n=e.r(83134),i=e.r(99935);class a extends i.BaseChannel{constructor(){super(...arguments),Object.defineProperty(this,"lc_graph_name",{enumerable:!0,configurable:!0,writable:!0,value:"LastValue"}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:[]})}fromCheckpoint(e){let t=new a;return void 0!==e&&(t.value=[e]),t}update(e){if(0===e.length)return!1;if(1!==e.length)throw new n.InvalidUpdateError("LastValue can only receive one value per step.",{lc_error_code:"INVALID_CONCURRENT_GRAPH_UPDATE"});return this.value=[e[e.length-1]],!0}get(){if(0===this.value.length)throw new n.EmptyChannelError;return this.value[0]}checkpoint(){if(0===this.value.length)throw new n.EmptyChannelError;return this.value[0]}isAvailable(){return 0!==this.value.length}}r.LastValue=a;class s extends i.BaseChannel{constructor(){super(...arguments),Object.defineProperty(this,"lc_graph_name",{enumerable:!0,configurable:!0,writable:!0,value:"LastValueAfterFinish"}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"finished",{enumerable:!0,configurable:!0,writable:!0,value:!1})}fromCheckpoint(e){let t=new s;if(void 0!==e){let[r,n]=e;t.value=[r],t.finished=n}return t}update(e){return 0!==e.length&&(this.finished=!1,this.value=[e[e.length-1]],!0)}get(){if(0===this.value.length||!this.finished)throw new n.EmptyChannelError;return this.value[0]}checkpoint(){if(0!==this.value.length)return[this.value[0],this.finished]}consume(){return!!this.finished&&(this.finished=!1,this.value=[],!0)}finish(){return!this.finished&&this.value.length>0&&(this.finished=!0,!0)}isAvailable(){return 0!==this.value.length&&this.finished}}r.LastValueAfterFinish=s},74585,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Annotation=r.AnnotationRoot=void 0,r.getChannel=s;let n=e.r(69979),i=e.r(13180);class a{constructor(e){Object.defineProperty(this,"lc_graph_name",{enumerable:!0,configurable:!0,writable:!0,value:"AnnotationRoot"}),Object.defineProperty(this,"spec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.spec=e}}function s(e){return"object"==typeof e&&e&&"reducer"in e&&e.reducer?new n.BinaryOperatorAggregate(e.reducer,e.default):"object"==typeof e&&e&&"value"in e&&e.value?new n.BinaryOperatorAggregate(e.value,e.default):new i.LastValue}r.AnnotationRoot=a,r.Annotation=function(e){return e?s(e):new i.LastValue},r.Annotation.Root=e=>new a(e)},81369,(e,t,r)=>{t.exports=e.r(56044)},45864,(e,t,r)=>{"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.Command=r.Send=r.CommandInstance=r.CHECKPOINT_NAMESPACE_END=r.CHECKPOINT_NAMESPACE_SEPARATOR=r.RESERVED=r.NULL_TASK_ID=r.TASK_NAMESPACE=r.PULL=r.PUSH=r.TASKS=r.SELF=r.TAG_NOSTREAM=r.TAG_HIDDEN=r.RECURSION_LIMIT_DEFAULT=r.RUNTIME_PLACEHOLDER=r.PREVIOUS=r.RETURN=r.NO_WRITES=r.RESUME=r.INTERRUPT=r.CONFIG_KEY_ABORT_SIGNALS=r.CONFIG_KEY_CHECKPOINT_MAP=r.CONFIG_KEY_NODE_FINISHED=r.CONFIG_KEY_CHECKPOINT_NS=r.CONFIG_KEY_CHECKPOINT_ID=r.CONFIG_KEY_DURABILITY=r.CONFIG_KEY_PREVIOUS_STATE=r.CONFIG_KEY_SCRATCHPAD=r.CONFIG_KEY_RESUME_MAP=r.CONFIG_KEY_RESUME_VALUE=r.CONFIG_KEY_STREAM=r.CONFIG_KEY_TASK_ID=r.CONFIG_KEY_RESUMING=r.CONFIG_KEY_CHECKPOINTER=r.CONFIG_KEY_READ=r.CONFIG_KEY_CALL=r.CONFIG_KEY_SEND=r.CACHE_NS_WRITES=r.ERROR=r.COPY=r.INPUT=r.END=r.START=void 0,r._isSendInterface=s,r._isSend=l,r.isInterrupted=function(e){return!!e&&"object"==typeof e&&r.INTERRUPT in e&&Array.isArray(e[r.INTERRUPT])},r.isCommand=c,r._deserializeCommandSendObjectGraph=d,r.START="__start__",r.END="__end__",r.INPUT="__input__",r.COPY="__copy__",r.ERROR="__error__",r.CACHE_NS_WRITES="__pregel_ns_writes",r.CONFIG_KEY_SEND="__pregel_send",r.CONFIG_KEY_CALL="__pregel_call",r.CONFIG_KEY_READ="__pregel_read",r.CONFIG_KEY_CHECKPOINTER="__pregel_checkpointer",r.CONFIG_KEY_RESUMING="__pregel_resuming",r.CONFIG_KEY_TASK_ID="__pregel_task_id",r.CONFIG_KEY_STREAM="__pregel_stream",r.CONFIG_KEY_RESUME_VALUE="__pregel_resume_value",r.CONFIG_KEY_RESUME_MAP="__pregel_resume_map",r.CONFIG_KEY_SCRATCHPAD="__pregel_scratchpad",r.CONFIG_KEY_PREVIOUS_STATE="__pregel_previous",r.CONFIG_KEY_DURABILITY="__pregel_durability",r.CONFIG_KEY_CHECKPOINT_ID="checkpoint_id",r.CONFIG_KEY_CHECKPOINT_NS="checkpoint_ns",r.CONFIG_KEY_NODE_FINISHED="__pregel_node_finished",r.CONFIG_KEY_CHECKPOINT_MAP="checkpoint_map",r.CONFIG_KEY_ABORT_SIGNALS="__pregel_abort_signals",r.INTERRUPT="__interrupt__",r.RESUME="__resume__",r.NO_WRITES="__no_writes__",r.RETURN="__return__",r.PREVIOUS="__previous__",r.RUNTIME_PLACEHOLDER="__pregel_runtime_placeholder__",r.RECURSION_LIMIT_DEFAULT=25,r.TAG_HIDDEN="langsmith:hidden",r.TAG_NOSTREAM="langsmith:nostream",r.SELF="__self__",r.TASKS="__pregel_tasks",r.PUSH="__pregel_push",r.PULL="__pregel_pull",r.TASK_NAMESPACE="6ba7b831-9dad-11d1-80b4-00c04fd430c8",r.NULL_TASK_ID="00000000-0000-0000-0000-000000000000",r.RESERVED=[r.TAG_HIDDEN,r.INPUT,r.INTERRUPT,r.RESUME,r.ERROR,r.NO_WRITES,r.CONFIG_KEY_SEND,r.CONFIG_KEY_READ,r.CONFIG_KEY_CHECKPOINTER,r.CONFIG_KEY_DURABILITY,r.CONFIG_KEY_STREAM,r.CONFIG_KEY_RESUMING,r.CONFIG_KEY_TASK_ID,r.CONFIG_KEY_CALL,r.CONFIG_KEY_RESUME_VALUE,r.CONFIG_KEY_SCRATCHPAD,r.CONFIG_KEY_PREVIOUS_STATE,r.CONFIG_KEY_CHECKPOINT_MAP,r.CONFIG_KEY_CHECKPOINT_NS,r.CONFIG_KEY_CHECKPOINT_ID],r.CHECKPOINT_NAMESPACE_SEPARATOR="|",r.CHECKPOINT_NAMESPACE_END=":";let i=Symbol.for("langgraph.command");class a{constructor(){Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:void 0})}}function s(e){return null!=e&&"string"==typeof e.node&&void 0!==e.args}r.CommandInstance=a,n=i;class o{constructor(e,t){Object.defineProperty(this,"lg_name",{enumerable:!0,configurable:!0,writable:!0,value:"Send"}),Object.defineProperty(this,"node",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.node=e,this.args=d(t)}toJSON(){return{lg_name:this.lg_name,node:this.node,args:this.args}}}function l(e){return e instanceof o}r.Send=o;class u extends a{constructor(e){super(),Object.defineProperty(this,"lg_name",{enumerable:!0,configurable:!0,writable:!0,value:"Command"}),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"graph",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"update",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resume",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"goto",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.resume=e.resume,this.graph=e.graph,this.update=e.update,e.goto&&(this.goto=Array.isArray(e.goto)?d(e.goto):[d(e.goto)])}_updateAsTuples(){return this.update&&"object"==typeof this.update&&!Array.isArray(this.update)?Object.entries(this.update):Array.isArray(this.update)&&this.update.every(e=>Array.isArray(e)&&2===e.length&&"string"==typeof e[0])?this.update:[["__root__",this.update]]}toJSON(){let e;return e="string"==typeof this.goto?this.goto:l(this.goto)?this.goto.toJSON():this.goto?.map(e=>"string"==typeof e?e:e.toJSON()),{lg_name:this.lg_name,update:this.update,resume:this.resume,goto:e}}}function c(e){return"object"==typeof e&&null!=e&&"lg_name"in e&&"Command"===e.lg_name}function d(e,t=new Map){if(null!=e&&"object"==typeof e){let r;if(t.has(e))return t.get(e);if(Array.isArray(e))r=[],t.set(e,r),e.forEach((e,n)=>{r[n]=d(e,t)});else if(!c(e)||e instanceof u)if(!s(e)||e instanceof o)if(c(e)||l(e))r=e,t.set(e,r);else if("lc_serializable"in e&&e.lc_serializable)r=e,t.set(e,r);else for(let[n,i]of(r={},t.set(e,r),Object.entries(e)))r[n]=d(i,t);else r=new o(e.node,e.args),t.set(e,r);else r=new u(e),t.set(e,r);return r}return e}r.Command=u,Object.defineProperty(u,"PARENT",{enumerable:!0,configurable:!0,writable:!0,value:"__parent__"})},94497,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ensureLangGraphConfig=function(...e){let t={tags:[],metadata:{},callbacks:void 0,recursionLimit:25,configurable:{}},r=n.AsyncLocalStorageProviderSingleton.getRunnableConfig();if(void 0!==r){for(let[e,n]of Object.entries(r))if(void 0!==n)if(a.includes(e)){let r;r=Array.isArray(n)?[...n]:"object"==typeof n?"callbacks"===e&&"copy"in n&&"function"==typeof n.copy?n.copy():{...n}:n,t[e]=r}else t[e]=n}for(let r of e)if(void 0!==r)for(let[e,n]of Object.entries(r))void 0!==n&&s.includes(e)&&(t[e]=n);for(let[e,r]of Object.entries(t.configurable))t.metadata=t.metadata??{},e.startsWith("__")||"string"!=typeof r&&"number"!=typeof r&&"boolean"!=typeof r||e in t.metadata||(t.metadata[e]=r);return t},r.getStore=function(e){let t=e??n.AsyncLocalStorageProviderSingleton.getRunnableConfig();if(void 0===t)throw Error("Config not retrievable. This is likely because you are running in an environment without support for AsyncLocalStorage.\nIf you're running `getStore` in such environment, pass the `config` from the node function directly.");return t?.store},r.getWriter=function(e){let t=e??n.AsyncLocalStorageProviderSingleton.getRunnableConfig();if(void 0===t)throw Error("Config not retrievable. This is likely because you are running in an environment without support for AsyncLocalStorage.\nIf you're running `getWriter` in such environment, pass the `config` from the node function directly.");return t?.writer||t?.configurable?.writer},r.getConfig=function(){return n.AsyncLocalStorageProviderSingleton.getRunnableConfig()},r.getCurrentTaskInput=function(e){let t=e??n.AsyncLocalStorageProviderSingleton.getRunnableConfig();if(void 0===t)throw Error("Config not retrievable. This is likely because you are running in an environment without support for AsyncLocalStorage.\nIf you're running `getCurrentTaskInput` in such environment, pass the `config` from the node function directly.");if(t.configurable?.[i.CONFIG_KEY_SCRATCHPAD]?.currentTaskInput===void 0)throw Error("BUG: internal scratchpad not initialized.");return t.configurable[i.CONFIG_KEY_SCRATCHPAD].currentTaskInput},r.recastCheckpointNamespace=function(e){return e.split(i.CHECKPOINT_NAMESPACE_SEPARATOR).filter(e=>!e.match(/^\d+$/)).map(e=>e.split(i.CHECKPOINT_NAMESPACE_END)[0]).join(i.CHECKPOINT_NAMESPACE_SEPARATOR)},r.getParentCheckpointNamespace=function(e){let t=e.split(i.CHECKPOINT_NAMESPACE_SEPARATOR);for(;t.length>1&&t[t.length-1].match(/^\d+$/);)t.pop();return t.slice(0,-1).join(i.CHECKPOINT_NAMESPACE_SEPARATOR)};let n=e.r(92595),i=e.r(45864),a=["tags","metadata","callbacks","configurable"],s=["tags","metadata","callbacks","runName","maxConcurrency","recursionLimit","configurable","runId","outputKeys","streamMode","store","writer","context","interruptBefore","interruptAfter","checkpointDuring","durability","signal"]},93053,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RunnableCallable=void 0,r.prefixGenerator=function*(e,t){if(void 0===t)yield*e;else for(let r of e)yield[t,r]},r.gatherIterator=o,r.gatherIteratorSync=function(e){let t=[];for(let r of e)t.push(r);return t},r.patchConfigurable=function(e,t){return e?"configurable"in e?{...e,configurable:{...e.configurable,...t}}:{...e,configurable:t}:{configurable:t}},r.isAsyncGeneratorFunction=function(e){return null!=e&&"function"==typeof e&&e instanceof Object.getPrototypeOf(async function*(){}).constructor},r.isGeneratorFunction=function(e){return null!=e&&"function"==typeof e&&e instanceof Object.getPrototypeOf(function*(){}).constructor};let n=e.r(78541),i=e.r(92595),a=e.r(94497);class s extends n.Runnable{constructor(e){super(),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langgraph"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"recurse",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.name=e.name??e.func.name,this.func=e.func,this.config=e.tags?{tags:e.tags}:void 0,this.trace=e.trace??this.trace,this.recurse=e.recurse??this.recurse}async _tracedInvoke(e,t,r){return new Promise((a,s)=>{let o=(0,n.patchConfig)(t,{callbacks:r?.getChild()});i.AsyncLocalStorageProviderSingleton.runWithConfig(o,async()=>{try{let t=await this.func(e,o);a(t)}catch(e){s(e)}})})}async invoke(e,t){let r,s=(0,a.ensureLangGraphConfig)(t),o=(0,n.mergeConfigs)(this.config,s);return(r=this.trace?await this._callWithConfig(this._tracedInvoke,e,o):await i.AsyncLocalStorageProviderSingleton.runWithConfig(o,async()=>this.func(e,o)),n.Runnable.isRunnable(r)&&this.recurse)?await i.AsyncLocalStorageProviderSingleton.runWithConfig(o,async()=>r.invoke(e,o)):r}}async function o(e){let t=[];for await(let r of(await e))t.push(r);return t}r.RunnableCallable=s},33514,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChannelWrite=r.PASSTHROUGH=r.SKIP_WRITE=void 0;let n=e.r(78541),i=e.r(45864),a=e.r(93053),s=e.r(83134);function o(e){return"object"==typeof e&&e?.[Symbol.for("LG_PASSTHROUGH")]!==void 0}r.SKIP_WRITE={[Symbol.for("LG_SKIP_WRITE")]:!0},r.PASSTHROUGH={[Symbol.for("LG_PASSTHROUGH")]:!0};let l=Symbol("IS_WRITER");class u extends a.RunnableCallable{constructor(e,t){super({writes:e,name:`ChannelWrite<${e.map(e=>(0,i._isSend)(e)?e.node:"channel"in e?e.channel:"...").join(",")}>`,tags:t,func:async(e,t)=>this._write(e,t??{})}),Object.defineProperty(this,"writes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.writes=e}async _write(e,t){let r=this.writes.map(t=>d(t)&&o(t.value)?{mapper:t.mapper,value:e}:c(t)&&o(t.value)?{channel:t.channel,value:e,skipNone:t.skipNone,mapper:t.mapper}:t);return await u.doWrite(t,r),e}static async doWrite(e,t){for(let e of t){if(c(e)){if(e.channel===i.TASKS)throw new s.InvalidUpdateError("Cannot write to the reserved channel TASKS");if(o(e.value))throw new s.InvalidUpdateError("PASSTHROUGH value must be replaced")}if(d(e)&&o(e.value))throw new s.InvalidUpdateError("PASSTHROUGH value must be replaced")}let r=[];for(let n of t)if((0,i._isSend)(n))r.push([i.TASKS,n]);else if(d(n)){let t=await n.mapper.invoke(n.value,e);null!=t&&t.length>0&&r.push(...t)}else if(c(n)){let t=void 0!==n.mapper?await n.mapper.invoke(n.value,e):n.value;if("object"==typeof t&&t?.[Symbol.for("LG_SKIP_WRITE")]!==void 0||n.skipNone&&void 0===t)continue;r.push([n.channel,t])}else throw Error(`Invalid write entry: ${JSON.stringify(n)}`);(e.configurable?.[i.CONFIG_KEY_SEND])(r)}static isWriter(e){return e instanceof u||l in e&&!!e[l]}static registerWriter(e){return Object.defineProperty(e,l,{value:!0})}}function c(e){return void 0!==e&&"string"==typeof e.channel}function d(e){return void 0!==e&&!c(e)&&n.Runnable.isRunnable(e.mapper)}r.ChannelWrite=u},4842,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PregelNode=r.ChannelRead=void 0;let n=e.r(78541),i=e.r(45864),a=e.r(33514),s=e.r(93053);class o extends s.RunnableCallable{constructor(e,t,r=!1){super({func:(e,t)=>o.doRead(t,this.channel,this.fresh,this.mapper)}),Object.defineProperty(this,"lc_graph_name",{enumerable:!0,configurable:!0,writable:!0,value:"ChannelRead"}),Object.defineProperty(this,"channel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fresh",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.fresh=r,this.mapper=t,this.channel=e,this.name=Array.isArray(e)?`ChannelRead<${e.join(",")}>`:`ChannelRead<${e}>`}static doRead(e,t,r,n){let a=e.configurable?.[i.CONFIG_KEY_READ];if(!a)throw Error("Runnable is not configured with a read function. Make sure to call in the context of a Pregel process");return n?n(a(t,r)):a(t,r)}}r.ChannelRead=o;let l=new n.RunnablePassthrough;class u extends n.RunnableBinding{constructor(e){let{channels:t,triggers:r,mapper:n,writers:i,bound:a,kwargs:s,metadata:o,retryPolicy:u,cachePolicy:c,tags:d,subgraphs:p,ends:h}=e,f=[...e.config?.tags?e.config.tags:[],...d??[]];super({...e,bound:e.bound??l,config:{...e.config?e.config:{},tags:f}}),Object.defineProperty(this,"lc_graph_name",{enumerable:!0,configurable:!0,writable:!0,value:"PregelNode"}),Object.defineProperty(this,"channels",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"triggers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"retryPolicy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cachePolicy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"subgraphs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ends",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.channels=t,this.triggers=r,this.mapper=n,this.writers=i??this.writers,this.bound=a??this.bound,this.kwargs=s??this.kwargs,this.metadata=o??this.metadata,this.tags=f,this.retryPolicy=u,this.cachePolicy=c,this.subgraphs=p,this.ends=h}getWriters(){let e=[...this.writers];for(;e.length>1&&e[e.length-1]instanceof a.ChannelWrite&&e[e.length-2]instanceof a.ChannelWrite;){let t=e.slice(-2),r=t[0].writes.concat(t[1].writes);e[e.length-2]=new a.ChannelWrite(r,t[0].config?.tags),e.pop()}return e}getNode(){let e=this.getWriters();if(this.bound!==l||0!==e.length)return this.bound===l&&1===e.length?e[0]:this.bound===l?new n.RunnableSequence({first:e[0],middle:e.slice(1,e.length-1),last:e[e.length-1],omitSequenceTags:!0}):e.length>0?new n.RunnableSequence({first:this.bound,middle:e.slice(0,e.length-1),last:e[e.length-1],omitSequenceTags:!0}):this.bound}join(e){if(!Array.isArray(e))throw Error("channels must be a list");if("object"!=typeof this.channels)throw Error("all channels must be named when using .join()");return new u({channels:{...this.channels,...Object.fromEntries(e.map(e=>[e,e]))},triggers:this.triggers,mapper:this.mapper,writers:this.writers,bound:this.bound,kwargs:this.kwargs,config:this.config,retryPolicy:this.retryPolicy,cachePolicy:this.cachePolicy})}pipe(e){return new u(a.ChannelWrite.isWriter(e)?{channels:this.channels,triggers:this.triggers,mapper:this.mapper,writers:[...this.writers,e],bound:this.bound,config:this.config,kwargs:this.kwargs,retryPolicy:this.retryPolicy,cachePolicy:this.cachePolicy}:this.bound===l?{channels:this.channels,triggers:this.triggers,mapper:this.mapper,writers:this.writers,bound:(0,n._coerceToRunnable)(e),config:this.config,kwargs:this.kwargs,retryPolicy:this.retryPolicy,cachePolicy:this.cachePolicy}:{channels:this.channels,triggers:this.triggers,mapper:this.mapper,writers:this.writers,bound:this.bound.pipe(e),config:this.config,kwargs:this.kwargs,retryPolicy:this.retryPolicy,cachePolicy:this.cachePolicy})}}r.PregelNode=u},6629,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.XXH3=function(e,t=n(0)){let r=new TextEncoder,h=i("string"==typeof e?r.encode(e):e),P=h.byteLength,E=e=>e.toString(16).padStart(32,"0");return E(P<=16?function(e,t){let r=e.byteLength;return(_(r<=16),r>8)?function(e,t,r){let i=e.byteLength;_(i>=9&&i<=16);{let a=(t.getBigUint64(32,!0)^t.getBigUint64(40,!0))+r&y,o=(t.getBigUint64(48,!0)^t.getBigUint64(56,!0))-r&y,c=e.getBigUint64(0,!0),d=e.getBigUint64(i-8,!0),p=(c^d^a)*l,h=(p&y)+(n(i-1)<<n(54));p=p&(g^y)|h,d^=o,p+=d+(d&b)*(s-n(1))<<n(64),p&=g;let f=((p^=function(e){let t=new DataView(new ArrayBuffer(8));return t.setBigUint64(0,e,!0),t.getBigUint64(0,!1)}(p>>n(64)))&y)*u;return f+=(p>>n(64))*u<<n(64),A((f&=g)&y)|A(f>>n(64))<<n(64)}}(e,m,t):r>=4?function(e,t,r){let i=e.byteLength;_(i>=4&&i<=8);{var a,s;let o=e.getUint32(0,!0),u=e.getUint32(i-4,!0),c=n(o)|n(u)<<n(32),d=(c^(t.getBigUint64(16,!0)^t.getBigUint64(24,!0))+r&y)*(l+(n(i)<<n(2)))&g;return d+=(d&y)<<n(65),d&=g,d^=d>>n(67),(s=((a=d&y)^a>>n(35))*f&y)^s>>n(28)|A(d>>n(64))<<n(64)}}(e,m,t):r>0?function(e,t,r){var i,a;let s,o=e.byteLength;_(o>0&&o<=3);let l=n(e.getUint8(o-1))|n(o<<8)|n(e.getUint8(0)<<16)|n(e.getUint8(o>>1)<<24),u=(l^(n(t.getUint32(0,!0))^n(t.getUint32(4,!0)))+r)&y,c=(n(t.getUint32(8,!0))^n(t.getUint32(12,!0)))-r;return(T((((i=s=((s=((s=l)&n(65535))<<n(16)|(s&n(0xffff0000))>>n(16))&n(0xff00ff))<<n(8)|(s&n(0xff00ff00))>>n(8))<<(a=n(13))|i>>n(32)-a)&b^c)&y)&y)<<n(64)|T(u)}(e,m,t):T(t^m.getBigUint64(64,!0)^m.getBigUint64(72,!0))|T(t^m.getBigUint64(80,!0)^m.getBigUint64(88,!0))<<n(64)}(h,t):P<=128?function(e,t,r){let a=n(e.byteLength)*l&y,s=n(e.byteLength-1)/n(32);for(;s>=0;){let o=Number(s);a=I(a,i(e,16*o),i(e,e.byteLength-16*(o+1)),i(t,32*o),r),s-=n(1)}let o=a+(a>>n(64))&y;o=A(o);let c=(a&y)*l+(a>>n(64))*d+(n(e.byteLength)-r&y)*u;return c&=y,o|(c=C(A(c)))<<n(64)}(h,m,t):P<=240?function(e,t,r){let a=n(e.byteLength)*l&y;for(let n=32;n<160;n+=32)a=I(a,i(e,n-32),i(e,n-16),i(t,n-32),r);a=A(a&y)|A(a>>n(64))<<n(64);for(let n=160;n<=e.byteLength;n+=32)a=I(a,i(e,n-32),i(e,n-16),i(t,3+n-160),r);let s=(a=I(a,i(e,e.byteLength-16),i(e,e.byteLength-32),i(t,103),C(r)))+(a>>n(64))&y;s=A(s);let o=(a&y)*l+(a>>n(64))*d+(n(e.byteLength)-r&y)*u;return o&=y,s|(o=C(A(o)))<<n(64)}(h,m,t):function(e,t){let r=new BigUint64Array([o,l,u,c,d,s,p,a]);_(e.byteLength>128),_(8*(r=function(e,t,r,n,a){let s=e,o=Math.floor((r.byteLength-64)/8),l=64*o,u=Math.floor((t.byteLength-1)/l);for(let e=0;e<u;e+=1)s=a(s=w(s,i(t,e*l),r,o),i(r,r.byteLength-64));{let e=Math.floor((t.byteLength-1-l*u)/64);s=n(s=w(s,i(t,u*l),r,e),i(t,t.byteLength-64),i(r,r.byteLength-64-7))}return s}(r,e,t,v,O)).length==64);{let a=S(r,i(t,11),n(e.byteLength)*l&y);return S(r,i(t,t.byteLength-64-11),~(n(e.byteLength)*u)&y)<<n(64)|a}}(h,m))},r.isXXH3=function(e){return/^[0-9a-f]{32}$/.test(e)};let n=e=>BigInt(e),i=(e,t=0)=>new DataView(e.buffer,e.byteOffset+t,e.byteLength-t),a=n("0x9E3779B1"),s=n("0x85EBCA77"),o=n("0xC2B2AE3D"),l=n("0x9E3779B185EBCA87"),u=n("0xC2B2AE3D27D4EB4F"),c=n("0x165667B19E3779F9"),d=n("0x85EBCA77C2B2AE63"),p=n("0x27D4EB2F165667C5"),h=n("0x165667919E3779F9"),f=n("0x9FB21C651E98DF25"),m=(e=>{let t=e.length;if(t%2!=0)throw Error("String should have an even number of characters");let r=t/2,n=new Uint8Array(r),a=0,s=0;for(;s<r;){let t=e.slice(a,a+=2);n[s]=Number.parseInt(t,16),s+=1}return i(n)})("b8fe6c3923a44bbe7c01812cf721ad1cded46de9839097db7240a4a4b7b3671fcb79e64eccc0e578825ad07dccff7221b8084674f743248ee03590e6813a264c3c2852bb91c300cb88d0658b1b532ea371644897a20df94e3819ef46a9deacd8a8fa763fe39c343ff9dcbbc7c70b4f1d8a51e04bcdb45931c89f7ec9d9787364eac5ac8334d3ebc3c581a0fffa1363eb170ddd51b7f0da49d316552629d4689e2b16be587d47a1fc8ff8b8d17ad031ce45cb3a8f95160428afd7fbcabb4b407e"),g=(n(1)<<n(128))-n(1),y=(n(1)<<n(64))-n(1),b=(n(1)<<n(32))-n(1);function _(e){if(!e)throw Error("Assert failed")}function v(e,t,r){for(let i=0;i<8;i+=1){let a=t.getBigUint64(8*i,!0),s=a^r.getBigUint64(8*i,!0);e[1^i]+=a,e[i]+=(s&b)*(s>>n(32)&b)&y}return e}function w(e,t,r,n){for(let a=0;a<n;a+=1)v(e,i(t,64*a),i(r,8*a));return e}function O(e,t){for(let i=0;i<8;i+=1){var r;let s=t.getBigUint64(8*i,!0),o=e[i];o=((r=o)^r>>n(47)^s)*a,e[i]=o&y}return e}function P(e,t){return E(e[0]^t.getBigUint64(0,!0),e[1]^t.getBigUint64(8,!0))}function S(e,t,r){let n=r;return n+=P(e.slice(0),i(t,0)),n+=P(e.slice(2),i(t,16)),n+=P(e.slice(4),i(t,32)),A((n+=P(e.slice(6),i(t,48)))&y)}function E(e,t){let r=e*t&g;return r&y^r>>n(64)}function k(e,t,r){return E((e.getBigUint64(0,!0)^t.getBigUint64(0,!0)+r)&y,(e.getBigUint64(8,!0)^t.getBigUint64(8,!0)-r)&y)}function I(e,t,r,a,s){let o=e&y,l=e>>n(64)&y;return o+=k(t,a,s),o^=r.getBigUint64(0,!0)+r.getBigUint64(8,!0),o&=y,l+=k(r,i(a,16),s),l^=t.getBigUint64(0,!0)+t.getBigUint64(8,!0),(l&=y)<<n(64)|o}function A(e){let t=e;return t^=t>>n(37),t*=h,t&=y,t^=t>>n(32)}function T(e){let t=e;return t^=t>>n(33),t*=u,t&=y,t^=t>>n(29),t*=c,t&=y,t^=t>>n(32)}function C(e){return~e+n(1)&y}},75627,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.readChannel=s,r.readChannels=o,r.mapCommand=function*(e,t){if(e.graph===n.Command.PARENT)throw new i.InvalidUpdateError("There is no parent graph.");if(e.goto){for(let t of Array.isArray(e.goto)?e.goto:[e.goto])if((0,n._isSend)(t))yield[n.NULL_TASK_ID,n.TASKS,t];else if("string"==typeof t)yield[n.NULL_TASK_ID,`branch:to:${t}`,"__start__"];else throw Error(`In Command.send, expected Send or string, got ${typeof t}`)}if(e.resume)if("object"==typeof e.resume&&Object.keys(e.resume).length&&Object.keys(e.resume).every(a.isXXH3))for(let[r,i]of Object.entries(e.resume)){let e=t.filter(e=>e[0]===r&&e[1]===n.RESUME).map(e=>e[2]).slice(0,1)??[];e.push(i),yield[r,n.RESUME,e]}else yield[n.NULL_TASK_ID,n.RESUME,e.resume];if(e.update){if("object"!=typeof e.update||!e.update)throw Error("Expected cmd.update to be a dict mapping channel names to update values");if(Array.isArray(e.update))for(let[t,r]of e.update)yield[n.NULL_TASK_ID,t,r];else for(let[t,r]of Object.entries(e.update))yield[n.NULL_TASK_ID,t,r]}},r.mapInput=function*(e,t){if(null!=t)if(Array.isArray(e)&&"object"==typeof t&&!Array.isArray(t))for(let r in t)e.includes(r)&&(yield[r,t[r]]);else if(Array.isArray(e))throw Error('Input chunk must be an object when "inputChannels" is an array');else yield[e,t]},r.mapOutputValues=function*(e,t,r){Array.isArray(e)?(!0===t||t.find(([t,r])=>e.includes(t)))&&(yield o(r,e)):(!0===t||t.some(([t,r])=>t===e))&&(yield s(r,e))},r.mapOutputUpdates=function*(e,t,r){let i,a=t.filter(([e,t])=>(void 0===e.config||!e.config.tags?.includes(n.TAG_HIDDEN))&&t[0][0]!==n.ERROR&&t[0][0]!==n.INTERRUPT);if(!a.length)return;i=a.some(([e])=>e.writes.some(([e,t])=>e===n.RETURN))?a.flatMap(([e])=>e.writes.filter(([e,t])=>e===n.RETURN).map(([t,r])=>[e.name,r])):Array.isArray(e)?a.flatMap(([t])=>{let{writes:r}=t,n={};for(let[t]of r)e.includes(t)&&(n[t]=(n[t]||0)+1);return Object.values(n).some(e=>e>1)?r.filter(([t])=>e.includes(t)).map(([e,r])=>[t.name,{[e]:r}]):[[t.name,Object.fromEntries(r.filter(([t])=>e.includes(t)))]]}):a.flatMap(([t])=>t.writes.filter(([t,r])=>t===e).map(([e,r])=>[t.name,r]));let s={};for(let[e,t]of i)e in s||(s[e]=[]),s[e].push(t);let o={};for(let e in s)if(1===s[e].length){let[t]=s[e];o[e]=t}else o[e]=s[e];r&&(o.__metadata__={cached:r}),yield o},r.single=function(e){for(let t of e)return t;return null};let n=e.r(45864),i=e.r(83134),a=e.r(6629);function s(e,t,r=!0,n=!1){try{return e[t].get()}catch(e){if(e.name===i.EmptyChannelError.unminifiable_name){if(n)return e;else if(r)return null}throw e}}function o(e,t,r=!0){if(!Array.isArray(t))return s(e,t);{let n={};for(let a of t)try{n[a]=s(e,a,!r)}catch(e){if(e.name===i.EmptyChannelError.unminifiable_name)continue}return n}}},34323,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Call=void 0,r.isCall=function(e){return"object"==typeof e&&null!==e&&"__lg_type"in e&&"call"===e.__lg_type},r.Call=class{constructor({func:e,name:t,input:r,retry:n,cache:i,callbacks:a}){Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"input",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"retry",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__lg_type",{enumerable:!0,configurable:!0,writable:!0,value:"call"}),this.func=e,this.name=t,this.input=r,this.retry=n,this.cache=i,this.callbacks=a}}},79427,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.combineCallbacks=void 0,r.getNullChannelVersion=i,r.getNewChannelVersions=function(e,t){if(!(Object.keys(e).length>0))return t;{let r=i(t);return Object.fromEntries(Object.entries(t).filter(([t,n])=>n>(e[t]??r)))}},r._coerceToDict=function(e,t){return!e||Array.isArray(e)||e instanceof Date||"object"!=typeof e?{[t]:e}:e},r.patchConfigurable=a,r.patchCheckpointMap=function(e,t){let r=t?.parents??{};return Object.keys(r).length>0?a(e,{[n.CONFIG_KEY_CHECKPOINT_MAP]:{...r,[e.configurable?.checkpoint_ns??""]:e.configurable?.checkpoint_id}}):e},r.combineAbortSignals=function(...e){let t=[...new Set(e.filter(Boolean))];if(0===t.length)return{signal:void 0,dispose:void 0};if(1===t.length)return{signal:t[0],dispose:void 0};let r=new AbortController,n=()=>{let e=t.find(e=>e.aborted)?.reason;r.abort(e),t.forEach(e=>e.removeEventListener("abort",n))};t.forEach(e=>e.addEventListener("abort",n,{once:!0}));let i=t.find(e=>e.aborted);return i&&r.abort(i.reason),{signal:r.signal,dispose:()=>{t.forEach(e=>e.removeEventListener("abort",n))}}};let n=e.r(45864);function i(e){let t=typeof e[n.START];if("number"===t)return 0;if("string"===t)return"";for(let t in e){if(!Object.prototype.hasOwnProperty.call(e,t))continue;let r=typeof e[t];if("number"===r)return 0;if("string"===r)return"";break}}function a(e,t){return null===e?{configurable:t}:e?.configurable===void 0?{...e,configurable:t}:{...e,configurable:{...e.configurable,...t}}}r.combineCallbacks=(e,t)=>{if(e||t)return e?t?Array.isArray(e)&&Array.isArray(t)?[...e,...t]:Array.isArray(e)?[...e,t]:Array.isArray(t)?[e,...t]:[e,t]:e:t}},46177,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getRunnableForFunc=function(e,t){let r=new o.RunnableCallable({func:e=>t(...e),name:e,trace:!1,recurse:!1});return new n.RunnableSequence({name:e,first:r,last:new s.ChannelWrite([{channel:a.RETURN,value:s.PASSTHROUGH}],[a.TAG_HIDDEN])})},r.getRunnableForEntrypoint=function(e,t){return new o.RunnableCallable({func:(e,r)=>t(e,r),name:e,trace:!1,recurse:!1})},r.call=function({func:e,name:t,cache:r,retry:n},...s){let o=i.AsyncLocalStorageProviderSingleton.getRunnableConfig();if("function"==typeof o.configurable?.[a.CONFIG_KEY_CALL])return o.configurable[a.CONFIG_KEY_CALL](e,t,s,{retry:n,cache:r,callbacks:o.callbacks});throw Error("Async local storage not initialized. Please call initializeAsyncLocalStorageSingleton() before using this function.")};let n=e.r(78541),i=e.r(92595),a=e.r(45864),s=e.r(33514),o=e.r(93053)},12756,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.increment=void 0,r.shouldInterrupt=function(e,t,r){let n=(0,c.getNullChannelVersion)(e.channel_versions),i=e.versions_seen[o.INTERRUPT]??{},a=!1;for(let t in e.channel_versions)if(Object.prototype.hasOwnProperty.call(e.channel_versions,t)&&e.channel_versions[t]>(i[t]??n)){a=!0;break}let s=r.some(e=>"*"===t?!e.config?.tags?.includes(o.TAG_HIDDEN):t.includes(e.name));return a&&s},r._localRead=f,r._localWrite=m,r._applyWrites=y,r._prepareNextTasks=function(e,t,r,n,i,a,s){let l={},u=n[o.TASKS];if(u?.isAvailable()){let c=u.get().length;for(let u=0;u<c;u+=1){let c=b([o.PUSH,u],e,t,r,n,i,a,s);void 0!==c&&(l[c.id]=c)}}for(let u in r){if(!Object.prototype.hasOwnProperty.call(r,u))continue;let c=b([o.PULL,u],e,t,r,n,i,a,s);void 0!==c&&(l[c.id]=c)}return l},r._prepareSingleTask=b;let n=e.r(78541),i=e.r(77978),a=e.r(99935),s=e.r(75627),o=e.r(45864),l=e.r(34323),u=e.r(83134),c=e.r(79427),d=e.r(46177),p=e.r(6629);function h(e){let t;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t=null==t?e[r]:(0,i.maxChannelVersion)(t,e[r]));return t}function f(e,t,r,n,o=!1){let l,u=new Set;if(Array.isArray(n))u=new Set(n.filter(e=>r.writes.some(([t,r])=>t===e)));else{for(let[e]of r.writes)if(e===n){u=new Set([e]);break}u=u||new Set}if(o&&u.size>0){let o=Object.fromEntries(Object.entries(t).filter(([e,t])=>u.has(e))),c=(0,a.createCheckpoint)(e,o,-1),d=(0,a.emptyChannels)(o,c);y((0,i.copyCheckpoint)(c),d,[r],void 0,void 0),l=(0,s.readChannels)({...t,...d},n)}else l=(0,s.readChannels)(t,n);return l}function m(e,t,r){for(let[e,n]of r)if([o.PUSH,o.TASKS].includes(e)&&null!=n){if(!(0,o._isSend)(n))throw new u.InvalidUpdateError(`Invalid packet type, expected SendProtocol, got ${JSON.stringify(n)}`);if(!(n.node in t))throw new u.InvalidUpdateError(`Invalid node name "${n.node}" in Send packet`)}e(r)}r.increment=e=>void 0!==e?e+1:1;let g=new Set([o.NO_WRITES,o.PUSH,o.RESUME,o.INTERRUPT,o.RETURN,o.ERROR]);function y(e,t,r,n,i){r.sort((e,t)=>{let r=e.path?.slice(0,3)||[],n=t.path?.slice(0,3)||[];for(let e=0;e<Math.min(r.length,n.length);e+=1){if(r[e]<n[e])return -1;if(r[e]>n[e])return 1}return r.length-n.length});let s=r.some(e=>e.triggers.length>0),l=(0,a.getOnlyChannels)(t);for(let t of r)for(let r of(e.versions_seen[t.name]??={},t.triggers))r in e.channel_versions&&(e.versions_seen[t.name][r]=e.channel_versions[r]);let c=h(e.channel_versions);for(let t of new Set(r.flatMap(e=>e.triggers).filter(e=>!o.RESERVED.includes(e))))t in l&&l[t].consume()&&void 0!==n&&(e.channel_versions[t]=n(c));let d={};for(let e of r)for(let[t,r]of e.writes)g.has(t)||t in l&&(d[t]??=[],d[t].push(r));c=h(e.channel_versions);let p=new Set;for(let[t,r]of Object.entries(d))if(t in l){let i,a=l[t];try{i=a.update(r)}catch(e){if(e.name===u.InvalidUpdateError.unminifiable_name){let n=new u.InvalidUpdateError(`Invalid update for channel "${t}" with values ${JSON.stringify(r)}: ${e.message}`);throw n.lc_error_code=e.lc_error_code,n}throw e}i&&void 0!==n&&(e.channel_versions[t]=n(c),a.isAvailable()&&p.add(t))}if(s)for(let t in l){if(!Object.prototype.hasOwnProperty.call(l,t))continue;let r=l[t];r.isAvailable()&&!p.has(t)&&r.update([])&&void 0!==n&&(e.channel_versions[t]=n(c),r.isAvailable()&&p.add(t))}if(s&&!Object.keys(i??{}).some(e=>p.has(e)))for(let t in l){if(!Object.prototype.hasOwnProperty.call(l,t))continue;let r=l[t];r.finish()&&void 0!==n&&(e.channel_versions[t]=n(c),r.isAvailable()&&p.add(t))}}function b(e,t,r,a,h,g,y,b){let{step:v,checkpointer:w,manager:O}=b,P=g.configurable??{},S=P.checkpoint_ns??"";if(e[0]===o.PUSH&&(0,l.isCall)(e[e.length-1])){let s=e[e.length-1],l=(0,d.getRunnableForFunc)(s.name,s.func),u=[o.PUSH],c=""===S?s.name:`${S}${o.CHECKPOINT_NAMESPACE_SEPARATOR}${s.name}`,E=(0,i.uuid5)(JSON.stringify([c,v.toString(),s.name,o.PUSH,e[1],e[2]]),t.id),k=`${c}${o.CHECKPOINT_NAMESPACE_END}${E}`,I=[...e.slice(0,3),!0],A={langgraph_step:v,langgraph_node:s.name,langgraph_triggers:u,langgraph_path:I,langgraph_checkpoint_ns:k};if(!y)return{id:E,name:s.name,interrupts:[],path:I};{let e=[];return{name:s.name,input:s.input,proc:l,writes:e,config:(0,n.patchConfig)((0,n.mergeConfigs)(g,{metadata:A,store:b.store??g.store}),{runName:s.name,callbacks:O?.getChild(`graph:step:${v}`),configurable:{[o.CONFIG_KEY_TASK_ID]:E,[o.CONFIG_KEY_SEND]:t=>m(t=>e.push(...t),a,t),[o.CONFIG_KEY_READ]:(r,n=!1)=>f(t,h,{name:s.name,writes:e,triggers:u,path:I},r,n),[o.CONFIG_KEY_CHECKPOINTER]:w??P[o.CONFIG_KEY_CHECKPOINTER],[o.CONFIG_KEY_CHECKPOINT_MAP]:{...P[o.CONFIG_KEY_CHECKPOINT_MAP],[S]:t.id},[o.CONFIG_KEY_SCRATCHPAD]:_({pendingWrites:r??[],taskId:E,currentTaskInput:s.input,resumeMap:g.configurable?.[o.CONFIG_KEY_RESUME_MAP],namespaceHash:(0,p.XXH3)(k)}),[o.CONFIG_KEY_PREVIOUS_STATE]:t.channel_values[o.PREVIOUS],checkpoint_id:void 0,checkpoint_ns:k}}),triggers:u,retry_policy:s.retry,cache_key:s.cache?{key:(0,p.XXH3)((s.cache.keyFunc??JSON.stringify)([s.input])),ns:[o.CACHE_NS_WRITES,s.name??"__dynamic__"],ttl:s.cache.ttl}:void 0,id:E,path:I,writers:[]}}}if(e[0]===o.PUSH){let s="number"==typeof e[1]?e[1]:parseInt(e[1],10);if(!h[o.TASKS]?.isAvailable())return;let l=h[o.TASKS].get();if(s<0||s>=l.length)return;let u=(0,o._isSendInterface)(l[s])&&!(0,o._isSend)(l[s])?new o.Send(l[s].node,l[s].args):l[s];if(!(0,o._isSendInterface)(u))return void console.warn(`Ignoring invalid packet ${JSON.stringify(u)} in pending sends.`);if(!(u.node in a))return void console.warn(`Ignoring unknown node name ${u.node} in pending sends.`);let c=[o.PUSH],d=""===S?u.node:`${S}${o.CHECKPOINT_NAMESPACE_SEPARATOR}${u.node}`,E=(0,i.uuid5)(JSON.stringify([d,v.toString(),u.node,o.PUSH,s.toString()]),t.id),k=`${d}${o.CHECKPOINT_NAMESPACE_END}${E}`,I={langgraph_step:v,langgraph_node:u.node,langgraph_triggers:c,langgraph_path:e.slice(0,3),langgraph_checkpoint_ns:k};if(!y)return{id:E,name:u.node,interrupts:[],path:e};{let i=a[u.node],s=i.getNode();if(void 0!==s){void 0!==i.metadata&&(I={...I,...i.metadata});let l=[];return{name:u.node,input:u.args,proc:s,subgraphs:i.subgraphs,writes:l,config:(0,n.patchConfig)((0,n.mergeConfigs)(g,{metadata:I,tags:i.tags,store:b.store??g.store}),{runName:u.node,callbacks:O?.getChild(`graph:step:${v}`),configurable:{[o.CONFIG_KEY_TASK_ID]:E,[o.CONFIG_KEY_SEND]:e=>m(e=>l.push(...e),a,e),[o.CONFIG_KEY_READ]:(r,n=!1)=>f(t,h,{name:u.node,writes:l,triggers:c,path:e},r,n),[o.CONFIG_KEY_CHECKPOINTER]:w??P[o.CONFIG_KEY_CHECKPOINTER],[o.CONFIG_KEY_CHECKPOINT_MAP]:{...P[o.CONFIG_KEY_CHECKPOINT_MAP],[S]:t.id},[o.CONFIG_KEY_SCRATCHPAD]:_({pendingWrites:r??[],taskId:E,currentTaskInput:u.args,resumeMap:g.configurable?.[o.CONFIG_KEY_RESUME_MAP],namespaceHash:(0,p.XXH3)(k)}),[o.CONFIG_KEY_PREVIOUS_STATE]:t.channel_values[o.PREVIOUS],checkpoint_id:void 0,checkpoint_ns:k}}),triggers:c,retry_policy:i.retryPolicy,cache_key:i.cachePolicy?{key:(0,p.XXH3)((i.cachePolicy.keyFunc??JSON.stringify)([u.args])),ns:[o.CACHE_NS_WRITES,i.name??"__dynamic__",u.node],ttl:i.cachePolicy.ttl}:void 0,id:E,path:e,writers:i.getWriters()}}}}else if(e[0]===o.PULL){let l=e[1].toString(),d=a[l];if(void 0===d)return;if(r?.length){let e=""===S?l:`${S}${o.CHECKPOINT_NAMESPACE_SEPARATOR}${l}`,n=(0,i.uuid5)(JSON.stringify([e,v.toString(),l,o.PULL,l]),t.id);if(r.some(e=>e[0]===n&&e[1]!==o.ERROR))return}let E=(0,c.getNullChannelVersion)(t.channel_versions);if(void 0===E)return;let k=t.versions_seen[l]??{},I=d.triggers.find(e=>!!h[e].isAvailable()&&(t.channel_versions[e]??E)>(k[e]??E));if(void 0!==I){let c=function(e,t,r){let n;if("object"!=typeof e.channels||Array.isArray(e.channels))if(Array.isArray(e.channels)){let r=!1;for(let i of e.channels)try{n=(0,s.readChannel)(t,i,!1),r=!0;break}catch(e){if(e.name===u.EmptyChannelError.unminifiable_name)continue;throw e}if(!r)return}else throw Error(`Invalid channels type, expected list or dict, got ${e.channels}`);else for(let[r,i]of(n={},Object.entries(e.channels)))if(e.triggers.includes(i))try{n[r]=(0,s.readChannel)(t,i,!1)}catch(e){if(e.name===u.EmptyChannelError.unminifiable_name)return;throw e}else if(i in t)try{n[r]=(0,s.readChannel)(t,i,!1)}catch(e){if(e.name===u.EmptyChannelError.unminifiable_name)continue;throw e}return r&&void 0!==e.mapper&&(n=e.mapper(n)),n}(d,h,y);if(void 0===c)return;let E=""===S?l:`${S}${o.CHECKPOINT_NAMESPACE_SEPARATOR}${l}`,k=(0,i.uuid5)(JSON.stringify([E,v.toString(),l,o.PULL,[I]]),t.id),A=`${E}${o.CHECKPOINT_NAMESPACE_END}${k}`,T={langgraph_step:v,langgraph_node:l,langgraph_triggers:[I],langgraph_path:e,langgraph_checkpoint_ns:A};if(!y)return{id:k,name:l,interrupts:[],path:e};{let i=d.getNode();if(void 0!==i){void 0!==d.metadata&&(T={...T,...d.metadata});let s=[];return{name:l,input:c,proc:i,subgraphs:d.subgraphs,writes:s,config:(0,n.patchConfig)((0,n.mergeConfigs)(g,{metadata:T,tags:d.tags,store:b.store??g.store}),{runName:l,callbacks:O?.getChild(`graph:step:${v}`),configurable:{[o.CONFIG_KEY_TASK_ID]:k,[o.CONFIG_KEY_SEND]:e=>m(e=>{s.push(...e)},a,e),[o.CONFIG_KEY_READ]:(r,n=!1)=>f(t,h,{name:l,writes:s,triggers:[I],path:e},r,n),[o.CONFIG_KEY_CHECKPOINTER]:w??P[o.CONFIG_KEY_CHECKPOINTER],[o.CONFIG_KEY_CHECKPOINT_MAP]:{...P[o.CONFIG_KEY_CHECKPOINT_MAP],[S]:t.id},[o.CONFIG_KEY_SCRATCHPAD]:_({pendingWrites:r??[],taskId:k,currentTaskInput:c,resumeMap:g.configurable?.[o.CONFIG_KEY_RESUME_MAP],namespaceHash:(0,p.XXH3)(A)}),[o.CONFIG_KEY_PREVIOUS_STATE]:t.channel_values[o.PREVIOUS],checkpoint_id:void 0,checkpoint_ns:A}}),triggers:[I],retry_policy:d.retryPolicy,cache_key:d.cachePolicy?{key:(0,p.XXH3)((d.cachePolicy.keyFunc??JSON.stringify)([c])),ns:[o.CACHE_NS_WRITES,d.name??"__dynamic__",l],ttl:d.cachePolicy.ttl}:void 0,id:k,path:e,writers:d.getWriters()}}}}}}function _({pendingWrites:e,taskId:t,currentTaskInput:r,resumeMap:n,namespaceHash:i}){let a=e.find(([e,t])=>e===o.NULL_TASK_ID&&t===o.RESUME)?.[2],s={callCounter:0,interruptCounter:-1,resume:(()=>{let r=e.filter(([e,r])=>e===t&&r===o.RESUME).flatMap(([e,t,r])=>r);if(null!=n&&i in n){let e=n[i];r.push(e)}return r})(),nullResume:a,subgraphCounter:0,currentTaskInput:r,consumeNullResume:()=>{if(s.nullResume)return delete s.nullResume,e.splice(e.findIndex(([e,t])=>e===o.NULL_TASK_ID&&t===o.RESUME),1),a}};return s}},21995,(e,t,r)=>{"use strict";function n(e){return"lg_is_pregel"in e&&!0===e.lg_is_pregel}Object.defineProperty(r,"__esModule",{value:!0}),r.isPregelLike=n,r.findSubgraphPregel=function(e){let t=[e];for(let e of t)if(n(e))return e;else"steps"in e&&Array.isArray(e.steps)&&t.push(...e.steps)}},69558,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.wrap=void 0,r.printCheckpoint=function(e,t){console.log(`${(0,r.wrap)(o.blue,"[langgraph/checkpoint]")}Finishing step ${e}. Channel values:

${JSON.stringify(Object.fromEntries(l(t)),null,2)}`)},r._readChannels=l,r.mapDebugTasks=function*(e){for(let{id:t,name:r,input:i,config:a,triggers:s,writes:o}of e){if(a?.tags?.includes(n.TAG_HIDDEN))continue;let e=o.filter(([e,r])=>e===t&&r===n.INTERRUPT).map(([,e])=>e);yield{id:t,name:r,input:i,triggers:s,interrupts:e}}},r.mapDebugTaskResults=function*(e,t){for(let[{id:r,name:i,config:a},s]of e)a?.tags?.includes(n.TAG_HIDDEN)||(yield{id:r,name:i,result:u(s.filter(([e])=>Array.isArray(t)?t.includes(e):e===t)),interrupts:s.filter(e=>e[0]===n.INTERRUPT).map(e=>e[1])})},r.mapDebugCheckpoint=function*(e,t,r,n,i,o,l,u){function d(e){let t={};return null!=e.callbacks&&(t.callbacks=e.callbacks),null!=e.configurable&&(t.configurable=e.configurable),null!=e.maxConcurrency&&(t.max_concurrency=e.maxConcurrency),null!=e.metadata&&(t.metadata=e.metadata),null!=e.recursionLimit&&(t.recursion_limit=e.recursionLimit),null!=e.runId&&(t.run_id=e.runId),null!=e.runName&&(t.run_name=e.runName),null!=e.tags&&(t.tags=e.tags),t}let p=e.configurable?.checkpoint_ns,h={};for(let t of i){if(!(t.subgraphs?.length?t.subgraphs:[t.proc]).find(s.findSubgraphPregel))continue;let r=`${t.name}:${t.id}`;p&&(r=`${p}|${r}`),h[t.id]={configurable:{thread_id:e.configurable?.thread_id,checkpoint_ns:r}}}yield{config:d(e),values:(0,a.readChannels)(t,r),metadata:n,next:i.map(e=>e.name),tasks:c(i,o,h,u),parentConfig:l?d(l):void 0}},r.tasksWithWrites=c,r.printStepCheckpoint=function(e,t,n){console.log([`${(0,r.wrap)(o.blue,`[${e}:checkpoint]`)}`,`\x1b[1m State at the end of step ${e}:\x1b[0m
`,JSON.stringify((0,a.readChannels)(t,n),null,2)].join(""))},r.printStepTasks=function(e,t){let n=t.length;console.log([`${(0,r.wrap)(o.blue,`[${e}:tasks]`)}`,`\x1b[1m Starting step ${e} with ${n} task${1===n?"":"s"}:\x1b[0m
`,t.map(e=>`- ${(0,r.wrap)(o.green,String(e.name))} -> ${JSON.stringify(e.input,null,2)}`).join("\n")].join(""))},r.printStepWrites=function(e,t,n){let i={};for(let[e,r]of t)n.includes(e)&&(i[e]||(i[e]=[]),i[e].push(r));console.log([`${(0,r.wrap)(o.blue,`[${e}:writes]`)}`,`\x1b[1m Finished step ${e} with writes to ${Object.keys(i).length} channel${1!==Object.keys(i).length?"s":""}:\x1b[0m
`,Object.entries(i).map(([e,t])=>`- ${(0,r.wrap)(o.yellow,e)} -> ${t.map(e=>JSON.stringify(e)).join(", ")}`).join("\n")].join(""))};let n=e.r(45864),i=e.r(83134),a=e.r(75627),s=e.r(21995),o={blue:{start:"\x1b[34m",end:"\x1b[0m"},green:{start:"\x1b[32m",end:"\x1b[0m"},yellow:{start:"\x1b[33;1m",end:"\x1b[0m"}};function*l(e){for(let[t,r]of Object.entries(e))try{yield[t,r.get()]}catch(e){if(e.name===i.EmptyChannelError.unminifiable_name)continue;throw e}}function u(e){let t={};for(let[n,i]of e){let e=String(n);if(e in t){var r;let n="object"==typeof(r=t[e])&&null!==r&&"$writes"in r&&Array.isArray(r.$writes)?t[e].$writes:[t[e]];n.push(i),t[e]={$writes:n}}else t[e]=i}return t}function c(e,t,r,i){return e.map(e=>{let a=t.find(([t,r])=>t===e.id&&r===n.ERROR)?.[2],s=t.filter(([t,r])=>t===e.id&&r===n.INTERRUPT).map(([,,e])=>e),o=(()=>{if(a||s.length||!t.length)return;let r=t.findIndex(([t,r])=>t===e.id&&r===n.RETURN);if(r>=0)return t[r][2];if("string"==typeof i)return t.find(([t,r])=>t===e.id&&r===i)?.[2];if(Array.isArray(i)){let r=t.filter(([t,r])=>t===e.id&&i.includes(r)).map(([,e,t])=>[e,t]);if(!r.length)return;return u(r)}})();if(a)return{id:e.id,name:e.name,path:e.path,error:a,interrupts:s,result:o};let l=r?.[e.id];return{id:e.id,name:e.name,path:e.path,interrupts:s,...void 0!==l?{state:l}:{},result:o}})}r.wrap=(e,t)=>`${e.start}${t}${e.end}`},65283,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IterableReadableWritableStream=r.IterableReadableStreamWithAbortSignal=void 0;let n=e.r(99078);class i extends n.IterableReadableStream{constructor(e,t){let r=e.getReader(),n=t??new AbortController;super({start:e=>(function t(){return r.read().then(({done:r,value:n})=>r?void e.close():(e.enqueue(n),t()))})()}),Object.defineProperty(this,"_abortController",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_innerReader",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._abortController=n,this._innerReader=r}async cancel(e){this._abortController.abort(e),this._innerReader.releaseLock()}get signal(){return this._abortController.signal}}r.IterableReadableStreamWithAbortSignal=i;class a extends n.IterableReadableStream{get closed(){return this._closed}constructor(e){let t,r=new Promise(e=>{t=e});super({start:e=>{t(e)}}),Object.defineProperty(this,"modes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"controller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"passthroughFn",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_closed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),r.then(e=>{this.controller=e}),this.passthroughFn=e.passthroughFn,this.modes=e.modes}push(e){this.passthroughFn?.(e),this.controller.enqueue(e)}close(){try{this.controller.close()}catch(e){}finally{this._closed=!0}}error(e){this.controller.error(e)}}r.IterableReadableWritableStream=a},274,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PregelLoop=void 0;let n=e.r(77978),i=e.r(99935),a=e.r(45864),s=e.r(12756),o=e.r(93053),l=e.r(75627),u=e.r(83134),c=e.r(79427),d=e.r(69558),p=e.r(65283),h=e.r(6629),f=Symbol.for("INPUT_DONE"),m=Symbol.for("INPUT_RESUMING");class g extends n.BaseCache{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:Promise.resolve()}),this.cache=e}async get(e){return this.enqueueOperation("get",e)}async set(e){return this.enqueueOperation("set",e)}async clear(e){return this.enqueueOperation("clear",e)}async stop(){await this.queue}enqueueOperation(e,...t){let r=this.queue.then(()=>this.cache[e](...t));return this.queue=r.then(()=>void 0,()=>void 0),r}}class y{get isResuming(){let e=!1;if(a.START in this.checkpoint.channel_versions)e=!0;else for(let t in this.checkpoint.channel_versions)if(Object.prototype.hasOwnProperty.call(this.checkpoint.channel_versions,t)){e=!0;break}let t=this.config.configurable?.[a.CONFIG_KEY_RESUMING]!==void 0&&this.config.configurable?.[a.CONFIG_KEY_RESUMING],r=null===this.input||void 0===this.input,n=(0,a.isCommand)(this.input)&&null!=this.input.resume,i=this.input===m,s=!this.isNested&&this.config.metadata?.run_id!==void 0&&this.checkpointMetadata?.run_id!==void 0&&this.config.metadata.run_id===this.checkpointMetadata?.run_id;return e&&(t||r||n||i||s)}constructor(e){Object.defineProperty(this,"input",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkpointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkpointerGetNextVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"channels",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkpointIdSaved",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkpointConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkpointMetadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkpointNamespace",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkpointPendingWrites",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"checkpointPreviousVersions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"step",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"durability",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKeys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamKeys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"skipDoneTasks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"prevCheckpointConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:"pending"}),Object.defineProperty(this,"tasks",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"stream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkpointerPromises",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"isNested",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_checkpointerChainedPromise",{enumerable:!0,configurable:!0,writable:!0,value:Promise.resolve()}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interruptAfter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interruptBefore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"toInterrupt",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"triggerToNodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.input=e.input,this.checkpointer=e.checkpointer,void 0!==this.checkpointer?this.checkpointerGetNextVersion=this.checkpointer.getNextVersion.bind(this.checkpointer):this.checkpointerGetNextVersion=s.increment,this.checkpoint=e.checkpoint,this.checkpointMetadata=e.checkpointMetadata,this.checkpointPreviousVersions=e.checkpointPreviousVersions,this.channels=e.channels,this.checkpointPendingWrites=e.checkpointPendingWrites,this.step=e.step,this.stop=e.stop,this.config=e.config,this.checkpointConfig=e.checkpointConfig,this.isNested=e.isNested,this.manager=e.manager,this.outputKeys=e.outputKeys,this.streamKeys=e.streamKeys,this.nodes=e.nodes,this.skipDoneTasks=e.skipDoneTasks,this.store=e.store,this.cache=e.cache?new g(e.cache):void 0,this.stream=e.stream,this.checkpointNamespace=e.checkpointNamespace,this.prevCheckpointConfig=e.prevCheckpointConfig,this.interruptAfter=e.interruptAfter,this.interruptBefore=e.interruptBefore,this.durability=e.durability,this.debug=e.debug,this.triggerToNodes=e.triggerToNodes}static async initialize(e){let{config:t,stream:r}=e;void 0!==r&&t.configurable?.[a.CONFIG_KEY_STREAM]!==void 0&&(r=function(...e){return new p.IterableReadableWritableStream({passthroughFn:t=>{for(let r of e)r.modes.has(t[1])&&r.push(t)},modes:new Set(e.flatMap(e=>Array.from(e.modes)))})}(r,t.configurable[a.CONFIG_KEY_STREAM]));let s=!t.configurable||!("checkpoint_id"in t.configurable),o=t.configurable?.[a.CONFIG_KEY_SCRATCHPAD];t.configurable&&o&&(o.subgraphCounter>0&&(t=(0,c.patchConfigurable)(t,{[a.CONFIG_KEY_CHECKPOINT_NS]:[t.configurable[a.CONFIG_KEY_CHECKPOINT_NS],o.subgraphCounter.toString()].join(a.CHECKPOINT_NAMESPACE_SEPARATOR)})),o.subgraphCounter+=1);let l=a.CONFIG_KEY_READ in(t.configurable??{});l||t.configurable?.checkpoint_ns===void 0||t.configurable?.checkpoint_ns===""||(t=(0,c.patchConfigurable)(t,{checkpoint_ns:"",checkpoint_id:void 0}));let u=t;t.configurable?.[a.CONFIG_KEY_CHECKPOINT_MAP]!==void 0&&t.configurable?.[a.CONFIG_KEY_CHECKPOINT_MAP]?.[t.configurable?.checkpoint_ns]&&(u=(0,c.patchConfigurable)(t,{checkpoint_id:t.configurable[a.CONFIG_KEY_CHECKPOINT_MAP][t.configurable?.checkpoint_ns]}));let d=t.configurable?.checkpoint_ns?.split(a.CHECKPOINT_NAMESPACE_SEPARATOR)??[],h=await e.checkpointer?.getTuple(u)??{config:t,checkpoint:(0,n.emptyCheckpoint)(),metadata:{source:"input",step:-2,parents:{}},pendingWrites:[]};u={...t,...h.config,configurable:{checkpoint_ns:"",...t.configurable,...h.config.configurable}};let f=h.parentConfig,m=(0,n.copyCheckpoint)(h.checkpoint),g={...h.metadata},b=h.pendingWrites??[],_=(0,i.emptyChannels)(e.channelSpecs,m),v=(g.step??0)+1,w=v+(t.recursionLimit??25)+1,O={...m.channel_versions},P=e.store?new n.AsyncBatchedStore(e.store):void 0;return P&&await P.start(),new y({input:e.input,config:t,checkpointer:e.checkpointer,checkpoint:m,checkpointMetadata:g,checkpointConfig:u,prevCheckpointConfig:f,checkpointNamespace:d,channels:_,isNested:l,manager:e.manager,skipDoneTasks:s,step:v,stop:w,checkpointPreviousVersions:O,checkpointPendingWrites:b,outputKeys:e.outputKeys??[],streamKeys:e.streamKeys??[],nodes:e.nodes,stream:r,store:P,cache:e.cache,interruptAfter:e.interruptAfter,interruptBefore:e.interruptBefore,durability:e.durability,debug:e.debug,triggerToNodes:e.triggerToNodes})}_checkpointerPutAfterPrevious(e){this._checkpointerChainedPromise=this._checkpointerChainedPromise.then(()=>this.checkpointer?.put(e.config,e.checkpoint,e.metadata,e.newVersions)),this.checkpointerPromises.push(this._checkpointerChainedPromise)}putWrites(e,t){let r=t;if(0===r.length)return;for(let[t,i]of(r.every(([e])=>e in n.WRITES_IDX_MAP)&&(r=Array.from(new Map(r.map(e=>[e[0],e])).values())),this.checkpointPendingWrites=this.checkpointPendingWrites.filter(t=>t[0]!==e),r))this.checkpointPendingWrites.push([e,t,i]);let i=(0,c.patchConfigurable)(this.checkpointConfig,{[a.CONFIG_KEY_CHECKPOINT_NS]:this.config.configurable?.checkpoint_ns??"",[a.CONFIG_KEY_CHECKPOINT_ID]:this.checkpoint.id});if("exit"!==this.durability&&null!=this.checkpointer&&this.checkpointerPromises.push(this.checkpointer.putWrites(i,r,e)),this.tasks&&this._outputWrites(e,r),!t.length||!this.cache||!this.tasks)return;let s=this.tasks[e];null!=s&&null!=s.cache_key&&t[0][0]!==a.ERROR&&t[0][0]!==a.INTERRUPT&&this.cache.set([{key:[s.cache_key.ns,s.cache_key.key],value:s.writes,ttl:s.cache_key.ttl}])}_outputWrites(e,t,r=!1){let n=this.tasks[e];if(void 0!==n){if(void 0!==n.config&&(n.config.tags??[]).includes(a.TAG_HIDDEN))return;if(t.length>0)if(t[0][0]===a.INTERRUPT){if(n.path?.[0]===a.PUSH&&n.path?.at(-1)===!0)return;let e=t.filter(e=>e[0]===a.INTERRUPT).flatMap(e=>e[1]);this._emit([["updates",{[a.INTERRUPT]:e}],["values",{[a.INTERRUPT]:e}]])}else t[0][0]!==a.ERROR&&this._emit((0,o.gatherIteratorSync)((0,o.prefixGenerator)((0,l.mapOutputUpdates)(this.outputKeys,[[n,t]],r),"updates")));r||this._emit((0,o.gatherIteratorSync)((0,o.prefixGenerator)((0,d.mapDebugTaskResults)([[n,t]],this.streamKeys),"tasks")))}}async _matchCachedWrites(){if(!this.cache)return[];let e=[],t=([e,t])=>`ns:${e.join(",")}|key:${t}`,r=[],n={};for(let e of Object.values(this.tasks))null==e.cache_key||e.writes.length||(r.push([e.cache_key.ns,e.cache_key.key]),n[t([e.cache_key.ns,e.cache_key.key])]=e);if(0===r.length)return[];for(let{key:i,value:a}of(await this.cache.get(r))){let r=n[t(i)];null!=r&&(r.writes.push(...a),e.push({task:r,result:a}))}return e}async tick(e){this.store&&!this.store.isRunning&&await this.store?.start();let{inputKeys:t=[]}=e;if("pending"!==this.status)throw Error(`Cannot tick when status is no longer "pending". Current status: "${this.status}"`);if([f,m].includes(this.input))if(this.toInterrupt.length>0)throw this.status="interrupt_before",new u.GraphInterrupt;else{if(!Object.values(this.tasks).every(e=>e.writes.length>0))return!1;let e=Object.values(this.tasks).flatMap(e=>e.writes);(0,s._applyWrites)(this.checkpoint,this.channels,Object.values(this.tasks),this.checkpointerGetNextVersion,this.triggerToNodes);let t=await (0,o.gatherIterator)((0,o.prefixGenerator)((0,l.mapOutputValues)(this.outputKeys,e,this.channels),"values"));if(this._emit(t),this.checkpointPendingWrites=[],await this._putCheckpoint({source:"loop"}),(0,s.shouldInterrupt)(this.checkpoint,this.interruptAfter,Object.values(this.tasks)))throw this.status="interrupt_after",new u.GraphInterrupt;this.config.configurable?.[a.CONFIG_KEY_RESUMING]!==void 0&&delete this.config.configurable?.[a.CONFIG_KEY_RESUMING]}else await this._first(t);if(this.step>this.stop)return this.status="out_of_steps",!1;let r=(0,s._prepareNextTasks)(this.checkpoint,this.checkpointPendingWrites,this.nodes,this.channels,this.config,!0,{step:this.step,checkpointer:this.checkpointer,isResuming:this.isResuming,manager:this.manager,store:this.store,stream:this.stream});if(this.tasks=r,this.checkpointer&&this._emit(await (0,o.gatherIterator)((0,o.prefixGenerator)((0,d.mapDebugCheckpoint)(this.checkpointConfig,this.channels,this.streamKeys,this.checkpointMetadata,Object.values(this.tasks),this.checkpointPendingWrites,this.prevCheckpointConfig,this.outputKeys),"checkpoints"))),0===Object.values(this.tasks).length)return this.status="done",!1;if(this.skipDoneTasks&&this.checkpointPendingWrites.length>0){for(let[e,t,r]of this.checkpointPendingWrites){if(t===a.ERROR||t===a.INTERRUPT||t===a.RESUME)continue;let n=Object.values(this.tasks).find(t=>t.id===e);n&&n.writes.push([t,r])}for(let e of Object.values(this.tasks))e.writes.length>0&&this._outputWrites(e.id,e.writes,!0)}if(Object.values(this.tasks).every(e=>e.writes.length>0))return this.tick({inputKeys:t});if((0,s.shouldInterrupt)(this.checkpoint,this.interruptBefore,Object.values(this.tasks)))throw this.status="interrupt_before",new u.GraphInterrupt;let n=await (0,o.gatherIterator)((0,o.prefixGenerator)((0,d.mapDebugTasks)(Object.values(this.tasks)),"tasks"));return this._emit(n),!0}async finishAndHandleError(e){"exit"===this.durability&&(!this.isNested||void 0!==e||this.checkpointNamespace.every(e=>!e.includes(a.CHECKPOINT_NAMESPACE_END)))&&(this._putCheckpoint(this.checkpointMetadata),this._flushPendingWrites());let t=this._suppressInterrupt(e);return(t||void 0===e)&&(this.output=(0,l.readChannels)(this.channels,this.outputKeys)),t&&(void 0!==this.tasks&&this.checkpointPendingWrites.length>0&&Object.values(this.tasks).some(e=>e.writes.length>0)&&((0,s._applyWrites)(this.checkpoint,this.channels,Object.values(this.tasks),this.checkpointerGetNextVersion,this.triggerToNodes),this._emit((0,o.gatherIteratorSync)((0,o.prefixGenerator)((0,l.mapOutputValues)(this.outputKeys,Object.values(this.tasks).flatMap(e=>e.writes),this.channels),"values")))),(0,u.isGraphInterrupt)(e)&&!e.interrupts.length&&this._emit([["updates",{[a.INTERRUPT]:[]}],["values",{[a.INTERRUPT]:[]}]])),t}async acceptPush(e,t,r){if(this.interruptAfter?.length>0&&(0,s.shouldInterrupt)(this.checkpoint,this.interruptAfter,[e]))return void this.toInterrupt.push(e);let n=(0,s._prepareSingleTask)([a.PUSH,e.path??[],t,e.id,r],this.checkpoint,this.checkpointPendingWrites,this.nodes,this.channels,e.config??{},!0,{step:this.step,checkpointer:this.checkpointer,manager:this.manager,store:this.store,stream:this.stream});if(n){if(this.interruptBefore?.length>0&&(0,s.shouldInterrupt)(this.checkpoint,this.interruptBefore,[n]))return void this.toInterrupt.push(n);for(let{task:e}of(this._emit((0,o.gatherIteratorSync)((0,o.prefixGenerator)((0,d.mapDebugTasks)([n]),"tasks"))),this.debug&&(0,d.printStepTasks)(this.step,[n]),this.tasks[n.id]=n,this.skipDoneTasks&&this._matchWrites({[n.id]:n}),await this._matchCachedWrites()))this._outputWrites(e.id,e.writes,!0);return n}}_suppressInterrupt(e){return(0,u.isGraphInterrupt)(e)&&!this.isNested}async _first(e){let{configurable:t}=this.config,r=t?.[a.CONFIG_KEY_SCRATCHPAD];if(r&&void 0!==r.nullResume&&this.putWrites(a.NULL_TASK_ID,[[a.RESUME,r.nullResume]]),(0,a.isCommand)(this.input)){let e=null!=this.input.resume;if(null!=this.input.resume&&"object"==typeof this.input.resume&&Object.keys(this.input.resume).every(h.isXXH3)&&(this.config.configurable??={},this.config.configurable[a.CONFIG_KEY_RESUME_MAP]=this.input.resume),e&&null==this.checkpointer)throw Error("Cannot use Command(resume=...) without checkpointer");let t={};for(let[e,r,n]of(0,l.mapCommand)(this.input,this.checkpointPendingWrites))t[e]??=[],t[e].push([r,n]);if(0===Object.keys(t).length)throw new u.EmptyInputError("Received empty Command input");for(let[e,r]of Object.entries(t))this.putWrites(e,r)}let n=(this.checkpointPendingWrites??[]).filter(e=>e[0]===a.NULL_TASK_ID).map(e=>e.slice(1));n.length>0&&(0,s._applyWrites)(this.checkpoint,this.channels,[{name:a.INPUT,writes:n,triggers:[]}],this.checkpointerGetNextVersion,this.triggerToNodes);let i=(0,a.isCommand)(this.input)&&n.length>0;if(this.isResuming||i){for(let e in this.channels)if(Object.prototype.hasOwnProperty.call(this.channels,e)&&void 0!==this.checkpoint.channel_versions[e]){let t=this.checkpoint.channel_versions[e];this.checkpoint.versions_seen[a.INTERRUPT]={...this.checkpoint.versions_seen[a.INTERRUPT],[e]:t}}let e=await (0,o.gatherIterator)((0,o.prefixGenerator)((0,l.mapOutputValues)(this.outputKeys,!0,this.channels),"values"));this._emit(e)}if(this.isResuming)this.input=m;else if(i)await this._putCheckpoint({source:"input"}),this.input=f;else{let t=await (0,o.gatherIterator)((0,l.mapInput)(e,this.input));if(t.length>0){let e=(0,s._prepareNextTasks)(this.checkpoint,this.checkpointPendingWrites,this.nodes,this.channels,this.config,!0,{step:this.step});(0,s._applyWrites)(this.checkpoint,this.channels,Object.values(e).concat([{name:a.INPUT,writes:t,triggers:[]}]),this.checkpointerGetNextVersion,this.triggerToNodes),await this._putCheckpoint({source:"input"}),this.input=f}else if(a.CONFIG_KEY_RESUMING in(this.config.configurable??{}))this.input=f;else throw new u.EmptyInputError(`Received no input writes for ${JSON.stringify(e,null,2)}`)}this.isNested||(this.config=(0,c.patchConfigurable)(this.config,{[a.CONFIG_KEY_RESUMING]:this.isResuming}))}_emit(e){for(let[t,r]of e)if(this.stream.modes.has(t)&&this.stream.push([this.checkpointNamespace,t,r]),("checkpoints"===t||"tasks"===t)&&this.stream.modes.has("debug")){let e="checkpoints"===t?this.step-1:this.step,n=new Date().toISOString(),i="checkpoints"===t?"checkpoint":"object"==typeof r&&null!=r&&"result"in r?"task_result":"task";this.stream.push([this.checkpointNamespace,"debug",{step:e,type:i,timestamp:n,payload:r}])}}_putCheckpoint(e){let t=this.checkpointMetadata===e,r=null!=this.checkpointer&&("exit"!==this.durability||t),s=e=>{this.prevCheckpointConfig=this.checkpointConfig?.configurable?.checkpoint_id?this.checkpointConfig:void 0,this.checkpointConfig=(0,c.patchConfigurable)(this.checkpointConfig,{[a.CONFIG_KEY_CHECKPOINT_NS]:this.config.configurable?.checkpoint_ns??""});let t={...this.checkpoint.channel_versions},r=(0,c.getNewChannelVersions)(this.checkpointPreviousVersions,t);this.checkpointPreviousVersions=t,this._checkpointerPutAfterPrevious({config:{...this.checkpointConfig},checkpoint:(0,n.copyCheckpoint)(e),metadata:{...this.checkpointMetadata},newVersions:r}),this.checkpointConfig={...this.checkpointConfig,configurable:{...this.checkpointConfig.configurable,checkpoint_id:this.checkpoint.id}}};t||(this.checkpointMetadata={...e,step:this.step,parents:this.config.configurable?.[a.CONFIG_KEY_CHECKPOINT_MAP]??{}}),this.checkpoint=(0,i.createCheckpoint)(this.checkpoint,r?this.channels:void 0,this.step,t?{id:this.checkpoint.id}:void 0),r&&s(this.checkpoint),t||(this.step+=1)}_flushPendingWrites(){if(null==this.checkpointer||0===this.checkpointPendingWrites.length)return;let e=(0,c.patchConfigurable)(this.checkpointConfig,{[a.CONFIG_KEY_CHECKPOINT_NS]:this.config.configurable?.checkpoint_ns??"",[a.CONFIG_KEY_CHECKPOINT_ID]:this.checkpoint.id}),t={};for(let[e,r,n]of this.checkpointPendingWrites)t[e]??=[],t[e].push([r,n]);for(let[r,n]of Object.entries(t))this.checkpointerPromises.push(this.checkpointer.putWrites(e,n,r))}_matchWrites(e){for(let[t,r,n]of this.checkpointPendingWrites){if(r===a.ERROR||r===a.INTERRUPT||r===a.RESUME)continue;let i=Object.values(e).find(e=>e.id===t);i&&i.writes.push([r,n])}for(let t of Object.values(e))t.writes.length>0&&this._outputWrites(t.id,t.writes,!0)}}r.PregelLoop=y},61196,(e,t,r)=>{t.exports=e.r(9255)},7812,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.StreamMessagesHandler=void 0;let n=e.r(61196),i=e.r(22991),a=e.r(45864);class s extends n.BaseCallbackHandler{constructor(e){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"StreamMessagesHandler"}),Object.defineProperty(this,"streamFn",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadatas",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"seen",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"emittedChatModelRunIds",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"stableMessageIdMap",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.streamFn=e}_emit(e,t,r,n=!1){if(n&&void 0!==t.id&&void 0!==this.seen[t.id])return;let a=t.id;null!=r&&((0,i.isToolMessage)(t)?a??=`run-${r}-tool-${t.tool_call_id}`:((null==a||a===`run-${r}`)&&(a=this.stableMessageIdMap[r]??a??`run-${r}`),this.stableMessageIdMap[r]??=a)),a!==t.id&&(t.id=a,t.lc_kwargs.id=a),null!=t.id&&(this.seen[t.id]=t),this.streamFn([e[0],"messages",[t,e[1]]])}handleChatModelStart(e,t,r,n,i,s,o,l){!o||s&&(s.includes(a.TAG_NOSTREAM)||s.includes("nostream"))||(this.metadatas[r]=[o.langgraph_checkpoint_ns.split("|"),{tags:s,name:l,...o}])}handleLLMNewToken(e,t,r,n,a,s){let o=s?.chunk;(this.emittedChatModelRunIds[r]=!0,void 0!==this.metadatas[r])&&((0,i.isBaseMessage)(o?.message)?this._emit(this.metadatas[r],o.message,r):this._emit(this.metadatas[r],new i.AIMessageChunk({content:e}),r))}handleLLMEnd(e,t){if(void 0!==this.metadatas[t]){if(!this.emittedChatModelRunIds[t]){let r=e.generations?.[0]?.[0];(0,i.isBaseMessage)(r?.message)&&this._emit(this.metadatas[t],r?.message,t,!0),delete this.emittedChatModelRunIds[t]}delete this.metadatas[t],delete this.stableMessageIdMap[t]}}handleLLMError(e,t){delete this.metadatas[t]}handleChainStart(e,t,r,n,s,o,l,u){if(void 0!==o&&u===o.langgraph_node&&(void 0===s||!s.includes(a.TAG_HIDDEN))&&(this.metadatas[r]=[o.langgraph_checkpoint_ns.split("|"),{tags:s,name:u,...o}],"object"==typeof t)){for(let e of Object.values(t))if(((0,i.isBaseMessage)(e)||(0,i.isBaseMessageChunk)(e))&&void 0!==e.id)this.seen[e.id]=e;else if(Array.isArray(e))for(let t of e)((0,i.isBaseMessage)(t)||(0,i.isBaseMessageChunk)(t))&&void 0!==t.id&&(this.seen[t.id]=t)}}handleChainEnd(e,t){let r=this.metadatas[t];if(delete this.metadatas[t],void 0!==r){if((0,i.isBaseMessage)(e))this._emit(r,e,t,!0);else if(Array.isArray(e))for(let n of e)(0,i.isBaseMessage)(n)&&this._emit(r,n,t,!0);else if(null!=e&&"object"==typeof e){for(let n of Object.values(e))if((0,i.isBaseMessage)(n))this._emit(r,n,t,!0);else if(Array.isArray(n))for(let e of n)(0,i.isBaseMessage)(e)&&this._emit(r,e,t,!0)}}}handleChainError(e,t){delete this.metadatas[t]}}r.StreamMessagesHandler=s},20574,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_MAX_RETRIES=r.DEFAULT_MAX_INTERVAL=r.DEFAULT_BACKOFF_FACTOR=r.DEFAULT_INITIAL_INTERVAL=void 0,r._runWithRetry=u;let n=e.r(45864),i=e.r(83134),a=e.r(94497),s=e.r(79427);r.DEFAULT_INITIAL_INTERVAL=500,r.DEFAULT_BACKOFF_FACTOR=2,r.DEFAULT_MAX_INTERVAL=128e3,r.DEFAULT_MAX_RETRIES=3;let o=[400,401,402,403,404,405,406,407,409],l=e=>{if(e.message.startsWith("Cancel")||e.message.startsWith("AbortError")||"AbortError"===e.name||"GraphValueError"===e.name||e?.code==="ECONNABORTED")return!1;let t=e?.response?.status??e?.status;return!(t&&o.includes(+t))&&e?.error?.code!=="insufficient_quota"};async function u(e,t,o,u){let c,d,p=e.retry_policy??t,h=void 0!==p?p.initialInterval??r.DEFAULT_INITIAL_INTERVAL:0,f=0,{config:m}=e;for(o&&(m=(0,s.patchConfigurable)(m,o)),m={...m,signal:u};!u?.aborted;){e.writes.splice(0,e.writes.length),c=void 0;try{d=await e.proc.invoke(e.input,m);break}catch(u){if((c=u).pregelTaskId=e.id,(0,i.isParentCommand)(c)){let t=m?.configurable?.checkpoint_ns,r=c.command;if(r.graph===t){for(let t of e.writers)await t.invoke(r,m);c=void 0;break}if(r.graph===n.Command.PARENT){let e=(0,a.getParentCheckpointNamespace)(t);c.command=new n.Command({...c.command,graph:e})}}if((0,i.isGraphBubbleUp)(c)||void 0===p||(f+=1)>=(p.maxAttempts??r.DEFAULT_MAX_RETRIES)||!(p.retryOn??l)(c))break;h=Math.min(p.maxInterval??r.DEFAULT_MAX_INTERVAL,h*(p.backoffFactor??r.DEFAULT_BACKOFF_FACTOR));let t=p.jitter?Math.floor(h+1e3*Math.random()):h;await new Promise(e=>setTimeout(e,t));let o=c.name??c.constructor.unminifiable_name??c.constructor.name;(p?.logWarning??!0)&&console.log(`Retrying task "${String(e.name)}" after ${h.toFixed(2)}ms (attempt ${f}) after ${o}: ${c}`),m=(0,s.patchConfigurable)(m,{[n.CONFIG_KEY_RESUMING]:!0})}}return{task:e,result:d,error:c,signalAborted:u?.aborted}}},73866,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PregelRunner=void 0;let n=e.r(34323),i=e.r(79427),a=e.r(45864),s=e.r(83134),o=e.r(20574),l=Symbol.for("promiseAdded");async function u(e,t,r,i,s,l={}){let c=t.config?.configurable?.[a.CONFIG_KEY_SCRATCHPAD];if(!c)throw Error(`BUG: No scratchpad found on task ${t.name}__${t.id}`);let d=c.callCounter;c.callCounter+=1;let p=new n.Call({func:r,name:i,input:s,cache:l.cache,retry:l.retry,callbacks:l.callbacks}),h=await this.scheduleTask(t,d,p);if(!h)return;let f=this.executingTasksMap[h.id];if(void 0!==f)return f;if(h.writes.length>0){let e=h.writes.filter(([e])=>e===a.RETURN),t=h.writes.filter(([e])=>e===a.ERROR);if(e.length>0){if(1===e.length)return Promise.resolve(e[0][1]);throw Error(`BUG: multiple returns found for task ${h.name}__${h.id}`)}if(t.length>0){if(1===t.length){let e=t[0][1];return Promise.reject(e instanceof Error?e:Error(String(e)))}throw Error(`BUG: multiple errors found for task ${h.name}__${h.id}`)}return}{let t=(0,o._runWithRetry)(h,l.retry,{[a.CONFIG_KEY_CALL]:u.bind(this,e,h)});return this.executingTasksMap[h.id]=t,this.barrier.next(),t.then(({result:e,error:t})=>t?Promise.reject(t):e)}}r.PregelRunner=class{constructor({loop:e,nodeFinished:t}){Object.defineProperty(this,"nodeFinished",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"loop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.loop=e,this.nodeFinished=t}async tick(e={}){let t,{timeout:r,retryPolicy:n,onStepWrite:i,maxConcurrency:a}=e,o=new Set,l=new AbortController,u=l.signal,c=r?AbortSignal.timeout(r):void 0,d=Object.values(this.loop.tasks).filter(e=>0===e.writes.length),{signals:p,disposeCombinedSignal:h}=this._initializeAbortSignals({exceptionSignal:u,stepTimeoutSignal:c,signal:e.signal});for await(let{task:e,error:r,signalAborted:i}of this._executeTasksWithRetry(d,{signals:p,retryPolicy:n,maxConcurrency:a}))this._commit(e,r),(0,s.isGraphInterrupt)(r)||(0,s.isGraphBubbleUp)(r)&&!(0,s.isGraphInterrupt)(t)?t=r:r&&(0===o.size||!i)&&(l.abort(),o.add(r));if(h?.(),i?.(this.loop.step,Object.values(this.loop.tasks).map(e=>e.writes).flat()),1===o.size)throw Array.from(o)[0];if(o.size>1)throw AggregateError(Array.from(o),`Multiple errors occurred during superstep ${this.loop.step}. See the "errors" field of this exception for more details.`);if((0,s.isGraphInterrupt)(t)||(0,s.isGraphBubbleUp)(t)&&this.loop.isNested)throw t}_initializeAbortSignals({exceptionSignal:e,stepTimeoutSignal:t,signal:r}){let n=this.loop.config.configurable?.[a.CONFIG_KEY_ABORT_SIGNALS]??{},s=n.externalAbortSignal??r,o=t??n.timeoutAbortSignal,{signal:l,dispose:u}=(0,i.combineAbortSignals)(s,o,e),c={externalAbortSignal:s,timeoutAbortSignal:o,composedAbortSignal:l};return this.loop.config=(0,i.patchConfigurable)(this.loop.config,{[a.CONFIG_KEY_ABORT_SIGNALS]:c}),{signals:c,disposeCombinedSignal:u}}async *_executeTasksWithRetry(e,t){let r,{retryPolicy:n,maxConcurrency:s,signals:c}=t??{},d=function(){let e={next:()=>void 0,wait:Promise.resolve(l)};return e.wait=new Promise(function t(r){e.next=()=>{e.wait=new Promise(t),r(l)}}),e}(),p={},h={executingTasksMap:p,barrier:d,retryPolicy:n,scheduleTask:async(e,t,r)=>this.loop.acceptPush(e,t,r)};if(c?.composedAbortSignal?.aborted)throw Error("Abort");let f=0,m=(0,i.combineAbortSignals)(c?.externalAbortSignal,c?.timeoutAbortSignal),g=m.signal?new Promise((e,t)=>{r=()=>t(Error("Abort")),m.signal?.addEventListener("abort",r,{once:!0})}):void 0;for(;(0===f||Object.keys(p).length>0)&&e.length;){for(;Object.values(p).length<(s??e.length)&&f<e.length;f+=1){let t=e[f];p[t.id]=(0,o._runWithRetry)(t,n,{[a.CONFIG_KEY_CALL]:u?.bind(h,this,t)},c?.composedAbortSignal).catch(e=>({task:t,error:e,signalAborted:c?.composedAbortSignal?.aborted}))}let t=await Promise.race([...Object.values(p),...g?[g]:[],d.wait]);t!==l&&(yield t,null!=r&&(m.signal?.removeEventListener("abort",r),m.dispose?.()),delete p[t.task.id])}}_commit(e,t){if(void 0!==t)if((0,s.isGraphInterrupt)(t)){if(t.interrupts.length){let r=t.interrupts.map(e=>[a.INTERRUPT,e]),n=e.writes.filter(e=>e[0]===a.RESUME);n.length&&r.push(...n),this.loop.putWrites(e.id,r)}}else(0,s.isGraphBubbleUp)(t)&&e.writes.length?this.loop.putWrites(e.id,e.writes):this.loop.putWrites(e.id,[[a.ERROR,{message:t.message,name:t.name}]]);else this.nodeFinished&&(e.config?.tags==null||!e.config.tags.includes(a.TAG_HIDDEN))&&this.nodeFinished(String(e.name)),0===e.writes.length&&e.writes.push([a.NO_WRITES,null]),this.loop.putWrites(e.id,e.writes)}}},23836,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GraphValidationError=void 0,r.validateGraph=function({nodes:e,channels:t,inputChannels:r,outputChannels:s,streamChannels:o,interruptAfterNodes:l,interruptBeforeNodes:u}){if(!t)throw new a("Channels not provided");let c=new Set,d=new Set;for(let[t,r]of Object.entries(e)){if(t===n.INTERRUPT)throw new a(`"Node name ${n.INTERRUPT} is reserved"`);if(r.constructor===i.PregelNode)r.triggers.forEach(e=>c.add(e));else throw new a(`Invalid node type ${typeof r}, expected PregelNode`)}for(let e of c)if(!(e in t))throw new a(`Subscribed channel '${String(e)}' not in channels`);if(Array.isArray(r)){if(r.every(e=>!c.has(e)))throw new a(`None of the input channels ${r} are subscribed to by any node`)}else if(!c.has(r))throw new a(`Input channel ${String(r)} is not subscribed to by any node`);for(let e of(Array.isArray(s)?s.forEach(e=>d.add(e)):d.add(s),o&&!Array.isArray(o)?d.add(o):Array.isArray(o)&&o.forEach(e=>d.add(e)),d))if(!(e in t))throw new a(`Output channel '${String(e)}' not in channels`);if(l&&"*"!==l){for(let t of l)if(!(t in e))throw new a(`Node ${String(t)} not in nodes`)}if(u&&"*"!==u){for(let t of u)if(!(t in e))throw new a(`Node ${String(t)} not in nodes`)}},r.validateKeys=function(e,t){if(Array.isArray(e)){for(let r of e)if(!(r in t))throw Error(`Key ${String(r)} not found in channels`)}else if(!(e in t))throw Error(`Key ${String(e)} not found in channels`)};let n=e.r(45864),i=e.r(4842);class a extends Error{constructor(e){super(e),this.name="GraphValidationError"}}r.GraphValidationError=a},95241,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Topic=void 0;let n=e.r(83134),i=e.r(99935);class a extends i.BaseChannel{constructor(e){super(),Object.defineProperty(this,"lc_graph_name",{enumerable:!0,configurable:!0,writable:!0,value:"Topic"}),Object.defineProperty(this,"unique",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"accumulate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"seen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"values",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.unique=e?.unique??this.unique,this.accumulate=e?.accumulate??this.accumulate,this.seen=new Set,this.values=[]}fromCheckpoint(e){let t=new a({unique:this.unique,accumulate:this.accumulate});return void 0!==e&&(t.seen=new Set(e[0]),t.values=e[1]),t}update(e){let t=!1;this.accumulate||(t=this.values.length>0,this.values=[]);let r=e.flat();if(r.length>0)if(this.unique)for(let e of r)this.seen.has(e)||(t=!0,this.seen.add(e),this.values.push(e));else t=!0,this.values.push(...r);return t}get(){if(0===this.values.length)throw new n.EmptyChannelError;return this.values}checkpoint(){return[[...this.seen],this.values]}isAvailable(){return 0!==this.values.length}}r.Topic=a},94279,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Pregel=r.Channel=void 0;let n=e.r(78541),i=e.r(77978),a=e.r(99935),s=e.r(45864),o=e.r(83134),l=e.r(93053),u=e.r(12756),c=e.r(69558),d=e.r(75627),p=e.r(274),h=e.r(7812),f=e.r(4842),m=e.r(73866),g=e.r(65283),y=e.r(94497),b=e.r(79427),_=e.r(21995),v=e.r(23836),w=e.r(33514),O=e.r(95241);r.Channel=class{static subscribeTo(e,t){let r,{key:n,tags:i}={key:void 0,tags:void 0,...t??{}};if(Array.isArray(e)&&void 0!==n)throw Error("Can't specify a key when subscribing to multiple channels");r="string"==typeof e?n?{[n]:e}:[e]:Object.fromEntries(e.map(e=>[e,e]));let a=Array.isArray(e)?e:[e];return new f.PregelNode({channels:r,triggers:a,tags:i})}static writeTo(e,t){let r=[];for(let t of e)r.push({channel:t,value:w.PASSTHROUGH,skipNone:!1});for(let[e,i]of Object.entries(t??{}))n.Runnable.isRunnable(i)||"function"==typeof i?r.push({channel:e,value:w.PASSTHROUGH,skipNone:!0,mapper:(0,n._coerceToRunnable)(i)}):r.push({channel:e,value:i,skipNone:!1});return new w.ChannelWrite(r)}};class P extends n.Runnable{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langgraph","pregel"]})}invoke(e,t){throw Error("Not implemented")}withConfig(e){return super.withConfig(e)}stream(e,t){return super.stream(e,t)}}r.Pregel=class extends P{static lc_name(){return"LangGraph"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langgraph","pregel"]}),Object.defineProperty(this,"lg_is_pregel",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"channels",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputChannels",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputChannels",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoValidate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"streamMode",{enumerable:!0,configurable:!0,writable:!0,value:["values"]}),Object.defineProperty(this,"streamChannels",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interruptAfter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interruptBefore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"checkpointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"retryPolicy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"triggerToNodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let{streamMode:t}=e;if(null==t||Array.isArray(t)||(t=[t]),this.nodes=e.nodes,this.channels=e.channels,s.TASKS in this.channels&&"lc_graph_name"in this.channels[s.TASKS]&&"Topic"!==this.channels[s.TASKS].lc_graph_name)throw Error(`Channel '${s.TASKS}' is reserved and cannot be used in the graph.`);this.channels[s.TASKS]=new O.Topic({accumulate:!1}),this.autoValidate=e.autoValidate??this.autoValidate,this.streamMode=t??this.streamMode,this.inputChannels=e.inputChannels,this.outputChannels=e.outputChannels,this.streamChannels=e.streamChannels??this.streamChannels,this.interruptAfter=e.interruptAfter,this.interruptBefore=e.interruptBefore,this.stepTimeout=e.stepTimeout??this.stepTimeout,this.debug=e.debug??this.debug,this.checkpointer=e.checkpointer,this.retryPolicy=e.retryPolicy,this.config=e.config,this.store=e.store,this.cache=e.cache,this.name=e.name,this.autoValidate&&this.validate()}withConfig(e){let t=(0,n.mergeConfigs)(this.config,e);return new this.constructor({...this,config:t})}validate(){for(let[e,t]of((0,v.validateGraph)({nodes:this.nodes,channels:this.channels,outputChannels:this.outputChannels,inputChannels:this.inputChannels,streamChannels:this.streamChannels,interruptAfterNodes:this.interruptAfter,interruptBeforeNodes:this.interruptBefore}),Object.entries(this.nodes)))for(let r of t.triggers)this.triggerToNodes[r]??=[],this.triggerToNodes[r].push(e);return this}get streamChannelsList(){return Array.isArray(this.streamChannels)?this.streamChannels:this.streamChannels?[this.streamChannels]:Object.keys(this.channels)}get streamChannelsAsIs(){return this.streamChannels?this.streamChannels:Object.keys(this.channels)}async getGraphAsync(e){return this.getGraph(e)}*getSubgraphs(e,t){for(let[r,n]of Object.entries(this.nodes))if(void 0===e||e.startsWith(r))for(let i of n.subgraphs?.length?n.subgraphs:[n.bound]){let n=(0,_.findSubgraphPregel)(i);if(void 0!==n){if(r===e)return void(yield[r,n]);if(void 0===e&&(yield[r,n]),t){let i=e;for(let[a,o]of(void 0!==e&&(i=e.slice(r.length+1)),n.getSubgraphs(i,t)))yield[`${r}${s.CHECKPOINT_NAMESPACE_SEPARATOR}${a}`,o]}}}}async *getSubgraphsAsync(e,t){yield*this.getSubgraphs(e,t)}async _prepareStateSnapshot({config:e,saved:t,subgraphCheckpointer:r,applyPendingWrites:n=!1}){if(void 0===t)return{values:{},next:[],config:e,tasks:[]};let o=(0,a.emptyChannels)(this.channels,t.checkpoint);if(t.pendingWrites?.length){let e=t.pendingWrites.filter(([e,t])=>e===s.NULL_TASK_ID).map(([e,t,r])=>[String(t),r]);e.length>0&&(0,u._applyWrites)(t.checkpoint,o,[{name:s.INPUT,writes:e,triggers:[]}],void 0,this.triggerToNodes)}let p=Object.values((0,u._prepareNextTasks)(t.checkpoint,t.pendingWrites,this.nodes,o,t.config,!0,{step:(t.metadata?.step??-1)+1,store:this.store})),h=await (0,l.gatherIterator)(this.getSubgraphsAsync()),f=t.config.configurable?.checkpoint_ns??"",m={};for(let e of p){let n=h.find(([t])=>t===e.name);if(!n)continue;let i=`${String(e.name)}${s.CHECKPOINT_NAMESPACE_END}${e.id}`;if(f&&(i=`${f}${s.CHECKPOINT_NAMESPACE_SEPARATOR}${i}`),void 0===r){let r={configurable:{thread_id:t.config.configurable?.thread_id,checkpoint_ns:i}};m[e.id]=r}else{let a={configurable:{[s.CONFIG_KEY_CHECKPOINTER]:r,thread_id:t.config.configurable?.thread_id,checkpoint_ns:i}},o=n[1];m[e.id]=await o.getState(a,{subgraphs:!0})}}if(n&&t.pendingWrites?.length){let e=Object.fromEntries(p.map(e=>[e.id,e]));for(let[r,n,a]of t.pendingWrites)![s.ERROR,s.INTERRUPT,i.SCHEDULED].includes(n)&&r in e&&e[r].writes.push([String(n),a]);let r=p.filter(e=>e.writes.length>0);r.length>0&&(0,u._applyWrites)(t.checkpoint,o,r,void 0,this.triggerToNodes)}let g=t?.metadata;g&&t?.config?.configurable?.thread_id&&(g={...g,thread_id:t.config.configurable.thread_id});let y=p.filter(e=>0===e.writes.length).map(e=>e.name);return{values:(0,d.readChannels)(o,this.streamChannelsAsIs),next:y,tasks:(0,c.tasksWithWrites)(p,t?.pendingWrites??[],m,this.streamChannelsAsIs),metadata:g,config:(0,b.patchCheckpointMap)(t.config,t.metadata),createdAt:t.checkpoint.ts,parentConfig:t.parentConfig}}async getState(e,t){let r=e.configurable?.[s.CONFIG_KEY_CHECKPOINTER]??this.checkpointer;if(!r)throw new o.GraphValueError("No checkpointer set");let i=e.configurable?.checkpoint_ns??"";if(""!==i&&e.configurable?.[s.CONFIG_KEY_CHECKPOINTER]===void 0){let n=(0,y.recastCheckpointNamespace)(i);for await(let[i,a]of this.getSubgraphsAsync(n,!0))if(i===n)return await a.getState((0,l.patchConfigurable)(e,{[s.CONFIG_KEY_CHECKPOINTER]:r}),{subgraphs:t?.subgraphs});throw Error(`Subgraph with namespace "${n}" not found.`)}let a=(0,n.mergeConfigs)(this.config,e),u=await r.getTuple(e);return await this._prepareStateSnapshot({config:a,saved:u,subgraphCheckpointer:t?.subgraphs?r:void 0,applyPendingWrites:!e.configurable?.checkpoint_id})}async *getStateHistory(e,t){let r=e.configurable?.[s.CONFIG_KEY_CHECKPOINTER]??this.checkpointer;if(!r)throw new o.GraphValueError("No checkpointer set");let i=e.configurable?.checkpoint_ns??"";if(""!==i&&e.configurable?.[s.CONFIG_KEY_CHECKPOINTER]===void 0){let n=(0,y.recastCheckpointNamespace)(i);for await(let[i,a]of this.getSubgraphsAsync(n,!0))if(i===n)return void(yield*a.getStateHistory((0,l.patchConfigurable)(e,{[s.CONFIG_KEY_CHECKPOINTER]:r}),t));throw Error(`Subgraph with namespace "${n}" not found.`)}let a=(0,n.mergeConfigs)(this.config,e,{configurable:{checkpoint_ns:i}});for await(let e of r.list(a,t))yield this._prepareStateSnapshot({config:e.config,saved:e})}async bulkUpdateState(e,t){let r=e.configurable?.[s.CONFIG_KEY_CHECKPOINTER]??this.checkpointer;if(!r)throw new o.GraphValueError("No checkpointer set");if(0===t.length)throw Error("No supersteps provided");if(t.some(e=>0===e.updates.length))throw Error("No updates provided");let c=e.configurable?.checkpoint_ns??"";if(""!==c&&e.configurable?.[s.CONFIG_KEY_CHECKPOINTER]===void 0){let n=(0,y.recastCheckpointNamespace)(c);for await(let[,i]of this.getSubgraphsAsync(n,!0))return await i.bulkUpdateState((0,l.patchConfigurable)(e,{[s.CONFIG_KEY_CHECKPOINTER]:r}),t);throw Error(`Subgraph "${n}" not found`)}let p=async(e,t)=>{let c=this.config?(0,n.mergeConfigs)(this.config,e):e,h=await r.getTuple(c),f=void 0!==h?(0,i.copyCheckpoint)(h.checkpoint):(0,i.emptyCheckpoint)(),m={...h?.checkpoint.channel_versions},g=h?.metadata?.step??-1,y=(0,l.patchConfigurable)(c,{checkpoint_ns:c.configurable?.checkpoint_ns??""}),_=c.metadata??{};h?.config.configurable&&(y=(0,l.patchConfigurable)(c,h.config.configurable),_={...h.metadata,..._});let{values:v,asNode:w}=t[0];if(null==v&&void 0===w){if(t.length>1)throw new o.InvalidUpdateError("Cannot create empty checkpoint with multiple updates");let e=await r.put(y,(0,a.createCheckpoint)(f,void 0,g),{source:"update",step:g+1,parents:h?.metadata?.parents??{}},{});return(0,b.patchCheckpointMap)(e,h?h.metadata:void 0)}let O=(0,a.emptyChannels)(this.channels,f);if(null===v&&w===s.END){if(t.length>1)throw new o.InvalidUpdateError("Cannot apply multiple updates when clearing state");if(h){let e=(0,u._prepareNextTasks)(f,h.pendingWrites||[],this.nodes,O,h.config,!0,{step:(h.metadata?.step??-1)+1,checkpointer:r,store:this.store}),t=(h.pendingWrites||[]).filter(e=>e[0]===s.NULL_TASK_ID).map(e=>e.slice(1));for(let[n,a,o]of(t.length>0&&(0,u._applyWrites)(f,O,[{name:s.INPUT,writes:t,triggers:[]}],r.getNextVersion.bind(r),this.triggerToNodes),h.pendingWrites||[]))![s.ERROR,s.INTERRUPT,i.SCHEDULED].includes(a)&&n in e&&e[n].writes.push([a,o]);(0,u._applyWrites)(f,O,Object.values(e),r.getNextVersion.bind(r),this.triggerToNodes)}let e=await r.put(y,(0,a.createCheckpoint)(f,O,g),{..._,source:"update",step:g+1,parents:h?.metadata?.parents??{}},(0,b.getNewChannelVersions)(m,f.channel_versions));return(0,b.patchCheckpointMap)(e,h?h.metadata:void 0)}if(w===s.COPY){if(t.length>1)throw new o.InvalidUpdateError("Cannot copy checkpoint with multiple updates");if(null==h)throw new o.InvalidUpdateError("Cannot copy a non-existent checkpoint");let e=(0,a.createCheckpoint)(f,void 0,g),n=await r.put(h.parentConfig??(0,l.patchConfigurable)(h.config,{checkpoint_id:void 0}),e,{source:"fork",step:g+1,parents:h.metadata?.parents??{}},{});if(Array.isArray(v)&&0!==v.length&&v.every(e=>Array.isArray(e)&&2===e.length)){let t=Object.values((0,u._prepareNextTasks)(e,h.pendingWrites,this.nodes,O,n,!1,{step:g+2})).reduce((e,{name:t,id:r})=>(e[t]??=[],e[t].push({id:r}),e),{}),r=v.reduce((e,r)=>{let[n,i]=r;e[i]??=[];let a=e[i].length,s=t[i]?.[a]?.id;return e[i].push({values:n,asNode:i,taskId:s}),e},{});return p((0,b.patchCheckpointMap)(n,h.metadata),Object.values(r).flat())}return(0,b.patchCheckpointMap)(n,h.metadata)}if(w===s.INPUT){if(t.length>1)throw new o.InvalidUpdateError("Cannot apply multiple updates when updating as input");let e=await (0,l.gatherIterator)((0,d.mapInput)(this.inputChannels,v));if(0===e.length)throw new o.InvalidUpdateError(`Received no input writes for ${JSON.stringify(this.inputChannels,null,2)}`);(0,u._applyWrites)(f,O,[{name:s.INPUT,writes:e,triggers:[]}],r.getNextVersion.bind(this.checkpointer),this.triggerToNodes);let n=h?.metadata?.step!=null?h.metadata.step+1:-1,c=await r.put(y,(0,a.createCheckpoint)(f,O,n),{source:"input",step:n,parents:h?.metadata?.parents??{}},(0,b.getNewChannelVersions)(m,f.channel_versions));return await r.putWrites(c,e,(0,i.uuid5)(s.INPUT,f.id)),(0,b.patchCheckpointMap)(c,h?h.metadata:void 0)}if(c.configurable?.checkpoint_id===void 0&&h?.pendingWrites!==void 0&&h.pendingWrites.length>0){let e=(0,u._prepareNextTasks)(f,h.pendingWrites,this.nodes,O,h.config,!0,{store:this.store,checkpointer:this.checkpointer,step:(h.metadata?.step??-1)+1}),t=(h.pendingWrites??[]).filter(e=>e[0]===s.NULL_TASK_ID).map(e=>e.slice(1));for(let[r,n,a]of(t.length>0&&(0,u._applyWrites)(h.checkpoint,O,[{name:s.INPUT,writes:t,triggers:[]}],void 0,this.triggerToNodes),h.pendingWrites))[s.ERROR,s.INTERRUPT,i.SCHEDULED].includes(n)||void 0===e[r]||e[r].writes.push([n,a]);let r=Object.values(e).filter(e=>e.writes.length>0);r.length>0&&(0,u._applyWrites)(f,O,r,void 0,this.triggerToNodes)}let P=Object.values(f.versions_seen).map(e=>Object.values(e)).flat().find(e=>!!e),S=[];if(1===t.length){let{values:e,asNode:r,taskId:n}=t[0];if(void 0===r&&1===Object.keys(this.nodes).length)[r]=Object.keys(this.nodes);else if(void 0===r&&void 0===P)"string"==typeof this.inputChannels&&void 0!==this.nodes[this.inputChannels]&&(r=this.inputChannels);else if(void 0===r){let e=Object.entries(f.versions_seen).map(([e,t])=>Object.values(t).map(t=>[t,e])).flat().filter(([e,t])=>t!==s.INTERRUPT).sort(([e],[t])=>(0,i.compareChannelVersions)(e,t));e&&(1===e.length?r=e[0][1]:e[e.length-1][0]!==e[e.length-2][0]&&(r=e[e.length-1][1]))}if(void 0===r)throw new o.InvalidUpdateError('Ambiguous update, specify "asNode"');S.push({values:e,asNode:r,taskId:n})}else for(let{asNode:e,values:r,taskId:n}of t){if(null==e)throw new o.InvalidUpdateError('"asNode" is required when applying multiple updates');S.push({values:r,asNode:e,taskId:n})}let E=[];for(let{asNode:e,values:t,taskId:r}of S){if(void 0===this.nodes[e])throw new o.InvalidUpdateError(`Node "${e.toString()}" does not exist`);let a=this.nodes[e].getWriters();if(!a.length)throw new o.InvalidUpdateError(`No writers found for node "${e.toString()}"`);E.push({name:e,input:t,proc:a.length>1?n.RunnableSequence.from(a,{omitSequenceTags:!0}):a[0],writes:[],triggers:[s.INTERRUPT],id:r??(0,i.uuid5)(s.INTERRUPT,f.id),writers:[]})}for(let e of E)await e.proc.invoke(e.input,(0,n.patchConfig)({...c,store:c?.store??this.store},{runName:c.runName??`${this.getName()}UpdateState`,configurable:{[s.CONFIG_KEY_SEND]:t=>e.writes.push(...t),[s.CONFIG_KEY_READ]:(t,r=!1)=>(0,u._localRead)(f,O,e,t,r)}}));for(let e of E){let t=e.writes.filter(e=>e[0]!==s.PUSH);void 0!==h&&t.length>0&&await r.putWrites(y,t,e.id)}(0,u._applyWrites)(f,O,E,r.getNextVersion.bind(this.checkpointer),this.triggerToNodes);let k=(0,b.getNewChannelVersions)(m,f.channel_versions),I=await r.put(y,(0,a.createCheckpoint)(f,O,g+1),{source:"update",step:g+1,parents:h?.metadata?.parents??{}},k);for(let e of E){let t=e.writes.filter(e=>e[0]===s.PUSH);t.length>0&&await r.putWrites(I,t,e.id)}return(0,b.patchCheckpointMap)(I,h?h.metadata:void 0)},h=e;for(let{updates:e}of t)h=await p(h,e);return h}async updateState(e,t,r){return this.bulkUpdateState(e,[{updates:[{values:t,asNode:r}]}])}_defaults(e){let t,r,{debug:n,streamMode:i,inputKeys:a,outputKeys:o,interruptAfter:l,interruptBefore:u,...c}=e,d=!0,p=void 0!==n?n:this.debug,h=o;void 0===h?h=this.streamChannelsAsIs:(0,v.validateKeys)(h,this.channels);let f=a;void 0===f?f=this.inputChannels:(0,v.validateKeys)(f,this.channels);let m=u??this.interruptBefore??[],g=l??this.interruptAfter??[];if(void 0!==i?(t=Array.isArray(i)?i:[i],d="string"==typeof i):(t=e.configurable?.[s.CONFIG_KEY_TASK_ID]!==void 0?["values"]:this.streamMode,d=!0),!1===this.checkpointer)r=void 0;else if(void 0!==e&&e.configurable?.[s.CONFIG_KEY_CHECKPOINTER]!==void 0)r=e.configurable[s.CONFIG_KEY_CHECKPOINTER];else if(!0===this.checkpointer)throw Error("checkpointer: true cannot be used for root graphs.");else r=this.checkpointer;let y=e.store??this.store,b=e.cache??this.cache;if(null!=e.durability&&null!=e.checkpointDuring)throw Error("Cannot use both `durability` and `checkpointDuring` at the same time.");let _=(()=>{if(null!=e.checkpointDuring)return!1===e.checkpointDuring?"exit":"async"})();return[p,t,f,h,c,m,g,r,y,d,b,e.durability??_??e?.configurable?.[s.CONFIG_KEY_DURABILITY]??"async"]}async stream(e,t){let r=new AbortController,n={recursionLimit:this.config?.recursionLimit,...t,signal:(0,b.combineAbortSignals)(t?.signal,r.signal).signal};return new g.IterableReadableStreamWithAbortSignal(await super.stream(e,n),r)}streamEvents(e,t,r){let n=new AbortController,i={recursionLimit:this.config?.recursionLimit,...t,callbacks:(0,b.combineCallbacks)(this.config?.callbacks,t?.callbacks),signal:(0,b.combineAbortSignals)(t?.signal,n.signal).signal};return new g.IterableReadableStreamWithAbortSignal(super.streamEvents(e,i,r),n)}async _validateInput(e){return e}async _validateContext(e){return e}async *_streamIterator(e,t){let r,i,o=t?.subgraphs,l=(0,y.ensureLangGraphConfig)(this.config,t);if(void 0===l.recursionLimit||l.recursionLimit<1)throw Error('Passed "recursionLimit" must be at least 1.');if(void 0!==this.checkpointer&&!1!==this.checkpointer&&void 0===l.configurable)throw Error('Checkpointer requires one or more of the following "configurable" keys: "thread_id", "checkpoint_ns", "checkpoint_id"');let u=await this._validateInput(e),{runId:c,...d}=l,[f,_,,v,w,O,P,S,E,k,I,A]=this._defaults(d);void 0!==w.context?w.context=await this._validateContext(w.context):w.configurable=await this._validateContext(w.configurable);let T=new g.IterableReadableWritableStream({modes:new Set(_)});if(!0===this.checkpointer){w.configurable??={};let e=w.configurable[s.CONFIG_KEY_CHECKPOINT_NS]??"";w.configurable[s.CONFIG_KEY_CHECKPOINT_NS]=e.split(s.CHECKPOINT_NAMESPACE_SEPARATOR).map(e=>e.split(s.CHECKPOINT_NAMESPACE_END)[0]).join(s.CHECKPOINT_NAMESPACE_SEPARATOR)}if(_.includes("messages")){let e=new h.StreamMessagesHandler(e=>T.push(e)),{callbacks:t}=w;if(void 0===t)w.callbacks=[e];else if(Array.isArray(t))w.callbacks=t.concat(e);else{let r=t.copy();r.addHandler(e,!0),w.callbacks=r}}_.includes("custom")&&(w.writer=e=>{let t=(0,y.getConfig)()?.configurable?.[s.CONFIG_KEY_CHECKPOINT_NS]?.split(s.CHECKPOINT_NAMESPACE_SEPARATOR).slice(0,-1);T.push([t??[],"custom",e])});let C=await (0,n.getCallbackManagerForConfig)(w),j=await C?.handleChainStart(this.toJSON(),(0,b._coerceToDict)(e,"input"),c,void 0,void 0,void 0,w?.runName??this.getName()),x=(0,a.getOnlyChannels)(this.channels),$=(async()=>{try{r=await p.PregelLoop.initialize({input:u,config:w,checkpointer:S,nodes:this.nodes,channelSpecs:x,outputKeys:v,streamKeys:this.streamChannelsAsIs,store:E,cache:I,stream:T,interruptAfter:P,interruptBefore:O,manager:j,debug:this.debug,triggerToNodes:this.triggerToNodes,durability:A});let e=new m.PregelRunner({loop:r,nodeFinished:w.configurable?.[s.CONFIG_KEY_NODE_FINISHED]});t?.subgraphs&&(r.config.configurable={...r.config.configurable,[s.CONFIG_KEY_STREAM]:r.stream}),await this._runLoop({loop:r,runner:e,debug:f,config:w}),"sync"===A&&await Promise.all(r?.checkpointerPromises??[])}catch(e){i=e}finally{try{r&&(await r.store?.stop(),await r.cache?.stop()),await Promise.all(r?.checkpointerPromises??[])}catch(e){i=i??e}i?T.error(i):T.close()}})();try{for await(let e of T){if(void 0===e)throw Error("Data structure error.");let[t,r,n]=e;_.includes(r)&&(o&&!k?yield[t,r,n]:k?o?yield[t,n]:yield n:yield[r,n])}}catch(e){throw await j?.handleChainError(i),e}finally{await $}await j?.handleChainEnd(r?.output??{},c,void 0,void 0,void 0)}async invoke(e,t){let r,n=t?.streamMode??"values",i={...t,outputKeys:t?.outputKeys??this.outputChannels,streamMode:n},a=[],o=await this.stream(e,i),l=[];for await(let e of o)"values"===n?(0,s.isInterrupted)(e)?l.push(e[s.INTERRUPT]):r=e:a.push(e);if("values"===n){if(l.length>0){let e=l.flat(1);if(null==r)return{[s.INTERRUPT]:e};if("object"==typeof r)return{...r,[s.INTERRUPT]:e}}return r}return a}async _runLoop(e){let t,{loop:r,runner:n,debug:i,config:a}=e;try{for(;await r.tick({inputKeys:this.inputChannels});){for(let{task:e}of(await r._matchCachedWrites()))r._outputWrites(e.id,e.writes,!0);i&&(0,c.printStepCheckpoint)(r.checkpointMetadata.step,r.channels,this.streamChannelsList),i&&(0,c.printStepTasks)(r.step,Object.values(r.tasks)),await n.tick({timeout:this.stepTimeout,retryPolicy:this.retryPolicy,onStepWrite:(e,t)=>{i&&(0,c.printStepWrites)(e,t,this.streamChannelsList)},maxConcurrency:a.maxConcurrency,signal:a.signal})}if("out_of_steps"===r.status)throw new o.GraphRecursionError(`Recursion limit of ${a.recursionLimit} reached without hitting a stop condition. You can increase the limit by setting the "recursionLimit" config key.`,{lc_error_code:"GRAPH_RECURSION_LIMIT"})}catch(e){if(t=e,!await r.finishAndHandleError(t))throw e}finally{void 0===t&&await r.finishAndHandleError()}}async clearCache(){await this.cache?.clear([])}}},22762,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BinaryOperatorAggregate=r.empty=r.createCheckpoint=r.BaseChannel=void 0;var n=e.r(99935);Object.defineProperty(r,"BaseChannel",{enumerable:!0,get:function(){return n.BaseChannel}}),Object.defineProperty(r,"createCheckpoint",{enumerable:!0,get:function(){return n.createCheckpoint}}),Object.defineProperty(r,"empty",{enumerable:!0,get:function(){return n.emptyChannels}});var i=e.r(69979);Object.defineProperty(r,"BinaryOperatorAggregate",{enumerable:!0,get:function(){return i.BinaryOperatorAggregate}})},95567,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EphemeralValue=void 0;let n=e.r(83134),i=e.r(22762);class a extends i.BaseChannel{constructor(e=!0){super(),Object.defineProperty(this,"lc_graph_name",{enumerable:!0,configurable:!0,writable:!0,value:"EphemeralValue"}),Object.defineProperty(this,"guard",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.guard=e}fromCheckpoint(e){let t=new a(this.guard);return void 0!==e&&(t.value=[e]),t}update(e){if(0===e.length){let e=this.value.length>0;return this.value=[],e}if(1!==e.length&&this.guard)throw new n.InvalidUpdateError("EphemeralValue can only receive one value per step.");return this.value=[e[e.length-1]],!0}get(){if(0===this.value.length)throw new n.EmptyChannelError;return this.value[0]}checkpoint(){if(0===this.value.length)throw new n.EmptyChannelError;return this.value[0]}isAvailable(){return 0!==this.value.length}}r.EphemeralValue=a},93144,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CompiledGraph=r.Graph=r.Branch=void 0;let n=e.r(78541),i=e.r(81369),a=e.r(99243),s=e.r(79403),o=e.r(4842),l=e.r(94279),u=e.r(95567),c=e.r(33514),d=e.r(45864),p=e.r(93053),h=e.r(83134),f=e.r(21995);class m{constructor(e){Object.defineProperty(this,"path",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ends",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.Runnable.isRunnable(e.path)?this.path=e.path:this.path=(0,n._coerceToRunnable)(e.path).withConfig({runName:"Branch"}),this.ends=Array.isArray(e.pathMap)?e.pathMap.reduce((e,t)=>(e[t]=t,e),{}):e.pathMap}run(e,t){return c.ChannelWrite.registerWriter(new p.RunnableCallable({name:"<branch_run>",trace:!1,func:async(r,n)=>{try{return await this._route(r,n,e,t)}catch(e){throw e.name===h.NodeInterrupt.unminifiable_name&&console.warn("[WARN]: 'NodeInterrupt' thrown in conditional edge. This is likely a bug in your graph implementation.\nNodeInterrupt should only be thrown inside a node, not in edge conditions."),e}}}))}async _route(e,t,r,n){let i,a=await this.path.invoke(n?n(t):e,t);if(Array.isArray(a)||(a=[a]),(i=this.ends?a.map(e=>(0,d._isSend)(e)?e:this.ends[e]):a).some(e=>!e))throw Error("Branch condition returned unknown or null destination");if(i.filter(d._isSend).some(e=>e.node===d.END))throw new h.InvalidUpdateError("Cannot send a packet to the END node");return await r(i,t)??e}}r.Branch=m,r.Graph=class{constructor(){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"branches",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"entryPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"compiled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.nodes={},this.edges=new Set,this.branches={}}warnIfCompiled(e){this.compiled&&console.warn(e)}get allEdges(){return this.edges}addNode(...e){let t=e.length>=1&&"string"!=typeof e[0]?Array.isArray(e[0])?e[0]:Object.entries(e[0]):[[e[0],e[1],e[2]]];if(0===t.length)throw Error("No nodes provided in `addNode`");for(let[e,r,i]of t){for(let t of[d.CHECKPOINT_NAMESPACE_SEPARATOR,d.CHECKPOINT_NAMESPACE_END])if(e.includes(t))throw Error(`"${t}" is a reserved character and is not allowed in node names.`);if(this.warnIfCompiled("Adding a node to a graph that has already been compiled. This will not be reflected in the compiled graph."),e in this.nodes)throw Error(`Node \`${e}\` already present.`);if(e===d.END)throw Error(`Node \`${e}\` is reserved.`);let t=(0,n._coerceToRunnable)(r);this.nodes[e]={runnable:t,metadata:i?.metadata,subgraphs:(0,f.isPregelLike)(t)?[t]:i?.subgraphs,ends:i?.ends}}return this}addEdge(e,t){if(this.warnIfCompiled("Adding an edge to a graph that has already been compiled. This will not be reflected in the compiled graph."),e===d.END)throw Error("END cannot be a start node");if(t===d.START)throw Error("START cannot be an end node");if(Array.from(this.edges).some(([t])=>t===e)&&!("channels"in this))throw Error(`Already found path for ${e}. For multiple edges, use StateGraph.`);return this.edges.add([e,t]),this}addConditionalEdges(e,t,r){let i="object"==typeof e?e:{source:e,path:t,pathMap:r};if(this.warnIfCompiled("Adding an edge to a graph that has already been compiled. This will not be reflected in the compiled graph."),!n.Runnable.isRunnable(i.path)){let e=Array.isArray(i.pathMap)?i.pathMap.join(","):Object.keys(i.pathMap??{}).join(",");i.path=(0,n._coerceToRunnable)(i.path).withConfig({runName:`Branch<${i.source}${""!==e?`,${e}`:""}>`.slice(0,63)})}let a="RunnableLambda"===i.path.getName()?"condition":i.path.getName();if(this.branches[i.source]&&this.branches[i.source][a])throw Error(`Condition \`${a}\` already present for node \`${e}\``);return this.branches[i.source]??={},this.branches[i.source][a]=new m(i),this}setEntryPoint(e){return this.warnIfCompiled("Setting the entry point of a graph that has already been compiled. This will not be reflected in the compiled graph."),this.addEdge(d.START,e)}setFinishPoint(e){return this.warnIfCompiled("Setting a finish point of a graph that has already been compiled. This will not be reflected in the compiled graph."),this.addEdge(e,d.END)}compile({checkpointer:e,interruptBefore:t,interruptAfter:r,name:n}={}){this.validate([...Array.isArray(t)?t:[],...Array.isArray(r)?r:[]]);let i=new g({builder:this,checkpointer:e,interruptAfter:r,interruptBefore:t,autoValidate:!1,nodes:{},channels:{[d.START]:new u.EphemeralValue,[d.END]:new u.EphemeralValue},inputChannels:d.START,outputChannels:d.END,streamChannels:[],streamMode:"values",name:n});for(let[e,t]of Object.entries(this.nodes))i.attachNode(e,t);for(let[e,t]of this.edges)i.attachEdge(e,t);for(let[e,t]of Object.entries(this.branches))for(let[r,n]of Object.entries(t))i.attachBranch(e,r,n);return i.validate()}validate(e){let t=new Set([...this.allEdges].map(([e,t])=>e));for(let[e]of Object.entries(this.branches))t.add(e);for(let e of t)if(e!==d.START&&!(e in this.nodes))throw Error(`Found edge starting at unknown node \`${e}\``);let r=new Set([...this.allEdges].map(([e,t])=>t));for(let[e,t]of Object.entries(this.branches))for(let n of Object.values(t))if(null!=n.ends)for(let e of Object.values(n.ends))r.add(e);else for(let t of(r.add(d.END),Object.keys(this.nodes)))t!==e&&r.add(t);for(let e of Object.values(this.nodes))for(let t of e.ends??[])r.add(t);for(let e of Object.keys(this.nodes))if(!r.has(e))throw new h.UnreachableNodeError(`Node \`${e}\` is not reachable.

If you are returning Command objects from your node,
make sure you are passing names of potential destination nodes as an "ends" array
into ".addNode(..., { ends: ["node1", "node2"] })".`,{lc_error_code:"UNREACHABLE_NODE"});for(let e of r)if(e!==d.END&&!(e in this.nodes))throw Error(`Found edge ending at unknown node \`${e}\``);if(e){for(let t of e)if(!(t in this.nodes))throw Error(`Interrupt node \`${t}\` is not present`)}this.compiled=!0}};class g extends l.Pregel{constructor({builder:e,...t}){super(t),Object.defineProperty(this,"builder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.builder=e}attachNode(e,t){this.channels[e]=new u.EphemeralValue,this.nodes[e]=new o.PregelNode({channels:[],triggers:[],metadata:t.metadata,subgraphs:t.subgraphs,ends:t.ends}).pipe(t.runnable).pipe(new c.ChannelWrite([{channel:e,value:c.PASSTHROUGH}],[d.TAG_HIDDEN])),this.streamChannels.push(e)}attachEdge(e,t){if(t===d.END){if(e===d.START)throw Error("Cannot have an edge from START to END");this.nodes[e].writers.push(new c.ChannelWrite([{channel:d.END,value:c.PASSTHROUGH}],[d.TAG_HIDDEN]))}else this.nodes[t].triggers.push(e),this.nodes[t].channels.push(e)}attachBranch(e,t,r){for(let n of(e!==d.START||this.nodes[d.START]||(this.nodes[d.START]=l.Channel.subscribeTo(d.START,{tags:[d.TAG_HIDDEN]})),this.nodes[e].pipe(r.run(r=>{let n=r.map(r=>(0,d._isSend)(r)?r:{channel:r===d.END?d.END:`branch:${e}:${t}:${r}`,value:c.PASSTHROUGH});return new c.ChannelWrite(n,[d.TAG_HIDDEN])})),r.ends?Object.values(r.ends):Object.keys(this.nodes)))if(n!==d.END){let r=`branch:${e}:${t}:${n}`;this.channels[r]=new u.EphemeralValue,this.nodes[n].triggers.push(r),this.nodes[n].channels.push(r)}}async getGraphAsync(e){let t=e?.xray,r=new i.Graph,n={[d.START]:r.addNode({schema:a.z.any()},d.START)},o={},l={};function u(e,t,i,s=!1){if(t===d.END&&void 0===o[d.END]&&(o[d.END]=r.addNode({schema:a.z.any()},d.END)),void 0!==n[e]){if(void 0===o[t])throw Error(`End node ${t} not found!`);return r.addEdge(n[e],o[t],i!==t?i:void 0,s)}}for(let[i,a]of(t&&(l=Object.fromEntries((await (0,p.gatherIterator)(this.getSubgraphsAsync())).filter(e=>y(e[1])))),Object.entries(this.builder.nodes))){let u=b(i),d=a.runnable,p=a.metadata??{};if(this.interruptBefore?.includes(i)&&this.interruptAfter?.includes(i)?p.__interrupt="before,after":this.interruptBefore?.includes(i)?p.__interrupt="before":this.interruptAfter?.includes(i)&&(p.__interrupt="after"),t){let a="number"==typeof t?t-1:t,h=void 0!==l[i]?await l[i].getGraphAsync({...e,xray:a}):d.getGraph(e);if(h.trimFirstNode(),h.trimLastNode(),Object.keys(h.nodes).length>1){let[e,t]=r.extend(h,u);if(void 0===e)throw Error(`Could not extend subgraph "${i}" due to missing entrypoint.`);function c(e,t){if(void 0!==e&&!(0,s.validate)(e))return e;if(!t||!t.lc_runnable)return t.name??"UnknownSchema";try{let e=t.getName();return e=e.startsWith("Runnable")?e.slice(8):e}catch(e){return t.getName()}}void 0!==t&&(n[u]={name:c(t.id,t.data),...t}),o[u]={name:c(e.id,e.data),...e}}else{let e=r.addNode(d,u,p);n[u]=e,o[u]=e}}else{let e=r.addNode(d,u,p);n[u]=e,o[u]=e}}for(let[e,t]of[...this.builder.allEdges].sort(([e],[t])=>e<t?-1:+(t>e)))u(b(e),b(t));for(let[e,t]of Object.entries(this.builder.branches)){let r={...Object.fromEntries(Object.keys(this.builder.nodes).filter(t=>t!==e).map(e=>[b(e),b(e)])),[d.END]:d.END};for(let n of Object.values(t)){for(let[t,i]of Object.entries(void 0!==n.ends?n.ends:r))u(b(e),b(i),t,!0)}}for(let[e,t]of Object.entries(this.builder.nodes))if(void 0!==t.ends)for(let r of t.ends)u(b(e),b(r),void 0,!0);return r}getGraph(e){let t=e?.xray,r=new i.Graph,n={[d.START]:r.addNode({schema:a.z.any()},d.START)},o={},l={};function u(e,t,i,s=!1){return t===d.END&&void 0===o[d.END]&&(o[d.END]=r.addNode({schema:a.z.any()},d.END)),r.addEdge(n[e],o[t],i!==t?i:void 0,s)}for(let[i,a]of(t&&(l=Object.fromEntries((0,p.gatherIteratorSync)(this.getSubgraphs()).filter(e=>y(e[1])))),Object.entries(this.builder.nodes))){let u=b(i),d=a.runnable,p=a.metadata??{};if(this.interruptBefore?.includes(i)&&this.interruptAfter?.includes(i)?p.__interrupt="before,after":this.interruptBefore?.includes(i)?p.__interrupt="before":this.interruptAfter?.includes(i)&&(p.__interrupt="after"),t){let a="number"==typeof t?t-1:t,h=void 0!==l[i]?l[i].getGraph({...e,xray:a}):d.getGraph(e);if(h.trimFirstNode(),h.trimLastNode(),Object.keys(h.nodes).length>1){let[e,t]=r.extend(h,u);if(void 0===e)throw Error(`Could not extend subgraph "${i}" due to missing entrypoint.`);function c(e,t){if(void 0!==e&&!(0,s.validate)(e))return e;if(!t||!t.lc_runnable)return t.name??"UnknownSchema";try{let e=t.getName();return e=e.startsWith("Runnable")?e.slice(8):e}catch(e){return t.getName()}}void 0!==t&&(n[u]={name:c(t.id,t.data),...t}),o[u]={name:c(e.id,e.data),...e}}else{let e=r.addNode(d,u,p);n[u]=e,o[u]=e}}else{let e=r.addNode(d,u,p);n[u]=e,o[u]=e}}for(let[e,t]of[...this.builder.allEdges].sort(([e],[t])=>e<t?-1:+(t>e)))u(b(e),b(t));for(let[e,t]of Object.entries(this.builder.branches)){let r={...Object.fromEntries(Object.keys(this.builder.nodes).filter(t=>t!==e).map(e=>[b(e),b(e)])),[d.END]:d.END};for(let n of Object.values(t)){for(let[t,i]of Object.entries(void 0!==n.ends?n.ends:r))u(b(e),b(i),t,!0)}}return r}}function y(e){return"function"==typeof e.attachNode&&"function"==typeof e.attachEdge}function b(e){return"subgraph"===e?`"${e}"`:e}r.CompiledGraph=g},98472,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.NamedBarrierValueAfterFinish=r.NamedBarrierValue=r.areSetsEqual=void 0;let n=e.r(83134),i=e.r(99935);r.areSetsEqual=(e,t)=>e.size===t.size&&[...e].every(e=>t.has(e));class a extends i.BaseChannel{constructor(e){super(),Object.defineProperty(this,"lc_graph_name",{enumerable:!0,configurable:!0,writable:!0,value:"NamedBarrierValue"}),Object.defineProperty(this,"names",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"seen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.names=e,this.seen=new Set}fromCheckpoint(e){let t=new a(this.names);return void 0!==e&&(t.seen=new Set(e)),t}update(e){let t=!1;for(let r of e)if(this.names.has(r))this.seen.has(r)||(this.seen.add(r),t=!0);else throw new n.InvalidUpdateError(`Value ${JSON.stringify(r)} not in names ${JSON.stringify(this.names)}`);return t}get(){if(!(0,r.areSetsEqual)(this.names,this.seen))throw new n.EmptyChannelError}checkpoint(){return[...this.seen]}consume(){return!!(this.seen&&this.names&&(0,r.areSetsEqual)(this.seen,this.names))&&(this.seen=new Set,!0)}isAvailable(){return!!this.names&&(0,r.areSetsEqual)(this.names,this.seen)}}r.NamedBarrierValue=a;class s extends i.BaseChannel{constructor(e){super(),Object.defineProperty(this,"lc_graph_name",{enumerable:!0,configurable:!0,writable:!0,value:"NamedBarrierValueAfterFinish"}),Object.defineProperty(this,"names",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"seen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finished",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.names=e,this.seen=new Set,this.finished=!1}fromCheckpoint(e){let t=new s(this.names);if(void 0!==e){let[r,n]=e;t.seen=new Set(r),t.finished=n}return t}update(e){let t=!1;for(let r of e)if(this.names.has(r)&&!this.seen.has(r))this.seen.add(r),t=!0;else if(!this.names.has(r))throw new n.InvalidUpdateError(`Value ${JSON.stringify(r)} not in names ${JSON.stringify(this.names)}`);return t}get(){if(!this.finished||!(0,r.areSetsEqual)(this.names,this.seen))throw new n.EmptyChannelError}checkpoint(){return[[...this.seen],this.finished]}consume(){return!!(this.finished&&this.seen&&this.names&&(0,r.areSetsEqual)(this.seen,this.names))&&(this.seen=new Set,this.finished=!1,!0)}finish(){return!!(!this.finished&&this.names&&(0,r.areSetsEqual)(this.names,this.seen))&&(this.finished=!0,!0)}isAvailable(){return this.finished&&!!this.names&&(0,r.areSetsEqual)(this.names,this.seen)}}r.NamedBarrierValueAfterFinish=s},61967,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.schemaMetaRegistry=r.SchemaMetaRegistry=r.META_EXTRAS_DESCRIPTION_PREFIX=void 0,r.withLangGraph=function(e,t){if(t.reducer&&!t.default){let r=(0,n.getInteropZodDefaultGetter)(e);null!=r&&(t.default=r)}if(!t.reducer)return r.schemaMetaRegistry.extend(e,()=>t),e;{let n=Object.assign(e,{lg_reducer_schema:t.reducer?.schema??e});return r.schemaMetaRegistry.extend(n,()=>t),n}};let n=e.r(15225),i=e.r(69979),a=e.r(13180);r.META_EXTRAS_DESCRIPTION_PREFIX="lg:";class s{constructor(){Object.defineProperty(this,"_map",{enumerable:!0,configurable:!0,writable:!0,value:new WeakMap}),Object.defineProperty(this,"_extensionCache",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}get(e){return this._map.get(e)}extend(e,t){let r=this.get(e);this._map.set(e,t(r))}remove(e){return this._map.delete(e),this}has(e){return this._map.has(e)}getChannelsForSchema(e){let t={};for(let[r,s]of Object.entries((0,n.getInteropZodObjectShape)(e))){let e=this.get(s);e?.reducer?t[r]=new i.BinaryOperatorAggregate(e.reducer.fn,e.default):t[r]=new a.LastValue}return t}getExtendedChannelSchemas(e,t){if(0===Object.keys(t).length)return e;let i=Object.entries(t).filter(([,e])=>!0===e).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>`${e}:${t}`).join("|"),a=this._extensionCache.get(i)??new WeakMap;if(a.has(e))return a.get(e);let s=e;if(t.withReducerSchema||t.withJsonSchemaExtrasAsDescription){let i=Object.entries((0,n.getInteropZodObjectShape)(e)).map(([e,i])=>{let a=this.get(i),s=t.withReducerSchema?a?.reducer?.schema??i:i;if(t.withJsonSchemaExtrasAsDescription&&a?.jsonSchemaExtra){let e=(0,n.getSchemaDescription)(s)??(0,n.getSchemaDescription)(i),t=JSON.stringify({...a.jsonSchemaExtra,description:e});s=s.describe(`${r.META_EXTRAS_DESCRIPTION_PREFIX}${t}`)}return[e,s]});s=(0,n.extendInteropZodObject)(e,Object.fromEntries(i)),(0,n.isZodSchemaV3)(s)&&(s._def.unknownKeys="strip")}return t.asPartial&&(s=(0,n.interopZodObjectPartial)(s)),a.set(e,s),this._extensionCache.set(i,a),s}}r.SchemaMetaRegistry=s,r.schemaMetaRegistry=new s},47250,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CompiledStateGraph=r.StateGraph=void 0,r.typedNode=function(e,t){return(e,t)=>(Object.assign(e,{[Symbol.for("langgraph.state.node")]:t}),e)};let n=e.r(78541),i=e.r(15225),a=e.r(99935),s=e.r(93144),o=e.r(33514),l=e.r(4842),u=e.r(98472),c=e.r(95567),d=e.r(93053),p=e.r(45864),h=e.r(83134),f=e.r(74585),m=e.r(21995),g=e.r(13180),y=e.r(61967),b="__root__",_=Symbol.for("langgraph.state.partial");class v extends s.Graph{constructor(e,t){if(super(),Object.defineProperty(this,"channels",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"waitingEdges",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"_schemaDefinition",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaRuntimeDefinition",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inputDefinition",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inputRuntimeDefinition",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_outputDefinition",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_outputRuntimeDefinition",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaDefinitions",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"_metaRegistry",{enumerable:!0,configurable:!0,writable:!0,value:y.schemaMetaRegistry}),Object.defineProperty(this,"_configSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_configRuntimeSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),function(e){return"object"==typeof e&&null!=e&&"state"in e&&!!(0,i.isInteropZodObject)(e.state)&&(!("input"in e)||!!(0,i.isInteropZodObject)(e.input))&&(!("output"in e)||!!(0,i.isInteropZodObject)(e.output))}(e)){let t=this._metaRegistry.getChannelsForSchema(e.state),r=null!=e.input?this._metaRegistry.getChannelsForSchema(e.input):t,n=null!=e.output?this._metaRegistry.getChannelsForSchema(e.output):t;this._schemaDefinition=t,this._schemaRuntimeDefinition=e.state,this._inputDefinition=r,this._inputRuntimeDefinition=e.input??_,this._outputDefinition=n,this._outputRuntimeDefinition=e.output??e.state}else if((0,i.isInteropZodObject)(e)){let t=this._metaRegistry.getChannelsForSchema(e);this._schemaDefinition=t,this._schemaRuntimeDefinition=e,this._inputDefinition=t,this._inputRuntimeDefinition=_,this._outputDefinition=t,this._outputRuntimeDefinition=e}else if(function(e){return"object"==typeof e&&null!==e&&void 0===e.stateSchema&&void 0!==e.input&&void 0!==e.output}(e))this._schemaDefinition=e.input.spec,this._inputDefinition=e.input.spec,this._outputDefinition=e.output.spec;else if(function(e){return"object"==typeof e&&null!==e&&void 0!==e.stateSchema}(e))this._schemaDefinition=e.stateSchema.spec,this._inputDefinition=e.input?.spec??this._schemaDefinition,this._outputDefinition=e.output?.spec??this._schemaDefinition;else if(function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&Object.keys(e).length>0&&Object.values(e).every(e=>"function"==typeof e||(0,a.isBaseChannel)(e))}(e)||O(e)){let t=O(e)?e.spec:e;this._schemaDefinition=t}else if(function(e){return"object"==typeof e&&null!==e&&void 0!==e.channels}(e)){let t=function(e){let t={};for(let[r,n]of Object.entries(e))t[r]=(0,f.getChannel)(n);return t}(e.channels);this._schemaDefinition=t}else throw Error("Invalid StateGraph input. Make sure to pass a valid Annotation.Root or Zod schema.");this._inputDefinition??=this._schemaDefinition,this._outputDefinition??=this._schemaDefinition,this._addSchema(this._schemaDefinition),this._addSchema(this._inputDefinition),this._addSchema(this._outputDefinition),(0,i.isInteropZodObject)(t)&&(this._configRuntimeSchema=t)}get allEdges(){return new Set([...this.edges,...Array.from(this.waitingEdges).flatMap(([e,t])=>e.map(e=>[e,t]))])}_addSchema(e){if(!this._schemaDefinitions.has(e))for(let[t,r]of(this._schemaDefinitions.set(e,e),Object.entries(e))){let e;if(e="function"==typeof r?r():r,void 0!==this.channels[t]){if(this.channels[t]!==e&&"LastValue"!==e.lc_graph_name)throw Error(`Channel "${t}" already exists with a different type.`)}else this.channels[t]=e}}addNode(...e){let t=e.length>=1&&"string"!=typeof e[0]?Array.isArray(e[0])?e[0]:Object.entries(e[0]).map(([e,t])=>[e,t,t[Symbol.for("langgraph.state.node")]??void 0]):[[e[0],e[1],e[2]]];if(0===t.length)throw Error("No nodes provided in `addNode`");for(let[e,r,a]of t){let t;if(e in this.channels)throw Error(`${e} is already being used as a state attribute (a.k.a. a channel), cannot also be used as a node name.`);for(let t of[p.CHECKPOINT_NAMESPACE_SEPARATOR,p.CHECKPOINT_NAMESPACE_END])if(e.includes(t))throw Error(`"${t}" is a reserved character and is not allowed in node names.`);if(this.warnIfCompiled("Adding a node to a graph that has already been compiled. This will not be reflected in the compiled graph."),e in this.nodes)throw Error(`Node \`${e}\` already present.`);if(e===p.END||e===p.START)throw Error(`Node \`${e}\` is reserved.`);let s=this._schemaDefinition;a?.input!==void 0&&((0,i.isInteropZodObject)(a.input)?s=this._metaRegistry.getChannelsForSchema(a.input):void 0!==a.input.spec&&(s=a.input.spec)),void 0!==s&&this._addSchema(s),t=n.Runnable.isRunnable(r)?r:"function"==typeof r?new d.RunnableCallable({func:r,name:e,trace:!1}):(0,n._coerceToRunnable)(r);let o=a?.cachePolicy;"boolean"==typeof o&&(o=o?{}:void 0);let l={runnable:t,retryPolicy:a?.retryPolicy,cachePolicy:o,metadata:a?.metadata,input:s??this._schemaDefinition,subgraphs:(0,m.isPregelLike)(t)?[t]:a?.subgraphs,ends:a?.ends,defer:a?.defer};this.nodes[e]=l}return this}addEdge(e,t){if("string"==typeof e)return super.addEdge(e,t);for(let t of(this.compiled&&console.warn("Adding an edge to a graph that has already been compiled. This will not be reflected in the compiled graph."),e)){if(t===p.END)throw Error("END cannot be a start node");if(!Object.keys(this.nodes).some(e=>e===t))throw Error(`Need to add a node named "${t}" first`)}if(t===p.END)throw Error("END cannot be an end node");if(!Object.keys(this.nodes).some(e=>e===t))throw Error(`Need to add a node named "${t}" first`);return this.waitingEdges.add([e,t]),this}addSequence(e){let t,r=Array.isArray(e)?e:Object.entries(e).map(([e,t])=>[e,t,t[Symbol.for("langgraph.state.node")]??void 0]);if(0===r.length)throw Error("Sequence requires at least one node.");for(let[e,n,i]of r){if(e in this.nodes)throw Error(`Node names must be unique: node with the name "${e}" already exists.`);this.addNode(e,n,i),null!=t&&this.addEdge(t,e),t=e}return this}compile({checkpointer:e,store:t,cache:r,interruptBefore:n,interruptAfter:i,name:a,description:s}={}){this.validate([...Array.isArray(n)?n:[],...Array.isArray(i)?i:[]]);let o=Object.keys(this._schemaDefinitions.get(this._outputDefinition)),l=1===o.length&&o[0]===b?b:o,u=Object.keys(this.channels),d=1===u.length&&u[0]===b?b:u,h=new w({builder:this,checkpointer:e,interruptAfter:i,interruptBefore:n,autoValidate:!1,nodes:{},channels:{...this.channels,[p.START]:new c.EphemeralValue},inputChannels:p.START,outputChannels:l,streamChannels:d,streamMode:"updates",store:t,cache:r,name:a,description:s});for(let[e,t]of(h.attachNode(p.START),Object.entries(this.nodes)))h.attachNode(e,t);for(let[e]of(h.attachBranch(p.START,p.SELF,S(),{withReader:!1}),Object.entries(this.nodes)))h.attachBranch(e,p.SELF,S(),{withReader:!1});for(let[e,t]of this.edges)h.attachEdge(e,t);for(let[e,t]of this.waitingEdges)h.attachEdge(e,t);for(let[e,t]of Object.entries(this.branches))for(let[r,n]of Object.entries(t))h.attachBranch(e,r,n);return h.validate()}}r.StateGraph=v;class w extends s.CompiledGraph{constructor({description:e,...t}){super(t),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_metaRegistry",{enumerable:!0,configurable:!0,writable:!0,value:y.schemaMetaRegistry}),this.description=e}attachNode(e,t){let r;r=e===p.START?Object.entries(this.builder._schemaDefinitions.get(this.builder._inputDefinition)).map(([e])=>e):Object.keys(this.builder.channels);let n=[{value:o.PASSTHROUGH,mapper:new d.RunnableCallable({func:r.length&&r[0]===b?function(e){if((0,p.isCommand)(e))return e.graph===p.Command.PARENT?null:e._updateAsTuples();if(Array.isArray(e)&&e.length>0&&e.some(e=>(0,p.isCommand)(e))){let t=[];for(let r of e)if((0,p.isCommand)(r)){if(r.graph===p.Command.PARENT)continue;t.push(...r._updateAsTuples())}else t.push([b,r]);return t}return null!=e?[[b,e]]:null}:function t(n){if(!n)return null;if((0,p.isCommand)(n))return n.graph===p.Command.PARENT?null:n._updateAsTuples().filter(([e])=>r.includes(e));if(Array.isArray(n)&&n.length>0&&n.some(p.isCommand)){let e=[];for(let i of n)if((0,p.isCommand)(i)){if(i.graph===p.Command.PARENT)continue;e.push(...i._updateAsTuples().filter(([e])=>r.includes(e)))}else{let r=t(i);r&&e.push(...r??[])}return e}{if("object"==typeof n&&!Array.isArray(n))return Object.entries(n).filter(([e])=>r.includes(e));let t=Array.isArray(n)?"array":typeof n;throw new h.InvalidUpdateError(`Expected node "${e.toString()}" to return an object or an array containing at least one Command object, received ${t}`,{lc_error_code:"INVALID_GRAPH_NODE_RETURN_VALUE"})}},trace:!1,recurse:!1})}];if(e===p.START)this.nodes[e]=new l.PregelNode({tags:[p.TAG_HIDDEN],triggers:[p.START],channels:[p.START],writers:[new o.ChannelWrite(n,[p.TAG_HIDDEN])]});else{let r=t?.input??this.builder._schemaDefinition,i=Object.fromEntries(Object.keys(this.builder._schemaDefinitions.get(r)).map(e=>[e,e])),a=1===Object.keys(i).length&&b in i,s=`branch:to:${e}`;this.channels[s]=t?.defer?new g.LastValueAfterFinish:new c.EphemeralValue(!1),this.nodes[e]=new l.PregelNode({triggers:[s],channels:a?Object.keys(i):i,writers:[new o.ChannelWrite(n,[p.TAG_HIDDEN])],mapper:a?void 0:e=>Object.fromEntries(Object.entries(e).filter(([e])=>e in i)),bound:t?.runnable,metadata:t?.metadata,retryPolicy:t?.retryPolicy,cachePolicy:t?.cachePolicy,subgraphs:t?.subgraphs,ends:t?.ends})}}attachEdge(e,t){if(t!==p.END){if("string"==typeof e)this.nodes[e].writers.push(new o.ChannelWrite([{channel:`branch:to:${t}`,value:null}],[p.TAG_HIDDEN]));else if(Array.isArray(e)){let r=`join:${e.join("+")}:${t}`;for(let n of(this.channels[r]=this.builder.nodes[t].defer?new u.NamedBarrierValueAfterFinish(new Set(e)):new u.NamedBarrierValue(new Set(e)),this.nodes[t].triggers.push(r),e))this.nodes[n].writers.push(new o.ChannelWrite([{channel:r,value:n}],[p.TAG_HIDDEN]))}}}attachBranch(e,t,r,n={withReader:!0}){let i=async(t,r)=>{let n=t.filter(e=>e!==p.END);if(!n.length)return;let i=n.map(t=>(0,p._isSend)(t)?t:{channel:t===p.END?t:`branch:to:${t}`,value:e});await o.ChannelWrite.doWrite({...r,tags:(r.tags??[]).concat([p.TAG_HIDDEN])},i)};this.nodes[e].writers.push(r.run(i,n.withReader?e=>l.ChannelRead.doRead(e,this.streamChannels??this.outputChannels,!0):void 0))}async _validateInput(e){if(null==e)return e;let t=(()=>{let e=this.builder._inputRuntimeDefinition,t=this.builder._schemaRuntimeDefinition,r=e=>{if(null!=e)return this._metaRegistry.getExtendedChannelSchemas(e,{withReducerSchema:!0})};return(0,i.isInteropZodObject)(e)?r(e):e===_?(0,i.interopZodObjectPartial)(r(t)):void 0})();return(0,p.isCommand)(e)?(e.update&&null!=t&&(e.update=(0,i.interopParse)(t,e.update)),e):null!=t?(0,i.interopParse)(t,e):e}async _validateContext(e){let t=this.builder._configRuntimeSchema;return(0,i.isInteropZodObject)(t)&&(0,i.interopParse)(t,e),e}}function O(e){return"object"==typeof e&&null!==e&&"lc_graph_name"in e&&"AnnotationRoot"===e.lc_graph_name}function P(e){if((0,p._isSend)(e))return[e];let t=[];(0,p.isCommand)(e)?t.push(e):Array.isArray(e)&&t.push(...e.filter(p.isCommand));let r=[];for(let e of t){if(e.graph===p.Command.PARENT)throw new h.ParentCommand(e);(0,p._isSend)(e.goto)||"string"==typeof e.goto?r.push(e.goto):Array.isArray(e.goto)&&r.push(...e.goto)}return r}function S(){let e=new d.RunnableCallable({func:P,tags:[p.TAG_HIDDEN],trace:!1,recurse:!1,name:"<control_branch>"});return new s.Branch({path:e})}r.CompiledStateGraph=w},32139,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MessageGraph=r.REMOVE_ALL_MESSAGES=void 0,r.messagesStateReducer=s,r.pushMessage=function(e,t,r){let i=r?.stateKey??"messages";r?.stateKey===null&&(i=void 0);let a=(0,n.coerceMessageLikeToMessage)(e);if(!a.id)throw Error("Message ID is required.");let s=(Array.isArray(t.callbacks)?t.callbacks:void 0!==t.callbacks?t.callbacks.handlers:[]).find(e=>"name"in e&&"StreamMessagesHandler"===e.name);if(s){let e=t.metadata??{},r=(e.langgraph_checkpoint_ns??"").split("|");s._emit([r,e],a,void 0,!1)}return i&&t.configurable?.__pregel_send?.([[i,a]]),a};let n=e.r(22991),i=e.r(79403),a=e.r(47250);function s(e,t){let a,s=Array.isArray(e)?e:[e],o=Array.isArray(t)?t:[t],l=s.map(n.coerceMessageLikeToMessage),u=o.map(n.coerceMessageLikeToMessage);for(let e of l)(null===e.id||void 0===e.id)&&(e.id=(0,i.v4)(),e.lc_kwargs.id=e.id);for(let e=0;e<u.length;e+=1){let t=u[e];(null===t.id||void 0===t.id)&&(t.id=(0,i.v4)(),t.lc_kwargs.id=t.id),"remove"===t.getType()&&t.id===r.REMOVE_ALL_MESSAGES&&(a=e)}if(null!=a)return u.slice(a+1);let c=[...l],d=new Map(c.map((e,t)=>[e.id,t])),p=new Set;for(let e of u){let t=d.get(e.id);if(void 0!==t)"remove"===e.getType()?p.add(e.id):(p.delete(e.id),c[t]=e);else{if("remove"===e.getType())throw Error(`Attempting to delete a message with an ID that doesn't exist ('${e.id}')`);d.set(e.id,c.length),c.push(e)}}return c.filter(e=>!p.has(e.id))}r.REMOVE_ALL_MESSAGES="__remove_all__";class o extends a.StateGraph{constructor(){super({channels:{__root__:{reducer:s,default:()=>[]}}})}}r.MessageGraph=o},46923,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.REMOVE_ALL_MESSAGES=r.messagesStateReducer=r.MessageGraph=r.typedNode=r.CompiledStateGraph=r.StateGraph=r.Graph=r.AnnotationRoot=r.Annotation=void 0;var n=e.r(74585);Object.defineProperty(r,"Annotation",{enumerable:!0,get:function(){return n.Annotation}}),Object.defineProperty(r,"AnnotationRoot",{enumerable:!0,get:function(){return n.AnnotationRoot}});var i=e.r(93144);Object.defineProperty(r,"Graph",{enumerable:!0,get:function(){return i.Graph}});var a=e.r(47250);Object.defineProperty(r,"StateGraph",{enumerable:!0,get:function(){return a.StateGraph}}),Object.defineProperty(r,"CompiledStateGraph",{enumerable:!0,get:function(){return a.CompiledStateGraph}}),Object.defineProperty(r,"typedNode",{enumerable:!0,get:function(){return a.typedNode}});var s=e.r(32139);Object.defineProperty(r,"MessageGraph",{enumerable:!0,get:function(){return s.MessageGraph}}),Object.defineProperty(r,"messagesStateReducer",{enumerable:!0,get:function(){return s.messagesStateReducer}}),Object.defineProperty(r,"REMOVE_ALL_MESSAGES",{enumerable:!0,get:function(){return s.REMOVE_ALL_MESSAGES}})},3422,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.entrypoint=void 0,r.task=function(e,t){let r,n="string"==typeof e?{name:e,retry:void 0,cachePolicy:void 0}:e,{name:i,retry:a}=n;if((0,c.isAsyncGeneratorFunction)(t)||(0,c.isGeneratorFunction)(t))throw Error("Generators are disallowed as tasks. For streaming responses, use config.write.");let s=n.cachePolicy??("cache"in n?n.cache:void 0);return r="boolean"==typeof s?s?{}:void 0:s,(...e)=>(0,l.call)({func:t,name:i,retry:a,cache:r},...e)},r.getPreviousState=function(){let e=n.AsyncLocalStorageProviderSingleton.getRunnableConfig();return e.configurable?.[s.CONFIG_KEY_PREVIOUS_STATE]};let n=e.r(92595),i=e.r(94279),a=e.r(4842),s=e.r(45864),o=e.r(95567),l=e.r(46177),u=e.r(13180),c=e.r(93053),d=e.r(33514);r.entrypoint=function(e,t){let{name:r,checkpointer:n,store:p,cache:h}="string"==typeof e?{name:e,checkpointer:void 0,store:void 0}:e;if((0,c.isAsyncGeneratorFunction)(t)||(0,c.isGeneratorFunction)(t))throw Error("Generators are disallowed as entrypoints. For streaming responses, use config.write.");let f=(0,l.getRunnableForEntrypoint)(r,t);function m(e){return"object"==typeof e&&null!==e&&"__lg_type"in e&&"__pregel_final"===e.__lg_type}let g=new c.RunnableCallable({name:"pluckReturnValue",func:e=>m(e)?e.value:e}),y=new c.RunnableCallable({name:"pluckSaveValue",func:e=>m(e)?e.save:e}),b=new a.PregelNode({bound:f,triggers:[s.START],channels:[s.START],writers:[new d.ChannelWrite([{channel:s.END,value:d.PASSTHROUGH,mapper:g},{channel:s.PREVIOUS,value:d.PASSTHROUGH,mapper:y}],[s.TAG_HIDDEN])]});return new i.Pregel({name:r,checkpointer:n,nodes:{[r]:b},channels:{[s.START]:new o.EphemeralValue,[s.END]:new u.LastValue,[s.PREVIOUS]:new u.LastValue},inputChannels:s.START,outputChannels:s.END,streamChannels:s.END,streamMode:"updates",store:p,cache:h})},r.entrypoint.final=function({value:e,save:t}){return{value:e,save:t,__lg_type:"__pregel_final"}}},10640,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MessagesZodState=r.MessagesZodMeta=r.MessagesAnnotation=void 0;let n=e.r(32770),i=e.r(74585),a=e.r(32139),s=e.r(61967);r.MessagesAnnotation=i.Annotation.Root({messages:(0,i.Annotation)({reducer:a.messagesStateReducer,default:()=>[]})}),r.MessagesZodMeta={reducer:{fn:a.messagesStateReducer},jsonSchemaExtra:{langgraph_type:"messages"},default:()=>[]},r.MessagesZodState=n.z.object({messages:(0,s.withLangGraph)(n.z.custom(),r.MessagesZodMeta)})},25602,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.MessagesZodMeta=r.MessagesZodState=r.MessagesAnnotation=r.task=r.entrypoint=r.InMemoryStore=r.AsyncBatchedStore=r.BaseStore=r.BaseCheckpointSaver=r.emptyCheckpoint=r.copyCheckpoint=r.MemorySaver=r.isInterrupted=r.INTERRUPT=r.END=r.START=r.isCommand=r.Command=r.Send=r.BinaryOperatorAggregate=r.BaseChannel=r.Annotation=r.REMOVE_ALL_MESSAGES=r.addMessages=r.messagesStateReducer=r.typedNode=r.MessageGraph=r.CompiledStateGraph=r.StateGraph=r.Graph=void 0;var a=e.r(46923);Object.defineProperty(r,"Graph",{enumerable:!0,get:function(){return a.Graph}}),Object.defineProperty(r,"StateGraph",{enumerable:!0,get:function(){return a.StateGraph}}),Object.defineProperty(r,"CompiledStateGraph",{enumerable:!0,get:function(){return a.CompiledStateGraph}}),Object.defineProperty(r,"MessageGraph",{enumerable:!0,get:function(){return a.MessageGraph}}),Object.defineProperty(r,"typedNode",{enumerable:!0,get:function(){return a.typedNode}}),Object.defineProperty(r,"messagesStateReducer",{enumerable:!0,get:function(){return a.messagesStateReducer}}),Object.defineProperty(r,"addMessages",{enumerable:!0,get:function(){return a.messagesStateReducer}}),Object.defineProperty(r,"REMOVE_ALL_MESSAGES",{enumerable:!0,get:function(){return a.REMOVE_ALL_MESSAGES}}),Object.defineProperty(r,"Annotation",{enumerable:!0,get:function(){return a.Annotation}}),i(e.r(83134),r);var s=e.r(22762);Object.defineProperty(r,"BaseChannel",{enumerable:!0,get:function(){return s.BaseChannel}}),Object.defineProperty(r,"BinaryOperatorAggregate",{enumerable:!0,get:function(){return s.BinaryOperatorAggregate}});var o=e.r(45864);Object.defineProperty(r,"Send",{enumerable:!0,get:function(){return o.Send}}),Object.defineProperty(r,"Command",{enumerable:!0,get:function(){return o.Command}}),Object.defineProperty(r,"isCommand",{enumerable:!0,get:function(){return o.isCommand}}),Object.defineProperty(r,"START",{enumerable:!0,get:function(){return o.START}}),Object.defineProperty(r,"END",{enumerable:!0,get:function(){return o.END}}),Object.defineProperty(r,"INTERRUPT",{enumerable:!0,get:function(){return o.INTERRUPT}}),Object.defineProperty(r,"isInterrupted",{enumerable:!0,get:function(){return o.isInterrupted}});var l=e.r(77978);Object.defineProperty(r,"MemorySaver",{enumerable:!0,get:function(){return l.MemorySaver}}),Object.defineProperty(r,"copyCheckpoint",{enumerable:!0,get:function(){return l.copyCheckpoint}}),Object.defineProperty(r,"emptyCheckpoint",{enumerable:!0,get:function(){return l.emptyCheckpoint}}),Object.defineProperty(r,"BaseCheckpointSaver",{enumerable:!0,get:function(){return l.BaseCheckpointSaver}}),Object.defineProperty(r,"BaseStore",{enumerable:!0,get:function(){return l.BaseStore}}),Object.defineProperty(r,"AsyncBatchedStore",{enumerable:!0,get:function(){return l.AsyncBatchedStore}}),Object.defineProperty(r,"InMemoryStore",{enumerable:!0,get:function(){return l.InMemoryStore}});var u=e.r(3422);Object.defineProperty(r,"entrypoint",{enumerable:!0,get:function(){return u.entrypoint}}),Object.defineProperty(r,"task",{enumerable:!0,get:function(){return u.task}});var c=e.r(10640);Object.defineProperty(r,"MessagesAnnotation",{enumerable:!0,get:function(){return c.MessagesAnnotation}}),Object.defineProperty(r,"MessagesZodState",{enumerable:!0,get:function(){return c.MessagesZodState}}),Object.defineProperty(r,"MessagesZodMeta",{enumerable:!0,get:function(){return c.MessagesZodMeta}})},86775,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.interrupt=function(e){let t=n.AsyncLocalStorageProviderSingleton.getRunnableConfig();if(!t)throw Error("Called interrupt() outside the context of a graph.");let r=t.configurable;if(!r)throw Error("No configurable found in config");if(!r[a.CONFIG_KEY_CHECKPOINTER])throw new i.GraphValueError("No checkpointer set");let o=r[a.CONFIG_KEY_SCRATCHPAD];o.interruptCounter+=1;let l=o.interruptCounter;if(o.resume.length>0&&l<o.resume.length)return r[a.CONFIG_KEY_SEND]?.([[a.RESUME,o.resume]]),o.resume[l];if(void 0!==o.nullResume){if(o.resume.length!==l)throw Error(`Resume length mismatch: ${o.resume.length} !== ${l}`);let e=o.consumeNullResume();return o.resume.push(e),r[a.CONFIG_KEY_SEND]?.([[a.RESUME,o.resume]]),e}let u=r[a.CONFIG_KEY_CHECKPOINT_NS]?.split(a.CHECKPOINT_NAMESPACE_SEPARATOR),c=u?(0,s.XXH3)(u.join(a.CHECKPOINT_NAMESPACE_SEPARATOR)):void 0;throw new i.GraphInterrupt([{id:c,value:e}])};let n=e.r(92595),i=e.r(83134),a=e.r(45864),s=e.r(6629)},16666,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.getCurrentTaskInput=r.getPreviousState=r.getConfig=r.getWriter=r.getStore=r.interrupt=void 0,(0,e.r(47035).initializeAsyncLocalStorageSingleton)(),i(e.r(25602),r);var a=e.r(86775);Object.defineProperty(r,"interrupt",{enumerable:!0,get:function(){return a.interrupt}});var s=e.r(94497);Object.defineProperty(r,"getStore",{enumerable:!0,get:function(){return s.getStore}}),Object.defineProperty(r,"getWriter",{enumerable:!0,get:function(){return s.getWriter}}),Object.defineProperty(r,"getConfig",{enumerable:!0,get:function(){return s.getConfig}});var o=e.r(3422);Object.defineProperty(r,"getPreviousState",{enumerable:!0,get:function(){return o.getPreviousState}});var l=e.r(94497);Object.defineProperty(r,"getCurrentTaskInput",{enumerable:!0,get:function(){return l.getCurrentTaskInput}})},23371,(e,t,r)=>{t.exports=e.r(16666)},67151,(e,t,r)=>{"use strict";function n(e){if(!e||"string"!=typeof e)return{thinking:null,cleanedContent:e||""};let t=/<think>([\s\S]*?)<\/think>/gi,r=[...e.matchAll(t)];if(0===r.length)return{thinking:null,cleanedContent:e};let n=r.map(e=>e[1].trim()).join("\n\n---\n\n"),i=e.replace(t,"");return{thinking:n,cleanedContent:i=i.trim().replace(/\n{3,}/g,"\n\n")}}function i(e,t="LLM"){if(!e||0===e.trim().length)return;let r="â•”"+"â•".repeat(78)+"â•—",n="â•š"+"â•".repeat(78)+"â•",a=`ðŸ’­ ${t} Thinking`;console.log("\n"+r),console.log("â•‘ "+a.padEnd(77)+"â•‘"),console.log("â• "+"â•".repeat(78)+"â•£"),e.split("\n").forEach(e=>{if(0===e.length)return void console.log("â•‘"+" ".repeat(78)+"â•‘");let t=e.split(" "),r="";t.forEach(e=>{(r+" "+e).length>74?(console.log("â•‘ "+r.padEnd(77)+"â•‘"),r=e):r=r?r+" "+e:e}),r&&console.log("â•‘ "+r.padEnd(77)+"â•‘")}),console.log(n+"\n")}Object.defineProperty(r,"__esModule",{value:!0}),r.extractThinking=n,r.logThinking=i,r.extractAndLogThinking=function(e,t="LLM"){let{thinking:r,cleanedContent:a}=n(e);return r&&i(r,t),a}},80166,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.routerNode=void 0;let i=e.r(67151);r.routerNode=e=>n(void 0,void 0,void 0,function*(){var t,r,n,a;let s=(null==(t=e.messages[e.messages.length-1])?void 0:t.content)||(null==(r=e.query)?void 0:r.message)||"",o=e.redInstance,l=null==(n=e.options)?void 0:n.conversationId,u=null==(a=e.options)?void 0:a.generationId;yield o.logger.log({level:"info",category:"router",message:`<cyan>ðŸ§­ Analyzing query:</cyan> <dim>${s.substring(0,80)}${s.length>80?"...":""}</dim>`,generationId:u,conversationId:l});let c="";if(l){let e=yield o.memory.getExecutiveSummary(l);e&&(c=`

Conversation Context: ${e}`)}try{let e=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),t=yield o.localModel.invoke([{role:"system",content:`You are a routing assistant for Red.

          TODAY'S DATE: ${e}

          ${c?`CONVERSATION SUMMARY: ${c}`:""}

          Classify the user's message into only one of the following categories:

          1. WEB_SEARCH - Query needs current/recent information
          2. SCRAPE_URL - Query contains a URL to read  
          3. SYSTEM_COMMAND - Query asks to execute a command
          4. CHAT - Everything else (greetings, questions, explanations)

          Reply with ONLY ONE of: CHAT, WEB_SEARCH, SCRAPE_URL: [url], SYSTEM_COMMAND: [command]

          You may use <think> tags for reasoning, but put the answer outside the tags.`},{role:"user",content:s}]);console.log("[Router] Raw Ollama output:",JSON.stringify({content:t.content,type:typeof t.content,length:t.content.toString().length},null,2));let r=t.content.toString().trim(),{thinking:n,cleanedContent:a}=(0,i.extractThinking)(r);(0,i.logThinking)(n,"Router"),n&&u&&l&&(yield o.logger.logThought({content:n,source:"router",generationId:u,conversationId:l}));let d=[{pattern:/\b(SCRAPE_URL:\s*https?:\/\/[^\s<]+)/i,name:"SCRAPE_URL"},{pattern:/\b(SYSTEM_COMMAND:\s*[^\n<]+)/i,name:"SYSTEM_COMMAND"},{pattern:/\b(WEB_SEARCH)\b/i,name:"WEB_SEARCH"},{pattern:/\b(CHAT)\b/i,name:"CHAT"}],p="";for(let{pattern:e,name:t}of d){let r=a.match(e);if(r){p=r[1].toUpperCase().trim(),console.log(`[Router] Found ${t} in response:`,p);break}}if(!p&&n)for(let{pattern:e,name:t}of(console.log("[Router] No decision outside thinking tags, checking inside..."),d)){let r=n.match(e);if(r){p=r[1].toUpperCase().trim(),console.log(`[Router] Found ${t} in thinking:`,p);break}}if(console.log("[Router] Final decision:",p),p.startsWith("WEB_SEARCH"))return yield o.logger.log({level:"success",category:"router",message:`<green>â†’ Route:</green> <bold>WEB_SEARCH</bold>`,generationId:u,conversationId:l,metadata:{decision:"WEB_SEARCH",nextGraph:"toolPicker",toolAction:"web_search"}}),{nextGraph:"toolPicker",toolAction:"web_search"};if(p.startsWith("SCRAPE_URL")){let e=p.match(/SCRAPE_URL:\s*(.+)$/i),t=e?e[1].trim():"";return yield o.logger.log({level:"success",category:"router",message:`<green>â†’ Route:</green> <bold>SCRAPE_URL</bold> <dim>${t}</dim>`,generationId:u,conversationId:l,metadata:{decision:"SCRAPE_URL",url:t,nextGraph:"toolPicker",toolAction:"scrape_url"}}),{nextGraph:"toolPicker",toolAction:"scrape_url",toolParam:t}}if(p.startsWith("SYSTEM_COMMAND")){let e=p.match(/SYSTEM_COMMAND:\s*(.+)$/i),t=e?e[1].trim():"";return yield o.logger.log({level:"success",category:"router",message:`<green>â†’ Route:</green> <bold>SYSTEM_COMMAND</bold> <dim>${t}</dim>`,generationId:u,conversationId:l,metadata:{decision:"SYSTEM_COMMAND",command:t,nextGraph:"toolPicker",toolAction:"system_command"}}),{nextGraph:"toolPicker",toolAction:"system_command",toolParam:t}}return yield o.logger.log({level:"success",category:"router",message:`<green>â†’ Route:</green> <bold>CHAT</bold>`,generationId:u,conversationId:l,metadata:{decision:"CHAT",nextGraph:"chat"}}),{nextGraph:"chat"}}catch(t){let e=t instanceof Error?t.message:String(t);return yield o.logger.log({level:"error",category:"router",message:`<red>âœ— Router error:</red> ${e} <dim>(defaulting to CHAT)</dim>`,generationId:u,conversationId:l,metadata:{error:e}}),{nextGraph:"chat"}}})},86272,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.chatNode=void 0;let i=e.r(67151);r.chatNode=e=>n(void 0,void 0,void 0,function*(){var t,r,n,a;try{let n=e.redInstance,a=e.query,s=e.options||{},o=s.conversationId,l=s.generationId;yield n.logger.log({level:"info",category:"chat",message:`<cyan>ðŸ’¬ Generating response...</cyan>`,generationId:l,conversationId:o});let u=n.localModel,c=[...e.messages||[]];console.log("[Chat] Initial messages from state:",c.length);let d=c.some(e=>{var t;return("user"===e.role||(null==(t=e._getType)?void 0:t.call(e))==="human")&&e.content===a.message});if(console.log("[Chat] User query already in messages?",d),!d){let t=[];if(e.systemMessage&&t.push({role:"system",content:e.systemMessage}),o){let e=yield n.memory.getContextSummary(o),r=yield n.memory.getContextForConversation(o);console.log("[Chat] Loaded from memory - Summary:",!!e,"Recent messages:",r.length),console.log("[Chat] Recent messages:",r.map(e=>{var t;return{role:e.role,content:null==(t=e.content)?void 0:t.substring(0,30)}})),e&&t.push({role:"user",content:`[Previous conversation context: ${e}]`});let i=r.filter(e=>"user"!==e.role||e.content!==a.message);console.log("[Chat] Filtered out current message, remaining:",i.length),t.push(...i.map(e=>({role:e.role,content:e.content})))}c=[...t,...c],a&&a.message&&c.push({role:"user",content:a.message})}console.log("[Chat] Final message count before LLM:",c.length),console.log("[Chat] Last 3 messages:",c.slice(-3).map(e=>{var t;return{role:e.role,content:null==(t=e.content)?void 0:t.substring(0,50)}}));let p=yield u.invoke(c);if("string"==typeof p.content){let{thinking:e,cleanedContent:a}=(0,i.extractThinking)(p.content);(0,i.logThinking)(e,"Chat"),e&&l&&o&&(yield n.logger.logThought({content:e,source:"chat",generationId:l,conversationId:o})),yield n.logger.log({level:"success",category:"chat",message:`<green>âœ“ Response generated</green> <dim>(${a.length} chars, ${(null==(t=p.usage_metadata)?void 0:t.total_tokens)||0} tokens)</dim>`,generationId:l,conversationId:o,metadata:{contentLength:a.length,tokens:p.usage_metadata,model:null==(r=p.response_metadata)?void 0:r.model}}),p.content=a}return{response:p,messages:[p]}}catch(s){let t=s instanceof Error?s.message:String(s),r=null==(n=e.options)?void 0:n.generationId,i=null==(a=e.options)?void 0:a.conversationId;return r&&i&&(yield e.redInstance.logger.log({level:"error",category:"chat",message:`<red>âœ— Chat error:</red> ${t}`,generationId:r,conversationId:i,metadata:{error:t}})),{response:{content:"Error processing request."},messages:[]}}})},99933,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ToolExecutor=void 0;let n=e.r(78541);class i extends n.RunnableBinding{constructor(e){let t={invalidToolMsgTemplate:"{requestedToolName} is not a valid tool, try one of {availableToolNamesString}.",...e};super({bound:n.RunnableLambda.from(async(e,t)=>this._execute(e,t)),config:{}}),Object.defineProperty(this,"lc_graph_name",{enumerable:!0,configurable:!0,writable:!0,value:"ToolExecutor"}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"toolMap",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"invalidToolMsgTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tools=t.tools,this.invalidToolMsgTemplate=t.invalidToolMsgTemplate,this.toolMap=this.tools.reduce((e,t)=>(e[t.name]=t,e),{})}async _execute(e,t){if(!(e.tool in this.toolMap))return this.invalidToolMsgTemplate.replace("{requestedToolName}",e.tool).replace("{availableToolNamesString}",Object.keys(this.toolMap).join(", "));{let r=this.toolMap[e.tool];return await r.invoke(e.toolInput,t)}}}r.ToolExecutor=i},30065,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createAgentExecutor=function({agentRunnable:e,tools:t}){let r;r=Array.isArray(t)?new n.ToolExecutor({tools:t}):t;let s=async(t,r)=>({agentOutcome:await e.invoke(t,r)}),o=async(e,t)=>{let n=e.agentOutcome;if(!n||"returnValues"in n)throw Error("Agent has not been run yet");let i=await r.invoke(n,t);return{steps:[{action:n,observation:i}]}};return new i.StateGraph({channels:{input:null,agentOutcome:null,steps:{reducer:(e,t)=>e.concat(t),default:()=>[]}}}).addNode("agent",s).addNode("action",o).addEdge(a.START,"agent").addConditionalEdges("agent",e=>e.agentOutcome&&"returnValues"in e.agentOutcome?"end":"continue",{continue:"action",end:a.END}).addEdge("action","agent").compile()};let n=e.r(99933),i=e.r(47250),a=e.r(45864)},89319,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createFunctionCallingExecutor=function({model:e,tools:t}){let r,u;if(Array.isArray(t)?(r=new s.ToolExecutor({tools:t}),u=t):(r=t,u=t.tools),!("bind"in e)||"function"!=typeof e.bind)throw Error("Model must be bindable");let c=u.map(e=>(0,n.convertToOpenAIFunction)(e)),d=e.bind({functions:c}),p=async(e,t)=>{let{messages:r}=e;return{messages:[await d.invoke(r,t)]}},h=async(e,t)=>{let n=(e=>{let{messages:t}=e,r=t[t.length-1];if(!r)throw Error("No messages found.");if(!r.additional_kwargs.function_call)throw Error("No function call found in message.");return{tool:r.additional_kwargs.function_call.name,toolInput:JSON.stringify(r.additional_kwargs.function_call.arguments),log:""}})(e),a=await r.invoke(n,t);return{messages:[new i.FunctionMessage({content:a,name:n.tool})]}};return new o.StateGraph({channels:{messages:{value:(e,t)=>e.concat(t),default:()=>[]}}}).addNode("agent",new a.RunnableLambda({func:p})).addNode("action",new a.RunnableLambda({func:h})).addEdge(l.START,"agent").addConditionalEdges("agent",e=>{let{messages:t}=e,r=t[t.length-1];return"function_call"in r.additional_kwargs&&r.additional_kwargs.function_call?"continue":"end"},{continue:"action",end:l.END}).addEdge("action","agent").compile()};let n=e.r(42200),i=e.r(22991),a=e.r(78541),s=e.r(99933),o=e.r(47250),l=e.r(45864)},87434,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ToolNode=void 0,r.toolsCondition=function(e){let t=Array.isArray(e)?e[e.length-1]:e.messages[e.messages.length-1];return void 0!==t&&"tool_calls"in t&&(t.tool_calls?.length??0)>0?"tools":s.END};let n=e.r(22991),i=e.r(93053),a=e.r(83134),s=e.r(45864),o=e=>Array.isArray(e)&&e.every(n.isBaseMessage);class l extends i.RunnableCallable{constructor(e,t){let{name:r,tags:n,handleToolErrors:i}=t??{};super({name:r,tags:n,func:(e,t)=>this.run(e,t)}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"handleToolErrors",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"trace",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.tools=e,this.handleToolErrors=i??this.handleToolErrors}async runTool(e,t){let r=this.tools.find(t=>t.name===e.name);try{if(void 0===r)throw Error(`Tool "${e.name}" not found.`);let i=await r.invoke({...e,type:"tool_call"},t);if((0,n.isBaseMessage)(i)&&"tool"===i.getType()||(0,s.isCommand)(i))return i;return new n.ToolMessage({status:"success",name:r.name,content:"string"==typeof i?i:JSON.stringify(i),tool_call_id:e.id})}catch(t){if(!this.handleToolErrors||(0,a.isGraphInterrupt)(t))throw t;return new n.ToolMessage({status:"error",content:`Error: ${t.message}
 Please fix your mistakes.`,name:e.name,tool_call_id:e.id??""})}}async run(e,t){let r;if("object"==typeof e&&null!=e&&"lg_tool_call"in e)r=[await this.runTool(e.lg_tool_call,t)];else{let n,i;if(o(e))n=e;else if("object"==typeof e&&null!=e&&"messages"in e&&o(e.messages))n=e.messages;else throw Error("ToolNode only accepts BaseMessage[] or { messages: BaseMessage[] } as input.");let a=new Set(n.filter(e=>"tool"===e.getType()).map(e=>e.tool_call_id));for(let e=n.length-1;e>=0;e-=1){let t=n[e];if("ai"===t.getType()){i=t;break}}if(i?.getType()!=="ai")throw Error("ToolNode only accepts AIMessages as input.");r=await Promise.all(i.tool_calls?.filter(e=>null==e.id||!a.has(e.id)).map(e=>this.runTool(e,t))??[])}if(!r.some(s.isCommand))return Array.isArray(e)?r:{messages:r};let n=[],i=null;for(let t of r)(0,s.isCommand)(t)?t.graph===s.Command.PARENT&&Array.isArray(t.goto)&&t.goto.every(e=>(0,s._isSend)(e))?i?i.goto.push(...t.goto):i=new s.Command({graph:s.Command.PARENT,goto:t.goto}):n.push(t):n.push(Array.isArray(e)?[t]:{messages:[t]});return i&&n.push(i),n}}r.ToolNode=l},83157,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r._addInlineAgentName=o,r._removeInlineAgentName=l,r.withAgentName=function(e,t){let r,n;if("inline"===t)r=o,n=l;else throw Error(`Invalid agent name mode: ${t}. Needs to be one of: "inline"`);return i.RunnableSequence.from([i.RunnableLambda.from(function(e){return e.map(r)}),e,i.RunnableLambda.from(n)])};let n=e.r(22991),i=e.r(78541),a=/<name>(.*?)<\/name>/s,s=/<content>(.*?)<\/content>/s;function o(e){if(!((0,n.isBaseMessage)(e)&&((0,n.isAIMessage)(e)||(0,n.isBaseMessageChunk)(e)&&(0,n.isAIMessageChunk)(e)))||!e.name)return e;let{name:t}=e;if("string"==typeof e.content)return new n.AIMessage({...Object.keys(e.lc_kwargs??{}).length>0?e.lc_kwargs:e,content:`<name>${t}</name><content>${e.content}</content>`,name:void 0});let r=[],i=0;for(let n of e.content)"string"==typeof n?(i+=1,r.push(`<name>${t}</name><content>${n}</content>`)):"object"==typeof n&&"type"in n&&"text"===n.type?(i+=1,r.push({...n,text:`<name>${t}</name><content>${n.text}</content>`})):r.push(n);return i||r.unshift({type:"text",text:`<name>${t}</name><content></content>`}),new n.AIMessage({...e.lc_kwargs,content:r,name:void 0})}function l(e){let t;if(!(0,n.isAIMessage)(e)||!e.content)return e;let r=[];if(Array.isArray(e.content))r=e.content.filter(e=>{if("text"===e.type){let r=e.text.match(a),n=e.text.match(s);if(r&&(!n||""===n[1]))return t=r[1],!1}return!0}).map(e=>{if("text"===e.type){let r=e.text.match(a),n=e.text.match(s);return r&&n?(t=r[1],{...e,text:n[1]}):e}return e});else{let n=e.content,i=n.match(a),o=n.match(s);if(!i||!o)return e;t=i[1],r=o[1]}return new n.AIMessage({...Object.keys(e.lc_kwargs??{}).length>0?e.lc_kwargs:e,content:r,name:t})}},32042,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createReactAgentAnnotation=void 0,r._shouldBindTools=y,r._bindTools=_,r._getModel=v,r.createReactAgent=function(e){let t,i,l,{llm:d,tools:m,messageModifier:g,stateModifier:b,prompt:O,stateSchema:P,contextSchema:S,checkpointSaver:E,checkpointer:k,interruptBefore:I,interruptAfter:A,store:T,responseFormat:C,preModelHook:j,postModelHook:x,name:$,description:N,version:R="v1",includeAgentName:M}=e;Array.isArray(m)?(t=m,i=new s.ToolNode(t.filter(p))):(t=m.tools,i=m);let D=null,L=async e=>{let r;if(D)return D;r=await y(e,t)?await _(e,t):e;let n=h(O,b,g),i="inline"===M?(0,c.withAgentName)(r,M):r;return D=n.pipe(i)},U=async(e,t,r)=>{let n=await e(t,r);return h(O,b,g).pipe("inline"===M?(0,c.withAgentName)(n,M):n)},F=new Set(t.filter(p).filter(e=>"returnDirect"in e&&e.returnDirect).map(e=>e.name)),z=async(e,t)=>{let r;if(null==C)throw Error("Attempted to generate structured output with no passed response schema. Please contact us for help.");let i=[...e.messages],a="function"==typeof d?await d(e,t):await v(d);if(!f(a))throw Error(`Expected \`llm\` to be a ChatModel with .withStructuredOutput() method, got ${a.constructor.name}`);if("object"==typeof C&&"schema"in C){let{prompt:e,schema:t,...s}=C;r=a.withStructuredOutput(t,s),null!=e&&i.unshift(new n.SystemMessage({content:e}))}else r=a.withStructuredOutput(C);return{structuredResponse:await r.invoke(i,t)}},B=async(e,t)=>{let r="function"==typeof d?await U(d,e,t):await L(d),n=await r.invoke(function(e){let{messages:t,llmInputMessages:r,...n}=e;return null!=r&&r.length>0?{messages:r,...n}:{messages:t,...n}}(e),t);return n.name=$,n.lc_kwargs.name=$,{messages:[n]}},G=P??(0,r.createReactAgentAnnotation)(),Z=new a.StateGraph(G,S).addNode("tools",i);if(!("messages"in Z._schemaDefinition))throw Error("Missing required `messages` key in state schema.");let K=e=>Object.fromEntries(Object.entries(e).filter(([e,t])=>null!=t)),V="agent";return null!=j?(Z.addNode("pre_model_hook",j).addEdge("pre_model_hook","agent"),V="pre_model_hook",l=o.Annotation.Root({...Z._schemaDefinition,...w.spec})):V="agent",Z.addNode("agent",B,{input:l}).addEdge(u.START,V),null!=x&&Z.addNode("post_model_hook",x).addEdge("agent","post_model_hook").addConditionalEdges("post_model_hook",e=>{let t,{messages:r}=e,i=new Set(r.filter(n.isToolMessage).map(e=>e.tool_call_id));for(let e=r.length-1;e>=0;e-=1){let i=r[e];if((0,n.isAIMessage)(i)){t=i;break}}let a=t?.tool_calls?.filter(e=>null==e.id||!i.has(e.id))??[],s=r.at(-1);return a.length>0?"v2"===R?a.map(t=>new u.Send("tools",{...e,lg_tool_call:t})):"tools":s&&(0,n.isToolMessage)(s)?V:null!=C?"generate_structured_response":u.END},K({tools:"tools",[V]:V,generate_structured_response:null!=C?"generate_structured_response":null,[u.END]:null!=C?null:u.END})),void 0!==C&&Z.addNode("generate_structured_response",z).addEdge("generate_structured_response",u.END),null==x&&Z.addConditionalEdges("agent",e=>{let{messages:t}=e,r=t[t.length-1];return(0,n.isAIMessage)(r)&&r.tool_calls?.length?"v2"===R?r.tool_calls.map(t=>new u.Send("tools",{...e,lg_tool_call:t})):"tools":null!=C?"generate_structured_response":u.END},K({tools:"tools",generate_structured_response:null!=C?"generate_structured_response":null,[u.END]:null!=C?null:u.END})),F.size>0?Z.addConditionalEdges("tools",e=>{for(let t=e.messages.length-1;t>=0;t-=1){let r=e.messages[t];if(!(0,n.isToolMessage)(r))break;if(void 0!==r.name&&F.has(r.name))return u.END}return V},K({[V]:V,[u.END]:u.END})):Z.addEdge("tools",V),Z.compile({checkpointer:k??E,interruptBefore:I,interruptAfter:A,store:T,name:$,description:N})};let n=e.r(22991),i=e.r(78541),a=e.r(46923),s=e.r(87434),o=e.r(74585),l=e.r(32139),u=e.r(45864),c=e.r(83157),d="prompt";function p(e){return i.Runnable.isRunnable(e)}function h(e,t,r){let a;if([e,t,r].filter(e=>null!=e).length>1)throw Error("Expected only one of prompt, stateModifier, or messageModifier, got multiple values");let s=e;null!=t?s=t:null!=r&&(s=function(e){if("string"==typeof e||(0,n.isBaseMessage)(e)&&"system"===e._getType())return e;if("function"==typeof e)return async t=>e(t.messages);if(i.Runnable.isRunnable(e))return i.RunnableLambda.from(e=>e.messages).pipe(e);throw Error(`Unexpected type for messageModifier: ${typeof e}`)}(r));var o=s;if(null==o)a=i.RunnableLambda.from(e=>e.messages).withConfig({runName:d});else if("string"==typeof o){let e=new n.SystemMessage(o);a=i.RunnableLambda.from(t=>[e,...t.messages??[]]).withConfig({runName:d})}else if((0,n.isBaseMessage)(o)&&"system"===o._getType())a=i.RunnableLambda.from(e=>[o,...e.messages]).withConfig({runName:d});else if("function"==typeof o)a=i.RunnableLambda.from(o).withConfig({runName:d});else if(i.Runnable.isRunnable(o))a=o;else throw Error(`Got unexpected type for 'prompt': ${typeof o}`);return a}function f(e){return"invoke"in e&&"function"==typeof e.invoke&&"_modelType"in e}function m(e){return"_queuedMethodOperations"in e&&"_model"in e&&"function"==typeof e._model}function g(e){return!!f(e)&&"bindTools"in e&&"function"==typeof e.bindTools}async function y(e,t){let r=e;if(i.RunnableSequence.isRunnableSequence(r)&&(r=r.steps.find(e=>i.RunnableBinding.isRunnableBinding(e)||f(e)||m(e))||r),m(r)&&(r=await r._model()),!i.RunnableBinding.isRunnableBinding(r))return!0;let n=null!=r.kwargs&&"object"==typeof r.kwargs&&"tools"in r.kwargs&&Array.isArray(r.kwargs.tools)?r.kwargs.tools??null:null!=r.config&&"object"==typeof r.config&&"tools"in r.config&&Array.isArray(r.config.tools)?r.config.tools??null:null;if(null!=n&&1===n.length&&"functionDeclarations"in n[0]&&(n=n[0].functionDeclarations),null==n)return!0;if(t.length!==n.length)throw Error("Number of tools in the model.bindTools() and tools passed to createReactAgent must match");let a=new Set(t.flatMap(e=>p(e)?e.name:[])),s=new Set;for(let e of n){let t;if("type"in e&&"function"===e.type)t=e.function.name;else if("name"in e)t=e.name;else{if(!("toolSpec"in e)||!("name"in e.toolSpec))continue;t=e.toolSpec.name}t&&s.add(t)}let o=[...a].filter(e=>!s.has(e));if(o.length>0)throw Error(`Missing tools '${o}' in the model.bindTools().Tools in the model.bindTools() must match the tools passed to createReactAgent.`);return!1}let b=(e,t)=>{if(g(e))return e.bindTools(t);if(i.RunnableBinding.isRunnableBinding(e)&&g(e.bound)){let r=e.bound.bindTools(t);return new i.RunnableBinding(i.RunnableBinding.isRunnableBinding(r)?{bound:r.bound,config:{...e.config,...r.config},kwargs:{...e.kwargs,...r.kwargs},configFactories:r.configFactories??e.configFactories}:{bound:r,config:e.config,kwargs:e.kwargs,configFactories:e.configFactories})}return null};async function _(e,t){let r=b(e,t);if(r)return r;if(m(e)){let r=b(await e._model(),t);if(r)return r}if(i.RunnableSequence.isRunnableSequence(e)){let r=e.steps.findIndex(e=>i.RunnableBinding.isRunnableBinding(e)||f(e)||m(e));if(r>=0){let n=b(e.steps[r],t);if(n){let t=e.steps.slice();return t.splice(r,1,n),i.RunnableSequence.from(t)}}}throw Error(`llm ${e} must define bindTools method.`)}async function v(e){let t=e;if(i.RunnableSequence.isRunnableSequence(t)&&(t=t.steps.find(e=>i.RunnableBinding.isRunnableBinding(e)||f(e)||m(e))||t),m(t)&&(t=await t._model()),i.RunnableBinding.isRunnableBinding(t)&&(t=t.bound),!f(t))throw Error(`Expected \`llm\` to be a ChatModel or RunnableBinding (e.g. llm.bind_tools(...)) with invoke() and generate() methods, got ${t.constructor.name}`);return t}r.createReactAgentAnnotation=()=>o.Annotation.Root({messages:(0,o.Annotation)({reducer:l.messagesStateReducer,default:()=>[]}),structuredResponse:o.Annotation});let w=o.Annotation.Root({llmInputMessages:(0,o.Annotation)({reducer:(e,t)=>(0,l.messagesStateReducer)([],t),default:()=>[]})})},58343,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.withAgentName=r.toolsCondition=r.ToolNode=r.ToolExecutor=r.createReactAgentAnnotation=r.createReactAgent=r.createFunctionCallingExecutor=r.createAgentExecutor=void 0;var n=e.r(30065);Object.defineProperty(r,"createAgentExecutor",{enumerable:!0,get:function(){return n.createAgentExecutor}});var i=e.r(89319);Object.defineProperty(r,"createFunctionCallingExecutor",{enumerable:!0,get:function(){return i.createFunctionCallingExecutor}});var a=e.r(32042);Object.defineProperty(r,"createReactAgent",{enumerable:!0,get:function(){return a.createReactAgent}}),Object.defineProperty(r,"createReactAgentAnnotation",{enumerable:!0,get:function(){return a.createReactAgentAnnotation}});var s=e.r(99933);Object.defineProperty(r,"ToolExecutor",{enumerable:!0,get:function(){return s.ToolExecutor}});var o=e.r(87434);Object.defineProperty(r,"ToolNode",{enumerable:!0,get:function(){return o.ToolNode}}),Object.defineProperty(r,"toolsCondition",{enumerable:!0,get:function(){return o.toolsCondition}});var l=e.r(83157);Object.defineProperty(r,"withAgentName",{enumerable:!0,get:function(){return l.withAgentName}})},48794,(e,t,r)=>{t.exports=e.r(58343)},77690,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.webSearchTool=void 0;let i=e.r(69045),a=e.r(99243),s=a.z.object({query:a.z.string().describe("The search query to look up on Google")});class o extends i.StructuredTool{constructor(){super(...arguments),this.name="web_search",this.description="Search the web using Google and get actual content from the pages. Use this when you need current information, facts, news, or data that you don't have in your training data. Returns up to 10 search results with titles, snippets, URLs, and relevant body content from each page.",this.schema=s}_call(e){return n(this,arguments,void 0,function*({query:e}){let t=Date.now();try{let r=process.env.GOOGLE_API_KEY,n=process.env.GOOGLE_SEARCH_ENGINE_ID||process.env.GOOGLE_CSE_ID;if(!r)return"Error: GOOGLE_API_KEY environment variable is not set. Cannot perform web search.";if(!n)return"Error: GOOGLE_SEARCH_ENGINE_ID or GOOGLE_CSE_ID environment variable is not set. Cannot perform web search.";console.log(`[Web Search Tool] Searching for: "${e}"`);let i=Date.now(),a=`https://www.googleapis.com/customsearch/v1?key=${r}&cx=${n}&q=${encodeURIComponent(e)}&num=10`,s=yield fetch(a),o=Date.now()-i;if(console.log(`[Web Search Tool] â±ï¸  Google search took ${o}ms`),!s.ok){let e=yield s.text();return`Error searching Google: ${s.status} ${s.statusText}. ${e}`}let l=yield s.json();if(!l.items||0===l.items.length)return`No results found for query: "${e}"`;console.log(`[Web Search Tool] Scraping ${l.items.length} results...`);let u=Date.now(),c=l.items.map(t=>this.scrapeUrl(t.link,e).catch(e=>`Error: ${e.message}`)),d=yield Promise.all(c),p=Date.now()-u;console.log(`[Web Search Tool] â±ï¸  Scraped ${l.items.length} pages in ${p}ms (${Math.round(p/l.items.length)}ms avg)`);let h=l.items.map((e,t)=>{let r=d[t];return`${t+1}. **${e.title}**
   Snippet: ${e.snippet}
   URL: ${e.link}
   
   Content:
   ${r}`}).join("\n\n---\n\n"),f=Date.now()-t;return console.log(`[Web Search Tool] â±ï¸  Total execution time: ${f}ms`),`Search results for "${e}":

${h}`}catch(r){let e=Date.now()-t;return console.error(`[Web Search Tool] Error after ${e}ms:`,r),`Error performing web search: ${r instanceof Error?r.message:String(r)}`}})}scrapeUrl(e,t){return n(this,void 0,void 0,function*(){let r=Date.now();try{let n=yield fetch(e,{headers:{"User-Agent":"Mozilla/5.0 (compatible; RedBot/1.0; +https://redbtn.io)"},signal:AbortSignal.timeout(8e3)});if(!n.ok)return console.log(`[Web Search Tool] â±ï¸  ${e} - Failed (${Date.now()-r}ms): HTTP ${n.status}`),`[Failed to fetch: HTTP ${n.status}]`;let i=n.headers.get("content-type")||"";if(!i.includes("text/html")&&!i.includes("text/plain"))return console.log(`[Web Search Tool] â±ï¸  ${e} - Skipped (${Date.now()-r}ms): ${i}`),`[Non-HTML content: ${i}]`;let a=yield n.text(),s=this.extractTextFromHtml(a);if(!s.trim())return console.log(`[Web Search Tool] â±ï¸  ${e} - Empty (${Date.now()-r}ms)`),"[No text content found]";let o=this.extractRelevantSections(s,t,1500),l=Date.now()-r;return console.log(`[Web Search Tool] â±ï¸  ${e} - Success (${l}ms, ${o.length} chars)`),o}catch(n){let t=Date.now()-r;if("AbortError"===n.name||"TimeoutError"===n.name)return console.log(`[Web Search Tool] â±ï¸  ${e} - Timeout (${t}ms)`),"[Timeout]";return console.log(`[Web Search Tool] â±ï¸  ${e} - Error (${t}ms): ${n.message}`),`[Error: ${n.message}]`}})}extractRelevantSections(e,t,r){let n=new Set(["a","an","the","is","are","was","were","be","been","being","have","has","had","do","does","did","will","would","should","could","may","might","what","when","where","who","which","why","how","for","to","of","in","on","at","by","with","from","about","as","into","through","during","before","after","above","below","between","under","again","further","then","once","here","there","all","any","both","each","few","more","most","other","some","such","no","nor","not","only","own","same","so","than","too","very","can","just","today","tonight","this","that"]),i=t.toLowerCase().split(/\s+/).filter(e=>e.length>2&&!n.has(e));if(0===i.length)return this.truncateToTokens(e,r);let a=e.match(/[^.!?]+[.!?]+/g)||[e],s=a.map(e=>{let t=e.toLowerCase(),r=0;for(let e of i){let n=RegExp(`\\b${e}\\w*\\b`,"gi"),i=t.match(n);i&&(r+=10*i.length)}return/\d+/.test(e)&&(r+=5),{sentence:e.trim(),score:r}});s.sort((e,t)=>t.score-e.score);let o="",l=new Set;for(let e of s)if(e.score>0&&!l.has(e.sentence)){let t=o+(o?" ":"")+e.sentence;if(this.estimateTokens(t)>r)break;o=t,l.add(e.sentence)}if(this.estimateTokens(o)<.5*r){let e=a.slice(0,10).map(e=>e.trim()).join(" ")+" ... "+o;return this.truncateToTokens(e,r)}return o||this.truncateToTokens(e,r)}estimateTokens(e){return Math.ceil(e.length/4)}extractTextFromHtml(e){let t=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi," ");return(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi," ")).replace(/<!--[\s\S]*?-->/g," ")).replace(/<[^>]+>/g," ")).replace(/&nbsp;/g," ")).replace(/&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&quot;/g,'"')).replace(/&#39;/g,"'")).replace(/&mdash;/g,"â€”")).replace(/&ndash;/g,"â€“")).replace(/\s+/g," ")).trim()}truncateToTokens(t,r){try{let{encoding_for_model:n}=e.r(11867),i=n("gpt-3.5-turbo"),a=i.encode(t);if(a.length<=r)return i.free(),t;let s=a.slice(0,r),o=new TextDecoder().decode(i.decode(s));return i.free(),o+"..."}catch(n){let e=4*r;if(t.length<=e)return t;return t.substring(0,e)+"..."}}}r.webSearchTool=new o},33405,(e,t,r)=>{t.exports=e.x("child_process",()=>require("child_process"))},50900,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.sendCommandTool=void 0;let i=e.r(69045),a=e.r(99243),s=e.r(33405),o=(0,e.r(24361).promisify)(s.exec),l=a.z.object({command:a.z.string().describe("The CLI command to execute (e.g., 'ls -la', 'pwd', 'echo hello')"),timeout:a.z.number().optional().describe("Optional timeout in milliseconds (default: 30000)")});class u extends i.StructuredTool{constructor(){super(...arguments),this.name="send_command",this.description="Execute a command line (CLI) command on the system. Use this to run shell commands, check system status, manage files, or interact with the operating system. Returns the command output (stdout/stderr). Use with caution as this executes real commands.",this.schema=l}_call(e){return n(this,arguments,void 0,function*({command:e,timeout:t=3e4}){let r=Date.now();try{for(let t of[/rm\s+-rf\s+\/($|\s)/,/:\(\)\{.*:\|:.*\};:/,/mkfs\./,/dd\s+if=/])if(t.test(e))return"Error: Command blocked for security reasons. This command pattern is not allowed.";console.log(`[Send Command Tool] Executing: ${e}`);let n=Date.now(),{stdout:i,stderr:a}=yield o(e,{timeout:t,maxBuffer:1048576,shell:"/bin/bash"}),s=Date.now()-n;console.log(`[Send Command Tool] â±ï¸  Command completed in ${s}ms`);let l="";i&&(l+=i),a&&(l+=(l?"\n":"")+`[STDERR]: ${a}`),l||(l="Command executed successfully with no output."),l.length>4e3&&(l=l.substring(0,4e3)+"\n\n... (output truncated)");let u=Date.now()-r;return console.log(`[Send Command Tool] â±ï¸  Total execution time: ${u}ms`),`Command: ${e}

Output:
${l}`}catch(a){let n=Date.now()-r;if(console.error(`[Send Command Tool] â±ï¸  Error after ${n}ms:`,a),a.killed&&"SIGTERM"===a.signal)return`Error: Command timed out after ${t}ms`;let i=`Error executing command: ${e}

`;return a.stdout&&(i+=`STDOUT:
${a.stdout}

`),a.stderr&&(i+=`STDERR:
${a.stderr}

`),a.code&&(i+=`Exit code: ${a.code}`),i.trim()}})}}r.sendCommandTool=new u},74526,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.scrapeUrlTool=void 0;let i=e.r(69045),a=e.r(99243),s=a.z.object({url:a.z.string().describe("The URL to scrape (must be http or https)")});class o extends i.StructuredTool{constructor(){super(...arguments),this.name="scrape_url",this.description="Fetch and extract text content from a webpage. Returns the main body text from the URL, limited to 1000 tokens.",this.schema=s}_call(t){return n(this,arguments,void 0,function*({url:t}){let r=Date.now();try{let n,i;try{n=new URL(t)}catch(e){return`Error: Invalid URL format: ${t}`}if(!["http:","https:"].includes(n.protocol))return"Error: Only HTTP and HTTPS protocols are allowed";console.log(`[Scrape URL Tool] Fetching: ${t}`);let a=yield fetch(t,{headers:{"User-Agent":"Mozilla/5.0 (compatible; RedBot/1.0; +https://redbtn.io)"},signal:AbortSignal.timeout(1e4)});if(!a.ok)return`Error: HTTP ${a.status} ${a.statusText}`;let s=a.headers.get("content-type")||"";if(!s.includes("text/html")&&!s.includes("text/plain"))return`Error: URL does not return HTML or text content (got: ${s})`;let o=i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(yield a.text()).replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi," ")).replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi," ")).replace(/<!--[\s\S]*?-->/g," ")).replace(/<[^>]+>/g," ")).replace(/&nbsp;/g," ")).replace(/&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&quot;/g,'"')).replace(/&#39;/g,"'")).replace(/&mdash;/g,"â€”")).replace(/&ndash;/g,"â€“")).replace(/\s+/g," ")).trim();if(!o.trim())return"Error: No text content found on the page";let l=function(t,r){try{let{encoding_for_model:n}=e.r(11867),i=n("gpt-3.5-turbo"),a=i.encode(t);if(a.length<=1e3)return i.free(),t;let s=a.slice(0,r),o=new TextDecoder().decode(i.decode(s));return i.free(),o+"\n\n... (content truncated to 1000 tokens)"}catch(n){let e=4*r;if(t.length<=e)return t;return t.substring(0,e)+"\n\n... (content truncated to ~1000 tokens)"}}(o,1e3),u=Date.now()-r;return console.log(`[Scrape URL Tool] â±ï¸  Scraped successfully in ${u}ms (${l.length} chars)`),`Content from ${t}:

${l}`}catch(t){let e=Date.now()-r;if(console.error(`[Scrape URL Tool] â±ï¸  Error after ${e}ms:`,t),"AbortError"===t.name||"TimeoutError"===t.name)return"Error: Request timed out after 10 seconds";return`Error scraping URL: ${t instanceof Error?t.message:String(t)}`}})}}r.scrapeUrlTool=new o},2823,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.scrapeUrlTool=r.sendCommandTool=r.webSearchTool=r.allTools=void 0;let n=e.r(77690);Object.defineProperty(r,"webSearchTool",{enumerable:!0,get:function(){return n.webSearchTool}});let i=e.r(50900);Object.defineProperty(r,"sendCommandTool",{enumerable:!0,get:function(){return i.sendCommandTool}});let a=e.r(74526);Object.defineProperty(r,"scrapeUrlTool",{enumerable:!0,get:function(){return a.scrapeUrlTool}}),r.allTools=[n.webSearchTool,i.sendCommandTool,a.scrapeUrlTool]},83090,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toolNode=void 0;let n=e.r(48794),i=e.r(2823);r.toolNode=new n.ToolNode(i.allTools)},1552,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.toolPickerNode=function(e){return n(this,void 0,void 0,function*(){var t,r,n;let o=(null==(t=e.query)?void 0:t.message)||"",l=e.redInstance,u=e.toolAction||"web_search",c=e.toolParam||"",d=null==(r=e.options)?void 0:r.generationId,p=null==(n=e.options)?void 0:n.conversationId;try{let e={web_search:"ðŸ”",scrape_url:"ðŸ“„",system_command:"âš™ï¸"}[u]||"ðŸ”§";yield l.logger.log({level:"info",category:"tool",message:`<yellow>${e} Executing tool:</yellow> <bold>${u}</bold>`,generationId:d,conversationId:p,metadata:{tool:u,param:c}});let t="",r=o;if("web_search"===u){yield l.logger.log({level:"debug",category:"tool",message:"<dim>Optimizing search query...</dim>",generationId:d,conversationId:p});let e=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),t=yield l.localModel.invoke([{role:"system",content:`Today's date: ${e}. You are a search query optimizer. Extract the key search terms from the user's question. Return ONLY the optimized search query, nothing else.

Examples:
"What baseball games are happening tonight?" â†’ "MLB games today schedule"
"Who won the election last week?" â†’ "election results 2025"
"What's the weather like in Paris?" â†’ "Paris weather today"
"Tell me about the new iPhone" â†’ "latest iPhone 2025 features"`},{role:"user",content:o}]),{thinking:n,cleanedContent:i}=(0,s.extractThinking)(t.content.toString());n&&d&&p&&(yield l.logger.logThought({content:n,source:"toolPicker-search-optimization",generationId:d,conversationId:p})),(0,s.logThinking)(n,"ToolPicker (Search Optimization)"),r=i.trim(),yield l.logger.log({level:"info",category:"tool",message:`<cyan>Optimized search:</cyan> <dim>"${o.substring(0,40)}${o.length>40?"...":""}"</dim> â†’ <green>"${r}"</green>`,generationId:d,conversationId:p,metadata:{originalQuery:o,optimizedQuery:r}})}if("web_search"===u){let e=i.allTools.find(e=>"web_search"===e.name);if(!e)return yield l.logger.log({level:"error",category:"tool",message:`<red>âœ— Tool not found:</red> web_search`,generationId:d,conversationId:p}),{selectedTools:[],messages:[],toolStatus:"error: tool not found"};t=yield e.invoke({query:r})}else if("scrape_url"===u){let e=i.allTools.find(e=>"scrape_url"===e.name);if(!e)return yield l.logger.log({level:"error",category:"tool",message:`<red>âœ— Tool not found:</red> scrape_url`,generationId:d,conversationId:p}),{selectedTools:[],messages:[],toolStatus:"error: tool not found"};let r=c||o;yield l.logger.log({level:"debug",category:"tool",message:`<dim>Scraping URL: ${r}</dim>`,generationId:d,conversationId:p}),t=yield e.invoke({url:r})}else if("system_command"===u){let e=i.allTools.find(e=>"send_command"===e.name);if(!e)return yield l.logger.log({level:"error",category:"tool",message:`<red>âœ— Tool not found:</red> send_command`,generationId:d,conversationId:p}),{selectedTools:[],messages:[],toolStatus:"error: tool not found"};let r=c||o;yield l.logger.log({level:"debug",category:"tool",message:`<dim>Executing command: ${r}</dim>`,generationId:d,conversationId:p}),t=yield e.invoke({command:r})}yield l.logger.log({level:"success",category:"tool",message:`<green>âœ“ Tool completed:</green> <bold>${u}</bold> <dim>(${t.length} chars)</dim>`,generationId:d,conversationId:p,metadata:{tool:u,resultLength:t.length}}),yield l.logger.log({level:"debug",category:"tool",message:"<dim>Extracting key information...</dim>",generationId:d,conversationId:p});let n=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),h=(yield l.localModel.invoke([{role:"system",content:`Today's date: ${n}. You are an information extraction expert. Extract key facts and data to answer the user's query accurately and concisely.`},{role:"user",content:`User Query: ${o}

Tool Results:
${t}

Extract and summarize the key information that answers this query:`}])).content.toString().trim(),{thinking:f,cleanedContent:m}=(0,s.extractThinking)(h);return f&&d&&p&&(yield l.logger.logThought({content:f,source:"toolPicker-extraction",generationId:d,conversationId:p})),(0,s.logThinking)(f,"ToolPicker"),h=m,yield l.logger.log({level:"success",category:"tool",message:`<green>âœ“ Information extracted</green> <dim>(${h.length} chars)</dim>`,generationId:d,conversationId:p,metadata:{summaryLength:h.length}}),{selectedTools:[u],messages:[new a.SystemMessage(`[INTERNAL CONTEXT - User cannot see this]
Relevant information found:

${h}

Use this information to answer the user's query directly and confidently. Do not say "according to search results" or reference external sources - answer as if you know this information.`)]}}catch(t){let e=t instanceof Error?t.message:String(t);return yield l.logger.log({level:"error",category:"tool",message:`<red>âœ— Tool execution error:</red> ${e}`,generationId:d,conversationId:p,metadata:{error:e,tool:u}}),{selectedTools:[],messages:[]}}})};let i=e.r(2823),a=e.r(22991),s=e.r(67151)},99790,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.redGraph=void 0;let n=e.r(23371),i=e.r(80166),a=e.r(86272),s=e.r(83090),o=e.r(1552),l=n.Annotation.Root({query:(0,n.Annotation)({reducer:(e,t)=>t,default:()=>({})}),options:(0,n.Annotation)({reducer:(e,t)=>t,default:()=>({})}),redInstance:(0,n.Annotation)({reducer:(e,t)=>t,default:()=>({})}),messages:(0,n.Annotation)({reducer:(e,t)=>e.concat(t),default:()=>[]}),response:(0,n.Annotation)({reducer:(e,t)=>t}),nextGraph:(0,n.Annotation)({reducer:(e,t)=>t}),selectedTools:(0,n.Annotation)({reducer:(e,t)=>t,default:()=>[]})});r.redGraph=new n.StateGraph(l).addNode("router",i.routerNode).addNode("toolPicker",o.toolPickerNode).addNode("chat",a.chatNode).addNode("tools",s.toolNode).addEdge("__start__","router").addConditionalEdges("router",e=>e.nextGraph||"chat",{homeGraph:n.END,assistantGraph:n.END,toolPicker:"toolPicker",chat:"chat"}).addEdge("toolPicker","chat").addConditionalEdges("chat",function(e){var t;let r=null==(t=e.response)?void 0:t.tool_calls;return r&&r.length>0?"tools":n.END},{tools:"tools",[n.END]:n.END}).addEdge("tools","chat").compile()},66338,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),s=0;s<a.length;s++)"default"!==a[s]&&n(r,t,a[s]);return i(r,t),r}}(),s=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})},o=e.e&&e.e.__await||function(e){return this instanceof o?(this.v=e,this):new o(e)},l=e.e&&e.e.__asyncValues||function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){var a,s,o;a=n,s=i,o=(t=e[r](t)).done,Promise.resolve(t.value).then(function(e){a({value:e,done:o})},s)})}}},u=e.e&&e.e.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),a=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),n[Symbol.asyncIterator]=function(){return this},n;function s(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){a.push([e,t,r,n])>1||l(e,t)})},t&&(n[e]=t(n[e])))}function l(e,t){try{var r;(r=i[e](t)).value instanceof o?Promise.resolve(r.value.v).then(u,c):d(a[0][2],r)}catch(e){d(a[0][3],e)}}function u(e){l("next",e)}function c(e){l("throw",e)}function d(e,t){e(t),a.shift(),a.length&&l(a[0][0],a[0][1])}};Object.defineProperty(r,"__esModule",{value:!0}),r.respond=function(t,r){return s(this,arguments,void 0,function*(t,r,n={}){var i,s;let p=n.conversationId||t.memory.generateConversationId(r.message),h=n.messageId,f=yield t.logger.startGeneration(p);if(!f)throw Error("A generation is already in progress for this conversation");yield t.memory.addMessage(p,{role:"user",content:r.message,timestamp:Date.now()});let m={query:r,options:Object.assign(Object.assign({},n),{conversationId:p,generationId:f}),redInstance:t};if(m.systemMessage=process.env.SYSTEM_PROMPT||`You are Red, an AI assistant developed by redbtn.io.
Current date: ${new Date().toLocaleDateString()}
Device: ${(null==(i=n.source)?void 0:i.device)||"unknown"}
Application: ${(null==(s=n.source)?void 0:s.application)||"unknown"}

CRITICAL RULES:
1. NEVER mention "knowledge cutoff", "training data", "as of my knowledge", or any limitations
2. NEVER introduce yourself unless this is the FIRST message in a new conversation or you're asked to do so
3. NEVER add disclaimers like "please note" or "for the most up-to-date information", and don't repeat the query to the user
4. If you have search results, use them directly and confidently
5. Be concise and helpful - answer the question directly without extra explanations`,n.stream)return function(t,r,n,i,s){return u(this,arguments,function*(){try{let{extractThinking:E,logThinking:k}=yield o(Promise.resolve().then(()=>a(e.r(67151))));yield yield o({_metadata:!0,conversationId:n,generationId:i}),console.log("[Streaming] Starting stream for conversation:",n,"generation:",i);let I=c.redGraph.streamEvents(r,{version:"v1"}),A=null,T="",C=!1,j="",x=!1,$=!1;try{for(var u,p,h,f,m,g,y,b,_,v,w,O,P=!0,S=l(I);!(u=(O=yield o(S.next())).done);P=!0){f=O.value,P=!1;let l=(null==(m=f.metadata)?void 0:m.langgraph_node)||"";if("toolPicker"===l&&"on_chain_start"===f.event&&!$){$=!0;let e=r.toolAction||"web_search",t={web_search:"ðŸ” Searching the web...",scrape_url:"ðŸ“„ Reading webpage...",system_command:"âš™ï¸ Executing command..."}[e]||"ðŸ”§ Using tool...";yield yield o({_toolStatus:!0,status:t,action:e}),console.log(`[Streaming] Tool indicator: ${t}`)}let u=f.name||"",c=f.tags||[],d=(null==(g=f.metadata)?void 0:g.langgraph_node)||"",p=u.toLowerCase().includes("router")||u.toLowerCase().includes("toolpicker")||d.toLowerCase().includes("router")||d.toLowerCase().includes("toolpicker")||c.some(e=>e.toLowerCase().includes("router")||e.toLowerCase().includes("toolpicker"));if("on_llm_stream"===f.event&&(null==(b=null==(y=f.data)?void 0:y.chunk)?void 0:b.content)&&!p){let r=f.data.chunk.content;for(let l=0;l<r.length;l++){let u=r[l];if(!x&&"<think>"===r.slice(l,l+7)){x=!0,l+=6;continue}if(x&&"</think>"===r.slice(l,l+8)){if(x=!1,l+=7,j.trim()&&(k(j.trim(),"Chat (Streaming)"),i&&n)){let r=j.trim();try{let l=yield o(Promise.resolve().then(()=>a(e.r(79334))).then(e=>e.getDatabase())),u=yield o(l.storeThought({thoughtId:`thought_${i}_${Date.now()}`,conversationId:n,generationId:i,source:"chat",content:r,timestamp:new Date,metadata:{streamChunk:!0}}));console.log(`[Respond] Stored thinking: ${u}`),s&&(yield o(t.messageQueue.publishThinking(s,r)))}catch(e){console.error("[Respond] Failed to store streaming thinking:",e)}}j="";continue}if(x)j+=u;else{if(!C&&("\n"===u||"\r"===u||" "===u))continue;T+=u,C=!0,yield yield o(u)}}}if("on_llm_end"===f.event&&!p){let e=null==(v=null==(_=f.data)?void 0:_.output)?void 0:v.generations;e&&e[0]&&(null==(w=e[0][0])?void 0:w.message)&&(A=e[0][0].message)}}}catch(e){p={error:e}}finally{try{!P&&!u&&(h=S.return)&&(yield o(h.call(S)))}finally{if(p)throw p.error}}if(j.trim()&&k(j.trim(),"Chat (Streaming)"),!C&&A&&A.content){let{thinking:r,cleanedContent:l}=E(A.content);if(r&&(k(r,"Chat (Non-streamed)"),i&&n))try{let l=yield o(Promise.resolve().then(()=>a(e.r(79334))).then(e=>e.getDatabase())),u=yield o(l.storeThought({thoughtId:`thought_${i}`,conversationId:n,generationId:i,source:"chat",content:r,timestamp:new Date,metadata:{model:t.localModel.model}}));console.log(`[Respond] Stored thinking: ${u}`),s&&(yield o(t.messageQueue.publishThinking(s,r)))}catch(e){console.error("[Respond] Failed to store non-streamed thinking:",e)}T=l;let u=l.split(" ");for(let e=0;e<u.length;e++){let t=u[e];yield yield o(0===e?t:" "+t),yield o(new Promise(e=>setTimeout(e,20)))}}if(T){yield o(t.memory.addMessage(n,{role:"assistant",content:T,timestamp:Date.now()})),yield o(t.logger.completeGeneration(i,{response:T,thinking:j||void 0,route:r.toolAction||"chat",toolsUsed:r.selectedTools,model:t.localModel.model,tokens:null==A?void 0:A.usage_metadata}));let e=yield o(t.memory.getMetadata(n)),a=(null==e?void 0:e.messageCount)||0;d.summarizeInBackground(n,t.memory,t.localModel),d.generateTitleInBackground(n,a,t.memory,t.localModel),a>=3&&d.generateExecutiveSummaryInBackground(n,t.memory,t.localModel)}A&&(yield yield o(A))}catch(e){throw yield o(t.logger.failGeneration(i,e instanceof Error?e.message:String(e))),e}})}(t,m,p,f,h);{let e=(yield c.redGraph.invoke(m)).response;yield t.memory.addMessage(p,{role:"assistant",content:"string"==typeof e.content?e.content:JSON.stringify(e.content),timestamp:Date.now()});let r=yield t.memory.getMetadata(p),n=(null==r?void 0:r.messageCount)||0;return d.summarizeInBackground(p,t.memory,t.localModel),d.generateTitleInBackground(p,n,t.memory,t.localModel),Object.assign(Object.assign({},e),{conversationId:p})}})};let c=e.r(99790),d=a(e.r(11554))},33185,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ColorTags=void 0,r.stripColorTags=function(e){return e.replace(/<\/?[a-z]+>/gi,"")},r.parseColorTagsToAnsi=function(e){let t=e;for(let[e,r]of Object.entries({red:"\x1b[31m",green:"\x1b[32m",yellow:"\x1b[33m",blue:"\x1b[34m",magenta:"\x1b[35m",cyan:"\x1b[36m",white:"\x1b[37m",gray:"\x1b[90m",bold:"\x1b[1m",dim:"\x1b[2m",italic:"\x1b[3m",underline:"\x1b[4m"}))t=t.replace(RegExp(`<${e}>`,"gi"),r);return t.replace(/<\/[a-z]+>/gi,"\x1b[0m")},r.parseColorTagsToHtml=function(e){let t=e;for(let[e,r]of Object.entries({red:"color: #ef4444",green:"color: #10b981",yellow:"color: #f59e0b",blue:"color: #3b82f6",magenta:"color: #a855f7",cyan:"color: #06b6d4",white:"color: #ffffff",gray:"color: #6b7280",bold:"font-weight: bold",dim:"opacity: 0.6",italic:"font-style: italic",underline:"text-decoration: underline"}))t=t.replace(RegExp(`<${e}>`,"gi"),`<span style="${r}">`);return t.replace(/<\/[a-z]+>/gi,"</span>")},r.ColorTags={red:e=>`<red>${e}</red>`,green:e=>`<green>${e}</green>`,yellow:e=>`<yellow>${e}</yellow>`,blue:e=>`<blue>${e}</blue>`,magenta:e=>`<magenta>${e}</magenta>`,cyan:e=>`<cyan>${e}</cyan>`,white:e=>`<white>${e}</white>`,gray:e=>`<gray>${e}</gray>`,bold:e=>`<bold>${e}</bold>`,dim:e=>`<dim>${e}</dim>`,italic:e=>`<italic>${e}</italic>`,underline:e=>`<underline>${e}</underline>`,error:e=>`<red>${e}</red>`,success:e=>`<green>${e}</green>`,warning:e=>`<yellow>${e}</yellow>`,info:e=>`<cyan>${e}</cyan>`,debug:e=>`<dim>${e}</dim>`}},11229,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(59297),r),i(e.r(65207),r),i(e.r(33185),r)},43250,(e,t,r)=>{"use strict";var n=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.PersistentLogger=void 0;let i=e.r(65207),a=e.r(79334);class s extends i.Logger{constructor(e,t="default"){super(e),this.db=(0,a.getDatabase)(),this.logQueue=[],this.generationQueue=new Map,this.flushInterval=null,this.FLUSH_INTERVAL_MS=5e3,this.MAX_BATCH_SIZE=100,this.nodeId=t,this.startFlushInterval()}startFlushInterval(){this.flushInterval=setInterval(()=>n(this,void 0,void 0,function*(){yield this.flushQueues()}),this.FLUSH_INTERVAL_MS)}flushQueues(){return n(this,void 0,void 0,function*(){if(this.logQueue.length>0){let e=this.logQueue.splice(0,this.logQueue.length);try{yield this.db.storeLogs(e),console.log(`[PersistentLogger] Persisted ${e.length} logs to MongoDB`)}catch(e){console.error("[PersistentLogger] Failed to persist logs to MongoDB:",e)}}if(this.generationQueue.size>0){let e=Array.from(this.generationQueue.values());for(let t of(this.generationQueue.clear(),e))try{(yield this.db.getGeneration(t.generationId))?yield this.db.updateGenerationStatus(t.generationId,t.status,{endTime:t.endTime,duration:t.duration,error:t.error}):yield this.db.storeGeneration(t)}catch(e){console.error(`[PersistentLogger] Failed to persist generation ${t.generationId}:`,e)}e.length>0&&console.log(`[PersistentLogger] Persisted ${e.length} generation(s) to MongoDB`)}})}convertToStoredLog(e){return{logId:e.id,generationId:e.generationId,conversationId:e.conversationId,level:this.mapLogLevel(e.level),category:e.category,message:e.message,timestamp:new Date(e.timestamp),nodeId:this.nodeId,metadata:e.metadata}}mapLogLevel(e){return({info:"info",warn:"warn",error:"error",debug:"debug",trace:"trace",log:"info"})[e]||"info"}log(e){let t=Object.create(null,{log:{get:()=>super.log}});return n(this,void 0,void 0,function*(){yield t.log.call(this,e);try{let t=this.convertToStoredLog({id:`log_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,timestamp:Date.now(),level:e.level,category:e.category,message:e.message,generationId:e.generationId,conversationId:e.conversationId,metadata:e.metadata});this.logQueue.push(t),this.logQueue.length>=this.MAX_BATCH_SIZE&&(yield this.flushQueues())}catch(e){console.error("[PersistentLogger] Failed to queue log for MongoDB:",e)}})}startGeneration(e,t){let r=Object.create(null,{startGeneration:{get:()=>super.startGeneration}});return n(this,void 0,void 0,function*(){let n=yield r.startGeneration.call(this,e,t);if(n)try{let t={generationId:n,conversationId:e,status:"pending",nodeId:this.nodeId,startTime:new Date};this.generationQueue.set(n,t)}catch(e){console.error("[PersistentLogger] Failed to queue generation for MongoDB:",e)}return n})}completeGeneration(e,t){let r=Object.create(null,{completeGeneration:{get:()=>super.completeGeneration}});return n(this,void 0,void 0,function*(){var n;yield r.completeGeneration.call(this,e,t);try{let r=this.generationQueue.get(e);r?(r.status="completed",r.endTime=new Date,r.duration=r.endTime.getTime()-r.startTime.getTime(),t.tokens&&(r.tokensUsed=t.tokens.total||0),r.model=t.model):this.generationQueue.set(e,{generationId:e,conversationId:"",status:"completed",nodeId:this.nodeId,model:t.model,startTime:new Date,endTime:new Date,duration:0,tokensUsed:(null==(n=t.tokens)?void 0:n.total)||0}),yield this.flushQueues()}catch(e){console.error("[PersistentLogger] Failed to complete generation in MongoDB:",e)}})}failGeneration(e,t){let r=Object.create(null,{failGeneration:{get:()=>super.failGeneration}});return n(this,void 0,void 0,function*(){yield r.failGeneration.call(this,e,t);try{let r=this.generationQueue.get(e);r?(r.status="failed",r.endTime=new Date,r.duration=r.endTime.getTime()-r.startTime.getTime(),r.error=t):this.generationQueue.set(e,{generationId:e,conversationId:"",status:"failed",nodeId:this.nodeId,startTime:new Date,endTime:new Date,duration:0,error:t}),yield this.flushQueues()}catch(e){console.error("[PersistentLogger] Failed to mark generation as failed in MongoDB:",e)}})}shutdown(){return n(this,void 0,void 0,function*(){console.log("[PersistentLogger] Shutting down..."),this.flushInterval&&(clearInterval(this.flushInterval),this.flushInterval=null),yield this.flushQueues(),yield this.db.close(),console.log("[PersistentLogger] Shutdown complete")})}}r.PersistentLogger=s},95669,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),s=0;s<a.length;s++)"default"!==a[s]&&n(r,t,a[s]);return i(r,t),r}}(),s=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},o=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.Red=r.extractAndLogThinking=r.logThinking=r.extractThinking=r.PersistentLogger=r.MessageQueue=r.DatabaseManager=r.resetDatabase=r.getDatabase=void 0,e.r(64913);let l=e.r(64876),u=e.r(43601),c=e.r(65207),d=e.r(76889),p=a(e.r(11554)),h=e.r(66338);var f=e.r(79334);Object.defineProperty(r,"getDatabase",{enumerable:!0,get:function(){return f.getDatabase}}),Object.defineProperty(r,"resetDatabase",{enumerable:!0,get:function(){return f.resetDatabase}}),Object.defineProperty(r,"DatabaseManager",{enumerable:!0,get:function(){return f.DatabaseManager}});var m=e.r(43601);Object.defineProperty(r,"MessageQueue",{enumerable:!0,get:function(){return m.MessageQueue}}),s(e.r(11229),r);var g=e.r(43250);Object.defineProperty(r,"PersistentLogger",{enumerable:!0,get:function(){return g.PersistentLogger}});var y=e.r(67151);Object.defineProperty(r,"extractThinking",{enumerable:!0,get:function(){return y.extractThinking}}),Object.defineProperty(r,"logThinking",{enumerable:!0,get:function(){return y.logThinking}}),Object.defineProperty(r,"extractAndLogThinking",{enumerable:!0,get:function(){return y.extractAndLogThinking}}),r.Red=class{constructor(t){this.isLoaded=!1,this.isThinking=!1,this.baseState={},this.config=t,this.localModel=(0,d.createLocalModel)(t),this.openAIModel=(0,d.createOpenAIModel)(),this.geminiModel=(0,d.createGeminiModel)(),this.memory=new l.MemoryManager(t.redisUrl);let r=new(e.r(42512))(t.redisUrl);this.redis=r,this.messageQueue=new u.MessageQueue(r),this.logger=new c.Logger(r)}_invoke(e,t,r){return o(this,void 0,void 0,function*(){if(!this.isLoaded)throw Error("Red instance is not loaded. Please call load() before invoking a graph.");return{output:`Output from ${e}`,timestamp:new Date().toISOString()}})}load(e){return o(this,void 0,void 0,function*(){this.isLoaded||(e?this.nodeId=e:this.nodeId=`node_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,console.log(`Loading base state for node: ${this.nodeId}...`),this.baseState={loadedAt:new Date,nodeId:this.nodeId},this.isLoaded=!0,this.heartbeatInterval=p.startHeartbeat(this.nodeId,this.redis),console.log("Base state loaded successfully."))})}getActiveNodes(){return o(this,void 0,void 0,function*(){return p.getActiveNodes(this.redis)})}think(){return o(this,void 0,void 0,function*(){if(!this.isLoaded)throw Error("Red instance is not loaded. Please call load() before thinking.");if(!this.isThinking){this.isThinking=!0;do yield this._invoke("cognitionGraph",{cycleType:"autonomous"}),yield new Promise(e=>setTimeout(e,2e3));while(this.isThinking)}})}stopThinking(){this.isThinking&&(this.isThinking=!1)}shutdown(){return o(this,void 0,void 0,function*(){console.log(`[Red] Shutting down node: ${this.nodeId}...`),this.stopThinking(),yield p.stopHeartbeat(this.nodeId,this.redis,this.heartbeatInterval),this.heartbeatInterval=void 0,this.redis&&(yield this.redis.quit()),this.isLoaded=!1,console.log("[Red] Shutdown complete")})}respond(e){return o(this,arguments,void 0,function*(e,t={}){return(0,h.respond)(this,e,t)})}setConversationTitle(e,t){return o(this,void 0,void 0,function*(){return p.setConversationTitle(e,t,this.memory)})}getConversationTitle(e){return o(this,void 0,void 0,function*(){return p.getConversationTitle(e,this.memory)})}}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__856dab9e._.js.map