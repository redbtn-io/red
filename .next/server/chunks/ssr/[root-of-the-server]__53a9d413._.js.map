{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/alpha/code/%40redbtn/webapp/src/lib/conversation.ts"],"sourcesContent":["/**\n * Types for the chat application\n */\n\nexport interface Message {\n  id: string;\n  role: 'user' | 'assistant';\n  content: string;\n  thinking?: string; // Extracted thinking/reasoning (if present)\n  timestamp: number;\n}\n\nexport interface Conversation {\n  id: string;\n  title: string;\n  titleSetByUser?: boolean; // True if user manually set the title\n  messages: Message[];\n  createdAt: number;\n  updatedAt: number;\n}\n\n/**\n * LocalStorage utilities for conversation management\n */\nconst CONVERSATIONS_KEY = 'red_conversations';\nconst ACTIVE_CONVERSATION_KEY = 'red_active_conversation';\n\nexport const conversationStorage = {\n  /**\n   * Get all conversations\n   */\n  getAll(): Conversation[] {\n    if (typeof window === 'undefined') return [];\n    const stored = localStorage.getItem(CONVERSATIONS_KEY);\n    return stored ? JSON.parse(stored) : [];\n  },\n\n  /**\n   * Get a specific conversation by ID\n   */\n  get(id: string): Conversation | null {\n    const conversations = this.getAll();\n    return conversations.find(c => c.id === id) || null;\n  },\n\n  /**\n   * Save a conversation\n   */\n  save(conversation: Conversation): void {\n    const conversations = this.getAll();\n    const index = conversations.findIndex(c => c.id === conversation.id);\n    \n    if (index >= 0) {\n      conversations[index] = conversation;\n    } else {\n      conversations.push(conversation);\n    }\n    \n    localStorage.setItem(CONVERSATIONS_KEY, JSON.stringify(conversations));\n  },\n\n  /**\n   * Delete a conversation\n   */\n  delete(id: string): void {\n    const conversations = this.getAll().filter(c => c.id !== id);\n    localStorage.setItem(CONVERSATIONS_KEY, JSON.stringify(conversations));\n  },\n\n  /**\n   * Get active conversation ID\n   */\n  getActiveId(): string | null {\n    if (typeof window === 'undefined') return null;\n    return localStorage.getItem(ACTIVE_CONVERSATION_KEY);\n  },\n\n  /**\n   * Set active conversation ID\n   */\n  setActiveId(id: string): void {\n    localStorage.setItem(ACTIVE_CONVERSATION_KEY, id);\n  },\n\n  /**\n   * Create a new conversation\n   */\n  create(): Conversation {\n    const conversation: Conversation = {\n      id: `conv_${Date.now()}_${Math.random().toString(36).substring(7)}`,\n      title: 'New Conversation',\n      messages: [],\n      createdAt: Date.now(),\n      updatedAt: Date.now()\n    };\n    \n    this.save(conversation);\n    return conversation;\n  },\n\n  /**\n   * Add a message to a conversation\n   */\n  addMessage(conversationId: string, message: Message): void {\n    const conversation = this.get(conversationId);\n    if (!conversation) return;\n    \n    conversation.messages.push(message);\n    conversation.updatedAt = Date.now();\n    \n    // Update title from first message if still \"New Conversation\"\n    if (conversation.title === 'New Conversation' && message.role === 'user') {\n      conversation.title = message.content.substring(0, 50) + (message.content.length > 50 ? '...' : '');\n    }\n    \n    this.save(conversation);\n  }\n};\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AAmBD;;CAEC,GACD,MAAM,oBAAoB;AAC1B,MAAM,0BAA0B;AAEzB,MAAM,sBAAsB;IACjC;;GAEC,GACD;QACE,wCAAmC,OAAO,EAAE;;;QAC5C,MAAM;IAER;IAEA;;GAEC,GACD,KAAI,EAAU;QACZ,MAAM,gBAAgB,IAAI,CAAC,MAAM;QACjC,OAAO,cAAc,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,OAAO;IACjD;IAEA;;GAEC,GACD,MAAK,YAA0B;QAC7B,MAAM,gBAAgB,IAAI,CAAC,MAAM;QACjC,MAAM,QAAQ,cAAc,SAAS,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,aAAa,EAAE;QAEnE,IAAI,SAAS,GAAG;YACd,aAAa,CAAC,MAAM,GAAG;QACzB,OAAO;YACL,cAAc,IAAI,CAAC;QACrB;QAEA,aAAa,OAAO,CAAC,mBAAmB,KAAK,SAAS,CAAC;IACzD;IAEA;;GAEC,GACD,QAAO,EAAU;QACf,MAAM,gBAAgB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QACzD,aAAa,OAAO,CAAC,mBAAmB,KAAK,SAAS,CAAC;IACzD;IAEA;;GAEC,GACD;QACE,wCAAmC,OAAO;;;IAE5C;IAEA;;GAEC,GACD,aAAY,EAAU;QACpB,aAAa,OAAO,CAAC,yBAAyB;IAChD;IAEA;;GAEC,GACD;QACE,MAAM,eAA6B;YACjC,IAAI,CAAC,KAAK,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,IAAI;YACnE,OAAO;YACP,UAAU,EAAE;YACZ,WAAW,KAAK,GAAG;YACnB,WAAW,KAAK,GAAG;QACrB;QAEA,IAAI,CAAC,IAAI,CAAC;QACV,OAAO;IACT;IAEA;;GAEC,GACD,YAAW,cAAsB,EAAE,OAAgB;QACjD,MAAM,eAAe,IAAI,CAAC,GAAG,CAAC;QAC9B,IAAI,CAAC,cAAc;QAEnB,aAAa,QAAQ,CAAC,IAAI,CAAC;QAC3B,aAAa,SAAS,GAAG,KAAK,GAAG;QAEjC,8DAA8D;QAC9D,IAAI,aAAa,KAAK,KAAK,sBAAsB,QAAQ,IAAI,KAAK,QAAQ;YACxE,aAAa,KAAK,GAAG,QAAQ,OAAO,CAAC,SAAS,CAAC,GAAG,MAAM,CAAC,QAAQ,OAAO,CAAC,MAAM,GAAG,KAAK,QAAQ,EAAE;QACnG;QAEA,IAAI,CAAC,IAAI,CAAC;IACZ;AACF","debugId":null}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file:///home/alpha/code/%40redbtn/webapp/src/components/Modal.tsx"],"sourcesContent":["import { X } from 'lucide-react';\n\ninterface ModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  title: string;\n  children: React.ReactNode;\n}\n\nexport function Modal({ isOpen, onClose, title, children }: ModalProps) {\n  if (!isOpen) return null;\n\n  return (\n    <>\n      {/* Backdrop */}\n      <div\n        className=\"fixed inset-0 bg-black bg-opacity-50 z-50\"\n        onClick={onClose}\n      />\n\n      {/* Modal */}\n      <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n        <div className=\"bg-[#1a1a1a] border border-[#2a2a2a] rounded-xl max-w-md w-full shadow-2xl\">\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-4 border-b border-[#2a2a2a]\">\n            <h2 className=\"text-lg font-semibold text-gray-100\">{title}</h2>\n            <button\n              onClick={onClose}\n              className=\"p-1 hover:bg-[#2a2a2a] rounded-lg transition-colors text-gray-400 hover:text-gray-200\"\n            >\n              <X size={20} />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"p-4\">\n            {children}\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n\ninterface ConfirmModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onConfirm: () => void;\n  title: string;\n  message: string;\n  confirmText?: string;\n  cancelText?: string;\n  variant?: 'danger' | 'warning' | 'info';\n}\n\nexport function ConfirmModal({\n  isOpen,\n  onClose,\n  onConfirm,\n  title,\n  message,\n  confirmText = 'Confirm',\n  cancelText = 'Cancel',\n  variant = 'danger'\n}: ConfirmModalProps) {\n  const handleConfirm = () => {\n    onConfirm();\n    onClose();\n  };\n\n  const confirmButtonClass = variant === 'danger'\n    ? 'bg-red-500 hover:bg-red-600'\n    : variant === 'warning'\n    ? 'bg-yellow-500 hover:bg-yellow-600'\n    : 'bg-blue-500 hover:bg-blue-600';\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title={title}>\n      <p className=\"text-gray-300 mb-6\">{message}</p>\n      \n      <div className=\"flex gap-3 justify-end\">\n        <button\n          onClick={onClose}\n          className=\"px-4 py-2 bg-[#2a2a2a] hover:bg-[#333] rounded-lg transition-colors text-gray-300\"\n        >\n          {cancelText}\n        </button>\n        <button\n          onClick={handleConfirm}\n          className={`px-4 py-2 ${confirmButtonClass} rounded-lg transition-colors text-white font-medium`}\n        >\n          {confirmText}\n        </button>\n      </div>\n    </Modal>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAAA;;;AASO,SAAS,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAc;IACpE,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACE;;0BAEE,8OAAC;gBACC,WAAU;gBACV,SAAS;;;;;;0BAIX,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCAEb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAG,WAAU;8CAAuC;;;;;;8CACrD,8OAAC;oCACC,SAAS;oCACT,WAAU;8CAEV,cAAA,8OAAC,iMAAC;wCAAC,MAAM;;;;;;;;;;;;;;;;;sCAKb,8OAAC;4BAAI,WAAU;sCACZ;;;;;;;;;;;;;;;;;;;AAMb;AAaO,SAAS,aAAa,EAC3B,MAAM,EACN,OAAO,EACP,SAAS,EACT,KAAK,EACL,OAAO,EACP,cAAc,SAAS,EACvB,aAAa,QAAQ,EACrB,UAAU,QAAQ,EACA;IAClB,MAAM,gBAAgB;QACpB;QACA;IACF;IAEA,MAAM,qBAAqB,YAAY,WACnC,gCACA,YAAY,YACZ,sCACA;IAEJ,qBACE,8OAAC;QAAM,QAAQ;QAAQ,SAAS;QAAS,OAAO;;0BAC9C,8OAAC;gBAAE,WAAU;0BAAsB;;;;;;0BAEnC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,SAAS;wBACT,WAAU;kCAET;;;;;;kCAEH,8OAAC;wBACC,SAAS;wBACT,WAAW,CAAC,UAAU,EAAE,mBAAmB,oDAAoD,CAAC;kCAE/F;;;;;;;;;;;;;;;;;;AAKX","debugId":null}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///home/alpha/code/%40redbtn/webapp/src/components/Header.tsx"],"sourcesContent":["import { Menu, Plus } from 'lucide-react';\n\ninterface HeaderProps {\n  title: string;\n  onMenuClick: () => void;\n  onNewChat: () => void;\n}\n\nexport function Header({ title, onMenuClick, onNewChat }: HeaderProps) {\n  return (\n    <div className=\"sticky top-0 z-40 bg-[#0f0f0f] border-b border-[#2a2a2a] px-4 py-3 flex items-center gap-3\">\n      <button\n        onClick={onMenuClick}\n        className=\"lg:hidden p-2 hover:bg-[#1a1a1a] rounded-lg transition-colors text-gray-300\"\n      >\n        <Menu size={24} />\n      </button>\n      <h1 className=\"text-lg font-semibold text-gray-100\">\n        {title}\n      </h1>\n      <button\n        onClick={onNewChat}\n        className=\"ml-auto p-2 hover:bg-[#1a1a1a] rounded-lg transition-colors text-gray-300\"\n        title=\"New Chat\"\n      >\n        <Plus size={20} />\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AAAA;;;AAQO,SAAS,OAAO,EAAE,KAAK,EAAE,WAAW,EAAE,SAAS,EAAe;IACnE,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,SAAS;gBACT,WAAU;0BAEV,cAAA,8OAAC,0MAAI;oBAAC,MAAM;;;;;;;;;;;0BAEd,8OAAC;gBAAG,WAAU;0BACX;;;;;;0BAEH,8OAAC;gBACC,SAAS;gBACT,WAAU;gBACV,OAAM;0BAEN,cAAA,8OAAC,0MAAI;oBAAC,MAAM;;;;;;;;;;;;;;;;;AAIpB","debugId":null}},
    {"offset": {"line": 309, "column": 0}, "map": {"version":3,"sources":["file:///home/alpha/code/%40redbtn/webapp/src/components/Sidebar.tsx"],"sourcesContent":["import { Plus, MessageSquare, Trash2, Edit2, Check, X, Terminal } from 'lucide-react';\nimport Image from 'next/image';\nimport Link from 'next/link';\nimport { type Conversation } from '@/lib/conversation';\n\ninterface SidebarProps {\n  isOpen: boolean;\n  conversations: Conversation[];\n  activeConversationId: string | null;\n  editingTitleId: string | null;\n  editingTitleValue: string;\n  onClose: () => void;\n  onNewChat: () => void;\n  onSwitchConversation: (id: string) => void;\n  onDeleteClick: (id: string, event: React.MouseEvent) => void;\n  onStartEditingTitle: (conv: Conversation, event: React.MouseEvent) => void;\n  onSaveEditedTitle: (conversationId: string) => void;\n  onCancelEditingTitle: () => void;\n  onEditingTitleChange: (value: string) => void;\n}\n\nexport function Sidebar({\n  isOpen,\n  conversations,\n  activeConversationId,\n  editingTitleId,\n  editingTitleValue,\n  onClose,\n  onNewChat,\n  onSwitchConversation,\n  onDeleteClick,\n  onStartEditingTitle,\n  onSaveEditedTitle,\n  onCancelEditingTitle,\n  onEditingTitleChange\n}: SidebarProps) {\n  return (\n    <>\n      {/* Sidebar */}\n      <div\n        className={`\n          fixed inset-y-0 left-0 z-50 w-64 bg-[#0f0f0f] border-r border-[#2a2a2a] text-white transform transition-transform duration-200 ease-in-out\n          lg:relative lg:translate-x-0\n          ${isOpen ? 'translate-x-0' : '-translate-x-full'}\n        `}\n      >\n        <div className=\"flex flex-col h-full\">\n          {/* Logo Header */}\n          <div className=\"p-4 border-b border-[#2a2a2a]\">\n            <Link href=\"/\" className=\"flex items-center gap-2 mb-4 no-underline hover:opacity-90\">\n              <div className=\"w-8 h-8 rounded-lg flex items-center justify-center overflow-hidden\">\n                <Image \n                  src=\"/logo.png\" \n                  alt=\"Red\" \n                  width={32} \n                  height={32}\n                  className=\"w-full h-full object-cover\"\n                />\n              </div>\n              <span className=\"text-lg font-semibold\">redbtn</span>\n            </Link>\n            <button\n              onClick={onNewChat}\n              className=\"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-500 hover:bg-red-600 rounded-lg transition-colors font-medium\"\n            >\n              <Plus size={18} />\n              <span>New Chat</span>\n            </button>\n          </div>\n\n          {/* Conversations List */}\n          <div className=\"flex-1 overflow-y-auto p-3\">\n            <div className=\"space-y-1\">\n              {conversations.map(conv => (\n                <div\n                  key={conv.id}\n                  className={`\n                    relative rounded-lg transition-all group\n                    ${conv.id === activeConversationId \n                      ? 'bg-[#1a1a1a] border border-[#2a2a2a]' \n                      : 'hover:bg-[#1a1a1a] border border-transparent'\n                    }\n                  `}\n                >\n                  <button\n                    onClick={() => onSwitchConversation(conv.id)}\n                    className=\"w-full text-left px-3 py-2.5\"\n                    disabled={editingTitleId === conv.id}\n                  >\n                    <div className=\"flex items-start gap-2 pr-16\">\n                      <MessageSquare size={16} className=\"mt-0.5 flex-shrink-0 text-gray-400\" />\n                      <div className=\"flex-1 min-w-0\">\n                        {editingTitleId === conv.id ? (\n                          <div className=\"flex items-center gap-1\" onClick={(e) => e.stopPropagation()}>\n                            <input\n                              type=\"text\"\n                              value={editingTitleValue}\n                              onChange={(e) => onEditingTitleChange(e.target.value)}\n                              onKeyDown={(e) => {\n                                if (e.key === 'Enter') onSaveEditedTitle(conv.id);\n                                if (e.key === 'Escape') onCancelEditingTitle();\n                              }}\n                              className=\"flex-1 text-base font-medium bg-[#0f0f0f] border border-[#2a2a2a] rounded px-2 py-1 text-gray-200 focus:outline-none focus:border-red-500\"\n                              autoFocus\n                            />\n                            <button\n                              onClick={() => onSaveEditedTitle(conv.id)}\n                              className=\"p-1 hover:bg-[#2a2a2a] rounded text-green-400 hover:text-green-300\"\n                              title=\"Save\"\n                            >\n                              <Check size={14} />\n                            </button>\n                            <button\n                              onClick={onCancelEditingTitle}\n                              className=\"p-1 hover:bg-[#2a2a2a] rounded text-gray-400 hover:text-gray-300\"\n                              title=\"Cancel\"\n                            >\n                              <X size={14} />\n                            </button>\n                          </div>\n                        ) : (\n                          <div className=\"text-sm font-medium truncate text-gray-200\">{conv.title}</div>\n                        )}\n                        <div className=\"text-xs text-gray-500 mt-0.5\">\n                          {conv.messages.length} {conv.messages.length === 1 ? 'message' : 'messages'}\n                        </div>\n                      </div>\n                    </div>\n                  </button>\n                  \n                  {/* Action Buttons */}\n                  {editingTitleId !== conv.id && (\n                    <div className=\"absolute right-2 top-1/2 -translate-y-1/2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                      <button\n                        onClick={(e) => onStartEditingTitle(conv, e)}\n                        className=\"p-2 hover:bg-[#2a2a2a] rounded-lg text-gray-400 hover:text-blue-400\"\n                        title=\"Edit title\"\n                      >\n                        <Edit2 size={14} />\n                      </button>\n                      <button\n                        onClick={(e) => onDeleteClick(conv.id, e)}\n                        className=\"p-2 hover:bg-[#2a2a2a] rounded-lg text-gray-400 hover:text-red-400\"\n                        title=\"Delete conversation\"\n                      >\n                        <Trash2 size={14} />\n                      </button>\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Footer */}\n          <div className=\"p-4 border-t border-[#2a2a2a] space-y-3\">\n            {/* Logs Link */}\n            <Link\n              href=\"/logs\"\n              className=\"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-[#1a1a1a] transition-colors group\"\n            >\n              <Terminal size={16} className=\"text-gray-400 group-hover:text-[var(--red-primary)]\" />\n              <span className=\"text-sm text-gray-400 group-hover:text-[var(--foreground)]\">\n                Virtual Terminal\n              </span>\n            </Link>\n            \n            {/* Status */}\n            <div className=\"flex items-center gap-2 text-xs text-gray-500 px-3\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n              <span>Red Connected</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Overlay for mobile */}\n      {isOpen && (\n        <div\n          className=\"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden\"\n          onClick={onClose}\n        />\n      )}\n    </>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 670, "column": 0}, "map": {"version":3,"sources":["file:///home/alpha/code/%40redbtn/webapp/src/components/ChatInput.tsx"],"sourcesContent":["import { Send } from 'lucide-react';\n\ninterface ChatInputProps {\n  value: string;\n  disabled: boolean;\n  messagesEndRef: React.RefObject<HTMLDivElement | null>;\n  onChange: (value: string) => void;\n  onSend: () => void;\n}\n\nexport function ChatInput({ value, disabled, messagesEndRef, onChange, onSend }: ChatInputProps) {\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      onSend();\n    }\n  };\n\n  return (\n    <div className=\"sticky bottom-0 z-40 bg-[#0f0f0f] border-t border-[#2a2a2a] py-3 px-4\">\n      <div className=\"max-w-4xl mx-auto flex gap-3 items-center\">\n        <div className=\"flex-1 relative inline-block\">\n          <textarea\n            value={value}\n            onChange={(e) => onChange(e.target.value)}\n            onKeyDown={handleKeyDown}\n            onFocus={() => {\n              // On mobile, keyboard may resize viewport; scroll after a short delay\n              setTimeout(() => {\n                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n              }, 300);\n            }}\n            placeholder=\"Type your message...\"\n            className=\"w-full resize-none bg-[#1a1a1a] border border-[#2a2a2a] text-gray-100 placeholder-gray-500 rounded-xl px-4 pr-16 py-3 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all leading-tight block\"\n            rows={1}\n            disabled={disabled}\n          />\n          {/* Helper hint visible on medium+ screens (absolute so it doesn't affect layout). Hidden when input has content */}\n          <div className={`hidden md:block pointer-events-none absolute right-3 bottom-3 text-xs text-gray-500 px-2 py-0.5 rounded-md ${value ? 'opacity-0' : 'opacity-100'} transition-opacity bg-[#0f0f0f]`}>\n            (Shift+Enter for new line)\n          </div>\n        </div>\n        <button\n          onClick={onSend}\n          disabled={!value.trim() || disabled}\n          className=\"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 disabled:bg-gray-700 disabled:text-gray-500 disabled:cursor-not-allowed transition-all flex items-center gap-2 font-medium shadow-lg\"\n        >\n          <Send size={20} />\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;;AAUO,SAAS,UAAU,EAAE,KAAK,EAAE,QAAQ,EAAE,cAAc,EAAE,QAAQ,EAAE,MAAM,EAAkB;IAC7F,MAAM,gBAAgB,CAAC;QACrB,IAAI,EAAE,GAAG,KAAK,WAAW,CAAC,EAAE,QAAQ,EAAE;YACpC,EAAE,cAAc;YAChB;QACF;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BACC,OAAO;4BACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;4BACxC,WAAW;4BACX,SAAS;gCACP,sEAAsE;gCACtE,WAAW;oCACT,eAAe,OAAO,EAAE,eAAe;wCAAE,UAAU;oCAAS;gCAC9D,GAAG;4BACL;4BACA,aAAY;4BACZ,WAAU;4BACV,MAAM;4BACN,UAAU;;;;;;sCAGZ,8OAAC;4BAAI,WAAW,CAAC,2GAA2G,EAAE,QAAQ,cAAc,cAAc,gCAAgC,CAAC;sCAAE;;;;;;;;;;;;8BAIvM,8OAAC;oBACC,SAAS;oBACT,UAAU,CAAC,MAAM,IAAI,MAAM;oBAC3B,WAAU;8BAEV,cAAA,8OAAC,0MAAI;wBAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;AAKtB","debugId":null}},
    {"offset": {"line": 823, "column": 0}, "map": {"version":3,"sources":["file:///home/alpha/code/%40redbtn/webapp/src/components/LoadingStates.tsx"],"sourcesContent":["import { Brain, MessageSquare, Search, Terminal, GitBranch, Loader2 } from 'lucide-react';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\nimport remarkMath from 'remark-math';\nimport rehypeKatex from 'rehype-katex';\nimport { useState } from 'react';\n\ninterface LoadingStateContainerProps {\n  currentStatus: {\n    action: string;\n    description?: string;\n  } | null;\n  thinking: string | null;\n  messageId: string;\n  skeletonShrinking: boolean;\n}\n\nexport function LoadingStateContainer({\n  currentStatus,\n  thinking,\n  messageId,\n  skeletonShrinking\n}: LoadingStateContainerProps) {\n  const [showThinking, setShowThinking] = useState(false);\n\n  const getIcon = () => {\n    if (!currentStatus) return <Loader2 size={16} className=\"text-red-400 animate-spin\" />;\n    \n    switch (currentStatus.action) {\n      case 'thinking':\n        return <Brain size={16} className=\"text-red-400\" />;\n      case 'processing':\n      case 'routing':\n        return <GitBranch size={16} className=\"text-red-400\" />;\n      case 'searching':\n      case 'web_search':\n        return <Search size={16} className=\"text-red-400\" />;\n      case 'system_command':\n      case 'running_command':\n      case 'commands':\n        return <Terminal size={16} className=\"text-red-400\" />;\n      default:\n        return <Loader2 size={16} className=\"text-red-400 animate-spin\" />;\n    }\n  };\n\n  const getStatusText = () => {\n    if (!currentStatus) return 'Processing...';\n    \n    switch (currentStatus.action) {\n      case 'thinking':\n        return 'Reasoning';\n      case 'processing':\n      case 'routing':\n        return 'Processing';\n      case 'searching':\n      case 'web_search':\n        return 'Searching';\n      case 'system_command':\n      case 'running_command':\n      case 'commands':\n        return 'Running System Command';\n      default:\n        return currentStatus.description || currentStatus.action;\n    }\n  };\n\n  const hasThinking = thinking && thinking.length > 0;\n\n  return (\n    <div className=\"flex justify-start mb-6\">\n      <div className=\"max-w-[85%]\">\n        {/* Single loading box with dynamic status */}\n        <div\n          className={`bg-[#1a1a1a] border border-red-500/50 rounded-xl px-4 py-3 shadow-lg space-y-2 animate-pulse overflow-hidden origin-left ${\n            skeletonShrinking \n              ? 'transition-all duration-[800ms] ease-out opacity-0 scale-x-0 -translate-x-4' \n              : 'transition-all duration-[800ms] ease-out opacity-100 scale-x-100 translate-x-0'\n          }`}\n        >\n          {/* Line 1: Current status with icon */}\n          <div className=\"flex items-center gap-2 text-sm text-red-400\">\n            {getIcon()}\n            <span>{getStatusText()}</span>\n          </div>\n\n          {/* Line 2: Show thinking button (only if thinking exists) */}\n          {hasThinking && (\n            <button\n              onClick={() => setShowThinking(!showThinking)}\n              className=\"flex items-center gap-2 text-sm text-red-400 hover:text-red-300 transition-colors w-full text-left\"\n            >\n              <span>{showThinking ? 'Hide' : 'Show'} thinking</span>\n              <span className=\"ml-auto text-xs opacity-60\">\n                {thinking.length} chars\n              </span>\n            </button>\n          )}\n        </div>\n\n        {/* Expanded thinking content (separate box below) */}\n        {showThinking && hasThinking && (\n          <div className=\"bg-[#1a1a1a] border border-purple-500/30 rounded-xl px-4 py-3 shadow-lg mt-3\">\n            <div className=\"font-semibold mb-2 text-purple-300 flex items-center justify-between\">\n              <span>Reasoning:</span>\n              <span className=\"text-xs opacity-60 animate-pulse\">streaming...</span>\n            </div>\n            <div className=\"prose prose-invert prose-sm max-w-none \n              prose-p:my-1 prose-p:leading-relaxed prose-p:text-gray-300\n              prose-pre:bg-black/30 prose-pre:my-2\n              prose-code:text-white prose-code:bg-black/20 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-xs\n              [&_.katex]:text-white [&_.katex]:text-sm\">\n              <ReactMarkdown\n                remarkPlugins={[remarkGfm, remarkMath]}\n                rehypePlugins={[rehypeKatex]}\n              >\n                {thinking}\n              </ReactMarkdown>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAYO,SAAS,sBAAsB,EACpC,aAAa,EACb,QAAQ,EACR,SAAS,EACT,iBAAiB,EACU;IAC3B,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IAEjD,MAAM,UAAU;QACd,IAAI,CAAC,eAAe,qBAAO,8OAAC,4NAAO;YAAC,MAAM;YAAI,WAAU;;;;;;QAExD,OAAQ,cAAc,MAAM;YAC1B,KAAK;gBACH,qBAAO,8OAAC,6MAAK;oBAAC,MAAM;oBAAI,WAAU;;;;;;YACpC,KAAK;YACL,KAAK;gBACH,qBAAO,8OAAC,6NAAS;oBAAC,MAAM;oBAAI,WAAU;;;;;;YACxC,KAAK;YACL,KAAK;gBACH,qBAAO,8OAAC,gNAAM;oBAAC,MAAM;oBAAI,WAAU;;;;;;YACrC,KAAK;YACL,KAAK;YACL,KAAK;gBACH,qBAAO,8OAAC,sNAAQ;oBAAC,MAAM;oBAAI,WAAU;;;;;;YACvC;gBACE,qBAAO,8OAAC,4NAAO;oBAAC,MAAM;oBAAI,WAAU;;;;;;QACxC;IACF;IAEA,MAAM,gBAAgB;QACpB,IAAI,CAAC,eAAe,OAAO;QAE3B,OAAQ,cAAc,MAAM;YAC1B,KAAK;gBACH,OAAO;YACT,KAAK;YACL,KAAK;gBACH,OAAO;YACT,KAAK;YACL,KAAK;gBACH,OAAO;YACT,KAAK;YACL,KAAK;YACL,KAAK;gBACH,OAAO;YACT;gBACE,OAAO,cAAc,WAAW,IAAI,cAAc,MAAM;QAC5D;IACF;IAEA,MAAM,cAAc,YAAY,SAAS,MAAM,GAAG;IAElD,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BAEb,8OAAC;oBACC,WAAW,CAAC,yHAAyH,EACnI,oBACI,gFACA,kFACJ;;sCAGF,8OAAC;4BAAI,WAAU;;gCACZ;8CACD,8OAAC;8CAAM;;;;;;;;;;;;wBAIR,6BACC,8OAAC;4BACC,SAAS,IAAM,gBAAgB,CAAC;4BAChC,WAAU;;8CAEV,8OAAC;;wCAAM,eAAe,SAAS;wCAAO;;;;;;;8CACtC,8OAAC;oCAAK,WAAU;;wCACb,SAAS,MAAM;wCAAC;;;;;;;;;;;;;;;;;;;gBAOxB,gBAAgB,6BACf,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;8CAAK;;;;;;8CACN,8OAAC;oCAAK,WAAU;8CAAmC;;;;;;;;;;;;sCAErD,8OAAC;4BAAI,WAAU;sCAKb,cAAA,8OAAC,mMAAa;gCACZ,eAAe;oCAAC,wJAAS;oCAAE,yJAAU;iCAAC;gCACtC,eAAe;oCAAC,0JAAW;iCAAC;0CAE3B;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQjB","debugId":null}},
    {"offset": {"line": 1060, "column": 0}, "map": {"version":3,"sources":["file:///home/alpha/code/%40redbtn/webapp/src/components/Messages.tsx"],"sourcesContent":["import { MessageSquare, Brain } from 'lucide-react';\nimport { type Message } from '@/lib/conversation';\nimport { useState, useEffect } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\nimport remarkMath from 'remark-math';\nimport rehypeKatex from 'rehype-katex';\nimport { LoadingStateContainer } from './LoadingStates';\n\ninterface MessagesProps {\n  messages: Message[] | undefined;\n  thinking: Record<string, string>; // messageId -> thinking content\n  currentStatus: { action: string; description?: string } | null;\n  isLoading: boolean;\n  isStreaming: boolean;\n  streamingMessageId: string | null;\n  skeletonShrinking: boolean;\n  messagesEndRef: React.RefObject<HTMLDivElement | null>;\n  conversationId?: string;\n}\n\nexport function Messages({\n  messages,\n  thinking,\n  currentStatus,\n  isLoading,\n  isStreaming,\n  streamingMessageId,\n  skeletonShrinking,\n  messagesEndRef,\n  conversationId\n}: MessagesProps) {\n  // State for showing thinking during skeleton/loading phase\n  const [showLoadingThinking, setShowLoadingThinking] = useState(false);\n  \n  // Get thinking content for the streaming message (if any)\n  const streamingThinking = streamingMessageId ? thinking[streamingMessageId] : null;\n  const hasStreamingThinking = streamingThinking && streamingThinking.length > 0;\n  \n  return (\n    <div className=\"flex-1 overflow-y-auto pt-6 pb-6 px-6 space-y-6\">\n      {!messages?.length && !isLoading && (\n        <div className=\"flex items-center justify-center h-full\">\n          <div className=\"text-center text-gray-500\">\n            <MessageSquare size={48} className=\"mx-auto mb-4 opacity-20\" />\n            <p className=\"text-lg font-medium\">Start a conversation</p>\n            <p className=\"text-sm mt-2\">Send a message to begin chatting with Red AI</p>\n          </div>\n        </div>\n      )}\n      {messages?.map((message) => {\n        // Get thinking from prop for this message\n        const thinkingContent = message.role === 'assistant' ? thinking[message.id] : null;\n        \n        return (\n          <MessageBubble\n            key={message.id}\n            message={message}\n            thinking={thinkingContent || null}\n            isStreaming={isStreaming && streamingMessageId === message.id}\n          />\n        );\n      })}\n      \n      {/* Loading State with Status, Skeleton, and Thinking */}\n      {isLoading && streamingMessageId && (\n        <LoadingStateContainer\n          currentStatus={currentStatus}\n          thinking={thinking[streamingMessageId] || null}\n          messageId={streamingMessageId}\n          skeletonShrinking={skeletonShrinking}\n        />\n      )}\n      \n      <div ref={messagesEndRef} />\n    </div>\n  );\n}\n\ninterface MessageBubbleProps {\n  message: Message;\n  thinking: string | null;\n  isStreaming: boolean;\n}\n\nfunction MessageBubble({ message, thinking, isStreaming }: MessageBubbleProps) {\n  // Thinking starts HIDDEN by default, user must click to show\n  const [showThinking, setShowThinking] = useState(false);\n  const hasThinking = thinking && thinking.length > 0;\n  \n  // Show the toggle button if: thinking exists OR currently streaming\n  const showToggle = hasThinking || isStreaming;\n\n  \n  return (\n    <div\n      className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}\n    >\n      <div\n        className={`max-w-[80%] rounded-xl px-5 py-3.5 shadow-lg ${\n          message.role === 'user'\n            ? 'bg-[#1a1a1a] border border-[#2a2a2a] text-gray-100'\n            : `bg-red-500 text-white ${isStreaming ? 'streaming-pulse' : ''}`\n        }`}\n      >\n        {/* Main message content with markdown */}\n        <div className=\"prose prose-invert max-w-none \n          prose-p:my-2 prose-p:leading-relaxed\n          prose-pre:bg-black/30 prose-pre:border prose-pre:border-white/20 prose-pre:my-3\n          prose-code:text-white prose-code:bg-black/20 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm\n          prose-a:text-white prose-a:underline \n          prose-strong:text-white prose-strong:font-semibold\n          prose-em:text-white prose-em:italic\n          prose-headings:text-white prose-headings:font-bold prose-headings:mt-4 prose-headings:mb-2\n          prose-ul:my-2 prose-ol:my-2 prose-li:my-1\n          prose-table:my-3 prose-th:px-3 prose-th:py-2 prose-td:px-3 prose-td:py-2\n          [&_.katex]:text-white [&_.katex-display]:my-3 [&_.katex-display]:overflow-x-auto\">\n          <ReactMarkdown\n            remarkPlugins={[remarkGfm, remarkMath]}\n            rehypePlugins={[rehypeKatex]}\n            components={{\n              code: ({node, inline, className, children, ...props}: any) => {\n                return inline ? (\n                  <code className={className} {...props}>\n                    {children}\n                  </code>\n                ) : (\n                  <pre className=\"overflow-x-auto\">\n                    <code className={className} {...props}>\n                      {children}\n                    </code>\n                  </pre>\n                );\n              },\n              p: ({children, ...props}) => <p {...props}>{children}</p>\n            }}\n          >\n            {message.content}\n          </ReactMarkdown>\n        </div>\n        \n        {/* Thinking toggle - shows when streaming starts or thinking exists */}\n        {showToggle && message.role === 'assistant' && (\n          <div className=\"mt-3 pt-3 border-t border-white/20\">\n            <button\n              onClick={() => setShowThinking(!showThinking)}\n              className=\"flex items-center gap-2 text-sm opacity-80 hover:opacity-100 transition-opacity w-full text-left\"\n            >\n              <Brain size={16} />\n              <span>{showThinking ? 'Hide' : 'Show'} thinking</span>\n              {isStreaming && (\n                <span className=\"ml-auto text-xs opacity-60 animate-pulse\">\n                  {hasThinking ? 'streaming...' : 'waiting...'}\n                </span>\n              )}\n              {!isStreaming && hasThinking && (\n                <span className=\"ml-auto text-xs opacity-40\">\n                  {thinking?.length || 0} chars\n                </span>\n              )}\n            </button>\n            \n            {showThinking && hasThinking && (\n              <div className=\"mt-3 p-3 bg-black/20 rounded-lg text-sm\">\n                <div className=\"font-semibold mb-2 opacity-70 flex items-center justify-between\">\n                  <span>Reasoning:</span>\n                  {isStreaming && (\n                    <span className=\"text-xs opacity-60 animate-pulse\">updating live...</span>\n                  )}\n                </div>\n                <div className=\"prose prose-invert prose-sm max-w-none opacity-90 \n                  prose-p:my-1 prose-p:leading-relaxed\n                  prose-pre:bg-black/30 prose-pre:my-2\n                  prose-code:text-white prose-code:bg-black/20 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-xs\n                  [&_.katex]:text-white [&_.katex]:text-sm\">\n                  <ReactMarkdown\n                    remarkPlugins={[remarkGfm, remarkMath]}\n                    rehypePlugins={[rehypeKatex]}\n                  >\n                    {thinking}\n                  </ReactMarkdown>\n                </div>\n              </div>\n            )}\n            \n            {showThinking && !hasThinking && isStreaming && (\n              <div className=\"mt-3 p-3 bg-black/20 rounded-lg text-sm\">\n                <div className=\"text-xs opacity-60 italic\">Waiting for thinking to start...</div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1375, "column": 0}, "map": {"version":3,"sources":["file:///home/alpha/code/%40redbtn/webapp/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState, useRef } from 'react';\nimport { conversationStorage, type Conversation, type Message } from '@/lib/conversation';\nimport { ConfirmModal } from '@/components/Modal';\nimport { Header } from '@/components/Header';\nimport { Sidebar } from '@/components/Sidebar';\nimport { ChatInput } from '@/components/ChatInput';\nimport { Messages } from '@/components/Messages';\n\nexport default function ChatPage() {\n  const [conversations, setConversations] = useState<Conversation[]>([]);\n  const [activeConversationId, setActiveConversationId] = useState<string | null>(null);\n  const [input, setInput] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [skeletonShrinking, setSkeletonShrinking] = useState(false);\n  const [isStreaming, setIsStreaming] = useState(false);\n  const [streamingMessageId, setStreamingMessageId] = useState<string | null>(null);\n  const [currentThinking, setCurrentThinking] = useState<Record<string, string>>({});\n  const [currentStatus, setCurrentStatus] = useState<{action: string; description?: string} | null>(null);\n  const [isSidebarOpen, setIsSidebarOpen] = useState(false);\n  const [deleteModalOpen, setDeleteModalOpen] = useState(false);\n  const [conversationToDelete, setConversationToDelete] = useState<string | null>(null);\n  const [editingTitleId, setEditingTitleId] = useState<string | null>(null);\n  const [editingTitleValue, setEditingTitleValue] = useState('');\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  const activeConversation = conversations.find(c => c.id === activeConversationId);\n\n  // Track status changes with detailed logging\n  useEffect(() => {\n    if (currentStatus) {\n      console.log('ðŸŽ¯ [STATUS CHANGE] action:', currentStatus.action, 'description:', currentStatus.description);\n    } else {\n      console.log('ðŸŽ¯ [STATUS CHANGE] CLEARED (null)');\n    }\n  }, [currentStatus]);\n\n  // Load conversations on mount\n  useEffect(() => {\n    const stored = conversationStorage.getAll();\n    setConversations(stored);\n    \n    const activeId = conversationStorage.getActiveId();\n    if (activeId && stored.some(c => c.id === activeId)) {\n      setActiveConversationId(activeId);\n    } else if (stored.length > 0) {\n      setActiveConversationId(stored[0].id);\n      conversationStorage.setActiveId(stored[0].id);\n    }\n  }, []);\n\n  // Auto-scroll to bottom of messages\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [activeConversation?.messages]);\n\n  const createNewConversation = () => {\n    const newConv = conversationStorage.create();\n    setConversations(prev => [newConv, ...prev]);\n    setActiveConversationId(newConv.id);\n    conversationStorage.setActiveId(newConv.id);\n    setIsSidebarOpen(false);\n  };\n\n  const switchConversation = (id: string) => {\n    setActiveConversationId(id);\n    conversationStorage.setActiveId(id);\n    setIsSidebarOpen(false);\n    // Clear state when switching conversations\n    setCurrentThinking({});\n    setCurrentStatus(null);\n  };\n\n  const handleDeleteClick = (id: string, event: React.MouseEvent) => {\n    event.stopPropagation(); // Prevent switching to the conversation\n    setConversationToDelete(id);\n    setDeleteModalOpen(true);\n  };\n\n  const handleDeleteConfirm = () => {\n    if (!conversationToDelete) return;\n\n    // Delete the conversation\n    conversationStorage.delete(conversationToDelete);\n    const updatedConversations = conversationStorage.getAll();\n    setConversations(updatedConversations);\n\n    // If we deleted the active conversation, switch to another one\n    if (conversationToDelete === activeConversationId) {\n      if (updatedConversations.length > 0) {\n        setActiveConversationId(updatedConversations[0].id);\n        conversationStorage.setActiveId(updatedConversations[0].id);\n      } else {\n        setActiveConversationId(null);\n      }\n    }\n\n    setConversationToDelete(null);\n  };\n\n  // Fetch conversation title from Redis (generated by Red AI)\n  const fetchConversationTitle = async (conversationId: string) => {\n    try {\n      const response = await fetch(`/api/v1/conversations/${conversationId}/title`);\n      if (response.ok) {\n        const data = await response.json();\n        if (data.title) {\n          const conv = conversationStorage.get(conversationId);\n          if (conv && !conv.titleSetByUser) {\n            // Only update if user hasn't set a custom title\n            conv.title = data.title;\n            conversationStorage.save(conv);\n            setConversations(conversationStorage.getAll());\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Error fetching conversation title:', error);\n    }\n  };\n\n  // Update conversation title (user override)\n  const updateConversationTitle = async (conversationId: string, newTitle: string) => {\n    try {\n      const response = await fetch(`/api/v1/conversations/${conversationId}/title`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ title: newTitle })\n      });\n      \n      if (response.ok) {\n        const conv = conversationStorage.get(conversationId);\n        if (conv) {\n          conv.title = newTitle;\n          conv.titleSetByUser = true;\n          conversationStorage.save(conv);\n          setConversations(conversationStorage.getAll());\n        }\n      }\n    } catch (error) {\n      console.error('Error updating conversation title:', error);\n    }\n  };\n\n  const startEditingTitle = (conv: Conversation, event: React.MouseEvent) => {\n    event.stopPropagation();\n    setEditingTitleId(conv.id);\n    setEditingTitleValue(conv.title);\n  };\n\n  const saveEditedTitle = async (conversationId: string) => {\n    if (editingTitleValue.trim()) {\n      await updateConversationTitle(conversationId, editingTitleValue.trim());\n    }\n    setEditingTitleId(null);\n    setEditingTitleValue('');\n  };\n\n  const cancelEditingTitle = () => {\n    setEditingTitleId(null);\n    setEditingTitleValue('');\n  };\n\n  // Separate function to connect to message stream (can be called for reconnection)\n  const streamMessage = async (convId: string, messageId: string, streamUrl: string) => {\n    const assistantMessage: Message = {\n      id: messageId,\n      role: 'assistant',\n      content: '',\n      timestamp: Date.now()\n    };\n\n    let messageAdded = false;\n    let canStartDisplaying = false;\n    let firstCharReceived = false;\n    let streamingStarted = false; // NEW: Track if we've started streaming state\n    let receivedThinkingChunks = false; // Track if we received any thinking\n    const displayQueue: string[] = [];\n    let isDisplaying = false;\n    let displayedContent = '';\n\n    const startSkeletonShrink = () => {\n      if (streamingStarted) return; // Only do this once\n      streamingStarted = true;\n      \n      setSkeletonShrinking(true);\n      setIsStreaming(true);\n      // streamingMessageId already set in sendMessage()\n      \n      setTimeout(() => {\n        setIsLoading(false);\n        setSkeletonShrinking(false);\n        canStartDisplaying = true;\n      }, 400);\n    };\n\n    const displayNextChar = async () => {\n      if (isDisplaying) return;\n      if (!canStartDisplaying) {\n        setTimeout(() => displayNextChar(), 50);\n        return;\n      }\n      isDisplaying = true;\n\n      while (displayQueue.length > 0) {\n        const char = displayQueue.shift();\n        if (char) {\n          displayedContent += char;\n          assistantMessage.content = displayedContent;\n\n          if (!messageAdded && displayedContent.trim()) {\n            const conv = conversationStorage.get(convId);\n            if (conv) {\n              conv.messages.push(assistantMessage);\n              conversationStorage.save(conv);\n              setConversations(conversationStorage.getAll());\n              messageAdded = true;\n              setTimeout(() => {\n                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n              }, 50);\n            }\n          } else if (messageAdded) {\n            const conv = conversationStorage.get(convId);\n            if (conv) {\n              const msgIndex = conv.messages.findIndex(m => m.id === messageId);\n              if (msgIndex >= 0) {\n                conv.messages[msgIndex] = { ...assistantMessage };\n                conv.updatedAt = Date.now();\n                conversationStorage.save(conv);\n                setConversations(conversationStorage.getAll());\n              }\n            }\n          }\n\n          await new Promise(resolve => setTimeout(resolve, 10));\n        }\n      }\n\n      isDisplaying = false;\n    };\n\n    try {\n      const eventSource = await fetch(streamUrl, {\n        // Disable timeout on the fetch itself - let SSE stay open\n        signal: AbortSignal.timeout(300000) // 5 minute max timeout\n      });\n      if (!eventSource.ok) {\n        const errorText = await eventSource.text();\n        console.error('[Stream] Error response:', errorText);\n        \n        // If it's a 504 timeout, show a more helpful message\n        if (eventSource.status === 504) {\n          throw new Error('Request is taking longer than expected. The AI is still processing - please wait or try a simpler question.');\n        }\n        \n        throw new Error(`Failed to connect to stream: ${eventSource.status} ${errorText.substring(0, 200)}`);\n      }\n\n      const reader = eventSource.body?.getReader();\n      const decoder = new TextDecoder();\n\n      if (reader) {\n        while (true) {\n          const { done, value } = await reader.read();\n          if (done) break;\n\n          const chunk = decoder.decode(value);\n          const lines = chunk.split('\\n');\n\n          for (const line of lines) {\n            if (line.startsWith('data: ')) {\n              const data = line.slice(6);\n              if (data === '[DONE]') continue;\n\n              try {\n                const event = JSON.parse(data);\n                \n                // Handle different event types\n                if (event.type === 'status') {\n                  console.log('âš¡âš¡âš¡ [STATUS EVENT] action:', event.action, 'description:', event.description);\n                  setCurrentStatus({ action: event.action, description: event.description });\n                  console.log('âš¡âš¡âš¡ [STATUS SET] New status should be:', event.action);\n                  continue;\n                }\n                \n                if (event.type === 'tool_status') {\n                  console.log('ðŸ”§ðŸ”§ðŸ”§ [TOOL_STATUS EVENT] action:', event.action, 'status:', event.status);\n                  // Convert tool action to status for consistent UI display\n                  setCurrentStatus({ action: event.action, description: event.status });\n                  console.log('ðŸ”§ðŸ”§ðŸ”§ [TOOL_STATUS SET] New status should be:', event.action);\n                  continue;\n                }\n                \n                if (event.type === 'thinking_chunk' && event.content) {\n                  if (!receivedThinkingChunks) {\n                    receivedThinkingChunks = true;\n                  }\n                  setCurrentThinking(prev => ({\n                    ...prev,\n                    [messageId]: (prev[messageId] || '') + event.content\n                  }));\n                  \n                  // DON'T call startSkeletonShrink here - keep loading state visible during thinking\n                  // It will shrink when content starts arriving\n                  continue;\n                }\n                \n                if (event.type === 'content' && event.content) {\n                  if (!firstCharReceived) {\n                    firstCharReceived = true;\n                    startSkeletonShrink();\n                  }\n                  \n                  const characters = event.content.split('');\n                  displayQueue.push(...characters);\n                  \n                  if (!isDisplaying) {\n                    displayNextChar();\n                  }\n                  continue;\n                }\n                \n                if (event.type === 'thinking' && event.content) {\n                  // Legacy: Store full thinking block\n                  setCurrentThinking(prev => ({\n                    ...prev,\n                    [messageId]: (prev[messageId] || '') + event.content\n                  }));\n                  \n                  // Ensure streaming state is set when thinking arrives\n                  if (!streamingStarted) {\n                    startSkeletonShrink();\n                  }\n                  continue;\n                }\n                \n                if (event.type === 'complete') {\n                  // Generation complete\n                  break; // Exit the stream reader loop\n                }\n                \n                if (event.type === 'error') {\n                  throw new Error(event.error);\n                }\n              } catch (e) {\n                if (e instanceof SyntaxError) continue; // Ignore JSON parse errors\n                throw e;\n              }\n            }\n          }\n        }\n\n        // Wait for display queue to finish\n        while (displayQueue.length > 0 || isDisplaying) {\n          await new Promise(resolve => setTimeout(resolve, 50));\n        }\n\n        if (displayedContent.trim() && !messageAdded) {\n          const conv = conversationStorage.get(convId);\n          if (conv) {\n            conv.messages.push(assistantMessage);\n            conversationStorage.save(conv);\n          }\n        }\n      } // Close if (reader) block\n    } catch (error: any) {\n      throw error;\n    } finally {\n      setIsLoading(false);\n      setSkeletonShrinking(false);\n      setIsStreaming(false);\n      setStreamingMessageId(null);\n      setCurrentStatus(null);\n    }\n  };\n\n  const sendMessage = async () => {\n    if (!input.trim() || isLoading) return;\n    \n    let convId = activeConversationId;\n    \n    // Create new conversation if none exists\n    if (!convId) {\n      const newConv = conversationStorage.create();\n      setConversations(prev => [newConv, ...prev]);\n      convId = newConv.id;\n      setActiveConversationId(convId);\n      conversationStorage.setActiveId(convId);\n    }\n\n    const userMessage: Message = {\n      id: `msg_${Date.now()}_user`,\n      role: 'user',\n      content: input.trim(),\n      timestamp: Date.now()\n    };\n\n    // Add user message\n    conversationStorage.addMessage(convId, userMessage);\n    setConversations(conversationStorage.getAll());\n    setInput('');\n    setIsLoading(true);\n    \n    // Clear status and thinking - backend router will send the first status update immediately\n    setCurrentStatus(null);\n    setCurrentThinking({});\n\n    try {\n      // Step 1: Trigger generation (returns immediately with messageId)\n      const response = await fetch('/api/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          model: 'Red',\n          messages: [{ role: 'user', content: userMessage.content }],\n          stream: true,\n          conversationId: convId\n        })\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to start generation');\n      }\n\n      const data = await response.json();\n      const messageId = data.id;\n      const streamUrl = data.stream_url;\n      \n      // Set streaming message ID immediately so LoadingStateContainer can render\n      setStreamingMessageId(messageId);\n\n      // Step 2: Connect to message stream\n      await streamMessage(convId, messageId, streamUrl);\n\n      // Fetch title after message completes\n      const conv = conversationStorage.get(convId);\n      const messageCount = conv?.messages.length || 0;\n      if (messageCount === 2 || messageCount === 6) {\n        setTimeout(() => fetchConversationTitle(convId), 1500);\n      }\n    } catch (error) {\n      console.error('Error sending message:', error);\n      console.error('Error details:', {\n        message: error instanceof Error ? error.message : String(error),\n        stack: error instanceof Error ? error.stack : undefined,\n        error\n      });\n      alert(`Failed to send message: ${error instanceof Error ? error.message : String(error)}`);\n      setIsLoading(false);\n      setSkeletonShrinking(false);\n    }\n  };\n\n  return (\n    <div className=\"flex bg-[#0a0a0a]\" style={{ height: 'calc(var(--vh, 1vh) * 100)' }}>\n      {/* Sidebar */}\n      <Sidebar\n        isOpen={isSidebarOpen}\n        conversations={conversations}\n        activeConversationId={activeConversationId}\n        editingTitleId={editingTitleId}\n        editingTitleValue={editingTitleValue}\n        onClose={() => setIsSidebarOpen(false)}\n        onNewChat={createNewConversation}\n        onSwitchConversation={switchConversation}\n        onDeleteClick={handleDeleteClick}\n        onStartEditingTitle={startEditingTitle}\n        onSaveEditedTitle={saveEditedTitle}\n        onCancelEditingTitle={cancelEditingTitle}\n        onEditingTitleChange={setEditingTitleValue}\n      />\n\n      {/* Main content */}\n      <div className=\"flex-1 flex flex-col\">\n        {/* Header */}\n        <Header\n          title={activeConversation?.title || 'Chat'}\n          onMenuClick={() => setIsSidebarOpen(!isSidebarOpen)}\n          onNewChat={createNewConversation}\n        />\n\n        {/* Messages */}\n        <Messages\n          messages={activeConversation?.messages}\n          thinking={currentThinking}\n          currentStatus={currentStatus}\n          isLoading={isLoading}\n          isStreaming={isStreaming}\n          streamingMessageId={streamingMessageId}\n          skeletonShrinking={skeletonShrinking}\n          messagesEndRef={messagesEndRef}\n          conversationId={activeConversation?.id}\n        />\n\n        {/* Input */}\n        <ChatInput\n          value={input}\n          disabled={isLoading}\n          messagesEndRef={messagesEndRef}\n          onChange={setInput}\n          onSend={sendMessage}\n        />\n      </div>\n\n      {/* Delete Confirmation Modal */}\n      <ConfirmModal\n        isOpen={deleteModalOpen}\n        onClose={() => setDeleteModalOpen(false)}\n        onConfirm={handleDeleteConfirm}\n        title=\"Delete Conversation\"\n        message=\"Are you sure you want to delete this conversation? This action cannot be undone.\"\n        confirmText=\"Delete\"\n        cancelText=\"Cancel\"\n        variant=\"danger\"\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}