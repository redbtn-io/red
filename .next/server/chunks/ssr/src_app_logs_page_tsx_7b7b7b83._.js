module.exports=[82602,a=>{"use strict";a.s(["default",()=>n],82602);var b=a.i(87924),c=a.i(72131),d=a.i(26988),e=a.i(20238),f=a.i(45209);let g="text-xs px-3 py-1 rounded bg-[var(--background)] text-[var(--foreground)] hover:bg-[var(--background)]/60",h="bg-[var(--red-primary)] text-white";function i(a){return!!a&&"object"==typeof a&&!!Object.prototype.hasOwnProperty.call(a,"logs")&&Array.isArray(a.logs)}function j({conversationId:a,generationId:d,filterLevel:e,filterCategory:f,showThoughts:j,onStreamingChange:l}){let[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(!1),w=(0,c.useRef)(null),x=(0,c.useRef)(null),y=(0,c.useCallback)(async()=>{l(!0);try{let b=d?`/api/v1/generations/${d}/stream`:`/api/v1/conversations/${a}/stream`,c=await fetch(b);if(!c.ok)throw Error("Failed to stream logs");let e=c.body?.getReader();if(!e)throw Error("Stream not available");let f=new TextDecoder,g="";for(;;){let{done:a,value:b}=await e.read();if(a)break;let c=(g+=f.decode(b,{stream:!0})).split("\n");for(let a of(g=c.pop()||"",c))if(a.startsWith("data: "))try{let b=JSON.parse(a.slice(6));b&&"object"==typeof b&&"id"in b&&"timestamp"in b&&n(a=>[...a,b])}catch(a){console.error("Failed to parse log:",a)}else if(a.startsWith("event: complete"))return void l(!1)}}catch(a){console.error("Streaming error:",a instanceof Error?a.message:String(a)),l(!1)}},[a,d,l]);(0,c.useEffect)(()=>{s&&w.current&&w.current.scrollIntoView({behavior:"smooth"})},[m,s]),(0,c.useEffect)(()=>a||d?(x.current&&x.current.abort(),x.current=new AbortController,(async()=>{p(!0),r(null),l(!1);try{let b=!1;if(d){let a=await fetch(`/api/v1/generations/${d}/logs`,{signal:x.current?.signal});if(!a.ok)throw Error("Failed to fetch logs");let c=await a.json();i(c)&&n(c.logs);let e=await fetch(`/api/v1/generations/${d}`),f=await e.json();f&&"string"==typeof f.status&&(b="generating"===f.status)}else if(a){let c=await fetch(`/api/v1/conversations/${a}/logs`,{signal:x.current?.signal});if(!c.ok)throw Error("Failed to fetch logs");let d=await c.json();i(d)&&n(d.logs);let e=await fetch(`/api/v1/conversations/${a}/generation-state`),f=await e.json();f&&"boolean"==typeof f.isGenerating&&(b=f.isGenerating)}p(!1),b&&y()}catch(b){let a=b&&"string"==typeof b.name&&"AbortError"===b.name?null:b instanceof Error?b.message:String(b);a&&(r(a),p(!1))}})(),()=>{x.current?.abort()}):void n([]),[a,d,y,l]);let z=m.filter(a=>("all"===e||a.level===e)&&("all"===f||a.category===f)&&(!!j||"thought"!==a.category));return a||d?o?(0,b.jsxs)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] p-12 text-center",children:[(0,b.jsx)("div",{className:"inline-block w-8 h-8 border-4 border-[var(--background)] border-t-[var(--red-primary)] rounded-full animate-spin mb-4"}),(0,b.jsx)("p",{className:"text-[var(--foreground)] opacity-60",children:"Loading logs..."})]}):q?(0,b.jsx)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] p-6",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"text-2xl",children:"âŒ"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-[var(--red-primary)] mb-1",children:"Error loading logs"}),(0,b.jsx)("p",{className:"text-[var(--foreground)] opacity-60 text-sm",children:q})]})]})}):(0,b.jsxs)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] overflow-hidden",children:[(0,b.jsxs)("div",{className:"bg-[var(--background)]/40 border-b border-[var(--border-color)] px-4 py-3 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"text-sm text-[var(--foreground)] opacity-70",children:[(0,b.jsx)("span",{className:"font-medium",children:z.length})," ",1===z.length?"log":"logs"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>t(!s),className:`${g} ${s?h:""}`,title:s?"Disable auto-scroll":"Enable auto-scroll",children:s?"ðŸ“Œ Auto":"ðŸ“Œ"}),(0,b.jsx)("button",{onClick:()=>v(!u),className:`${g} ${u?h:""}`,title:u?"Disable compact view":"Enable compact view",children:u?"ï¿½ Compact":"ï¿½"}),(0,b.jsx)("button",{onClick:()=>n([]),className:g,title:"Clear logs",children:"ðŸ—‘ï¸"}),(0,b.jsx)("button",{onClick:()=>{let a=z.map(a=>`[${new Date(a.timestamp).toISOString()}] [${a.level}] ${a.message.replace(/<\/?(?:red|green|yellow|blue|magenta|cyan|white|black|gray|dim|bold|underline|blink|reverse|hidden)>/gi,"")}`).join("\n");navigator.clipboard.writeText(a)},className:g,title:"Copy logs",children:"ðŸ“‹"})]})]}),(0,b.jsx)("div",{className:"p-4 max-h-[70vh] overflow-y-auto font-sans text-sm",children:0===z.length?(0,b.jsx)("div",{className:"text-center py-12 text-[var(--foreground)] opacity-60",children:"No logs match the current filters"}):(0,b.jsxs)("div",{className:"space-y-2",children:[z.map(a=>(0,b.jsx)(k,{log:a,compact:u},a.id)),(0,b.jsx)("div",{ref:w})]})})]}):(0,b.jsxs)("div",{className:"bg-gray-900 rounded-lg border border-gray-800 p-12 text-center",children:[(0,b.jsx)("div",{className:"text-6xl mb-4",children:"ðŸ“"}),(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No logs selected"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Enter a conversation ID or generation ID to view logs"})]})}function k({log:a,compact:d}){let e,f=new Date(a.timestamp).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3}),g=(e=a.message,Object.entries({red:"text-red-400",green:"text-green-400",yellow:"text-yellow-400",blue:"text-blue-400",magenta:"text-magenta-400",cyan:"text-cyan-400",white:"text-white",gray:"text-gray-400",dim:"text-gray-500",bold:"font-bold"}).forEach(([a,b])=>{let c=RegExp(`<${a}>`,"gi");e=e.replace(c,`<span class="${b}">`)}),e=e.replace(/<\/(?:red|green|yellow|blue|magenta|cyan|white|black|gray|dim|bold|underline|blink|reverse|hidden)>/gi,"</span>")),[h,i]=(0,c.useState)(!1);return(0,b.jsxs)("div",{className:`py-3 px-3 rounded-lg group border border-[var(--border-color)]/30 bg-[var(--background)] ${d?"py-2 px-2":"py-3 px-3"}`,children:[(0,b.jsxs)("div",{className:`flex items-center gap-3 ${d?"mb-1":"mb-2"} flex-wrap`,children:[(0,b.jsx)("span",{className:"text-[var(--foreground)]/70 text-xs tabular-nums shrink-0",children:f}),(0,b.jsx)("span",{className:"shrink-0",title:a.level,children:{debug:"ðŸ›",info:"â„¹ï¸",success:"âœ…",warning:"âš ï¸",error:"âŒ"}[a.level]||"â€¢"}),(0,b.jsx)("span",{className:`shrink-0 text-xs uppercase font-semibold ${{debug:"text-gray-500",info:"text-blue-400",success:"text-green-400",warning:"text-yellow-400",error:"text-red-400"}[a.level]}`,children:a.level}),(0,b.jsx)("span",{className:"shrink-0 text-xs text-[var(--foreground)]/60 uppercase",children:a.category}),(0,b.jsx)("button",{onClick:()=>i(a=>!a),className:"ml-auto text-xs px-2 py-1 rounded bg-[var(--background)] text-[var(--foreground)] hover:bg-[var(--background)]/60",title:h?"Collapse":"Expand",children:h?"â–¾":"â–¸"})]}),(!d||h)&&(0,b.jsx)("div",{className:"pl-2 break-words text-sm leading-relaxed font-mono text-[var(--foreground)]/90",children:(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:g}})})]})}function l({conversationId:a,setConversationId:c,generationId:d,setGenerationId:e,filterLevel:f,setFilterLevel:g,filterCategory:h,setFilterCategory:i,showThoughts:j,setShowThoughts:k}){return(0,b.jsxs)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] p-4 space-y-4",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-[var(--foreground)] mb-4",children:"Filters"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"Conversation ID"}),(0,b.jsx)("input",{type:"text",value:a,onChange:a=>{c(a.target.value),e("")},placeholder:"conv_...",className:"w-full px-3 py-2 bg-[var(--background)] border border-[var(--border-color)] rounded text-sm text-[var(--foreground)] placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--red-primary)]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"Generation ID"}),(0,b.jsx)("input",{type:"text",value:d,onChange:a=>{e(a.target.value),c("")},placeholder:"gen_...",className:"w-full px-3 py-2 bg-[var(--background)] border border-[var(--border-color)] rounded text-sm text-[var(--foreground)] placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--red-primary)]"})]}),(0,b.jsx)("div",{className:"border-t border-[var(--border-color)] pt-4"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"Log Level"}),(0,b.jsxs)("select",{value:f,onChange:a=>g(a.target.value),className:"w-full px-3 py-2 bg-[var(--background)] border border-[var(--border-color)] rounded text-sm text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--red-primary)]",children:[(0,b.jsx)("option",{value:"all",children:"All Levels"}),(0,b.jsx)("option",{value:"debug",children:"ðŸ› Debug"}),(0,b.jsx)("option",{value:"info",children:"â„¹ï¸ Info"}),(0,b.jsx)("option",{value:"success",children:"âœ… Success"}),(0,b.jsx)("option",{value:"warning",children:"âš ï¸ Warning"}),(0,b.jsx)("option",{value:"error",children:"âŒ Error"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"Category"}),(0,b.jsxs)("select",{value:h,onChange:a=>i(a.target.value),className:"w-full px-3 py-2 bg-[var(--background)] border border-[var(--border-color)] rounded text-sm text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--red-primary)]",children:[(0,b.jsx)("option",{value:"all",children:"All Categories"}),(0,b.jsx)("option",{value:"generation",children:"ðŸ”„ Generation"}),(0,b.jsx)("option",{value:"router",children:"ðŸ§­ Router"}),(0,b.jsx)("option",{value:"tool",children:"ðŸ”§ Tool"}),(0,b.jsx)("option",{value:"chat",children:"ðŸ’¬ Chat"}),(0,b.jsx)("option",{value:"thought",children:"ðŸ’­ Thought"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:j,onChange:a=>k(a.target.checked),className:"w-4 h-4 rounded border-[var(--border-color)] bg-[var(--background)] text-[var(--red-primary)] focus:ring-2 focus:ring-[var(--red-primary)]"}),(0,b.jsx)("span",{className:"text-sm text-[var(--foreground)] opacity-70",children:"ðŸ’­ Show Thoughts"})]}),(0,b.jsx)("p",{className:"text-xs text-[var(--foreground)] opacity-50 mt-1 ml-6",children:"Internal reasoning from AI nodes"})]}),(0,b.jsxs)("div",{className:"border-t border-[var(--border-color)] pt-4 space-y-2",children:[(0,b.jsx)("button",{onClick:()=>{g("all"),i("all"),k(!0)},className:"w-full px-3 py-2 bg-[var(--background)] hover:bg-[var(--sidebar-bg)] text-sm text-[var(--foreground)] opacity-70 hover:opacity-100 rounded transition-all",children:"Reset Filters"}),(0,b.jsx)("button",{onClick:()=>{c(""),e("")},className:"w-full px-3 py-2 bg-[var(--background)] hover:bg-[var(--sidebar-bg)] text-sm text-[var(--foreground)] opacity-70 hover:opacity-100 rounded transition-all",children:"Clear IDs"})]})]})}function m({conversationId:a}){let[d,e]=(0,c.useState)(null),[f,g]=(0,c.useState)(!1);return((0,c.useEffect)(()=>{if(!a)return void e(null);let b=async()=>{g(!0);try{let b=await fetch(`/api/v1/logs/stats?conversationId=${a}`);if(b.ok){let a=await b.json();e(a)}}catch(a){console.error("Failed to fetch stats:",a)}g(!1)};b();let c=setInterval(()=>{d?.isGenerating&&b()},5e3);return()=>clearInterval(c)},[a,d?.isGenerating]),a)?f&&!d?(0,b.jsx)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] p-4",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-3",children:[(0,b.jsx)("div",{className:"h-4 bg-[var(--background)] rounded w-3/4"}),(0,b.jsx)("div",{className:"h-4 bg-[var(--background)] rounded w-1/2"})]})}):d?(0,b.jsxs)("div",{className:"bg-[var(--card-bg)] rounded-lg border border-[var(--border-color)] p-4 space-y-4",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-[var(--foreground)] mb-4",children:"Statistics"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-[var(--foreground)] opacity-60",children:"Total Logs"}),(0,b.jsx)("span",{className:"text-[var(--foreground)] font-semibold",children:d.totalLogs})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-[var(--foreground)] opacity-60",children:"Generations"}),(0,b.jsx)("span",{className:"text-[var(--foreground)] font-semibold",children:d.generationCount})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-[var(--foreground)] opacity-60",children:"Status"}),(0,b.jsx)("span",{className:d.isGenerating?"text-[var(--red-primary)]":"text-[var(--foreground)] opacity-40",children:d.isGenerating?"ðŸŸ¢ Active":"âšª Idle"})]})]}),(0,b.jsxs)("div",{className:"border-t border-[var(--border-color)] pt-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"By Level"}),(0,b.jsx)("div",{className:"space-y-2",children:Object.entries(d.byLevel).map(([a,c])=>{let e={debug:"text-gray-500",info:"text-blue-400",success:"text-green-400",warning:"text-yellow-400",error:"text-red-400"},f=d.totalLogs>0?c/d.totalLogs*100:0;return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,b.jsxs)("span",{className:e[a],children:[{debug:"ðŸ›",info:"â„¹ï¸",success:"âœ…",warning:"âš ï¸",error:"âŒ"}[a]," ",a]}),(0,b.jsx)("span",{className:"text-[var(--foreground)] opacity-60",children:c})]}),(0,b.jsx)("div",{className:"w-full bg-[var(--background)] rounded-full h-1.5",children:(0,b.jsx)("div",{className:`h-1.5 rounded-full ${e[a].replace("text-","bg-")}`,style:{width:`${f}%`}})})]},a)})})]}),(0,b.jsxs)("div",{className:"border-t border-[var(--border-color)] pt-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-[var(--foreground)] opacity-70 mb-2",children:"By Category"}),(0,b.jsx)("div",{className:"space-y-2",children:Object.entries(d.byCategory).map(([a,c])=>{let e=d.totalLogs>0?c/d.totalLogs*100:0;return(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,b.jsxs)("span",{className:"text-[var(--foreground)] opacity-60",children:[{generation:"ðŸ”„",router:"ðŸ§­",tool:"ðŸ”§",chat:"ðŸ’¬",thought:"ðŸ’­"}[a]," ",a]}),(0,b.jsx)("span",{className:"text-[var(--foreground)] font-medium",children:c})]}),(0,b.jsx)("div",{className:"w-full bg-[var(--background)] rounded-full h-1.5",children:(0,b.jsx)("div",{className:"h-1.5 rounded-full bg-[var(--red-primary)]",style:{width:`${e}%`}})})]},a)})})]})]}):null:null}function n(){let[a,g]=(0,c.useState)(""),[h,i]=(0,c.useState)(""),[k,n]=(0,c.useState)("all"),[o,p]=(0,c.useState)("all"),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(null);(0,c.useEffect)(()=>{let a=d.conversationStorage.getAll();x(a);let b=d.conversationStorage.getActiveId();b&&a.some(a=>a.id===b)&&(z(b),g(b))},[]);let A=()=>{let a=d.conversationStorage.create();x(b=>[a,...b]),z(a.id),d.conversationStorage.setActiveId(a.id),g(a.id),v(!1)};return(0,b.jsxs)("div",{className:"flex bg-[var(--background)]",style:{height:"calc(var(--vh, 1vh) * 100)"},children:[(0,b.jsx)(f.Sidebar,{isOpen:u,conversations:w,activeConversationId:y,editingTitleId:null,editingTitleValue:"",onClose:()=>v(!1),onNewChat:A,onSwitchConversation:a=>{z(a),d.conversationStorage.setActiveId(a),g(a),i(""),v(!1)},onDeleteClick:()=>{},onStartEditingTitle:()=>{},onSaveEditedTitle:()=>{},onCancelEditingTitle:()=>{},onEditingTitleChange:()=>{}}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,b.jsx)(e.Header,{title:"ðŸ“ Virtual Terminal",onMenuClick:()=>v(!u),onNewChat:A}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,b.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,b.jsx)("div",{children:(0,b.jsx)("p",{className:"text-[var(--foreground)] text-sm opacity-70",children:"Real-time logs from Red AI generations"})}),s&&(0,b.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-[var(--red-primary)]/10 border border-[var(--red-primary)]/30 rounded-lg",children:[(0,b.jsx)("div",{className:"w-2 h-2 bg-[var(--red-primary)] rounded-full animate-pulse"}),(0,b.jsx)("span",{className:"text-[var(--red-primary)] text-sm font-medium",children:"LIVE"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,b.jsx)(l,{conversationId:a,setConversationId:g,generationId:h,setGenerationId:i,filterLevel:k,setFilterLevel:n,filterCategory:o,setFilterCategory:p,showThoughts:q,setShowThoughts:r}),(0,b.jsx)(m,{conversationId:a})]}),(0,b.jsx)("div",{className:"lg:col-span-3",children:(0,b.jsx)(j,{conversationId:a,generationId:h,filterLevel:k,filterCategory:o,showThoughts:q,onStreamingChange:t})})]})]})]})]})}}];

//# sourceMappingURL=src_app_logs_page_tsx_7b7b7b83._.js.map